<?xml version="1.0" encoding="utf-8"?><rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>æ‚ é—²ã®å°å±‹</title><link>https://keepjolly.com/</link><description>ä¸€ä¸ªæç®€ä¸»é¢˜çš„åšå®¢ã€‚</description><generator>Hugo 0.120.4 https://gohugo.io/</generator><language>zh-CN</language><managingEditor>1366475809@qq.com (Rurouni)</managingEditor><webMaster>1366475809@qq.com (Rurouni)</webMaster><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><lastBuildDate>Sun, 19 Nov 2023 15:12:54 +0000</lastBuildDate><atom:link rel="self" type="application/rss+xml" href="https://keepjolly.com/rss.xml"/><item><title>å…¬åŠ¡å‘˜è¡Œæµ‹--è¨€è¯­ç†è§£</title><link>https://keepjolly.com/posts/learn/speech-understanding/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/speech-understanding/</guid><pubDate>Sun, 19 Nov 2023 22:34:44 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;p>è¿™ä¸ªè€å¸ˆä¸è®²é€‰é¡¹çš„å…¶ä»–é”™è¯¯åœ°æ–¹ï¼Œæœ‰ç‚¹ä¸å¥½&lt;/p>
&lt;h2 id="å‡†å¤‡çŸ¥è¯†">å‡†å¤‡çŸ¥è¯†&lt;/h2>
&lt;p>å›½è€ƒä¸»è¦è€ƒé€»è¾‘å¡«ç©ºã€ä¸­å¿ƒç†è§£&lt;/p>
&lt;ol>
&lt;li>é€»è¾‘å¡«ç©º&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>å½¢å¼ï¼šé¢˜å¹²+é—®æ³•+é€‰é¡¹&lt;/li>
&lt;li>é¢˜å¹²ä¸ºæ–‡æ®µä½†æ˜¯å…¶ä¸­æŒ–å»1-4ä¸ªæˆè¯­/å®è¯ å½¢æˆç©ºæ ¼&lt;/li>
&lt;li>é—®æ³•ä¸ºå¡«å…¥ç”»æ¨ªçº¿/æ‹¬å·éƒ¨åˆ†æœ€æ°å½“çš„ä¸€é¡¹æ˜¯ï¼Ÿ&lt;/li>
&lt;li>é€‰é¡¹ä¸ºå•é€‰ï¼Œå››ä¸ªé€‰é¡¹ éœ€ç†è§£æ–‡æ®µï¼Œé€‰å‡ºè¢«æŒ–å»çš„æˆè¯­/å®è¯&lt;/li>
&lt;/ul>
&lt;ol start="2">
&lt;li>ä¸­å¿ƒç†è§£&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>å½¢å¼ï¼šé¢˜å¹²+é—®æ³•+é€‰é¡¹&lt;/li>
&lt;li>é¢˜å¹²æ˜¯å®Œæ•´æ–‡æ®µï¼Œéœ€è¦æ•´ä½“é˜…è¯»ç†è§£&lt;/li>
&lt;li>é—®æ³•å¸¸ä¸ºè¿™æ®µæ–‡å­—ç»™æˆ‘ä»¬çš„å¯ç¤ºæ˜¯ï¼Ÿè¿™æ®µæ–‡å­—ä¸»è¦ä»‹ç»ï¼Ÿè¿™æ®µæ–‡å­—çš„æ ¸å¿ƒè§‚ç‚¹æ˜¯ï¼Ÿè¿™æ®µæ–‡å­—æ„åœ¨å¼ºè°ƒï¼Ÿæœ€é€‚åˆåšè¿™æ®µæ–‡å­—æ ‡é¢˜çš„æ˜¯ï¼Ÿç­‰ç­‰ç›®çš„æ˜¯è®©ä½ ç†è§£æ–‡æ®µçš„é—®æ³•&lt;/li>
&lt;li>é€‰é¡¹ä¸ºå•é€‰ï¼Œå››ä¸ªé€‰é¡¹ï¼Œéœ€ç†è§£æ–‡æ®µï¼Œé€‰å‡ºæ–‡æ®µæ ¸å¿ƒæ„æ€&lt;/li>
&lt;/ul>
&lt;ol start="3">
&lt;li>è¯­å¥å¡«å…¥&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>å½¢å¼ï¼šé¢˜å¹²+é—®æ³•+é€‰é¡¹&lt;/li>
&lt;li>é¢˜å¹²ä¸ºæ–‡æ®µï¼Œä½†æ˜¯æŒ–å»äº†å…¶ä¸­çš„ä¸€å¥å®Œæ•´å¥å­ï¼Œå½¢æˆç©ºæ ¼&lt;/li>
&lt;li>é—®æ³•ä¸ºå¡«å…¥ç”»æ¨ªçº¿/æ‹¬å·éƒ¨åˆ†æœ€æ°å½“çš„ä¸€å¥æ˜¯ï¼Ÿ&lt;/li>
&lt;li>é€‰é¡¹ä¸ºå•é€‰ï¼Œå››ä¸ªé€‰é¡¹ï¼Œéœ€ç†è§£æ–‡æ®µåŠç©ºæ ¼ä¸Šä¸‹æ–‡ï¼Œé€‰å‡ºè¢«æŒ–å»çš„å¥å­&lt;/li>
&lt;/ul>
&lt;ol start="4">
&lt;li>è¯­å¥æ’åº&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>å½¢å¼ï¼šé¢˜å¹²+é—®æ³•+é€‰é¡¹&lt;/li>
&lt;li>é¢˜å¹²æ˜¯å¤šä¸ªç‹¬ç«‹ä¸”ä¹±åºçš„å¥å­ï¼Œéœ€è¦å¯¹å¥å­æŒ‰ç…§åˆç†é¡ºåºè¿›è¡Œæ’åº&lt;/li>
&lt;li>é—®æ³•æ˜¯å°†ä»¥ä¸Šå¥å­é‡æ–°æ’åˆ—ï¼Œé¡ºåºæœ€æ°å½“æ­£ç¡®çš„ä¸€ç»„æ˜¯ï¼Ÿ&lt;/li>
&lt;li>é€‰é¡¹ä¸ºé€‰é¡¹ä¸ºå•é€‰ï¼Œå››ä¸ªé€‰é¡¹ï¼Œæ¯ä¸ªé€‰é¡¹éƒ½æ˜¯ä¸€ç»„å¥å­é¡ºåº&lt;/li>
&lt;/ul>
&lt;ol start="5">
&lt;li>ä¸‹æ–‡æ¨æ–­&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>å½¢å¼é¢˜å¹²+é—®æ³•é€‰é¡¹&lt;/li>
&lt;li>é¢˜å¹²æ˜¯å®Œæ•´çš„æ–‡æ®µï¼Œéœ€è¦æ•´ä½“é˜…è¯»ç†è§£&lt;/li>
&lt;li>é—®æ³•ä¸ºè¿™æ®µæ–‡å­—æ¥ä¸‹æœ€å¯æ’è®²è¿°/è°ˆè®ºçš„æ˜¯ï¼Ÿ&lt;/li>
&lt;li>é€‰é¡¹ä¸ºå•é€‰ï¼Œå››ä¸ªé€‰é¡¹ï¼Œéœ€è¦é€‰å‡ºä¸‹æ–‡å¯èƒ½å‡ºç°çš„å®Œæ•´è¯­å¥&lt;/li>
&lt;/ul>
&lt;ol start="6">
&lt;li>ç»†èŠ‚åˆ¤æ–­&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>å½¢å¼ï¼šé¢˜å¹²+é—®æ³•+é€‰é¡¹&lt;/li>
&lt;li>é¢˜å¹²æ˜¯å®Œæ•´çš„æ–‡æ®µï¼Œéœ€è¦æ•´ä½“é˜…è¯»&lt;/li>
&lt;li>é—®æ³•ä¸ºä¸‹åˆ—è¯´æ³•ä¸åŸæ–‡ç›¸ç¬¦/ä¸ç¬¦çš„æ˜¯ï¼Ÿä»¥ä¸‹æ— æ³•ä»ä¸Šè¿°æ–‡å­—å¾—çŸ¥çš„æ˜¯ï¼Ÿä»¥ä¸‹æ¦‚æ‹¬æ–‡ä¸­æœªæ¶‰åŠçš„æ˜¯ï¼Ÿç­‰ç­‰éœ€è¦å’Œæ–‡æ®µéƒ¨åˆ†å†…å®¹ä¸€ä¸€å¯¹åº”çš„é—®æ³•ã€‚&lt;/li>
&lt;li>é€‰é¡¹ä¸ºå•é€‰ï¼Œå››ä¸ªé€‰é¡¹ï¼Œéœ€è¦å’Œæ–‡æ®µè¿›è¡Œä¸€ä¸€å¯¹åº”&lt;/li>
&lt;/ul>
&lt;h2 id="è„‰ç»œå‰–æ-åŸºç¡€">è„‰ç»œå‰–æ-åŸºç¡€&lt;/h2>
&lt;ol>
&lt;li>åŸºæœ¬æ¦‚è¿°
&lt;ol>
&lt;li>ä»€ä¹ˆå«è„‰ç»œï¼Ÿå…¶å®å°±æ˜¯å†™æ–‡ç« çš„æ€ç»´ï¼Œå¦‚æœä½ è¦è¡¨è¾¾ä½ çš„è§‚ç‚¹ï¼Œåœ¨ä¸€ç¯‡å®Œæ•´çš„æ–‡ç« é‡Œé¢ï¼Œä¸å¯èƒ½ä¸€ä¸Šæ¥ä»€ä¹ˆéƒ½ä¸è¯´ï¼Œç›´æ¥è¯´è§‚ç‚¹ï¼Œä¸€å®šæ˜¯ä¸€æ­¥ä¸€æ­¥å¼•å‡ºæ¥çš„ï¼Œå› ä¸ºå†™æ–‡ç« çš„åŸºç¡€æ€è·¯ï¼Œå°±æ˜¯è®©è¯»è€…èƒ½å¤Ÿå……åˆ†ä½“ä¼šä½ æƒ³è¡¨è¾¾çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä¸€å®šè¦å°½å¯èƒ½é“ºå«ã€‚&lt;br />å¸¸è§çš„è„‰ç»œé¡ºæ‰¿æ–¹å¼ï¼šä»£æŒ‡ï¼ˆè¿™ï¼Œå…¶ï¼Œä¹‹ï¼Œæ­¤ï¼‰;è½¬æŠ˜ï¼ˆä½†æ˜¯ï¼Œè€Œï¼Œè€Œæ˜¯ã€‚);ç»“è®º&lt;br />(æ‰€ä»¥ï¼Œç”±xxå¯å¾—ã€‚....);ç›¸åŒè¯é¢˜ç­‰&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>ä¸‰å¤§åŸåˆ™
&lt;ol>
&lt;li>é¡ºæ‰¿è¯´æ„ä¹‰ï¼Œåæ–‡æ„ä¹‰ä¸é‡è¦ï¼Œè¿™æ˜¯è§‚ç‚¹æå‡ºçš„æ–¹å¼&lt;/li>
&lt;li>é¡ºæ‰¿å¼•å‡ºæ–°è¯é¢˜ï¼Œè‹¥åæ–‡åå¤è®ºè¿°æ–°è¯é¢˜ï¼Œåˆ™åæ–‡å†…å®¹é‡è¦ï¼›è‹¥å¤ç„¶è€Œæ­¢æä¸€ä¸‹ï¼Œ&lt;br />åˆ™ä¸é‡è¦
&lt;ol>
&lt;li>çŠç‘šçš„æ¯ä¸€â€œæ ‘â€å¯èƒ½åŒ…å«ç€æ•°åä¸‡è®¡çš„å¾®å°çŠç‘šä¸ªä½“ã€‚æ¯ä¸ªçŠç‘šè™«åˆå¸¦æœ‰å°‘é‡çš„å…‰åˆè—»ç±»ï¼Œè¿™äº›è—»ç±»ä¸ºçŠç‘šæä¾›é£Ÿç‰©ï¼Œå¸®åŠ©å…¶ä¿æŒå¥åº·ã€‚å½“æ°´æ¸©ä»…æ¯”å¹³å¸¸ä¸Šå‡å‡ åº¦æ—¶ï¼Œé¢å¯¹ç¯å¢ƒå‹åŠ›çš„çŠç‘šè™«ä¼šæŠŠè—»ç±»é©±é€å‡ºå»ï¼Œå…ˆå‰çš„æ•´æ”¯çŠç‘šç¾¤ä¼šå˜ç™½â€”â€”&lt;code>..è¿™å°±æ˜¯çŠç‘šç™½åŒ–..&lt;/code>ã€‚å¦‚æœæ°´æ¸©ä¸èƒ½åŠæ—¶å›å†·ï¼Œé‚£ä¹ˆçŠç‘šå¯èƒ½ä¼šæ­»äºé¥¥é¥¿æˆ–æ„ŸæŸ“ã€‚å³ä½¿çŠç‘šèƒ½é€ƒè¿‡ä¸€åŠ«ï¼Œä¹Ÿè¦è€—è´¹çº¦åå¹´æ—¶é—´æ‰èƒ½å®Œå…¨å¤åŸã€‚ &lt;br />è¿™æ®µæ–‡å­—æ„åœ¨è¯´æ˜ï¼š &lt;br />A.ç™½åŒ–æ˜¯çŠç‘šä¸»åŠ¨åº”å¯¹ç¯å¢ƒå‹åŠ›çš„ç»“æœ &lt;br />B.å…‰åˆè—»ç±»å¯¹äºçŠç‘šä¿æŒå¥åº·è‡³å…³é‡è¦&lt;br />C.çŠç‘šç¤æ˜¯ä¸€ä¸ªå¤æ‚åˆè„†å¼±çš„ç”Ÿæ€ç¾¤è½ &lt;br />D.æµ·æ´‹å‡æ¸©å¯¹çŠç‘šçš„ç”Ÿå­˜äº§ç”Ÿä¸¥é‡å¨èƒ&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>é¡ºæ‰¿å¼•å‡ºæ–°è¯é¢˜ï¼Œä½†æ˜¯å¤„äºç»“å°¾ï¼Œåˆ™é‡è¦ä¸é‡è¦éƒ½æœ‰å¯èƒ½ï¼Œå…·ä½“æƒ…å†µå…·ä½“åˆ†&lt;br />æï¼Œè¿™é‡Œè€ƒè™‘å‡ºé¢˜äººæˆªå–æ–‡ç« çš„æ€ç»´&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h2 id="ä¸­å¿ƒç†è§£">ä¸­å¿ƒç†è§£&lt;/h2>
&lt;h3 id="ä»¥äººä¸ºæœ¬">ä»¥äººä¸ºæœ¬&lt;/h3>
&lt;ol>
&lt;li>åŸºæœ¬æ¦‚è¿°&lt;br />ä½•ä¸ºä»¥äººä¸ºæœ¬ï¼Ÿè¿™é‡Œçš„äººæŒ‡çš„å°±æ˜¯å‡ºé¢˜äºº å¾ˆå¤šåŒå­¦éƒ½æœ‰ä¸€ä¸ªè¯¯åŒºï¼Œè¨€è¯­ç†è§£ä¸»è§‚ç†è§£å»åšé¢˜ï¼Œå…¶å®è¿™ä¸ªæ˜¯ä¸å¯¹çš„ï¼Œè¨€è¯­ç†è§£ç¡®å®æ˜¯ç†è§£ä¸ºç‹ï¼Œä½†æ˜¯è¿™ä¸ªç†è§£ä¸€å®šä¸èƒ½å’Œå‡ºé¢˜äººç›¸æ‚–ï¼Œ&lt;strong>ä½ æ€ä¹ˆæƒ³çš„å¹¶ä¸é‡è¦ï¼Œå‡ºé¢˜äººè¡¨è¾¾çš„æ‰æ˜¯æœ€é‡è¦çš„&lt;/strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘å¸¸è¯´çš„ä¸è¦å’Œå‡ºé¢˜å…¥æ‰³æ‰‹èˆªã€‚&lt;br />ä½†æ˜¯éš¾ç‚¹å°±åœ¨äºï¼Œä»€ä¹ˆæ‰æ˜¯å‡ºé¢˜äººæƒ³è¡¨è¾¾çš„ä¸œè¥¿å‘¢ï¼Ÿä¸ºæ­¤ï¼Œå®å“¥æ€»ç»“äº†&lt;strong>è§‚ç‚¹æå‡º&lt;/strong>çš„å…­å¤§æ–¹å¼ï¼Œæ—¨åœ¨è®©å¤§å®¶ç›´æ¥å’Œå‡ºé¢˜äººè¿›è¡Œå¯¹è¯ã€‚ä¸»è¦çœ‹è§‚ç‚¹ï¼Œä¸­å¿ƒæ€æƒ³ã€‚ ï¼ˆä¸€æ—¦è§‚ç‚¹æ‰¾é”™ï¼Œç›´æ¥é€‰é”™ï¼‰&lt;/li>
&lt;li>ä¸‡èƒ½è§£é¢˜å…¬å¼
&lt;ol>
&lt;li>ç†Ÿç»ƒæŒæ¡è§‚ç‚¹æå‡ºçš„å…­å¤§æ–¹å¼ï¼Œåˆ†ææ–‡æ®µç»“æ„ï¼Œé”å®šè§‚ç‚¹ã€‚&lt;/li>
&lt;li>æ‰¾åˆ°è§‚ç‚¹å‘å‡ºçš„ä¸»è¯­å’Œå®è§‚é™å®šã€‚&lt;/li>
&lt;li>åŒ¹é…é€‰é¡¹ï¼Œæ’é™¤å¹²æ‰°ã€‚ï¼ˆä¸»è¦åŒ¹é…è§‚ç‚¹çš„åŒä¹‰è¯ï¼ŒåŒè¯ï¼Œå¦‚é¢˜ç›®çš„ç¥ç»å…ƒï¼‰&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h4 id="è§‚ç‚¹æå‡ºçš„å…­å¤§æ–¹å¼">è§‚ç‚¹æå‡ºçš„å…­å¤§æ–¹å¼&lt;/h4>
&lt;ol>
&lt;li>å¿…è¦æ€§æå‡ºè§‚ç‚¹&lt;br />å½“é¢˜å¹²ä¸­å‡ºç°ï¼š&lt;code>..åªæœ‰ï¼ˆGè§‚ç‚¹ï¼‰æ‰..&lt;/code>ï¼Œ&lt;code>..é™¤éï¼ˆGï¼‰å¦åˆ™ä¸..&lt;/code> ç­‰æ ‡å¿—è¯ä»¥åŠ&lt;code>..åŸºç¡€ï¼Œ&lt;/code>..å‡è®¾..&lt;code>ï¼Œ&lt;/code>..å‰æ..&lt;code>ï¼Œ&lt;/code>..å…³é”®ï¼Œ&lt;code>..å¿…ä¸å¯å°‘..&lt;/code>ï¼Œ&lt;code>..ä¾èµ–..&lt;/code>ï¼Œ&lt;code>..ç¦»ä¸å¼€..&lt;/code>ç­‰è¯è¯­ï¼Œ&lt;strong>å¯è¡¨è¾¾å¿…è¦æ€§ï¼Œè¢«å¿…è¦ä¸»ä½“æ˜¯è§‚ç‚¹&lt;/strong>&lt;/li>
&lt;li>è®¾é—®æå‡ºè§‚ç‚¹ï¼ˆéš¾é¢˜ï¼‰&lt;br />éœ€è¦å…³æ³¨æ–‡æ®µæ˜¯å¦åœ¨è§£é‡Šè®¾é—®ï¼Œè‹¥&lt;strong>é‡ç‚¹åœ¨äºè§£é‡Šè®¾é—®&lt;/strong>ï¼Œè®¾é—®ç›´æ¥é”å®šè§‚ç‚¹ï¼Œç­”æ¡ˆå°±æ˜¯å¯¹é—®é¢˜çš„è§£é‡Š/å›ç­”&lt;br />æœ¬è´¨å°±æ˜¯ä½œè€…çš„ä¸»è§‚æ€§ï¼Œä¹Ÿå°±æ˜¯å†™ä½œçš„ç›®çš„æ€§&lt;/li>
&lt;/ol>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æåˆ°é’å°‘å¹´é¢ä¸´çš„å¨èƒï¼Œå¼•äººæ³¨ç›®çš„æ–°ç§‘æŠ€æ€»æ˜¯æ¯”é‚£äº›ç†Ÿæ‚‰å’Œéš¾ä»¥æ”¹å˜çš„é—®é¢˜æ›´å®¹æ˜“æˆä¸ºäººä»¬å…³æ³¨çš„ç„¦ç‚¹ï¼Œè¿™ç§åå·®å¯èƒ½ä¼šä½¿æˆ‘ä»¬çš„æ„ŸçŸ¥å‘ç”Ÿåç¦»ã€‚é™¤äº†ä½¿ç”¨æ‰‹æœºå¯¼è‡´ç³Ÿç³•çš„ç¡çœ è´¨é‡ï¼Œå®¶åº­å†²çªä¹Ÿæ˜¯é€ æˆé’å°‘å¹´å¿ƒç†å¥åº·é—®é¢˜çš„ä¸€ä¸ªé‡è¦åŸå› ï¼Œè‰¾ä¼¦è¯´ï¼šâ€œä¸ä»…å†²çªå’Œå‹åŠ›ä¼šå½±å“å¤§è„‘ï¼Œç¼ºä¹æ¸©æš–å’Œç¤¾ä¼šæ”¯æŒåŒæ ·ä¼šå½±å“å¤§è„‘â€ï¼Œæœ‰è¿™ä¹ˆå¤šè¯æ®éƒ½è¡¨æ˜ï¼Œå…¶ä»–å› ç´ ä¼šå¯¹é’å°‘å¹´äº§ç”Ÿå½±å“ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜åªæ˜¯æ‹…å¿ƒæ‰‹æœºï¼Ÿ&lt;/p>
&lt;p>è¿™æ®µæ–‡å­—æ—¨åœ¨å¼ºè°ƒï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;p>A.æ‰‹æœºæˆç˜¾å¹¶éæˆ‘ä»¬å”¯ä¸€éœ€è¦å…³æ³¨çš„é—®é¢˜&lt;/p>
&lt;p>B.å½“ä»Šé’å°‘å¹´çš„èº«å¿ƒå¥åº·é¢ä¸´ç€è¯¸å¤šå¨èƒ&lt;/p>
&lt;p>C.ç†Ÿæ‚‰å’Œéš¾ä»¥æ”¹å˜çš„é—®é¢˜å¯¹é’å°‘å¹´çš„å¥åº·å¨èƒæ›´å¤§&lt;/p>
&lt;p>D.é’å°‘å¹´ç¼ºä¹æ¸©æš–å’Œç¤¾ä¼šæ”¯æŒçš„é—®é¢˜äºŸå¾…å¼•èµ·é‡è§†&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¾ˆå¤šåŠ¨ç‰©æœ‰ç€é¢œè‰²å¤æ€ªçš„çœ¼ç›ï¼Œä¸ºä»€ä¹ˆäººæ²¡æœ‰å‘¢ï¼Ÿçœ¼ç›çš„é¢œè‰²å…¶å®æ˜¯æŒ‡è™¹è†œçš„é¢œè‰²ï¼Œå³çœ¼ç›ä¸­çš„ä¸€åœˆç¯çŠ¶è‚Œè‚‰çš„é¢œè‰²ã€‚å¦‚æœè™¹è†œä¸­å«æœ‰å¤§é‡çš„è‰²ç´ ï¼Œçœ¼ç›å°±ä¼šå‘ˆç°é»‘è¤è‰²ã€‚éšç€é»‘è‰²ç´ å«é‡çš„é™ä½ï¼Œçœ¼ç›å°±ä¼šå‘ˆç°å‡ºæ·¡è¤è‰²ã€ç»¿è‰²æˆ–è“è‰²ã€‚å½“ç³å­”æ‰©å¼ æ—¶ï¼Œè™¹è†œå¤„äºæ”¶ç¼©çŠ¶æ€ï¼Œç”±äºé»‘è‰²ç´ çš„å¯†åº¦å˜å¤§ï¼Œçœ¼ç›çš„é¢œè‰²ä¾¿ä¼šåŠ æ·±ä¸€äº›ï¼›å½“ç³å­”æ”¶ç¼©æ—¶ï¼Œè™¹è†œä¾¿ä¼šèˆ’å¼ ï¼Œçœ¼ç›çš„é¢œè‰²ä¹Ÿä¼šå› æ­¤å˜æµ…ã€‚ä¸è¿‡ï¼Œæ— è®ºè™¹è†œå¦‚ä½•èˆ’å¼ æˆ–æ”¶ç¼©ï¼Œäººç±»çš„çœ¼ç›ä¹Ÿä¸å¯èƒ½æ˜¯äº”é¢œå…­è‰²çš„ã€‚&lt;/p>
&lt;p>è¿™æ®µæ–‡å­—ä¸»è¦è§£é‡Šäº†ï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;p>A.ä¸ºä»€ä¹ˆæ˜¯é»‘è‰²ç´ å†³å®šäººçœ¼é¢œè‰²çš„æ·±æµ…&lt;/p>
&lt;p>B.ä¸ºä»€ä¹ˆæ˜¯ç³å­”çš„å¼ ç¼©å†³å®šçœ¼ç›çš„é¢œè‰²&lt;/p>
&lt;p>C.ä¸ºä»€ä¹ˆäººçš„çœ¼ç›ä¸å¯èƒ½æ˜¯äº”é¢œå…­è‰²çš„&lt;/p>
&lt;p>D.ä¸ºä»€ä¹ˆäººçœ¼é¢œè‰²ä¸ä¼šåƒåŠ¨ç‰©é‚£æ ·å¤æ€ª&lt;/p>
&lt;p>&lt;a href="https://www.chinagwy.org/html/stzx/qt/202206/98_510726.html">è§£é‡Š&lt;/a>ï¼Œæœ‰ç‚¹ä¸ç¬¦åˆè®¾é—®è§£é¢˜ï¼Œé€‰Däº†ã€‚æ³¨æ„è½¬æŠ˜ï¼Œâ€ä¸è¿‡â€œ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¸å…¶ä»–ç‰©ç§ç›¸æ¯”ï¼Œäººç±»æ‹¥æœ‰éå‡¡çš„è®¤çŸ¥èƒ½åŠ›ã€‚äººè„‘ç©¶ç«Ÿæœ‰ä»€ä¹ˆç‹¬åˆ°ä¹‹å¤„ï¼Œä½¿å¾—æˆ‘ä»¬è„±é¢–è€Œå‡ºå‘¢ï¼Ÿè„‘å®¹é‡æ˜¯ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„å€™é€‰è€…ï¼šå¦‚æœå¤§è„‘æ˜¯äº§ç”Ÿæ„è¯†è®¤çŸ¥çš„éƒ¨ä½ï¼Œæ›´å¤§çš„è„‘å®¹é‡åˆ™æ„å‘³ç€æ›´é«˜çš„è®¤çŸ¥èƒ½åŠ›ï¼Œä½†å¤§è±¡æœ‰ç€æ¯”äººç±»æ›´å¤§çš„è„‘å®¹é‡ï¼Œå´ä¸å…·å¤‡åƒæˆ‘ä»¬ä¸€æ ·çµæ´»è€Œå¤æ‚çš„è¡Œä¸ºã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¯¹äºè¿™ä¸ªé—®é¢˜æœ‰ä¸€ä¸ªç®€å•çš„è§£é‡Šï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬æ˜¯çµé•¿ç±»ï¼Œèƒ½å¤Ÿå°†å¤§é‡ç¥ç»å…ƒè£…è¿›è¾ƒå°çš„å¤§è„‘çš®å±‚é‡Œï¼›å…¶æ¬¡ï¼Œäººç±»å¤§è„‘çš„èƒ½é‡æ¶ˆè€—å¯è°“å¥¢ä¾ˆï¼Œåªå ä¸åˆ°2%çš„ä½“é‡ï¼Œå´å äº†è‡³å°‘ 20%çš„ä»£è°¢ç‡ã€‚è€Œå…¶ä»–åŠ¨ç‰©åœ¨é‡å¤–æ‘„å–ç”Ÿè‚‰ä¸­è·å–çš„èƒ½é‡ï¼Œå¹¶ä¸è¶³ä»¥æ”¯æŒå¦‚æ­¤ä¸°å¯Œçš„å¤§è„‘çš®å±‚ç¥ç»å…ƒæ´»åŠ¨ã€‚&lt;/p>
&lt;p>è¿™æ®µæ–‡å­—æ—¨åœ¨è¯´æ˜ï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;p>A.è„‘å®¹é‡ä¸èƒ½å†³å®šç‰©ç§çš„è®¤çŸ¥æ°´å¹³&lt;/p>
&lt;p>B.äººç±»åœ¨è®¤çŸ¥èƒ½åŠ›ä¸Šæœ‰ç»å¯¹çš„ä¼˜è¶Šæ€§&lt;/p>
&lt;p>C.äººè„‘è®¤çŸ¥èƒ½åŠ›çš„å½¢æˆååˆ†å¤æ‚&lt;/p>
&lt;p>D.ç”Ÿç†å› ç´ å†³å®šäº†äººç±»è®¤çŸ¥æ°´å¹³çš„ä¼˜åŠ¿&lt;/p>
&lt;p>ç”¨æç‚¼çš„è§‚ç‚¹/è®ºè¯ç»“æœé”å®šé€‰é¡¹ï¼Œå†åˆ©ç”¨é€‰é¡¹åçª¥è§‚ç‚¹çš„æ­£ç¡®æ€§ã€‚è¦å›ç­”é—®é¢˜ï¼Œé€‰Bä¸åº”è¯¥&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æå¯¹ç­–ç»™è§‚ç‚¹(ä¸‰å¤§)&lt;/p>
&lt;ol>
&lt;li>å¼€é—¨è§å±±ç»™å¯¹ç­–ï¼ˆç›´æ¥å¯¹ç­–ï¼‰&lt;br />å½“å‡ºç°è¦ ã€éœ€ã€éœ€è¦ã€äºŸéœ€ã€å¿…é¡»ã€åº”è¯¥ã€èƒ½å¤Ÿç­‰ï¼›ä»¥åŠï¼šå¦‚æœï¼ˆDå¯¹ç­–ï¼‰å°±ï¼›åªè¦ï¼ˆDï¼‰å°±æ—¶ï¼Œç›´æ¥è¡¨æ˜ä½œè€…è§‚ç‚¹
&lt;ol>
&lt;li>
&lt;p>å°å‰§åœºçš„â€œå°â€é¦–å…ˆä½“ç°åœ¨ç‰©ç†ç©ºé—´çš„â€œå°â€ã€‚ä¸€èˆ¬æ¥è®²ï¼Œå°å‰§åœºåœ¨ç‰©ç†ç©ºé—´çš„å®¹çº³åº¦ä¸Šæ˜¯å°çš„ï¼Œæ¼”å‡ºç©ºé—´åŸºæœ¬ä¸Šåœ¨ 2000 å¹³æ–¹ç±³å·¦å³ï¼Œè§‚ä¼—å¸­åœ¨ 500 åº§ä»¥ä¸‹ï¼Œæœ€ä¸ºå¸¸è§çš„ä¸º200è‡³300ä¸ªåº§ä½ã€‚å‚æ¼”äººæ•°ä¸å¤šï¼Œä¸€èˆ¬ä¸º 2 è‡³ 6 äººï¼Œæœ‰æ—¶ä¹Ÿä¼šæœ‰ç‹¬è§’æˆã€‚è¿™å°±å†³å®šäº†æ¼”å‰§ç©ºé—´çš„ç´§å‡‘æ€§å’Œè§‚æ¼”å…³ç³»çš„ç´§å¯†æ€§ã€‚å› æ­¤ï¼Œå°å‰§åœºä¸å®œè¿‡åº¦æ¸²æŸ“èˆå°ç¾æœ¯çš„å®é˜”ä¸éœ‡æ’¼æ•ˆæœï¼Œè€Œåº”è¯¥å…³æ³¨æ€æƒ³æ€§ã€è‰ºæœ¯å½¢å¼è¡¨è¾¾æˆ–åˆ›æ–°æ¢ç´¢ç»´åº¦ç­‰æˆå‰§è‰ºæœ¯çš„æœ¬ä½“å‘ˆç°ã€‚ç”¨è‹±å›½è‘—åæˆå‰§å®¶å½¼å¾—Â·å¸ƒé²å…‹çš„è¯æ¥è¯´ï¼šâ€œä½ è‹¥è¦çœ‹åˆ°ä»€ä¹ˆæœ‰è´¨é‡çš„ä¸œè¥¿ï¼Œå°±å¾—åˆ›é€ ä¸€ä¸ªç©ºçš„ç©ºé—´ã€‚â€å°å‰§åœºä¾¿æ˜¯ä»¥é²œæ´»çš„ã€æ–°é¢–çš„æ–¹å¼ä¼ é€’å†…å®¹ã€æ„ä¹‰ã€è¡¨è¾¾ã€è¯­è¨€å’ŒéŸ³ä¹ç­‰æ ¸å¿ƒè‰ºæœ¯å…ƒç´ çš„å­˜åœ¨ã€‚&lt;/p>
&lt;p>è¿™æ®µæ–‡å­—æ„åœ¨è¯´æ˜ï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;p>A.å°å‰§åœºè¥é€ å‡ºäº†ä¸€ä¸ªç©ºçš„è‰ºæœ¯åˆ›ä½œç©ºé—´&lt;/p>
&lt;p>B.ç‰©ç†ç©ºé—´çš„å°å†³å®šäº†å°å‰§åœºåˆ›ä½œçš„ç‰¹ç‚¹&lt;/p>
&lt;p>C.å°å‰§åœºåˆ›ä½œåº”æ›´å…³æ³¨æˆå‰§è‰ºæœ¯æœ¬ä½“å‘ˆç°&lt;/p>
&lt;p>D.å°å‰§åœºå…·æœ‰æ›´åŠ å¤šå…ƒåŒ–æ–¹å‘çš„åˆ›ä½œå–å‘&lt;/p>
&lt;p>åå¤å¼ºè°ƒè‰ºæœ¯ æ˜¯é‡ç‚¹&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>åšæ³•+å±å®³/æ„ä¹‰ç»™å¯¹ç­–&lt;br />é˜è¿°ä¸€ä¸ªåšæ³•æˆ–è€…æ²¡æœ‰ä¸€ä¸ªåšæ³•ï¼Œä¼šå¯¼è‡´è´Ÿé¢/æ­£é¢ç»“æœã€‚å¯¹ç­–å°±æ˜¯åšæ³•ï¼Œå±å®³/æ„ä¹‰ä¸é‡è¦
&lt;ol>
&lt;li>
&lt;p>ç½‘ç»œè¯­è¨€ï¼Œå°¤å…¶æ˜¯å½“ä¸‹æµè¡Œçš„ä¸€äº›æ–°æ½®ç½‘ç»œè¯­è¨€ï¼Œå¯¹æ±‰è¯­çš„å‘å±•æ˜¯ä¿ƒè¿›è¿˜æ˜¯é˜»ç¢ï¼Œæ˜¯æ±‰è¯­æ–‡åŒ–çš„ç²¾åè¿˜æ˜¯ç³Ÿç²•ï¼Œå¾—è®©å…¶åœ¨ä¸æ–­çš„å†²çªä¸­æ¥å—æ—¶é—´å’Œå®è·µçš„æ£€éªŒã€‚è€Œä¸ºäº†ä¿æŠ¤æ±‰è¯­ï¼Œä¿è¯å…¶å›ºæœ‰çš„çº¯æ´æ€§è€Œä¸€å‘³åœ°æ‘’å¼ƒæ‰“å‹æŸäº›å¸¦æœ‰æ¶ˆæå½±å“çš„ç½‘ç»œè¯­è¨€ï¼Œç”šè‡³åˆ¶å®šç›¸å…³è§„å®šæ€§æ¡æ–‡æ¡æ¬¾æ¥é™åˆ¶ç½‘ç»œè¯­è¨€çš„å‘å±•ï¼Œæœ‰æ—¶éä½†ä¸èƒ½æŠ‘åˆ¶ï¼Œåè€Œä¼šèµ·åˆ°ç›¸åçš„ä½œç”¨ã€‚&lt;br />è¿™æ®µæ–‡å­—æ„åœ¨è¯´æ˜ï¼š &lt;br />A.ç½‘ç»œè¯­è¨€çš„å‘å±•ä¸å®œé€šè¿‡è¡Œæ”¿æ‰‹æ®µå¹²é¢„&lt;br /> B.æ±‰è¯­çš„ä¼ æ‰¿ç¦»ä¸å¼€ç½‘ç»œè¯­è¨€çš„ä¸æ–­åˆ›æ–°&lt;br />C.ç½‘ç»œè¯­è¨€çš„ç”Ÿå‘½åŠ›éœ€è¦ä¾é æ—¶é—´æ¥æ£€éªŒ&lt;br /> D.æ–°ç”Ÿçš„ç½‘ç»œè¯­è¨€å¯èƒ½å½±å“æ±‰è¯­çš„çº¯æ´æ€§&lt;/p>
&lt;p>â€ç”šè‡³â€œæ ‡é€’è¿›ï¼Œçœ‹é€’è¿›çš„å†…å®¹&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å½“äººè„‘åœ¨å‘è‚²é˜¶æ®µæ¥è§¦åˆ°è§†è§‰åˆºæ¿€ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡çœ¼ç›çœ‹åˆ°å¤–ç•Œäº‹ç‰©æ—¶ï¼Œè§†çš®å±‚ä¸Šçš„ç¥ç»å…ƒä¼šè¢«æ¿€æ´»ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›ç¥ç»å…ƒä¼šå¯¹ä¸åŒçš„å›¾åƒç‰¹å¾å¦‚é¢œè‰²ã€å½¢çŠ¶ã€äº®åº¦ã€æœå‘ã€è·ç¦»ç­‰è¿›è¡ŒåŠ å·¥ã€‚å¦‚æœäººæ­£å¤„äºè§†è§‰åŠŸèƒ½çš„å‘è‚²å…³é”®æœŸï¼Œè€Œè§†è§‰ç¥ç»å…ƒæœªè¢«å……åˆ†æ¿€æ´»ï¼Œæœªæ¥åœ¨çœ‹åˆ°æŸäº›å›¾åƒç‰¹å¾æ—¶å°±ä¸ä¼šäº§ç”Ÿååº”æˆ–ååº”æ¯”è¾ƒå¼±ï¼Œå¯¼è‡´çœ‹ä¸è§æˆ–çœ‹ä¸æ¸…ã€‚&lt;br />è¿™æ®µæ–‡å­—æœ€é€‚åˆä½œä¸ºä¸‹åˆ—å“ªä¸ªè§‚ç‚¹çš„è®ºæ®ï¼Ÿ &lt;br />A.äººä½“çš„ä¸åŒæœºèƒ½å­˜åœ¨ç€ä¸åŒçš„å‘è‚²å…³é”®æœŸ &lt;br />B.äººä½“åŠŸèƒ½å‘è‚²ä¸å……åˆ†æœ‰å¯èƒ½é€ æˆç»ˆç”Ÿå½±å“&lt;br />C.å›¾åƒç‰¹å¾å¯¹è§†çš®å±‚ç¥ç»å…ƒçš„æ¿€æ´»è‡³å…³é‡è¦ &lt;br />D.é”™è¿‡å‘è‚²å…³é”®æœŸæœ‰å¯èƒ½ä¸§å¤±éƒ¨åˆ†äººä½“æœºèƒ½&lt;/p>
&lt;p>&lt;a href="https://shenzhen.huatu.com/tiku/3579934.html">è§£é‡Š&lt;/a>ï¼Œäººä½“æœºèƒ½æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå¯ä»¥æŒ‡ç¥ç»å…ƒã€‚è¿™é¢˜å¤ªç‰µå¼ºäº†&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>å¦å®šå‹å¯¹ç­–&lt;br />ç›´æ¥å¦å®šè¿™ä¸ªå¯¹ç­–ï¼Œå¸¸è§çš„æœ‰ä¸å¯ä»¥ï¼ˆåšï¼‰ï¼Œä¸èƒ½ï¼ˆåšï¼‰,ä¸è¦ï¼ˆåšï¼‰,ç¦æ­¢ï¼ˆåšï¼‰
&lt;ol>
&lt;li>
&lt;p>ç§‘ä¸¾æ˜¯ä¸€ç§å¤æ‚çš„æ–‡åŒ–ç°è±¡ã€‚ç„¶è€Œï¼Œåœ¨ç°ä»£ä¸­å›½äººå¯¹ä¼ ç»Ÿäº‹ç‰©çš„çœ‹æ³•ä¸­ï¼Œç§‘ä¸¾å¤§æ¦‚ä¹Ÿæ˜¯è¢«è¯¯è§£æœ€æ·±çš„åˆ¶åº¦ã€‚æˆ‘ä»¬ä¸åº”å¿½ç•¥ç§‘ä¸¾åˆ¶çš„å†å²æ€§ï¼Œè¯•æƒ³åœ¨ä¼ ç»Ÿç¤¾ä¼šï¼Œèƒ½æ„æƒ³å‡ºå…¶ä»–æ›´å¥½çš„é€‰æ‰åˆ¶åº¦æ¥å—ï¼Ÿå¤ä»£çš„ä¸­å›½ç»Ÿæ²»è€…å’Œè®¸å¤šæ–‡åŒ–å·¨äººå¹¶ä¸æ˜¯æ²¡æœ‰çœ‹åˆ°ç§‘ä¸¾åˆ¶çš„å±€é™å’Œå¼Šç«¯ï¼Œä¹Ÿä¸éƒ½æ˜¯å› å¾ªå®ˆæ—§ä¹‹è¾ˆã€‚ä½†ç»è¿‡åå¤æ¯”è¾ƒï¼Œæœ€åè¿˜æ˜¯é€‰æ‹©äº†ç§‘ä¸¾åˆ¶ï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ç§æ‹©å–„è€Œä»ã€‚å¤ä»£ä¸€äº›å­¦è€…æ‰¹è¯„ç§‘ä¸¾å–å£«å¹¶ä¸ç­‰äºåå¯¹ç§‘ä¸¾åˆ¶åº¦ã€‚ä»å¤ä»£åˆ°è¿‘ä»£çš„å­¦è€…å¯¹ç§‘ä¸¾åˆ¶çš„æ‰¹åˆ¤ä¸»è¦æ˜¯å¯¹åº”è¯•ç°è±¡ã€å¯¹è€ƒè¯•å†…å®¹å’Œå½¢å¼çš„æ‰¹åˆ¤ï¼Œç‰¹åˆ«æ˜¯å¯¹å…«è‚¡å–å£«çš„æ‰¹åˆ¤ï¼Œå¾ˆå°‘æœ‰äººå¦å®šç§‘ä¸¾åˆ¶æœ¬èº«ã€‚&lt;br />è¿™æ®µæ–‡å­—æ„åœ¨å¼ºè°ƒï¼ˆ ï¼‰ã€‚&lt;br /> A.å¤ä»£å­¦è€…å¯¹ç§‘ä¸¾åˆ¶çš„è‚¯å®šå¤šè¿‡å¦å®š&lt;br /> B.ç§‘ä¸¾åˆ¶çš„å¼Šç«¯å¹¶éæ¥è‡ªå…¶åˆ¶åº¦æœ¬èº«&lt;br />C.ç§‘ä¸¾åˆ¶æ˜¯å½“æ—¶å†å²æ¡ä»¶ä¸‹çš„ç†æ€§é€‰æ‹© &lt;br />D.åº”ä»ç°å®æƒ…å†µå‡ºå‘å¤šè§’åº¦è¯„ä»·ç§‘ä¸¾åˆ¶&lt;/p>
&lt;p>&lt;a href="https://cq.m.jinbiaochi.com/sydw/news_450928.html">è§£é‡Š&lt;/a>ï¼Œ&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>åˆ©ç”¨ä»–è€…ç»éªŒæè§‚ç‚¹&lt;br />åªè¦ä»–è€…ç»éªŒæ˜¯æˆåŠŸçš„ï¼Œå¯å€Ÿé‰´çš„ï¼Œä¸”æ–‡æ®µä½œè€…æ²¡æœ‰æå‡ºè‡ªå·±çš„è§‚ç‚¹ï¼Œåˆ™é‡ç‚¹å€Ÿé‰´&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å…³äºâ€œå¤©é¹…éƒ½æ˜¯ç™½è‰²çš„â€è¿™ä¸€å‡è¯´ï¼Œé€šå¸¸æˆ‘ä»¬åº”è¯¥ä¸€åªä¸€åªåœ°è°ƒæŸ¥å¤©é¹…çš„é¢œè‰²ã€‚è¿™ç§é€šè¿‡ç§¯ç´¯ä¸ªåˆ«è§‚å¯Ÿæ¥éªŒè¯å‡è¯´æˆ–æ¨å¯¼å‡ºå®šå¾‹çš„æ–¹æ³•ç§°ä¸ºâ€œå½’çº³æ³•â€ã€‚ä½†åŸºäºå½’çº³æ³•çš„æ¨è®ºä¸èƒ½å¸¦æ¥å¯é çš„æ­£ç¡®æ€§ï¼Œå“²å­¦å®¶æ³¢æ™®æå‡ºäº†ä¸ä¾èµ–äºå½’çº³æ³•çš„ç§‘å­¦æ–¹æ³•ã€‚ä»–è®¤ä¸ºï¼Œè¯•å›¾è¯æ˜å‡è¯´æ˜¯é”™è¯¯çš„æ‰æ˜¯ç§‘å­¦çš„ç ”ç©¶ã€‚ä¾‹å¦‚ï¼Œå³ä½¿åªæ‰¾åˆ°äº†ä¸€åªé»‘å¤©é¹…ï¼Œä¹Ÿèƒ½è¯æ˜â€œå¤©é¹…éƒ½æ˜¯ç™½è‰²çš„â€è¿™ä¸€å‡è¯´æ˜¯é”™è¯¯çš„ã€‚è™½ç„¶åŸºäºå½’çº³æ³•çš„éªŒè¯é€šå¸¸æ˜¯ä¸å¯é çš„ï¼Œä½†å¦‚æœè¯ä¼ªçš„è¯ï¼Œåˆ™æ˜¯å¯é çš„ã€‚é€šè¿‡åå¤â€œè®¾å®šä¸€ä¸ªç”¨æ¥è§£å†³é—®é¢˜çš„å‡è¯´ï¼Œå¯»æ‰¾å…¶åä¾‹æ¥è¯ä¼ªå‡è¯´ï¼Œå†è®¾ç«‹æ–°çš„å‡è¯´Â·Â·Â·Â·Â·Â·â€ï¼Œå°±å¯ä»¥è¿›è¡Œç§‘å­¦çš„ç ”ç©¶ã€‚ &lt;br />è¿™æ®µæ–‡å­—æ„åœ¨è¯´æ˜ï¼ˆ ï¼‰ã€‚ &lt;br /> A.ç§‘å­¦çš„æ–¹æ³•åº”æ˜¯â€œå¯å½’çº³â€ &lt;br />B.ç§‘å­¦çš„æ–¹æ³•åº”æ˜¯â€œå¯è¯ä¼ªâ€ &lt;br />C.ç§‘å­¦çš„æ–¹æ³•åº”æ˜¯â€œä¸å¯è¯ä¼ªâ€ &lt;br />D.ç§‘å­¦çš„æ–¹æ³•åº”æ˜¯â€œä¸å¯å½’çº³â€&lt;/p>
&lt;p>ä¸å¯è¯ä¼ªï¼Ÿè¦ç¬¦åˆè§‚ç‚¹ï¼šè¯•å›¾è¯æ˜å‡è¯´æ˜¯é”™è¯¯çš„æ‰æ˜¯ç§‘å­¦çš„ç ”ç©¶&lt;/p>
&lt;/li>
&lt;li>
&lt;p>äººåœ¨ç¤¾ä¼šä¸Šç”Ÿæ´»ï¼Œå½“ç„¶æœ‰é€‚åº”ç°å®çš„å¿…è¦ï¼Œä½†è¿™ä¸è¯¥æ˜¯æ•™è‚²çš„ä¸»è¦ç›®çš„ï¼Œè’™ç”°è¯´ï¼Œâ€œå­¦ä¹ ä¸æ˜¯ä¸ºäº†é€‚åº”å¤–ç•Œï¼Œè€Œæ˜¯ä¸ºäº†ä¸°å¯Œè‡ªå·±ã€‚â€å­”å­ä¹Ÿä¸»å¼ å­¦ä¹ æ˜¯â€œä¸ºå·±â€è€Œéâ€œä¸ºäººâ€çš„äº‹æƒ…ã€‚å¤å¾€ä»Šæ¥çš„å“²äººéƒ½å¼ºè°ƒï¼Œå­¦ä¹ æ˜¯ä¸ºäº†å‘å±•è‡ªå·±å†…åœ¨çš„ç²¾ç¥èƒ½åŠ›ï¼Œä»è€Œåœ¨å¤–éƒ¨ç°å®é¢å‰è·å¾—è‡ªç”±ã€‚å½“ç„¶ï¼Œè¿™åªæ˜¯ä¸€ç§å†…åœ¨è‡ªç”±ï¼Œä½†æ˜¯ï¼Œæ­£æ˜¯å‡­å€Ÿè¿™ç§å†…åœ¨è‡ªç”±ï¼Œè¿™äº›ç‹¬ç«‹äººæ ¼å’Œç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›ï¼Œé‚£äº›ä¼˜ç§€çš„çµé­‚å’Œå¤´è„‘å¯¹äºæ”¹å˜äººç±»ç¤¾ä¼šçš„ç°å®å‘ç”Ÿäº†ä¼Ÿå¤§çš„ä½œç”¨ã€‚&lt;br />è¿™æ®µè¯æƒ³è¡¨è¾¾ï¼ˆ ï¼‰ã€‚ &lt;br />A.æ•™è‚²çš„ç›®çš„æ˜¯è®©äººé€‚åº”ç¤¾ä¼š &lt;br />B.å­¦ä¹ æ˜¯ä¸ºäº†å‘å±•ä¸ªäººçš„å†…åœ¨ç²¾ç¥èƒ½åŠ›&lt;br /> C.äººçš„å†…åœ¨è‡ªç”±å¯¹æ”¹å˜äººç±»ç¤¾ä¼šçš„ç°å®å…·æœ‰ä¼Ÿå¤§çš„ä½œç”¨&lt;br /> D.æ•™è‚²çš„ä¸»è¦ç›®çš„æ˜¯è®©å­¦ç”Ÿæ‘†è„±ç°å®çš„æŸç¼šï¼Œè€Œéé€‚åº”ç°å®&lt;/p>
&lt;p>æ³¨æ„è„‰ç»œé¡ºæ‰¿ï¼Œä»–è€…è§‚ç‚¹(å­¦ä¹ æ˜¯ä¸ºäº†å‘å±•è‡ªå·±å†…åœ¨çš„ç²¾ç¥èƒ½åŠ›)ä¸ä¸€å®šå°±æ˜¯ç­”æ¡ˆ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¼ ç»Ÿçš„æ–‡æ˜æ ‡å‡†æœ‰ä¸‰ä¸ªï¼Œå³æ–‡å­—ã€é’é“œå™¨å’ŒåŸå¸‚ã€‚ä½†åæ¥è®¸å¤šè€ƒå¤å­¦å®¶å‘ç°ï¼Œç”±äºåŒºåŸŸä¸åŒï¼Œæ–‡æ˜çš„å·®å¼‚ä¹Ÿå¾ˆå¤§ï¼Œè¿™ä¸ªåˆ¤æ–­æ ‡å‡†ä¸ä½†è¡Œä¸é€šï¼Œè¿˜ä¼šç»™è€ƒå¤å·¥ä½œå¸¦æ¥é˜»ç¢ã€‚ç°å¦‚ä»Šï¼Œå›½é™…ä¸Šå¯¹æ–‡æ˜çš„åˆ¤æ–­æ ‡å‡†ä¸»è¦æ˜¯ï¼šå·²è¿›å…¥å›½å®¶ç¤¾ä¼šå½¢æ€ï¼Œå…·æœ‰ä¸€å¥—ç¤¼ä»ªç³»ç»Ÿå’Œç»Ÿæ²»ç®¡ç†åˆ¶åº¦ã€‚è‰¯æ¸šæ–‡åŒ–è™½æ²¡æœ‰é’é“œå™¨å’Œè¾ƒä¸ºæˆç†Ÿçš„æ–‡å­—ï¼Œä½†å…·æœ‰æ—©æœŸå›½å®¶ç¤¾ä¼šå½¢æ€å’Œè¾ƒä¸ºå®Œæ•´çš„ç¤¼ä»ªç³»ç»Ÿä»¥åŠç®¡ç†åˆ¶åº¦ï¼Œè¿˜å…·æœ‰è®¸å¤šä¸œæ–¹æ–‡æ˜çš„å› ç´ ã€‚æœ‰è‰¯æ¸šæ–‡åŒ–è€ƒå¤ç ”ç©¶å‘˜ç”šè‡³è®¤ä¸ºï¼Œè‰¯æ¸šæ–‡åŒ–æ˜¯ä¸œæ–¹æ—©æœŸä¸€ä¸ªé›†å¤§æˆçš„æ–‡æ˜ã€‚&lt;br /> è¿™æ®µæ–‡å­—æ„åœ¨å¼ºè°ƒï¼š&lt;br /> A.åŸå¸‚åº”è¯¥æˆä¸ºè®¤å®šæ–‡æ˜çš„é¦–è¦æ ‡å‡†&lt;br /> B.è‰¯æ¸šæ–‡åŒ–ç¬¦åˆé€šè¡Œçš„æ–‡æ˜åˆ¤æ–­æ ‡å‡†&lt;br />C.ä¼ ç»Ÿçš„æ–‡æ˜è¯„åˆ¤æ ‡å‡†ä»å…·æœ‰ç°å®æ„ä¹‰&lt;br /> D.è‰¯æ¸šæ–‡åŒ–é¢ è¦†äº†ä¼ ç»Ÿä¸Šå¯¹æ–‡æ˜çš„è®¤è¯†&lt;/p>
&lt;p>Dåº”è¯¥æ˜¯æ–‡æ˜æ ‡å‡†ï¼Œå…¨æ–‡éƒ½åœ¨å¼ºè°ƒæ–‡æ˜æ ‡å‡†&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>é‡è¦æ€§æè§‚ç‚¹&lt;/p>
&lt;ol>
&lt;li>å…¶ä¸€ï¼šå½“é¢˜å¹²ä¸­å‡ºç°ï¼šäº‹ç‰©æ„ä¹‰ï¼Œæ²¡æœ‰äº‹ç‰©+å±å®³æ—¶&lt;/li>
&lt;li>å…¶äºŒï¼šå½“é¢˜å¹²ä¸­å‡ºç°è¡¨è¾¾xxå¾ˆé‡è¦çš„æ ‡å¿—è¯ï¼Œå¦‚ï¼šç‹¬ç‰¹ä¼˜åŠ¿ï¼Œæ˜¾è‘—æå‡ï¼Œé‡è¦è§’è‰²ï¼Œæœ‰å¾ˆå¤§å¸®åŠ©ï¼Œå¸¦æ¥å¾ˆå¤šæ„ä¹‰ç­‰ç­‰ï¼Œå¯ä»¥ä»¥é‡è¦æ€§è¡¨è¾¾è§‚ç‚¹ï¼ˆéœ€çµæ´»ç†è§£ï¼‰&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/civilservant/">CivilServant</category></item><item><title>å…¬åŠ¡å‘˜è¡Œæµ‹--èµ„æ–™åˆ†æ</title><link>https://keepjolly.com/posts/learn/data-analysis/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/data-analysis/</guid><pubDate>Sun, 12 Nov 2023 00:49:46 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="ç»Ÿè®¡æœ¯è¯­">ç»Ÿè®¡æœ¯è¯­&lt;/h2>
&lt;ul>
&lt;li>åŸºæœŸé‡ä¸ç°æœŸé‡
&lt;ul>
&lt;li>ä½œä¸ºå¯¹æ¯”å‚ç…§çš„æ—¶æœŸç§°ä¸ºåŸºæœŸï¼Œç›¸å¯¹äºåŸºæœŸçš„ç§°ä¸ºç°æœŸ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¢é•¿é‡
&lt;ul>
&lt;li>åŸºæœŸé‡ä¸ç°æœŸé‡å¢é•¿ï¼ˆé™ä½/å‡å°‘çš„ï¼‰&lt;strong>ç»å¯¹&lt;/strong>é‡&lt;/li>
&lt;li>å¢é•¿é‡ = ç°æœŸé‡-åŸºæœŸé‡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¢é•¿ç‡
&lt;ul>
&lt;li>$å¢é•¿ç‡=\frac{å¢é•¿é‡}{åŸºæœŸé‡} = \frac{ç°æœŸé‡-åŸºæœŸé‡}{åŸºæœŸé‡}$&lt;/li>
&lt;li>å‡å°‘ç‡ = -å¢é•¿é‡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¹´å‡å¢é•¿é‡
&lt;ul>
&lt;li>$=\frac{ç°æœŸé‡-åŸºæœŸé‡}{é—´éš”å¹´ä»½}$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¹´å‡å¢é•¿ç‡
&lt;ul>
&lt;li>$ç°æœŸé‡=åŸºæœŸé‡\times(1+å¹´å‡å¢é•¿ç‡)^n$ï¼Œå…¶ä¸­nä¸ºç›¸å·®å¹´ä»½&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åŒæ¯”ç¯æ¯”
&lt;ul>
&lt;li>åŒæ¯”ï¼šä¸å†å²åŒæœŸæ¯”è¾ƒï¼Œå®é™…ä¸Šæ˜¯æŒ‡ä¸å†å¹´çš„åŒä¸€æ—¶æœŸç›¸æ¯”è¾ƒã€‚&lt;/li>
&lt;li>ç¯æ¯”ï¼šä¸ä¸Šä¸ªç»Ÿè®¡å‘¨æœŸæ¯”è¾ƒï¼Œå®é™…ä¸Šæ˜¯æŒ‡â€œä¸ç´§ç´§ç›¸é‚»çš„ç»Ÿè®¡å‘¨æœŸç›¸æ¯”è¾ƒâ€ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ¯”é‡ã€å€æ•°ã€å¹³å‡æ•°ã€ç™¾åˆ†æ•°ã€æˆæ•°ã€ç¿»ç•ª
&lt;ul>
&lt;li>$æ¯”é‡=\frac{éƒ¨åˆ†}{æ•´ä½“}$&lt;/li>
&lt;li>å€æ•°ï¼šAæ˜¯Bçš„$\frac{A}{B}$å€&lt;/li>
&lt;li>å¹³å‡æ•°ï¼šå¹³å‡æ•°=æ€»æ•°Ã·æ€»æ•°&lt;/li>
&lt;li>ç™¾åˆ†ç‚¹æ˜¯ç™¾åˆ†æ•°çš„å•ä½ï¼Œç”¨äºç™¾ä½æ•°åŠ å‡&lt;/li>
&lt;li>æˆè¡¨ç¤ºååˆ†ä¹‹ä¸€&lt;/li>
&lt;li>ç¿»ä¸€ç•ªä¸ºåŸæ¥çš„2å€ï¼Œç¿»nç•ªä¸ºåŸæ¥çš„$2^n$å€&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>é¡ºå·®ã€é€†å·®
&lt;ul>
&lt;li>é¡ºå·®ï¼šå‡ºå£&amp;gt;è¿›å£&lt;/li>
&lt;li>é€†å·®ï¼šè¿›å£&amp;gt;å‡ºå£&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>GDP=å¢åŠ å€¼&lt;/li>
&lt;/ul>
&lt;h2 id="é€Ÿç®—æŠ€å·§">é€Ÿç®—æŠ€å·§&lt;/h2>
&lt;h3 id="æˆªä½ç›´é™¤">æˆªä½ç›´é™¤&lt;/h3>
&lt;ol>
&lt;li>é€‰é¡¹é¦–ä½å‡ä¸åŒï¼Œä¿ç•™ä¸¤ä½
é€‰é¡¹é¦–ä½æœ‰ç›¸åŒçš„ï¼Œä¿ç•™ä¸‰ä½&lt;/li>
&lt;li>é€‰é¡¹ä¹‹é—´è¯¯å·®åœ¨ 10%ä»¥ä¸Šï¼Œä¿ç•™ä¸¤ä½
é€‰é¡¹ä¹‹é—´è¯¯å·®åœ¨ 10%ä»¥å†…ï¼Œä¿ç•™ä¸‰ä½&lt;/li>
&lt;li>ä¸€æ­¥é™¤å¼ï¼šåªä¼°ç®—åˆ†æ¯ï¼Œä¿ç•™ä¸‰ä½
å¤šæ­¥è¿é™¤ï¼šåˆ†å­åˆ†æ¯åŒæ—¶æˆªä½ï¼Œåˆ†å¼€ä¼°ç®—/äº¤å‰ä¼°ç®—&lt;/li>
&lt;/ol>
&lt;p>å…³äºå¤šæ­¥æˆªé™¤çš„å¢é•¿ç‡ä¼°ç®—&lt;/p>
&lt;p>$\frac{1+11%}{1+3%} \approx 1+8%$&lt;/p>
&lt;ul>
&lt;li>ä¹˜æ³•ä¼°ç®—ï¼šä¹˜æ³•ä¸€å¤§ä¸€å°ï¼Œå„æŒ‰æ¯”ä¾‹ç¼©æ”¾ï¼ˆç²—ç®—ä¸éœ€è¦ï¼Œé¦–ä½å‡ä¸åŒï¼‰&lt;/li>
&lt;li>$99\uparrow+101\downarrow \approx100*100$&lt;/li>
&lt;/ul>
&lt;h3 id="ç‰¹æ®Šåˆ†æ•°">ç‰¹æ®Šåˆ†æ•°&lt;/h3>
&lt;ul>
&lt;li>$\frac{1}{2}=50%$&lt;/li>
&lt;li>$\frac{1}{3}=33.3%$&lt;/li>
&lt;li>$\frac{1}{4}=25%$&lt;/li>
&lt;li>$\frac{1}{5}=20%$&lt;/li>
&lt;li>$\frac{1}{6}=16.7%$&lt;/li>
&lt;li>$\frac{1}{7}=13.4%$&lt;/li>
&lt;li>$\frac{1}{8}=12.5%$&lt;/li>
&lt;li>$\frac{1}{9}=11.1%$&lt;/li>
&lt;li>$\frac{1}{10}=10%$&lt;/li>
&lt;li>&lt;/li>
&lt;/ul>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>2011 å¹´å‰åä¸€ä¸ªæœˆï¼ŒæŸçœé«˜æ–°æŠ€æœ¯äº§ä¸šå®Œæˆæ€»äº§å€¼ 3763.00 äº¿å…ƒï¼Œå®ç°å¢åŠ  å€¼ 896.31 äº¿å…ƒã€‚å¢åŠ å€¼åŒæ¯”å¢é•¿ 30.74%ï¼Œæ¯”è§„æ¨¡ä»¥ä¸Šå·¥ä¸šå¢åŠ å€¼é«˜ 11.64 ä¸ªç™¾ åˆ†ç‚¹ï¼Œå è§„æ¨¡ä»¥ä¸Šå·¥ä¸šå¢åŠ å€¼çš„æ¯”é‡è¾¾åˆ° 25.32%ã€‚&lt;/p>
&lt;p>ã€ç»ƒ 5ã€‘2010 å¹´å‰åä¸€ä¸ªæœˆï¼Œè¯¥çœè§„æ¨¡ä»¥ä¸Šå·¥ä¸šå¢åŠ å€¼çº¦ä¸ºå¤šå°‘äº¿å…ƒï¼Ÿ&lt;/p>
&lt;p>A.2972 B.3540 C.3865 D.4373&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=4&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2259">1&lt;/a>ï¼Œæ³¨æ„ä¸Šä¸‹å¼å­å¯¹åº”çš„ä¸œè¥¿è¦ä¸€è‡´ï¼šæ±‚å‡ºä»Šå¹´çš„è§„æ¨¡ä»¥ä¸Šçš„GDPï¼Œå†æ ¹æ®è§„æ¨¡ä»¥ä¸Šçš„å¢é•¿ç‡æ±‚å»å¹´çš„GDPï¼›è€Œä¸æ˜¯æ±‚ä»Šå¹´çš„é«˜æ–°GDPï¼Œå†æ ¹æ®1+è§„æ¨¡ä»¥ä¸Šçš„å¢é•¿ç‡&lt;/p>
&lt;/li>
&lt;li>
&lt;p>2015 å¹´æˆ‘å›½é«˜æŠ€æœ¯åˆ¶é€ ä¸šå®ç°ä¸»è¥ä¸šåŠ¡æ”¶å…¥ 116048.9 äº¿å…ƒï¼Œæ¯” 2010 å¹´å¢é•¿ 108.2%ï¼›å å…¨éƒ¨åˆ¶é€ ä¸šä¼ä¸šçš„æ¯”é‡ä¸º 12.8%ï¼Œæ¯” 2010 å¹´æé«˜ 0.8 ä¸ªç™¾åˆ†ç‚¹ã€‚2015 å¹´æˆ‘å›½é«˜æŠ€æœ¯åˆ¶é€ ä¸šå®ç°åˆ©æ¶¦æ€»é¢ 7233.7 äº¿å…ƒï¼Œæ¯” 2010 å¹´å¢é•¿ 165.5%ï¼Œå¢å¹…æ¯” å…¶ä»–åˆ¶é€ ä¸šå¹³å‡æ°´å¹³é«˜å‡º 11.5 ä¸ªç™¾åˆ†ç‚¹ï¼›é«˜æŠ€æœ¯åˆ¶é€ ä¸šåˆ©æ¶¦æ€»é¢å å…¨éƒ¨åˆ¶é€ ä¸š çš„æ¯”é‡ä¸º 13.1%ï¼Œæ¯” 2010 å¹´æé«˜ 0.5 ä¸ªç™¾åˆ†ç‚¹ã€‚&lt;/p>
&lt;p>ã€ç»ƒ 3ã€‘2010 å¹´ï¼Œæˆ‘å›½åˆ¶é€ ä¸šå®ç°åˆ©æ¶¦æ€»é¢çº¦å¤šå°‘ä¸‡äº¿å…ƒï¼Ÿ&lt;/p>
&lt;p>Aï¼1.3 Bï¼1.7 Cï¼2.2 Dï¼2.8&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=4&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1425">2&lt;/a>ï¼Œ$\frac{åˆ©æ¶¦_{2015}}{1+165.5%} \div æ¯”é‡_{2010}$&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="åˆ†æ•°æ¯”è¾ƒ">åˆ†æ•°æ¯”è¾ƒ&lt;/h3>
&lt;ul>
&lt;li>æ–¹æ³•ä¸€
&lt;ul>
&lt;li>â‘ åˆ†å­å¤§ï¼Œåˆ†æ¯å°ï¼Œç›´æ¥åˆ¤æ–­åˆ†æ•°å¤§&lt;/li>
&lt;li>â‘¡åˆ†å­åˆ†æ¯åŒå¤§ï¼Œçœ‹å˜åŒ–é€Ÿåº¦ï¼Œ åˆ†å­å˜åŒ–å¤§ï¼Œé€‰åˆ†å­å¤§ï¼›åˆ†æ¯å˜åŒ–å¤§ï¼Œé€‰åˆ†æ¯å°&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ–¹æ³•äºŒï¼šç›´é™¤æ¯”è¾ƒ&lt;/li>
&lt;li>ä¼˜å…ˆ&lt;strong>ç›´é™¤é¦–ä½&lt;/strong>ï¼Œå…¶æ¬¡çœ‹å˜åŒ–é€Ÿåº¦&lt;/li>
&lt;/ul>
&lt;h2 id="é‡ç‚¹é¢˜å‹">é‡ç‚¹é¢˜å‹&lt;/h2>
&lt;h3 id="ç®€å•é¢˜">ç®€å•é¢˜&lt;/h3>
&lt;p>ç›´æ¥è®¡ç®—å’Œç›´æ¥æŸ¥æ‰¾&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æˆªè‡³ 2012 å¹´åº•ï¼Œåœ¨ç½‘æ°‘å¢é•¿é€Ÿåº¦é€æ­¥æ”¾ç¼“çš„èƒŒæ™¯ä¸‹ï¼Œç½‘ç»œè´­ç‰©åº”ç”¨ä¾ç„¶å‘ˆ ç°è¿…çŒ›å¢é•¿çš„åŠ¿å¤´ï¼Œç½‘ç»œè´­ç‰©ä½¿ç”¨ç‡æå‡è‡³ 42.9%ï¼Œå…¨å¹´ç½‘ç»œè´­ç‰©ç”¨æˆ·å¢åŠ  4807 ä¸‡ï¼Œç”¨æˆ·ç»å¯¹å¢é•¿é‡è¶…å‡ºä¸Šå¹´ 1463 ä¸‡ã€‚ç½‘ä¸Šæ”¯ä»˜ä½¿ç”¨ç‡æå‡è‡³ 39.2%ï¼Œå…¨å¹´ç”¨ æˆ·å¢é•¿ 5389 ä¸‡ã€‚ç½‘ä¸Šé“¶è¡Œä½¿ç”¨ç‡æå‡è‡³ 39.2%ï¼Œæ¯”ä¸Šå¹´åº•æå‡ 6.9 ä¸ªç™¾åˆ†ç‚¹ã€‚ 70.6%çš„ç½‘æ°‘ä½¿ç”¨å°å¼ç”µè„‘ä¸Šç½‘ï¼Œç›¸æ¯”ä¸Šå¹´åº•ä¸‹é™äº†è¿‘ä¸‰ä¸ªç™¾åˆ†ç‚¹ï¼Œä½¿ç”¨ç¬”è®°æœ¬ ç”µè„‘ä¸Šç½‘çš„ç½‘æ°‘æ¯”ä¾‹ä¸ä¸Šå¹´åº•ç›¸æ¯”ç•¥æœ‰é™ä½ï¼Œä¸º 45.9%ã€‚&lt;/p>
&lt;p>ã€ç»ƒ 7ã€‘2012 å¹´æˆ‘å›½ç½‘æ°‘ä½¿ç”¨å°å¼ç”µè„‘ä¸Šç½‘çš„æ¯”ä¾‹æ¯”ä½¿ç”¨ç¬”è®°æœ¬ç”µè„‘ä¸Šç½‘çš„ æ¯”ä¾‹é«˜&lt;/p>
&lt;p>A.è¿‘ 3 ä¸ªç™¾åˆ†ç‚¹ B.è¿‘ 3% C.24.7% D.24.7 ä¸ªç™¾åˆ†ç‚¹&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=5&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1608">1&lt;/a>ï¼Œç™¾åˆ†æ•°åŠ å‡æ˜¯ç™¾åˆ†ç‚¹&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å¢é•¿ç‡ç›¸å…³">å¢é•¿ç‡ç›¸å…³&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=5&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2890">å¢é•¿ç‡ç›¸å…³&lt;/a>&lt;/p>
&lt;p>$å¢é•¿ç‡=\frac{å¢é•¿é‡}{åŸºæœŸé‡} = \frac{ç°æœŸé‡-åŸºæœŸé‡}{åŸºæœŸé‡}$&lt;/p>
&lt;p>æˆªä½ç›´é™¤&lt;/p>
&lt;ol start="2">
&lt;li>ç°æœŸé‡ = åŸºæœŸé‡ Ã— (1 + ğ‘Ÿ)&lt;/li>
&lt;li>åŸºæœŸé‡ = $\frac{ç°æœŸé‡}{1 + r}$ = ç°æœŸé‡ âˆ’ å¢é•¿é‡&lt;/li>
&lt;/ol>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/11/20231116200706.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;p>ã€ç»ƒ 9ã€‘æŒ‰ 2011 å¹´çš„äººå£è‡ªç„¶å¢é•¿ç‡è®¡ç®—ï¼Œé¢„è®¡ 2012 å¹´çš„äººå£çº¦ä¸ºï¼ˆ ï¼‰ä¸‡äººã€‚&lt;/p>
&lt;p>Aï¼135382 Bï¼135409 Cï¼141129 Dï¼141202&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2857">1&lt;/a>ï¼Œ$å»å¹´ \times r = ä»Šå¹´-å»å¹´ \Rightarrow ä»Šå¹´ \times r = (å»å¹´+å¢é•¿é‡) \times r = å¢é•¿é‡+å¢é•¿é‡ \times r$&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="é—´éš”å¢é•¿ç‡">é—´éš”å¢é•¿ç‡&lt;/h4>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3122">é—´éš”å¢é•¿ç‡&lt;/a>&lt;/p>
&lt;p>é¢˜å‹ç‰¹å¾ï¼šé—´éš”ä¸€å¹´ï¼Œ2017 å¹´æ¯” 2015 å¹´å¢é•¿ç‡ï¼Œ2016 å¹´ç¬¬ä¸€å­£åº¦æ¯” 2014 å¹´ç¬¬ä¸€å­£åº¦å¢é•¿ç‡ã€‚&lt;/p>
&lt;p>å…¬å¼ï¼š$R = ğ‘Ÿ_1 + ğ‘Ÿ_2 + ğ‘Ÿ_1 \times ğ‘Ÿ_2$ï¼ˆğ‘Ÿ1å’Œğ‘Ÿ2æ˜¯è¾ƒå¤§ä¸¤ä¸ªå¹´ä»½çš„å¢é•¿ç‡ï¼‰&lt;/p>
&lt;p>å¤§èƒ†ä¼°ç®—ğ‘Ÿ1 Ã— ğ‘Ÿ2çš„æŠ€å·§ï¼š&lt;/p>
&lt;ul>
&lt;li>$r_1 \times r_2 = a% \times b% = \frac{ab}{100} %$&lt;/li>
&lt;li>r1 Ã— r2ï¼Œä¸€ä¸ªåŒ–ä¸ºåˆ†æ•°ï¼Œä¸€ä¸ªä¸å˜&lt;/li>
&lt;li>r1å’Œr2å‡å°äº 10%ï¼Œ r1 Ã— r2 &amp;lt; 1%ï¼Œå¤§èƒ†ä¼°ç®—&lt;/li>
&lt;/ul>
&lt;h4 id="æ··åˆå¢é•¿ç‡">æ··åˆå¢é•¿ç‡&lt;/h4>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=8.">æ··åˆå¢é•¿ç‡&lt;/a>&lt;/p>
&lt;ul>
&lt;li>æ··åˆå¢é•¿ç‡ï¼šå¤§å°å±…ä¸­ï¼Œåå‘åŸºæœŸé‡å¤§çš„&lt;/li>
&lt;li>ä¸­é—´=ä¸¤è¾¹çš„å¹³å‡æ•°ï¼›å·¦è¾¹&amp;lt;ä¸­é—´&amp;lt;å³è¾¹&lt;/li>
&lt;li>ä¸€èˆ¬é¢˜ç›®éƒ½æ˜¯ç»™å®šå½“å¹´çš„é‡å’Œå¢é•¿ç‡ï¼Œç¼ºå°‘å·¦/å³çš„å¢é•¿ç‡&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1539">ç²¾ç¡®æ±‚æ··åˆ&lt;/a>
&lt;img src="https://pic.keepjolly.com/halo/blog/2023/11/20231116225256.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>2013 å¹´ 3 æœˆæœ«ï¼Œä¸»è¦é‡‘èæœºæ„åŠå°å‹å†œæ‘é‡‘èæœºæ„ã€å¤–èµ„é“¶è¡Œäººæ°‘å¸æˆ¿åœ° äº§è´·æ¬¾ä½™é¢ 12.98 ä¸‡äº¿å…ƒï¼ŒåŒæ¯”å¢é•¿ 16.4%ã€‚åœ°äº§å¼€å‘è´·æ¬¾ä½™é¢ 1.04 ä¸‡äº¿å…ƒï¼Œ åŒæ¯”å¢é•¿ 21.4%ã€‚æˆ¿äº§å¼€å‘è´·æ¬¾ä½™é¢ 3.2 ä¸‡äº¿å…ƒï¼ŒåŒæ¯”å¢é•¿ 12.3%ã€‚ä¸ªäººè´­æˆ¿è´· æ¬¾ä½™é¢ 8.57 ä¸‡äº¿å…ƒï¼ŒåŒæ¯”å¢é•¿ 17.4%ã€‚ä¿éšœæ€§ä½æˆ¿å¼€å‘è´·æ¬¾ä½™é¢ 6140 äº¿å…ƒï¼ŒåŒ æ¯”å¢é•¿ 42.4%ã€‚&lt;/p>
&lt;p>ã€ä¾‹ 2ã€‘2013 å¹´ 3 æœˆæœ«ï¼Œæˆ¿åœ°äº§å¼€å‘è´·æ¬¾ä½™é¢åŒæ¯”å¢é€Ÿçº¦ä¸ºï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;p>A.14.4% B.12.3% C.19.3% D.21.4%&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=432">ä¾‹2&lt;/a>ï¼Œæˆ¿äº§3.2ï¼Œ12.3%ï¼Œåœ°äº§1.04ï¼Œ21.4%ï¼Œæˆ¿åœ°äº§12.3%&amp;lt; x &amp;lt;(12.3+21.4)/2%&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/11/20231116224858.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;p>ã€ä¾‹ 4ã€‘2013 å¹´ç¬¬ä¸‰å­£åº¦ç¤¾ä¼šç‰©æµæ€»é¢åŒæ¯”å¢é€Ÿé«˜äºç¬¬å››å­£åº¦(T/F)&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=50404">1&lt;/a>ï¼Œç´¯è®¡å‰ä¸‰å­£åº¦+ç´¯è®¡å‰äºŒå­£åº¦ =&amp;gt;ä¸‰å­£åº¦&amp;gt;9.5%ï¼›ç´¯è®¡å‰å››å­£åº¦+ç´¯è®¡å‰ä¸‰å­£åº¦=&amp;gt;å››å­£åº¦=9.5%&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="å¹´å‡å¢é•¿ç‡">å¹´å‡å¢é•¿ç‡&lt;/h4>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2949">å¹´å‡å¢é•¿ç‡&lt;/a>&lt;/p>
&lt;p>å¹´å‡å¢é•¿ç‡è®¡ç®—ï¼šä»£å…¥ç‰¹æ®Šå€¼(ç­”æ¡ˆçš„å±…ä¸­å€¼ï¼š10 20 )&lt;/p>
&lt;p>å¹´å‡å¢é•¿ç‡æ¯”è¾ƒï¼šæ¯”è¾ƒæ¯ä¸ª$\frac{ç°æœŸ}{åŸºæœŸ}$çš„å€¼ï¼Œ35.5åˆ°313=$35.5\times8^+$ï¼Œ8å€&lt;/p>
&lt;p>å…³äºæ€ä¹ˆæ•°å¹´ä»½ï¼šé—® 2013-2017 å¹´çš„å¹´å‡å¢é•¿ç‡ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡º 2012 å¹´çš„ å…·ä½“å€¼ï¼Œé‚£ä¹ˆä»¥ 2013 å¹´ä¸ºåŸºæœŸï¼Œæ±‚ 4 å¹´çš„å¹´å‡å¢é•¿ï¼›å¦‚æœç»™å‡ºäº† 2012 å¹´çš„å…·ä½“ å€¼ï¼Œé‚£ä¹ˆä»¥ 2012 å¹´ä¸ºåŸºæœŸï¼Œæ±‚ 5 å¹´çš„å¹´å‡å¢é•¿ã€‚&lt;/p>
&lt;p>$11^2=121,12^2=144,13^2=169,14^2=196,15^2=225,16^2=256$&lt;/p>
&lt;ul>
&lt;li>å¹´å‡å¢é•¿é‡
&lt;ul>
&lt;li>$=\frac{ç°æœŸé‡-åŸºæœŸé‡}{é—´éš”å¹´ä»½}$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¹´å‡å¢é•¿ç‡
&lt;ul>
&lt;li>$ç°æœŸé‡=åŸºæœŸé‡\times(1+å¹´å‡å¢é•¿ç‡)^n$ï¼Œå…¶ä¸­nä¸ºç›¸å·®å¹´ä»½&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/11/20231117230604.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">
ã€ä¾‹ 4ã€‘(2013 å¹´æ±Ÿè‹)è‹¥ä¸è€ƒè™‘ä»·æ ¼å› ç´ ï¼Œåˆ™ 2003-2011 å¹´ä¹å¹´ï¼Œæ±Ÿè‹é‡‘è ä¸šå¢åŠ å€¼å¹´å‡å¢é€Ÿ Vjã€ç¬¬ä¸‰äº§ä¸šå¢åŠ å€¼å¹´å‡å¢é€Ÿ Vsã€åœ°åŒºå›½å†…ç”Ÿäº§æ€»å€¼å¹´å‡å¢ é€Ÿ Vg çš„å¤§å°å…³ç³»æ˜¯ï¼š&lt;/p>
&lt;p>A. Vsï¼Vjï¼Vg B. Vjï¼Vgï¼Vs C. Vjï¼Vsï¼Vg D. Vsï¼Vgï¼Vj&lt;/p>
&lt;p>å¦‚æœç¬¬ä¸€å¹´åˆ°æœ€åä¸€å¹´çš„å¢é•¿ç‡å¤§ï¼Œå¹³å‡åˆ°æ¯ä¸€å¹´å°±å¤§ï¼Œæ‰€ä»¥çœ‹ç¬¬ä¸€å¹´åˆ°æœ€åä¸€å¹´çš„å¢é•¿ç‡ã€‚&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4588">1&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å¢é•¿é‡ç›¸å…³">å¢é•¿é‡ç›¸å…³&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=238">å¢é•¿é‡ç›¸å…³&lt;/a>&lt;/p>
&lt;p>å¢é•¿é‡ = ç°æœŸé‡ âˆ’ åŸºæœŸé‡ = åŸºæœŸé‡ Ã— r = ç°æœŸé‡/(1 + r) Ã— r&lt;/p>
&lt;p>è§£é¢˜æŠ€å·§:&lt;/p>
&lt;ul>
&lt;li>ç‰¹æ®Šåˆ†æ•°
&lt;ul>
&lt;li>ç°æœŸ/1+ç‰¹æ®Šåˆ†æ•° = ç°æœŸ/ç‰¹æ®Šåˆ†æ•°+1&lt;/li>
&lt;li>ç°æœŸ/(1+1/8) = ç°æœŸ/9&lt;/li>
&lt;li>ç°æœŸ/(1-1/8) = ç°æœŸ/7&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æˆªä½ç›´é™¤æ³•
&lt;ul>
&lt;li>ç°æœŸé‡Ã— r /(1 + r)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1706">å¢é•¿é‡å¤§å°æ¯”è¾ƒ&lt;/a>ï¼š&lt;/p>
&lt;ol>
&lt;li>ç°æœŸå€¼å¤§ï¼Œå¢é•¿ç‡å¤§ï¼Œå¤§å¤§åˆ™å¤§ã€‚&lt;/li>
&lt;li>ä¸€å¤§ä¸€å°ï¼Œè¿‘ä¼¼æ¯”è¾ƒç°æœŸé‡Ã—r çš„ä¹˜ç§¯
&lt;ol>
&lt;li>$\frac{Ar_1}{1+r_1}$å’Œ $\frac{Br_2}{1+r_2}$&lt;/li>
&lt;li>å¿½ç•¥åº•éƒ¨ï¼Œçœ‹åˆ†å­ä¹˜ç§¯&lt;/li>
&lt;li>r1å’Œr2çš„å·®è·åœ¨20%ä»¥å†…å¯ä»¥ç›´æ¥ç”¨ï¼Œæ¯”è¾ƒä¹˜ç§¯&lt;/li>
&lt;li>r1å’Œr2çš„å·®è·åœ¨20%ä»¥ä¸Šï¼Œåˆ—å‡ºå®Œæ•´å¼å­è¿›è¡Œä¼°ç®—&lt;/li>
&lt;li>å¦‚æœä¸¤ä¸ªä¹˜ç§¯æ¯”è¾ƒæ¥è¿‘ï¼Œåˆ—å‡ºå®Œæ•´å¼å­è¿›è¡Œä¼°ç®—&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>æ­£å¤§äºè´Ÿ&lt;/li>
&lt;/ol>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/11/20231117230954.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">
ã€ç»ƒ 8ã€‘2011ï½2017 å¹´ï¼Œå…¨å›½äºŒæ‰‹è½¦äº¤æ˜“é‡åŒæ¯”å¢é‡ä½äº 80 ä¸‡è¾†çš„å¹´ä»½æœ‰ å‡ ä¸ªï¼Ÿ&lt;/p>
&lt;p>Aï¼3 Bï¼4 Cï¼5 Dï¼7&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3823">ä¸ç­‰äºæ±‚å¹´å¹³å‡å¢é•¿ç‡&lt;/a>ï¼Œéœ€è¦æ±‚2011å¹´&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ¯”é‡ç›¸å…³">æ¯”é‡ç›¸å…³&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=457">åŸºæœŸæ¯”é‡&lt;/a>&lt;/p>
&lt;p>æ¯”é‡ = $\frac{A}{B} \times \frac{1+b}{1+a}$,ä¸åŒ–ç®€å¥½ä¸€ç‚¹$\frac{\frac{A}{1+a}}{\frac{B}{1+b}}$&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>2015 å¹´ï¼Œæ±Ÿè¥¿è§„æ¨¡ä»¥ä¸Šå·¥ä¸šå¢åŠ å€¼ 7268.9 äº¿å…ƒï¼Œæ¯”ä¸Šå¹´å¢é•¿ 9.2%ã€‚åˆ†è½»é‡ å·¥ä¸šçœ‹ï¼Œè½»å·¥ä¸šå¢åŠ å€¼ 2731.2 äº¿å…ƒï¼Œå¢é•¿ 7.7%ï¼›é‡å·¥ä¸šå¢åŠ å€¼ 4537.7 äº¿å…ƒï¼Œ å¢é•¿ 10.1%ã€‚&lt;/p>
&lt;p>ã€ä¾‹ 5ã€‘2014 å¹´æ±Ÿè¥¿çœé‡å·¥ä¸šå¢åŠ å€¼å è§„æ¨¡ä»¥ä¸Šå·¥ä¸šå¢åŠ å€¼çš„æ¯”é‡ä¸ºï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;p>Aï¼56.7% Bï¼62.4% Cï¼61.9% Dï¼68.3%&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=802">ä¾‹5&lt;/a>ï¼ŒBCåˆ†æ¯ä¿ç•™3ä½ï¼Œåˆ†å­ä¸å˜ï¼ŒBæ˜¯ç°æœŸæ¯”é‡ï¼Œç›´æ¥æ¨C&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="ä¸¤æœŸæ¯”é‡">ä¸¤æœŸæ¯”é‡&lt;/h4>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1087">ä¸¤æœŸæ¯”é‡å˜åŒ–&lt;/a>&lt;/p>
&lt;ul>
&lt;li>çœ‹&lt;strong>éƒ¨åˆ†&lt;/strong>çš„å¢é•¿ç‡å¤§äº&lt;strong>æ•´ä½“&lt;/strong>çš„å¢é•¿ç‡åˆ™æ¯”é‡å¢å¤§ï¼Œå¦åˆ™æ¯”é‡å‡å°‘
&lt;ul>
&lt;li>$å»å¹´ï¼š\frac{X_{part}}{Y_{all}} &amp;gt; ä»Šå¹´ï¼š\frac{X_{part}(1+a)}{Y_{all}(1+b)} \Rightarrow a&amp;gt;b æ¯”é‡ \uparrow$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ¯”é‡ä¸Šå‡ä¹Ÿå¯ä»¥åæ¨éƒ¨åˆ†å¢é€Ÿå¿«&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1639">ä¸¤æœŸæ¯”é‡å·®&lt;/a>(ç™¾åˆ†ç‚¹)ï¼š&lt;/p>
&lt;ul>
&lt;li>$\frac{A}{B} - \frac{A}{B}\times\frac{1+b}{1+a} = \frac{A}{B}(\frac{a-b}{1+a})$&lt;/li>
&lt;li>å®é™…ä¸Šçœ‹a-bï¼Œå…¶ä»–éƒ¨åˆ†&amp;lt;1&lt;/li>
&lt;/ul>
&lt;h3 id="å¹³å‡æ•°ä¸å€æ•°">å¹³å‡æ•°ä¸å€æ•°&lt;/h3>
&lt;ul>
&lt;li>ç°æœŸå€æ•°ï¼ŒA æ˜¯ B çš„å‡ å€ï¼ŒA/B&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=10&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=507">åŸºæœŸå€æ•°&lt;/a> $\frac{\frac{A}{1+a}}{\frac{B}{1+b}}=\frac{A}{B} \times \frac{1+b}{1+a}$&lt;/li>
&lt;li>å¹³å‡æ•° ç­‰å·®æ•°åˆ—å¹³å‡æ•°ç­‰äºä¸­ä½æ•°&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1f4411C7z5/?p=10&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1908">å¹³å‡å€¼å¢é•¿ç‡&lt;/a>ï¼š$\frac{ä»Šå¹´-å»å¹´}{å»å¹´} = \frac{A(1+a)/B(1+b)-A/B}{A/B}= \frac{a-b}{1+b}$ ï¼ˆä¸ç­‰äºæ¯”é‡å·®ï¼‰&lt;/li>
&lt;/ul>
&lt;p>åº”ç”¨æŠ€å·§ï¼šæˆªä½ç›´é™¤ï¼Œå é™¤ä¼°ç®—&lt;/p></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/civilservant/">CivilServant</category></item><item><title>å…¬åŠ¡å‘˜è¡Œæµ‹--æ•°é‡å…³ç³»</title><link>https://keepjolly.com/posts/learn/quantitative-relation/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/quantitative-relation/</guid><pubDate>Wed, 08 Nov 2023 23:00:50 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="è§£é¢˜æŠ€å·§">è§£é¢˜æŠ€å·§&lt;/h2>
&lt;h3 id="ä»£å…¥æ’é™¤æ³•-">ä»£å…¥æ’é™¤æ³• â€»&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=631">ä»£å…¥æ’é™¤æ³•&lt;/a>&lt;/p>
&lt;p>é¢˜å‹ï¼šå¤šä½æ•°é—®é¢˜ã€ä½™æ•°é—®é¢˜ã€å¹´é¾„é—®é¢˜ã€ä¸å®šæ–¹ç¨‹ã€ä¸ä¼šåšçš„&lt;/p>
&lt;hr>
&lt;p>å¤šä½æ•°é—®é¢˜&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å°†ä¸€ä¸ªä¸‰ä½æ•°çš„ä¸ªä½æ•°å­—å’Œç™¾ä½æ•°å­—è°ƒæ¢åæ‰€å¾—çš„ä¸‰ä½æ•°ä¸åŸä¸‰ä½æ•°çš„å’Œæ˜¯1070ï¼Œå·®æ˜¯198ï¼Œè¿™ä¸ªä¸‰ä½æ•°æ˜¯ï¼š&lt;/p>
&lt;p>Aï¼218 Bï¼327 Cï¼436 Dï¼524&lt;/p>
&lt;p>è§£ï¼š436ä»£å…¥å¾—634+436=1070ï¼Œ634-436=198&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>ä½™æ•°é—®é¢˜&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ä¸€æ‰¹æ­¦è­¦æˆ˜å£«å¹³å‡åˆ†æˆè‹¥å¹²å°ç»„å€¼å‹¤ã€‚å¦‚æœæ¯ 4 äººä¸€ç»„ï¼Œæ°å¥½ä½™ 1 äººï¼›å¦‚æœæ¯ 5 äººä¸€ç»„ï¼Œæ°å¥½ä¹Ÿä½™ 1 äººï¼›å¦‚æœæ¯ 6 äººä¸€ç»„ï¼Œæ°å¥½è¿˜æ˜¯ä½™ 1 äººã€‚è¿™æ‰¹æ­¦è­¦æˆ˜å£«è‡³å°‘æœ‰ï¼ˆ ï¼‰äººã€‚&lt;/p>
&lt;p>Aï¼121 Bï¼101 Cï¼81 Dï¼61&lt;/p>
&lt;p>è§£ï¼š&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2595">ç²¾å‡†ç©ºé™åˆ° 43:15&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ•°å­—ç‰¹æ€§">æ•°å­—ç‰¹æ€§&lt;/h3>
&lt;h4 id="å¥‡å¶æ€§">å¥‡å¶æ€§&lt;/h4>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2750">æ•°å­—ç‰¹æ€§&lt;/a>&lt;/p>
&lt;ul>
&lt;li>å¥‡/å¶ Â± å¥‡/å¶ = å¶&lt;/li>
&lt;li>å¥‡ Â± å¶ = å¥‡&lt;/li>
&lt;li>å¥‡ Ã— å¥‡ = å¥‡&lt;/li>
&lt;li>å¶ Ã— any = å¶&lt;/li>
&lt;/ul>
&lt;p>ä½¿ç”¨åœºæ™¯ï¼šçŸ¥å·®æ±‚å’Œã€çŸ¥å’Œæ±‚å·®ï¼›äºŒå€ç±»ã€å¹³å‡åˆ†ï¼›ä¸å®šæ–¹ç¨‹&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸæ¬¡æµ‹éªŒæœ‰ 50 é“åˆ¤æ–­é¢˜ï¼Œæ¯åšå¯¹ä¸€é¢˜å¾— 3 åˆ†ï¼Œä¸åšæˆ–åšé”™ä¸€é¢˜å€’ æ‰£1åˆ†ï¼ŒæŸå­¦ç”Ÿå…±å¾—82åˆ†ï¼Œé—®ç­”å¯¹é¢˜æ•°å’Œç­”é”™é¢˜æ•°ï¼ˆåŒ…æ‹¬ä¸åšï¼‰ç›¸å·®å¤šå°‘ï¼Ÿï¼ˆ ï¼‰&lt;/p>
&lt;p>A.33 B.39 C.17 D.16&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4422">ç»ƒ1&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ¯äº²ç°åœ¨çš„å¹´é¾„ä¸ªä½æ•°è·Ÿåä½æ•°å¯¹è°ƒå†å‡ 10 å²å°±æ˜¯å„¿å­çš„å¹´é¾„ï¼Œ å†è¿‡ 3 å¹´æ¯äº²çš„å¹´é¾„å°±æ˜¯å„¿å­å¹´é¾„çš„ 2 å€ï¼Œåˆ™æ¯äº²ç°åœ¨çš„å¹´é¾„æ˜¯ï¼ˆï¼‰ã€‚&lt;/p>
&lt;p>A.53 B.52 C.43 D.42&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3443">ä¾‹2&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="æ•´é™¤åˆ¤å®š">æ•´é™¤åˆ¤å®š&lt;/h4>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5764">æ•´é™¤åˆ¤å®šï¼ŒåŸç†åœ¨å‰é¢å‡ åˆ†é’Ÿ&lt;/a>&lt;/p>
&lt;ul>
&lt;li>2ï¼Œ4ï¼Œ8 æ•´é™¤åŠå…¶ä½™æ•°åˆ¤å®šæ³•åˆ™
&lt;ul>
&lt;li>ä¸€ä¸ªæ•°èƒ½è¢« 2(æˆ– 5)æ•´é™¤ï¼Œå½“ä¸”ä»…å½“&lt;strong>æœ«ä¸€ä½&lt;/strong>æ•°å­—èƒ½è¢« 2(æˆ–è€… 5)æ•´é™¤ï¼›&lt;/li>
&lt;li>ä¸€ä¸ªæ•°èƒ½è¢« 4(æˆ–è€… 25)æ•´é™¤ï¼Œå½“ä¸”ä»…å½“&lt;strong>æœ«ä¸¤ä½&lt;/strong>æ•°å­—èƒ½è¢« 4(æˆ–è€… 25)æ•´é™¤ï¼›&lt;/li>
&lt;li>ä¸€ä¸ªæ•°èƒ½è¢« 8(æˆ–è€… 125)æ•´é™¤ï¼Œå½“ä¸”ä»…å½“&lt;strong>æœ«ä¸‰ä½&lt;/strong>æ•°å­—èƒ½è¢« 8(æˆ–è€… 125)æ•´é™¤ï¼›&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>3ï¼Œ9 æ•´é™¤åˆ¤å®šåŸºæœ¬æ³•åˆ™
&lt;ul>
&lt;li>ä¸€ä¸ªæ•°å­—èƒ½è¢« 3 æ•´é™¤ï¼Œå½“ä¸”ä»…å½“å…¶å„ä½æ•°å­—&lt;strong>ä¹‹å’Œ&lt;/strong>èƒ½è¢« 3 æ•´é™¤ï¼›&lt;/li>
&lt;li>ä¸€ä¸ªæ•°å­—èƒ½è¢« 9 æ•´é™¤ï¼Œå½“ä¸”ä»…å½“å…¶å„ä½æ•°å­—&lt;strong>ä¹‹å’Œ&lt;/strong>èƒ½è¢« 9 æ•´é™¤ï¼›&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä½¿ç”¨åœºæ™¯ï¼šé¢˜ç›®å‡ºç° 2ã€4ã€8ã€3ã€9 ç­‰çš„å€æ•°ã€‚ é¢˜ç›®å‡ºç°å€æ•°ã€åˆ†æ•°ã€ç™¾åˆ†æ•°ã€æ¯”ä¾‹ã€åˆ†ç»„ï¼ˆ7ç”·5å¥³ä¸€ç»„ï¼š7ï¼š5ï¼‰ç­‰å­—çœ¼ã€‚ é¢˜ç›®ä¸­å‡ºç°â€œå„ä¸ªæ•°ä½ä¹‹å’Œâ€&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ä¸€ä¸ªå››ä½æ•°â€œâ–¡â–¡â–¡â–¡â€åˆ†åˆ«èƒ½è¢« 15ã€12 å’Œ 10 é™¤å°½ï¼Œä¸”è¢«è¿™ä¸‰ä¸ªæ•°é™¤å°½ æ—¶æ‰€å¾—çš„ä¸‰ä¸ªå•†çš„å’Œä¸º 1365ï¼Œé—®å››ä½æ•°â€œâ–¡â–¡â–¡â–¡â€ä¸­å››ä¸ªæ•°å­—çš„å’Œæ˜¯å¤šå°‘ï¼Ÿ&lt;/p>
&lt;p>Aï¼17 Bï¼16 Cï¼15 Dï¼14&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=6084">ä¾‹4ï¼Œè®¾å€¼å¯ä»¥è€ƒè™‘å…¬å€æ•°&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="å€æ•°å…³ç³»">å€æ•°å…³ç³»&lt;/h4>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=2&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=149">å€æ•°å…³ç³»&lt;/a>&lt;/p>
&lt;ul>
&lt;li>è‹¥ aï¼šb = mï¼šnï¼Œæˆ– $\frac{a}{b} = \frac{m}{n}$ æˆ–è€… $ğ‘ = \tfrac{m}{n}b$ï¼ˆmã€n äº’è´¨ï¼Œmï¼šn &lt;strong>ä¸èƒ½ç»§ç»­çº¦åˆ†&lt;/strong>ï¼‰ã€‚&lt;/li>
&lt;li>åˆ™ a æ˜¯ m çš„å€æ•°ï¼›b æ˜¯ n çš„å€æ•°ï¼›a + b æ˜¯ m + n çš„å€æ•°ï¼›a â€“ b æ˜¯ m â€“ n çš„å€æ•°&lt;/li>
&lt;li>ä¾‹ï¼šç”·æ˜¯å¥³ç”Ÿçš„9/4å€ $\Leftrightarrow$ ç”·ï¼šå¥³ = 9ï¼š4 $\Leftrightarrow$ aï¼šb=9ï¼š4 $\Leftrightarrow$ ç”·æ˜¯9çš„å€æ•°ï¼Œå¥³æ˜¯4çš„å€æ•° $\Leftrightarrow$ æ€»äººæ•°æ˜¯9+4çš„å€æ•°ï¼Œç”·å¥³ä¹‹å·®æ˜¯9-4çš„å€æ•°&lt;/li>
&lt;/ul>
&lt;p>ä½¿ç”¨åœºæ™¯ï¼šå€æ•°ã€ç™¾åˆ†æ•°ã€æ¯”ä¾‹ã€åˆ†ç»„ï¼ˆ7ç”·5å¥³ä¸€ç»„ï¼š7ï¼š5ï¼‰&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ç”²ä¹™ä¸¤é˜Ÿä¸¾è¡Œæ™ºåŠ›æŠ¢ç­”èµ›ï¼Œä¸¤é˜Ÿå¹³å‡å¾—åˆ†ä¸º 92 åˆ†ï¼Œå…¶ä¸­ç”²é˜Ÿå¹³å‡ å¾—åˆ† 88 åˆ†ï¼Œä¹™é˜Ÿå¹³å‡å¾—åˆ†ä¸º 94 åˆ†ï¼Œåˆ™ç”²ã€ä¹™ä¸¤é˜Ÿäººæ•°ä¹‹å’Œå¯èƒ½æ˜¯ï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;p>A.20 B.21 C.23 D.25&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=2&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2969">ä¾‹14(åå­—äº¤å‰ï¼Œä¸¤é˜Ÿå¹³å‡)&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¸¤ä¸ªæ´¾å‡ºæ‰€æŸæœˆå†…å…±å—ç†æ¡ˆä»¶ 160 èµ·ï¼Œå…¶ä¸­ç”²æ´¾å‡ºæ‰€å—ç†çš„æ¡ˆä»¶ä¸­ 17%æ˜¯åˆ‘äº‹æ¡ˆä»¶ï¼Œä¹™æ´¾å‡ºæ‰€å—ç†çš„æ¡ˆä»¶ä¸­æœ‰ 20%æ˜¯åˆ‘äº‹æ¡ˆä»¶ï¼Œé—®ä¹™æ´¾å‡ºæ‰€åœ¨è¿™ä¸ª æœˆä¸­å…±å—ç†å¤šå°‘èµ·éåˆ‘äº‹æ¡ˆä»¶ï¼Ÿ&lt;/p>
&lt;p>A.48 B.60 C.72 D.96&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=2&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3747">ç»ƒ4ï¼ˆä¸å¯çº¦åˆ†å¾—æ€»æ•°ï¼‰&lt;/a>ï¼Œå¹¶ä¸”100 &amp;lt; 160 &amp;lt; 200 åˆ™200ä¸è¡Œ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸæ±½è½¦å‚å•†ç”Ÿäº§ç”²ã€ä¹™ã€ä¸™ä¸‰ç§è½¦å‹,å…¶ä¸­ä¹™å‹äº§é‡çš„ 3 å€ä¸ä¸™å‹ äº§é‡çš„ 6 å€ä¹‹å’Œç­‰äºç”²å‹äº§é‡çš„ 4 å€ï¼Œç”²å‹äº§é‡ä¸ä¹™å‹äº§é‡çš„&lt;strong>2å€ä¹‹å’Œ&lt;/strong>ç­‰äºä¸™å‹ äº§é‡çš„ 7 å€ã€‚åˆ™ç”²ã€ä¹™ã€ä¸™ä¸‰å‹äº§é‡ä¹‹æ¯”ä¸º( )?&lt;/p>
&lt;p>A.5:4:3 B.4:3:2 C.4:2:1 D.3:2:1&lt;/p>
&lt;p>äºŒå€ä¹‹å’Œ != ä¹‹å’ŒäºŒå€&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ–¹ç¨‹æ³•">æ–¹ç¨‹æ³•&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=3&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=115">æ–¹ç¨‹æ³•&lt;/a>&lt;/p>
&lt;p>è®¾æœªçŸ¥æ•°çš„åŸåˆ™ï¼š&lt;/p>
&lt;ul>
&lt;li>åœ¨åŒç­‰æƒ…å†µä¸‹ï¼Œä¼˜å…ˆè®¾æ‰€æ±‚çš„é‡&lt;/li>
&lt;li>è®¾ä¸­é—´å˜é‡ã€ä»½æ•°(æœ‰åˆ†æ•°ã€ç™¾åˆ†æ•°ã€æ¯”ä¾‹å€æ•°ç‰¹å¾)&lt;/li>
&lt;li>ä¼˜å…ˆè®¾å°ä¸è®¾å¤§&lt;/li>
&lt;/ul>
&lt;p>é¢˜å‹ï¼šå’Œå·®å€æ¯”é—®é¢˜ã€é¸¡å…”åŒç¬¼ã€ç›ˆäºé—®é¢˜ã€å·¥ç¨‹é—®é¢˜ã€ç»æµåˆ©æ¶¦é—®é¢˜ã€ è¡Œç¨‹é—®é¢˜ç­‰ç­‰ã€‚&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å…¬å¸é”€å”®éƒ¨é—¨å…±æœ‰ç”²ã€ä¹™ã€ä¸™ã€ä¸å››ä¸ªé”€å”®å°ç»„ï¼Œæœ¬å¹´åº¦ç”²ç»„é”€å”® é‡‘é¢æ˜¯è¯¥éƒ¨é—¨é”€å”®é‡‘é¢æ€»æ•°çš„ 1/3ï¼Œä¹™ç»„é”€å”®é‡‘é¢æ˜¯å¦å¤–ä¸‰ä¸ªå°ç»„æ€»é¢çš„ 1/4ï¼Œä¸™ ç»„é”€å”®é‡‘é¢æ¯”ä¸ç»„é”€å”®é‡‘é¢å¤š 200 ä¸‡å…ƒï¼Œæ¯”ç”²ç»„å°‘ 200 ä¸‡å…ƒã€‚é—®é”€å”®éƒ¨é—¨é”€å”®æ€» é‡‘é¢æ˜¯å¤šå°‘ä¸‡å…ƒï¼Ÿï¼ˆ ï¼‰&lt;/p>
&lt;p>A.1800 B.2400 C.3000 D.3600&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=3&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1085">ä¾‹5ï¼Œä¹™æ˜¯å¦å¤–ä¸‰ç»„çš„1/4å€ï¼Œåˆ™ä¹™/æ€»=1/5&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æœ‰ç”²ã€ä¹™ä¸¤ç“¶ç›æ°´ï¼Œå…¶æµ“åº¦åˆ†åˆ«ä¸º 16%å’Œ 25%ï¼›è´¨é‡åˆ†åˆ«ä¸º 600 å…‹ å’Œ 240 å…‹ï¼Œè‹¥å‘è¿™ä¸¤ç“¶æº¶æ¶²ä¸­åŠ å…¥ç­‰é‡çš„æ°´ï¼Œä½¿ä»–ä»¬çš„æµ“åº¦ç›¸åŒï¼Œåˆ™éœ€è¦å‘è¿™ä¸¤ ç“¶ç›æ°´ä¸­åˆ†åˆ«åŠ å…¥çš„æ°´é‡ä¸ºï¼ˆï¼‰ã€‚&lt;/p>
&lt;p>A.320 å…‹ B. 360 å…‹ C. 370 å…‹ D. 377 å…‹&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=4&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1238">ç»ƒ5ï¼Œä¸¤ä¸ªåˆ†æ•°ç›¸ç­‰çš„å¿«é€Ÿè§£æ³•&lt;/a>ï¼Œ$\frac{a}{b} = \frac{c}{d} = \frac{a+c}{b+d} = \frac{a-c}{b-d}$ çº¦æ‰x&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="åŸºç¡€ç¯‡">åŸºç¡€ç¯‡&lt;/h2>
&lt;h3 id="ä¸å®šæ–¹ç¨‹">ä¸å®šæ–¹ç¨‹&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=4&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1731">ä¸å®šæ–¹ç¨‹&lt;/a>&lt;/p>
&lt;p>é™åˆ¶æ€§ä¸å®šæ–¹ç¨‹è§£æé¡ºåºï¼š&lt;/p>
&lt;ol>
&lt;li>å°¾æ•°æ³•
&lt;ul>
&lt;li>3x+&lt;strong>5y&lt;/strong>=41ï¼šï¼ˆ10=5ï¼Œ10ï¼Œ15ï¼Œ20ï¼Œ...ï¼‰yå¿…ä¸º0ï¼Œ5ç»“å°¾ï¼Œxåˆ™éœ€è¦ä»¤0+3x=1ï¼›5+3x=1&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å› å­å€æ•°
&lt;ul>
&lt;li>29x+&lt;strong>24&lt;/strong>y=&lt;strong>900&lt;/strong>ï¼šyæ˜¯12çš„å€æ•°ï¼Œå…ˆæ‰¾æœ€å¤§çš„å€æ•°ï¼ˆ3ï¼Œ4ï¼Œ5ï¼Œ...ï¼Œ12ï¼‰ï¼Œåˆ™xæ˜¯12çš„å€æ•°&lt;/li>
&lt;li>11a+7b=121ï¼š7b=11(11-a)$\rightarrow$ b=11,a=4&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¥‡å¶ç‰¹æ€§
&lt;ul>
&lt;li>3x+&lt;strong>4y&lt;/strong>=20ï¼šxå¿…é¡»å¶æ•°ï¼ˆçœ‹å·¦è¾¹æœ‰æ— &lt;a href="https://keepjolly.com/posts/learn/quantitative-relation/#%E5%A5%87%E5%81%B6%E6%80%A7">å¿…ä¸ºå¶æ•°&lt;/a>ï¼Œå³ä¹˜å¶æ•°å¿…ä¸ºå¶æ•°ï¼‰&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä»£å…¥æ’é™¤&lt;/li>
&lt;/ol>
&lt;p>é¢˜å‹ï¼š&lt;/p>
&lt;ul>
&lt;li>é™åˆ¶æ€§ä¸å®šæ–¹ç¨‹ï¼ˆç»„ï¼‰ï¼ŒæœªçŸ¥æ•°&lt;strong>å¿…é¡»æ˜¯æ­£æ•´æ•°&lt;/strong>ï¼Œä¾‹å¦‚æœªçŸ¥æ•°æ˜¯äººã€æ¡Œå­ã€ ç›’å­ã€ç¬”ç­‰ã€‚&lt;/li>
&lt;li>éé™åˆ¶æ€§ä¸å®šæ–¹ç¨‹ï¼ˆç»„ï¼‰ï¼ŒæœªçŸ¥æ•°ä¸é™åˆ¶å¿…é¡»æ˜¯æ•´æ•°ï¼Œä¾‹å¦‚é’±ã€æ—¶é—´ï¼Œ é‡é‡ç­‰ï¼Œæ­¤ç±»é¢˜å‹å‡ºé¢˜å·§å¦™ï¼ŒæŠ€å·§æ€§å¼ºã€‚&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å°åˆšä¹°äº† 3 æ”¯é’¢ç¬”ã€ä¸€ä¸ªç¬”è®°æœ¬ã€2 ç“¶å¢¨æ°´ï¼ŒèŠ±å» 35 å…ƒé’±ï¼Œå°å¼º åœ¨åŒä¸€å®¶åº—ä¹°åŒæ ·çš„ 5 æ”¯é’¢ç¬”ï¼Œ1 ä¸ªç¬”è®°æœ¬ï¼Œ3 ç“¶å¢¨æ°´èŠ±å» 52 å…ƒé’±ï¼Œåˆ™ä¹° 1 æ”¯é’¢ç¬”ã€1 ä¸ªç¬”è®°æœ¬ã€1 ç“¶å¢¨æ°´å…±éœ€ï¼ˆï¼‰å…ƒã€‚&lt;/p>
&lt;p>Aï¼9 Bï¼12 Cï¼15 Dï¼18&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=4&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4358">ä¾‹6&lt;/a>ï¼Œé‡åˆ°æ— ç©·è§£ç»™éš¾çº¦åˆ†çš„èµ‹0ï¼Œä¸€èˆ¬x+y+zçš„å½¢å¼ or çº¦åˆ†å¾—åˆ°ç‰¹å®šå½¢å¼ï¼ˆéš¾ï¼‰&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å·¥ç¨‹é—®é¢˜-">å·¥ç¨‹é—®é¢˜ â€»&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=5&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1413">å·¥ç¨‹é—®é¢˜&lt;/a>&lt;/p>
&lt;p>å…¬å¼ï¼šå·¥ä½œæ€»é‡wï¼æ•ˆç‡eÃ—æ—¶é—´t&lt;/p>
&lt;p>è§£é¢˜æ–¹æ³•ï¼šç”»è¡¨æ ¼&lt;/p>
&lt;p>ç»™å®šæ—¶é—´å‹ï¼šâ‘ èµ‹å€¼æ€»é‡ä¸ºæ—¶é—´çš„å…¬å€æ•°â‘¡æ±‚å‡ºå„è‡ªçš„æ•ˆç‡â‘¢åˆ†ææ±‚è§£&lt;/p>
&lt;p>ä¸€é¡¹å·¥ç¨‹ï¼Œç”²å•ç‹¬30å¤©å®Œæˆï¼Œä¹™å•ç‹¬45å¤©å®Œæˆï¼Œä¸¤äººåˆä½œå‡ å¤©å®Œæˆã€‚&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">w&lt;/th>
&lt;th style="text-align:center">e&lt;/th>
&lt;th style="text-align:center">t&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">90&lt;/td>
&lt;td style="text-align:center">å¾—å‡º3&lt;/td>
&lt;td style="text-align:center">30&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">90&lt;/td>
&lt;td style="text-align:center">å¾—å‡º2&lt;/td>
&lt;td style="text-align:center">45&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">å¾—åˆ°&lt;/td>
&lt;td style="text-align:center">3+2&lt;/td>
&lt;td style="text-align:center">90/5=18&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>æ•ˆç‡åˆ¶çº¦å‹ï¼šâ‘ èµ‹å€¼æ•ˆç‡â‘¡ç›´æ¥èµ‹å€¼å„è‡ªæ•ˆç‡æ¯”å€¼â‘¢åˆ†ææ±‚è§£&lt;/p>
&lt;p>é¢˜å‹ï¼š&lt;/p>
&lt;ul>
&lt;li>æ•ˆç‡æ¯”&lt;/li>
&lt;li>æé«˜20%ï¼Œåˆ™1ï¼š1.2=5ï¼š6&lt;/li>
&lt;li>42å°æœºå™¨ï¼Œåˆ™1ï¼š1ï¼š1ï¼š...&lt;/li>
&lt;li>æŸä¸€éƒ¨åˆ†å·¥ç¨‹ï¼Œç”²3å¤©ï¼Œä¹™5å¤©ï¼Œåˆ™ç”²ï¼šä¹™=5ï¼š3&lt;/li>
&lt;/ul>
&lt;p>ä¸€é¡¹å·¥ç¨‹ï¼Œç”²å’Œä¹™çš„æ•ˆç‡æ¯”ä¸º2ï¼š3ï¼Œåˆä½œ8å¤©å®Œæˆï¼Œç”²å•ç‹¬å‡ å¤©å®Œæˆï¼Ÿ&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">w&lt;/th>
&lt;th style="text-align:center">e&lt;/th>
&lt;th style="text-align:center">t&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">5*8=40&lt;/td>
&lt;td style="text-align:center">2&lt;/td>
&lt;td style="text-align:center">40/2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&lt;/td>
&lt;td style="text-align:center">3&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ä¸¤æ ¹åŒæ ·é•¿çš„æœ¨ç‚­ï¼Œç‡ƒçƒ§å®Œä¸€æ ¹ç²—çš„æœ¨ç‚­éœ€è¦ 2 å°æ—¶ï¼Œç‡ƒçƒ§å®Œä¸€æ ¹ ç»†çš„æœ¨ç‚­éœ€è¦ 1 å°æ—¶ã€‚ç°åŒæ—¶ç‚¹ç‡ƒè¿™ä¸¤æ ¹æœ¨ç‚­ï¼Œè‹¥å¹²åˆ†é’Ÿåå°†ä¸¤æ ¹æœ¨ç‚­åŒæ—¶ç†„ ç­ï¼Œå‘ç°ç²—æœ¨ç‚­çš„å‰©ä½™é•¿åº¦æ˜¯ç»†æœ¨ç‚­çš„å‰©ä½™é•¿åº¦çš„ 2 å€ï¼Œåˆ™ç‡ƒçƒ§äº†ï¼ˆï¼‰åˆ†é’Ÿã€‚&lt;/p>
&lt;p>A. 35 B. 40 C. 45 D. 50&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=5&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2609">ä¾‹4ï¼Œæ—¶é—´æ•ˆç‡å‹&lt;/a>ï¼Œ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>A å·¥ç¨‹é˜Ÿçš„æ•ˆç‡æ˜¯ B å·¥ç¨‹é˜Ÿçš„ 2 å€ï¼ŒæŸå·¥ç¨‹äº¤ç»™ä¸¤é˜Ÿå…±åŒå®Œæˆéœ€è¦ 6 å¤©ã€‚å¦‚æœä¸¤é˜Ÿçš„å·¥ä½œæ•ˆç‡å‡æé«˜ä¸€å€ï¼Œä¸” B é˜Ÿä¸­é€”ä¼‘æ¯äº† 1 å¤©ï¼Œé—®è¦ä¿è¯å·¥ç¨‹ æŒ‰åŸæ¥çš„æ—¶é—´å®Œæˆï¼ŒA é˜Ÿä¸­é€”æœ€å¤šå¯ä»¥ä¼‘æ¯å‡ å¤©ï¼Ÿ&lt;/p>
&lt;p>Aï¼4 Bï¼3 Cï¼2 Dï¼1&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=5&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4104">ä¾‹6&lt;/a>ï¼Œè®¡ç®—æŸä¸€é˜Ÿ(B)ç¡®å®šè¦å¹²çš„å¤©æ•°ï¼Œç„¶åå°±èƒ½å¾—åˆ°å¦ä¸€é˜Ÿéœ€è¦å¹²çš„å·¥ä½œé‡&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸä»¶åˆºç»£äº§å“ï¼Œéœ€è¦æ•ˆç‡ç›¸å½“çš„ä¸‰åç»£å·¥ 8 å¤©æ‰èƒ½å®Œæˆï¼›ç»£å“å®Œæˆ 50%æ—¶ï¼Œä¸€äººæœ‰äº‹æå‰ç¦»å¼€ï¼Œç»£å“ç”±å‰©ä¸‹çš„ä¸¤äººç»§ç»­å®Œæˆï¼›ç»£å“å®Œæˆ 75%æ—¶ï¼Œåˆ æœ‰ä¸€äººç¦»å¼€ï¼Œç»£å“ç”±æœ€åå‰©ä¸‹çš„é‚£ä¸ªäººåšå®Œã€‚é‚£ä¹ˆï¼Œå®Œæˆè¯¥ä»¶ç»£å“ä¸€å…±ç”¨äº†ï¼ˆï¼‰ å¤©ã€‚&lt;/p>
&lt;p>Aï¼10 å¤© Bï¼11 å¤© Cï¼12 å¤© Dï¼13 å¤©&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=5&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4293">ä¾‹7&lt;/a>ï¼Œ1ï¼š1ï¼š1&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸå•†é“ºç”²ä¹™ä¸¤ç»„å‘˜å·¥åˆ©ç”¨åŒ…è£…ç¤¼å“çš„è¾¹è§’æ–™åˆ¶ä½œä¸€æ‰¹èŠ±æœµè£…é¥°é—¨åº—ã€‚ ç”²ç»„å•ç‹¬åˆ¶ä½œéœ€è¦ 10 å°æ—¶ï¼Œä¹™ç»„å•ç‹¬åˆ¶ä½œéœ€è¦ 15 å°æ—¶ï¼Œç°ä¸¤ç»„ä¸€èµ·åšï¼ŒæœŸé—´ä¹™ ç»„ä¼‘æ¯äº† 1 å°æ—¶ 40 åˆ†ï¼Œå®Œæˆæ—¶ç”²ç»„æ¯”ä¹™ç»„å¤šåš 300 æœµã€‚é—®è¿™æ‰¹èŠ±æœ‰å¤šå°‘æœµï¼Ÿ&lt;/p>
&lt;p>A.600 B.900 C.1350 D.1500&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1046">ç»ƒ5&lt;/a>ï¼ŒåŒä¾‹6ï¼Œè®¡ç®—å„ç»„å®Œæˆçš„é‡ï¼ˆç›¸å¯¹å„è‡ªå®ŒæˆèŠ±æ•°çš„é‡ï¼Œx-300ï¼šx=20ï¼š10ï¼Œx=600ï¼‰&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Aã€Bã€C ä¸‰æ”¯æ–½å·¥é˜Ÿåœ¨ç‹åº„å’Œæåº„ä¿®è·¯ï¼Œç‹åº„è¦ä¿®è·¯ 900 ç±³ã€‚æåº„ è¦ä¿®è·¯ 1250 ç±³ã€‚å·²çŸ¥ Aã€Bã€C é˜Ÿæ¯å¤©åˆ†åˆ«èƒ½ä¿® 24 ç±³ã€30 ç±³ã€32 ç±³ï¼ŒAã€C é˜Ÿ åˆ†åˆ«åœ¨ç‹åº„å’Œæåº„ä¿®è·¯ï¼ŒB é˜Ÿå…ˆåœ¨ç‹åº„ï¼Œæ–½å·¥è‹¥å¹²å¤©åè½¬åˆ°æåº„ï¼Œä¸¤åœ°å·¥ç¨‹åŒæ—¶ å¼€å§‹åŒæ—¶ç»“æŸã€‚é—® B é˜Ÿåœ¨ç‹åº„å·¥ä½œäº†å‡ å¤©ï¼Ÿ&lt;/p>
&lt;p>A.9 B.10 C.11 D.12&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1523">ç»ƒ7&lt;/a>ï¼ŒåŒæ—¶å¼€å·¥åŒæ—¶ç»“æŸï¼Œä¸‰é˜Ÿä¸€ç›´å¹²åˆ°ç»“æŸ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å·¥å‚æœ‰ 5 æ¡æ•ˆç‡ä¸åŒçš„ç”Ÿäº§çº¿ã€‚æŸä¸ªç”Ÿäº§é¡¹ç›®å¦‚æœä»»é€‰ 3 æ¡ç”Ÿäº§çº¿ ä¸€èµ·åŠ å·¥ï¼Œæœ€å¿«éœ€è¦ 6 å¤©æ•´ï¼Œæœ€æ…¢éœ€è¦ 12 å¤©æ•´ï¼›5 æ¡ç”Ÿäº§çº¿ä¸€èµ·åŠ å·¥ï¼Œåˆ™éœ€è¦ 5 å¤©æ•´ã€‚é—®å¦‚æœæ‰€æœ‰ç”Ÿäº§çº¿çš„äº§èƒ½éƒ½æ‰©å¤§ä¸€å€ï¼Œä»»é€‰ 2 æ¡ç”Ÿäº§çº¿ä¸€èµ·åŠ å·¥ï¼Œæœ€å¤šéœ€ è¦å¤šå°‘å¤©å®Œæˆï¼Ÿ&lt;/p>
&lt;p>A.11 B.13 C.15 D.30&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1884">ç»ƒ8&lt;/a>ï¼Œæ•ˆç‡ä¸åŒï¼Œç›´æ¥è®¾a&amp;gt;b&amp;gt;c&amp;gt;d&amp;gt;eï¼Œæ±‚d+e&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸå·¥å‚çš„ä¸€ä¸ªç”Ÿäº§å°ç»„ï¼Œå½“æ¯ä¸ªå·¥äººéƒ½åœ¨å²—ä½å·¥ä½œï¼Œ9 å°æ—¶å¯ä»¥å®Œ æˆä¸€é¡¹ç”Ÿäº§ä»»åŠ¡ã€‚å¦‚æœäº¤æ¢å·¥äººç”²å’Œä¹™çš„å²—ä½ï¼Œå…¶ä»–äººä¸å˜ï¼Œå¯æå‰ 1 å°æ—¶å®Œæˆ ä»»åŠ¡ï¼›å¦‚æœäº¤æ¢å·¥äººä¸™å’Œä¸çš„å²—ä½ï¼Œå…¶ä»–äººä¸å˜ï¼Œä¹Ÿå¯ä»¥æå‰ 1 å°æ—¶å®Œæˆä»»åŠ¡ã€‚ å¦‚æœåŒæ—¶äº¤æ¢ç”²å’Œä¹™ï¼Œä¸™å’Œä¸çš„å²—ä½ï¼Œå…¶ä»–äººä¸å˜ï¼Œå¯ä»¥æå‰å¤šå°‘æ—¶é—´å®Œæˆï¼Ÿ&lt;/p>
&lt;p>A.1.4 B.1.8 C.2.2 D.2.6&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2211">ç»ƒ9&lt;/a>ï¼Œé¢˜ç›®æ²¡çœ‹æ‡‚ï¼Œäº¤æ¢äº†æ•ˆç‡+1ï¼Œéƒ½äº¤æ¢æ•ˆç‡+2&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="è¡Œç¨‹é—®é¢˜">è¡Œç¨‹é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2575">è¡Œç¨‹é—®é¢˜&lt;/a>&lt;/p>
&lt;p>å…¬å¼ï¼šS=vÃ—tï¼Œvtåæ¯”ï¼ŒSvtæ­£æ¯”&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3119">ç­‰è·ç¦»æ±‚å¹³å‡é€Ÿåº¦&lt;/a>ï¼š$\bar{v} =\frac{2v_1v_2}{v_1+v_2}$&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4737">æµæ°´è¡Œèˆ¹é—®é¢˜&lt;/a>
&lt;ul>
&lt;li>é¡ºæµé€Ÿåº¦ï¼é™æ°´èˆ¹é€Ÿ+æ°´é€Ÿ =&amp;gt; S=(èˆ¹é€Ÿ+æ°´é€Ÿ) Ã— æ—¶é—´&lt;/li>
&lt;li>é€†æµé€Ÿåº¦ï¼é™æ°´èˆ¹é€Ÿ-æ°´é€Ÿ =&amp;gt; S=(èˆ¹é€Ÿ-æ°´é€Ÿ) Ã— æ—¶é—´&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=6&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5251">ç›¸é‡è¿½åŠé—®é¢˜&lt;/a>
&lt;ul>
&lt;li>&lt;strong>ç›¸é‡&lt;/strong>è·ç¦»=(å¤§é€Ÿåº¦+å°é€Ÿåº¦) Ã— ç›¸é‡æ—¶é—´&lt;/li>
&lt;li>&lt;strong>è¿½åŠ&lt;/strong>è·ç¦»=(å¤§é€Ÿåº¦-å°é€Ÿåº¦) Ã— è¿½åŠæ—¶é—´&lt;/li>
&lt;li>ç±»ä¼¼é¡ºæ°´é€†æ°´&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=23">ç¯å½¢è·‘é“é—®é¢˜&lt;/a>
&lt;ul>
&lt;li>ç¯çº¿å‹ n æ¬¡ç›¸é‡ï¼Œ&lt;strong>æ€»(å…±åŒè¡Œèµ°çš„)è·ç¦»&lt;/strong>=n Ã— ç¯çº¿é•¿åº¦&lt;/li>
&lt;li>ç¯çº¿å‹ n æ¬¡è¿½åŠï¼Œè¿½åŠçš„è·ç¦»=n Ã— ç¯çº¿é•¿åº¦ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=695">ä¸¤ç«¯ç›¸é‡é—®é¢˜&lt;/a>
&lt;ul>
&lt;li>ç›´çº¿å‹ä¸¤ç«¯å‡ºå‘ n æ¬¡ç›¸é‡ï¼Œ&lt;strong>æ€»(å…±åŒè¡Œèµ°çš„)è·ç¦»&lt;/strong>=(2n-1) Ã— ä¸¤åœ°åˆå§‹è·ç¦»&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>è§£é¢˜æ–¹æ³•ï¼šç”»å›¾&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ä¸€æ¬¡é•¿è·‘æ¯”èµ›åœ¨å‘¨é•¿ä¸º 400 ç±³çš„ç¯å½¢è·‘é“ä¸Šè¿›è¡Œã€‚æ¯”èµ›ä¸­ï¼Œæœ€åä¸€ ååœ¨è·ç¦»ç¬¬ 3 åœˆç»ˆç‚¹ 150 ç±³å¤„è¢«ç¬¬ 1 åå®Œæˆè¶…åœˆï¼ˆå³æ¯”ä»–å¤šè·‘ 1 åœˆï¼‰ï¼Œ50 ç§’åï¼Œ ä»–åˆåœ¨è·ç¦»ç¬¬ 3 åœˆç»ˆç‚¹ 45 ç±³å¤„è¢«ç¬¬ 2 åå®Œæˆè¶…åœˆã€‚å‡å®šæ‰€æœ‰é€‰æ‰‹å‡æ˜¯åŒ€é€Ÿï¼Œé‚£ ä¹ˆç¬¬ 2 åé€Ÿåº¦çº¦ä¸ºï¼š&lt;/p>
&lt;p>Aï¼2.83m/s Bï¼2.9m/s Cï¼2.82m/s Dï¼2.1m/s&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3209">ç»ƒ7&lt;/a>ï¼Œé¢˜ç›®å¯çŸ¥æœ€æ…¢çš„é€Ÿåº¦ï¼Œæ—¶é—´ç›¸åŒä¸‹ï¼Œé€Ÿåº¦ä¹‹æ¯”=è·¯ç¨‹ä¹‹æ¯”&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”²ä¹™ä¸™åˆ†åˆ«éª‘æ‘©æ‰˜è½¦ã€ä¹˜å¤§å·´ã€æ‰“çš„ä» A åœ°å» B åœ°ï¼Œç”²çš„å‡ºå‘æ—¶é—´ åˆ†åˆ«æ¯”ä¹™ä¸™æ—© 15 åˆ†é’Ÿã€20 åˆ†é’Ÿï¼Œåˆ°è¾¾æ—¶é—´æ¯”ä¹™ä¸™éƒ½æ™š 5 åˆ†é’Ÿã€‚å·²çŸ¥ç”²ä¹™çš„é€Ÿåº¦ ä¹‹æ¯”æ˜¯ 2ï¼š3ï¼Œä¸™çš„é€Ÿåº¦æ˜¯ 60 åƒç±³/å°æ—¶ï¼Œåˆ™ AB ä¸¤åœ°é—´çš„è·ç¦»æ˜¯ï¼š&lt;/p>
&lt;p>Aï¼75 åƒç±³ Bï¼60 åƒç±³ Cï¼48 åƒç±³ Dï¼35 åƒç±³&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=7&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3727">ç»ƒ8&lt;/a>ï¼Œå›¾è¦ç”»å¯¹ï¼Œè·¯ç¨‹ç›¸åŒï¼Œé€Ÿåº¦æ—¶é—´åæ¯”&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ’åˆ—ç»„åˆ-">æ’åˆ—ç»„åˆ â€»&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=94">æ’åˆ—ç»„åˆ&lt;/a>ï¼Œæ¦‚ç‡è®ºçš„åŸºç¡€&lt;/p>
&lt;ul>
&lt;li>åˆ†ç±»ç”¨åŠ æ³•ï¼Œåˆ†æ­¥ç”¨ä¹˜æ³•&lt;/li>
&lt;li>æ’åˆ—æœ‰é¡ºåºï¼Œç»„åˆæ— é¡ºåº&lt;/li>
&lt;li>$A^m_n = n(n âˆ’ 1)(n âˆ’ 2) â€¦ (n âˆ’ m + 1)$&lt;/li>
&lt;li>$C_{n}^{m}=\frac{A_{n}^{m}}{m!}=\frac{n(n-1)(n-2) \ldots(n-m+1)}{m \times(m-1) \times(m-2) \ldots \times 2 \times 1}$&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3931">æ†ç»‘æ³•&lt;/a>ï¼šç›¸é‚»é—®é¢˜ï¼Œå°†ç›¸é‚»çš„å…ƒç´ æ†ç»‘æˆä¸€ä¸ªå…ƒç´ &lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4309">æ’ç©ºæ³•&lt;/a>ï¼šä¸ç›¸é‚»é—®é¢˜ï¼Œå…ˆå¯¹å…¶ä»–å…ƒç´ æ’åˆ—ï¼Œç„¶åå°†ä¸ç›¸é‚»çš„å…ƒç´ æ’å…¥ç©ºä¸­&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5160">æ’æ¿æ³•&lt;/a>ï¼šN ä¸ª&lt;strong>ç›¸åŒ&lt;/strong>ç‰©å“åˆ†ç»™ M ä¸ªäººï¼Œ&lt;strong>æ¯äººè‡³å°‘åˆ†å¾—ä¸€ä¸ª&lt;/strong>ï¼ŒN ä¸ªç‰©å“ä¸­é—´æœ‰ï¼ˆN-1ï¼‰ä¸ªé—´éš”ï¼Œåœ¨é—´éš”ä¸­æ’å…¥ï¼ˆM-1ï¼‰ä¸ªæ¿ï¼Œå…±æœ‰$C^{M-1}_{N-1}$ç§æƒ…å†µã€‚&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5334">é”™ä½æ’åˆ—&lt;/a>ï¼šæœ‰ N å°ä¿¡å’Œ N ä¸ªä¿¡å°ï¼Œæ¯å°ä¿¡éƒ½ä¸è£…åœ¨è‡ªå·±å¯¹åº”çš„ä¿¡å°é‡Œï¼Œå¯èƒ½çš„æ–¹æ¡ˆæ•°è®°ä½œ Dnï¼ŒD2=1ï¼ŒD3=2ï¼ŒD4=9ï¼ŒD5=44ï¼Œè®°ä½è¿™äº”ä¸ªå³å¯ã€‚&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸå•ä½ç»„ç»‡èŒå·¥å‚åŠ å‘¨æœ«åŸ¹è®­ï¼Œå…¶ä¸­è‹±è¯­åŸ¹è®­å’Œè´¢åŠ¡åŸ¹è®­å‡åœ¨å‘¨å…­ï¼Œ å…¬æ–‡å†™ä½œåŸ¹è®­å’Œæ³•å¾‹åŸ¹è®­å‡åœ¨å‘¨æ—¥ã€‚åŒä¸€å¤©ä¸¾åŠçš„ä¸¤åœºåŸ¹è®­æ¯äººåªèƒ½æŠ¥åå‚åŠ ä¸€åœºï¼Œä½†ä¸åœ¨åŒä¸€å¤©çš„åŸ¹è®­å¯ä»¥éƒ½å‚åŠ ã€‚åˆ™èŒå·¥å°åˆ˜æœ‰å¤šå°‘ç§ä¸åŒçš„æŠ¥åæ–¹å¼ï¼Ÿ&lt;/p>
&lt;p>Aï¼4 Bï¼8 Cï¼9 Dï¼16&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=719">ä¾‹3&lt;/a>ï¼Œåˆ†ç±»è®¨è®ºï¼ŒåªæŠ¥ä¸€åœºå’Œä¸¤åœº&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å•ä½è®¢é˜…äº† 30 ä»½å­¦ä¹ ææ–™å‘æ”¾ç»™ 3 ä¸ªéƒ¨é—¨ï¼Œæ¯ä¸ªéƒ¨é—¨è‡³å°‘å‘æ”¾ 9 ä»½ææ–™ã€‚é—®ä¸€å…±æœ‰å¤šå°‘ç§ä¸åŒçš„å‘æ”¾æ–¹æ³•ï¼Ÿï¼ˆ ï¼‰&lt;/p>
&lt;p>Aï¼12 Bï¼10 Cï¼9 Dï¼7&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1383">ç»ƒ6&lt;/a>ï¼Œå…ˆåˆ†è‡³åªå‰©ä¸€ä»½&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä» 1ã€2ã€3ã€4ã€5ã€6ã€7ã€8ã€9 ä¸­é€‰å– 2 ä¸ªæ•°ï¼Œè®©ä»–ä»¬çš„å’Œæ˜¯è´¨ æ•°ï¼Œåˆ™å…±æœ‰å¤šå°‘ç§é€‰æ³•ï¼Ÿ&lt;/p>
&lt;p>A.19 B.18 C.17 D.16 E.15 F.14 G.13 H.12&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=8&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5695">ä¾‹12&lt;/a>ï¼Œåˆ†ç±»è®¨è®ºï¼Œå…ˆåˆ—è´¨æ•°ï¼Œå†æ±‚å’Œ&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ¦‚ç‡é—®é¢˜">æ¦‚ç‡é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1603">æ¦‚ç‡é—®é¢˜&lt;/a>&lt;/p>
&lt;ul>
&lt;li>åŸºæœ¬æ¦‚ç‡
&lt;ul>
&lt;li>æŸç§æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡ï¼æ»¡è¶³æ¡ä»¶çš„æƒ…å†µæ•°Ã·æ€»çš„æƒ…å†µæ•°ã€‚&lt;/li>
&lt;li>Pï¼ æ»¡è¶³æ¡ä»¶çš„æƒ…å†µæ•°/æ€»çš„æƒ…å†µæ•°&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åˆ†æ­¥ä¹˜æ³•å‹ åˆ†æ­¥æ¦‚ç‡ = æ»¡è¶³æ¡ä»¶çš„æ¯ä¸ªæ­¥éª¤æ¦‚ç‡ä¹‹ç§¯&lt;/li>
&lt;li>åˆ†ç±»åŠ æ³•å‹ æ€»ä½“æ¦‚ç‡ ï¼ æ»¡è¶³æ¡ä»¶çš„å„ç§æƒ…å†µæ¦‚ç‡ä¹‹å’Œ&lt;/li>
&lt;li>é€†å‘è®¡ç®—å‹ æŸäº‹ä»¶çš„æ¦‚ç‡ = 1ï¼è¯¥äº‹ä»¶ä¸å‘ç”Ÿçš„æ¦‚ç‡&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸå•ä½å·¥ä¼šç»„ç»‡æ¡¥ç‰Œæ¯”èµ›ï¼Œå…±æœ‰ 8 äººæŠ¥åï¼Œéšæœºç»„æˆ 4 é˜Ÿï¼Œæ¯é˜Ÿ 2 äººã€‚é‚£ä¹ˆï¼Œå°ç‹å’Œå°ææ°å¥½è¢«åˆ†åœ¨åŒä¸€é˜Ÿçš„æ¦‚ç‡æ˜¯ï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;p>Aï¼1/7 Bï¼1/14 Cï¼1/21 Dï¼1/28&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2510">ä¾‹4&lt;/a>ï¼Œå…ˆç¡®å®šä¸€ä¸ª&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸåœºç¾½æ¯›çƒå•æ‰“æ¯”èµ›é‡‡å–ä¸‰å±€ä¸¤èƒœåˆ¶ã€‚å‡è®¾ç”²é€‰æ‰‹åœ¨æ¯å±€éƒ½æœ‰ 80% çš„æ¦‚ç‡èµ¢ä¹™é€‰æ‰‹ï¼Œé‚£ä¹ˆè¿™åœºå•æ‰“æ¯”èµ›ç”²æœ‰å¤šå¤§çš„æ¦‚ç‡æˆ˜èƒœä¹™é€‰æ‰‹ï¼Ÿ&lt;/p>
&lt;p>A. 0.768 B. 0.800 C. 0.896 D. 0.92420&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3221">ä¾‹5&lt;/a>ï¼Œè¿˜æ˜¯åˆ†ç±»è®¨è®º&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸå•†åœºææŠ½å¥–ä¿ƒé”€ï¼Œé™æ¯äººåªèƒ½å‚ä¸ä¸€æ¬¡ï¼Œæ´»åŠ¨è§„åˆ™æ˜¯ï¼šä¸€ä¸ªçº¸ç®± é‡Œè£…æœ‰ 5 ä¸ªå¤§å°ç›¸åŒçš„ä¹’ä¹“çƒï¼Œå…¶ä¸­ 3 ä¸ªæ˜¯ç™½è‰² 2 ä¸ªæ˜¯çº¢è‰²ï¼Œå‚ä¸è€…ä»ä¸­ä»»æ„æŠ½ å‡º 2 ä¸ªçƒï¼Œå¦‚æœä¸¤ä¸ªéƒ½æ˜¯ç™½è‰²å¯å¾—æŠµç”¨åˆ¸ 100 å…ƒï¼Œä¸€ç™½ä¸€çº¢å¯å¾—æŠµç”¨åˆ¸ 200 å…ƒï¼Œ ä¸¤ä¸ªéƒ½æ˜¯çº¢è‰²å¯å¾—æŠµç”¨åˆ¸ 400 å…ƒã€‚è‹¥å°æå’Œå°æ—ä¸¤äººåˆ†åˆ«å‚åŠ æŠ½å¥–ï¼Œé‚£ä¹ˆä¸¤äººè· å¾—æŠµç”¨åˆ¸ä¹‹å’Œä¸å°‘äº 600 å…ƒçš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ&lt;/p>
&lt;p>Aï¼0.12 Bï¼0.22 Cï¼0.13 Dï¼0.30&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3540">ä¾‹6&lt;/a>,æ±‚æ¦‚ç‡+åˆ†ç±»è®¨è®º&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨å°æç­‰è½¦æœŸé—´ï¼Œæœ‰è±ªåå‹ã€èˆ’é€‚å‹ã€æ ‡å‡†å‹ä¸‰ç§æ—…æ¸¸è½¦éšæœºå¼€è¿‡ã€‚ å°æä¸çŸ¥é“è±ªåå‹çš„æ ‡å‡†ï¼Œåªèƒ½é€šè¿‡å‰åä¸¤è¾†è½¦è¿›è¡Œå¯¹æ¯”ã€‚ä¸ºæ­¤ï¼Œå°æé‡‡å–çš„ç­– ç•¥æ˜¯ï¼šä¸ä¹˜åç¬¬ä¸€è¾†ï¼Œå¦‚æœå‘ç°ç¬¬äºŒè¾†æ¯”ç¬¬ä¸€è¾†æ›´è±ªåå°±ä¹˜åï¼›å¦‚æœä¸æ˜¯ï¼Œå°±ä¹˜ åæœ€åä¸€è¾†ã€‚é‚£ä¹ˆï¼Œä»–èƒ½ä¹˜åè±ªåå‹æ—…æ¸¸è½¦çš„æ¦‚ç‡æ˜¯ï¼š&lt;/p>
&lt;p>Aï¼1/2 Bï¼1/3 Cï¼1/4 Dï¼1/5&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4594">ç»ƒ2&lt;/a>ï¼Œçœ‹ä¸æ‡‚æ•°æ®å°‘æšä¸¾&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ·ä¸¤ä¸ªéª°å­ï¼Œæ·å‡ºçš„ç‚¹æ•°ä¹‹å’Œä¸ºå¥‡æ•°çš„æ¦‚ç‡ä¸º P1ï¼Œæ·å‡ºçš„ç‚¹æ•°ä¹‹å’Œ ä¸ºå¶æ•°çš„æ¦‚ç‡ä¸º P2ï¼Œé—® P1 å’Œ P2 çš„å¤§å°å…³ç³»ï¼Ÿ&lt;/p>
&lt;p>Aï¼P1=P2 Bï¼P1&amp;gt;P2 Cï¼P1&amp;lt;P2 Dï¼æ— æ³•ç¡®å®š&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=9&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4782">ç»ƒ3&lt;/a>,å’Œå¥‡=å¥‡+å¶ï¼Œå¶+å¥‡&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="ç»æµåˆ©æ¶¦-">ç»æµåˆ©æ¶¦ â€»&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=10&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=33">ç»æµåˆ©æ¶¦&lt;/a>&lt;/p>
&lt;ul>
&lt;li>åˆ©æ¶¦æŠ˜æ‰£é—®é¢˜ï¼š
&lt;ul>
&lt;li>æ€»æˆæœ¬=å•ä¸ªæˆæœ¬Ã—è¿›å£é‡ï¼›æ€»å”®ä»·ï¼å•ä»·Ã—é”€å”®é‡ï¼›&lt;/li>
&lt;li>åˆ©æ¶¦ï¼å”®ä»·-æˆæœ¬ï¼›æ€»åˆ©æ¶¦ï¼æ€»å”®ä»·-æ€»æˆæœ¬&lt;/li>
&lt;li>åˆ©æ¶¦ç‡ = åˆ©æ¶¦/æˆæœ¬ = (å”®ä»· âˆ’ æˆæœ¬)/æˆæœ¬ = å”®ä»·/æˆæœ¬ âˆ’ 1&lt;/li>
&lt;li>æ¯›åˆ© = åˆ©æ¶¦/è¥æ”¶&lt;/li>
&lt;li>åˆ—è¡¨æ³•ï¼šæˆæœ¬ å®šä»· å”®ä»· åˆ©æ¶¦*é‡=æ€»åˆ© ï¼ˆå”®ä»·=&lt;strong>ä¸æ‰“æŠ˜&lt;/strong>çš„å®šä»·ï¼‰&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=10&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2260">åˆ†æ®µè®¡è´¹é—®é¢˜&lt;/a>
&lt;ul>
&lt;li>åˆ†æ®µè®¡è´¹é—®é¢˜ä¸»è¦æ¶‰åŠæ°´ç”µã€èµ„è´¹ã€ææˆç­‰é€šå¸¸åˆ†æ®µè®¡è´¹é—®é¢˜ã€‚&lt;/li>
&lt;li>è§£é¢˜å…³é”®åœ¨äºæ‰¾åˆ°åˆ†æ®µèŠ‚ç‚¹ï¼Œåˆ†åŒºé—´è®¨è®ºè®¡ç®—ã€‚&lt;/li>
&lt;li>ç”»æ•°è½´&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å•†åœºé‡ŒæŸå•†å“æˆæœ¬ä¸Šæ¶¨äº† 20%ï¼Œå”®ä»·åªä¸Šæ¶¨äº† 10%ï¼Œæ¯›åˆ©ç‡ï¼ˆåˆ©æ¶¦ /è¿›è´§ä»·ï¼‰æ¯”ä»¥å‰çš„ä¸‹é™äº† 10 ä¸ªç™¾åˆ†ç‚¹ã€‚é—®åŸæ¥çš„æ¯›åˆ©ç‡æ˜¯å¤šå°‘ï¼Ÿ&lt;/p>
&lt;p>A.10% B.20% C.30% D.40%&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=10&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1990">ä¾‹7&lt;/a>ï¼Œæ¯”ä¾‹å…³ç³»ç›´æ¥èµ‹å€¼ï¼Œå‡ºç°æˆæœ¬ã€å”®ä»·ã€åˆ©æ¶¦ï¼Œä¼˜å…ˆåªèµ‹å€¼æˆæœ¬&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¼ä¸šèŠ±è´¹ 600 ä¸‡å…ƒå‡çº§ç”Ÿäº§çº¿ï¼Œå‡çº§åèƒ½è€—è´¹ç”¨é™ä½äº† 10%ï¼Œäºº å·¥æˆæœ¬é™ä½äº† 30%ï¼Œå¦‚æ¯å¤©çš„äº§é‡ä¸å˜ï¼Œé¢„è®¡åœ¨ 400 ä¸ªå·¥ä½œæ—¥åæ”¶å›æˆæœ¬ï¼Œå¦‚ æœå‡çº§å‰äººå·¥æˆæœ¬ä¸ºèƒ½è€—è´¹ç”¨çš„ 3 å€ï¼Œé—®å‡çº§åæ¯å¤©çš„äººå·¥æˆæœ¬æ¯”èƒ½è€—è´¹ç”¨é«˜ å¤šå°‘ä¸‡å…ƒï¼Ÿ&lt;/p>
&lt;p>Aï¼1.2 Bï¼1.5 Cï¼1.8 Dï¼2.4&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=10&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3989">ç»ƒ1&lt;/a>ï¼Œå›æ”¶æˆæœ¬=å¤©æ•°*èŠ‚çœè´¹ç”¨ï¼Œåˆ†ä¸ºå‰å&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸè‹—æœ¨å…¬å¸å‡†å¤‡å‡ºå”®ä¸€æ‰¹è‹—æœ¨ï¼Œå¦‚æœæ¯æ ªä»¥ 4 å…ƒå‡ºå”®ï¼Œå¯å–å‡º 20 ä¸‡ æ ªã€‚è‹¥è‹—æœ¨å•ä»·æ¯æé«˜ 0.4 å…ƒï¼Œå°±ä¼šå°‘å– 10000 æ ªï¼Œé—®åœ¨æœ€ä½³å®šä»·çš„æƒ…å†µä¸‹ï¼Œè¯¥ å…¬å¸æœ€å¤§æ”¶å…¥æ˜¯å¤šå°‘ä¸‡å…ƒï¼Ÿ&lt;/p>
&lt;p>Aï¼60 Bï¼80 Cï¼90 Dï¼100&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=10&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5024">ç»ƒ6&lt;/a>ï¼Œa+b=10 abâ‰¤25ï¼Œæœ€å¤§é—®é¢˜&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸå…¬å¸ A å•†å“åˆ©æ¶¦ä¸ºå®šä»·çš„ 30%ï¼Œå‰å¹´é”€é‡ä¸º 10 ä¸‡ä¸ªï¼›B å•†å“åˆ© æ¶¦ä¸ºå®šä»·çš„ 40%ï¼Œå‰å¹´é”€é‡ä¸º 4 ä¸‡ä¸ªã€‚å»å¹´å…¬å¸å°† Aã€B å•†å“æ†ç»‘é”€å”®ï¼Œå”®ä»·ä¸ºå‰å¹´ä¸¤ç§å•†å“å®šä»·ä¹‹å’Œçš„ 90%ï¼Œå…±å–å‡º 8 ä¸‡å¥—ï¼Œæ€»åˆ©æ¶¦æ¯”å‰å¹´å¢åŠ äº† 20%ã€‚å¦‚ä¸¤ ç§å•†å“å»å¹´çš„æˆæœ¬ä¸å‰å¹´ç›¸åŒï¼Œåˆ™å‰å¹´ A å•†å“çš„å®šä»·ä¸º B å•†å“å®šä»·çš„ï¼š&lt;/p>
&lt;p>Aï¼24% Bï¼25% Cï¼30% Dï¼36%&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=10&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5786">ç»ƒ7&lt;/a>ï¼Œå®šä»·ä¸æ‰“æŠ˜å°±æ˜¯å”®ä»·ï¼Œåˆ©æ¶¦=æˆæœ¬-å®šä»·&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æœ€å€¼é—®é¢˜">æœ€å€¼é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=11&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=36">æœ€å€¼é—®é¢˜&lt;/a>&lt;/p>
&lt;ul>
&lt;li>æœ€ä¸åˆ©æ„é€ 
&lt;ul>
&lt;li>é¢˜å‹ç‰¹å¾ï¼šè‡³å°‘â€¦â€¦æ‰èƒ½ä¿è¯â€¦â€¦&lt;/li>
&lt;li>è§£é¢˜æ–¹æ³•ï¼šæœ€ä¸åˆ©æƒ…å½¢ï¼‹1&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ•°åˆ—æ„é€ 
&lt;ul>
&lt;li>é¢˜å‹ç‰¹å¾ï¼š
&lt;ul>
&lt;li>æœ€å¤šâ€¦â€¦æœ€å°‘â€¦â€¦&lt;/li>
&lt;li>æœ€å°‘â€¦â€¦æœ€å¤šâ€¦â€¦&lt;/li>
&lt;li>æ’åç¬¬â€¦â€¦æœ€å¤šï¼ˆå°‘ï¼‰â€¦â€¦â€¦&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è§£é¢˜æ–¹æ³•ï¼š
&lt;ul>
&lt;li>æ’åºï¼Œæ‰€æœ‰å…ƒç´ è¿›è¡Œæ’åºï¼›&lt;/li>
&lt;li>å®šä½ï¼Œæ±‚è°è®¾è° xï¼›&lt;/li>
&lt;li>æ„é€ ï¼Œæ ¹æ®é¢˜æ„æ„é€ å…¶ä»–å…ƒç´ çš„å€¼ï¼›&lt;/li>
&lt;li>æ±‚å’Œï¼Œæ‰€æœ‰å…ƒç´ æ±‚å’Œï¼Œè§£ xã€‚&lt;/li>
&lt;li>å¦‚æœæ±‚å¾— x ä¸ºå°æ•°ï¼Œé—®æœ€å°‘ï¼šå‘ä¸Šå–æ•´ï¼Œé—®æœ€å¤šï¼šå‘ä¸‹å–æ•´ã€‚åå‘å–æ•°&lt;/li>
&lt;li>æœ€å°‘çš„å–æœ€å¤§ï¼Œå³æ¯”æ¬¡å°çš„-1ï¼Œæœ€å¤§çš„å–æœ€å°ï¼Œå³æ¯”æ¬¡å¤§çš„+1ï¼Œå·²çŸ¥çš„å…·ä½“é‡å€¼ä¸æ”¹å˜&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=11&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1843">å¤šé›†åˆåå‘æ„é€  &lt;/a>
&lt;ul>
&lt;li>é¢˜å‹ç‰¹å¾ï¼šå¤šé›†åˆé¢˜ç›®ä¸­ï¼Œé—®é¢˜ä¸­å‡ºç°ï¼Œè‡³å°‘â€¦â€¦éƒ½â€¦â€¦çš„æƒ…å†µä¸‹ï¼›&lt;/li>
&lt;li>è§£æç­–ç•¥ï¼šé‡‡ç”¨é€†å‘æ€è€ƒï¼Œåå‘ï¼Œæ±‚å’Œï¼Œåšå·®ã€‚
&lt;ul>
&lt;li>å„é›†åˆçš„å¯¹ç«‹é¢çš„æ•°é‡&lt;/li>
&lt;li>å„é›†åˆåå‘æ•°é‡ç›¸åŠ  sum&lt;/li>
&lt;li>æ€»æ•°é‡-sum&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸå•ä½ 2011 å¹´æ‹›è˜äº† 65 åæ¯•ä¸šç”Ÿï¼Œæ‹Ÿåˆ†é…åˆ°è¯¥å•ä½çš„ 7 ä¸ªä¸åŒéƒ¨ é—¨ã€‚å‡è®¾è¡Œæ”¿éƒ¨é—¨åˆ†å¾—çš„æ¯•ä¸šç”Ÿäººæ•°æ¯”å…¶ä»–éƒ¨é—¨éƒ½å¤šï¼Œé—®è¡Œæ”¿éƒ¨é—¨åˆ†å¾—çš„æ¯•ä¸šç”Ÿ äººæ•°è‡³å°‘ä¸ºå¤šå°‘åï¼Ÿ&lt;/p>
&lt;p>Aï¼10 Bï¼11 Cï¼12 Dï¼13&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=11&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1509">ä¾‹5&lt;/a>ï¼Œéƒ½å¤š&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æœ‰ç¼–å·ä¸º 1ï½13 çš„å¡ç‰‡ï¼Œæ¯ä¸ªç¼–å·æœ‰ 4 å¼ ï¼Œå…± 52 å¼ å¡ç‰‡ã€‚é—®è‡³å°‘ æ‘¸å‡ºå¤šå°‘å¼ ï¼Œå°±å¯ä¿è¯ä¸€å®šæœ‰ 3 å¼ å¡ç‰‡ç¼–å·ç›¸è¿ï¼Ÿï¼ˆ ï¼‰&lt;/p>
&lt;p>Aï¼27 å¼  Bï¼29 å¼  Cï¼33 å¼  Dï¼37 å¼ &lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=11&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3140">ç»ƒ4&lt;/a>ï¼Œmagic&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨ä¸€æ¬¡ç«æ ‡ä¸­ï¼Œè¯„æ ‡å°ç»„å¯¹å‚åŠ ç«æ ‡çš„å…¬å¸è¿›è¡Œè¯„åˆ†ï¼Œæ»¡åˆ† 120 åˆ†ã€‚ æŒ‰å¾—åˆ†æ’åï¼Œå‰ 5 åçš„å¹³å‡åˆ†ä¸º 115 åˆ†ï¼Œä¸”å¾—åˆ†æ˜¯äº’ä¸ç›¸åŒçš„æ•´æ•°ï¼Œåˆ™ç¬¬ä¸‰åå¾— åˆ†è‡³å°‘æ˜¯ï¼ˆ ï¼‰&lt;/p>
&lt;p>A.112 åˆ† B.113 åˆ† C.115 åˆ† D.116 åˆ†&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=11&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3369">ç»ƒ5&lt;/a>,æœ€å¤§çš„è®©ä»–æœ€å¤§ï¼Œè‡³å°‘çš„è®©ä»–æœ€å°&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å®¹æ–¥åŸç†">å®¹æ–¥åŸç†&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=11&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4295">å®¹æ–¥åŸç†&lt;/a>&lt;/p>
&lt;ul>
&lt;li>ä¸¤é›†åˆæ ‡å‡†å‹å…¬å¼
&lt;ul>
&lt;li>|ğ´| + |ğµ| âˆ’ |ğ´ğµ| = æ€»æ•° âˆ’ éƒ½ä¸æ»¡è¶³&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä¸‰é›†åˆæ ‡å‡†
&lt;ul>
&lt;li>|ğ´| + |ğµ| + |ğ¶| âˆ’ |ğ´ğµ| âˆ’ |ğµğ¶| âˆ’ |ğ´ğ¶| + |ğ´ğµğ¶| = æ€»æ•° âˆ’ éƒ½ä¸æ»¡è¶³&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=11&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5487">ä¸‰é›†åˆéæ ‡å‡†&lt;/a>
&lt;ul>
&lt;li>|ğ´| + |ğµ| + |ğ¶| âˆ’ åªæ»¡è¶³ä¸¤ä¸ªæ¡ä»¶çš„ âˆ’ 2 Ã— æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ = æ€»æ•° âˆ’ éƒ½ä¸æ»¡è¶³&lt;/li>
&lt;li>ä½¿ç”¨åœºæ™¯ï¼šåªæœ‰å½“é¢˜ç›®ä¸­å‡ºç°â€œï¼ˆåªï¼‰æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶â€æ—¶ï¼Œä½¿ç”¨éæ ‡å‡†å…¬å¼ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ–‡æ°å›¾æ³•ï¼šæ¯ä¸€ä¸ªå°é—­åŒºåŸŸå†…åªæœ‰ä¸€ä¸ªæ•°å­—ï¼Œå¹¶ä¸”ä»£è¡¨è¯¥åŒºåŸŸçš„é¢ç§¯ã€‚
&lt;ul>
&lt;li>ä½¿ç”¨åŸåˆ™ï¼šå‡ºç°â€œåªæ»¡è¶³æŸä¸€ä¸ªæ¡ä»¶â€æ—¶ï¼Œä¼˜å…ˆç”»å›¾æ³•ã€‚&lt;/li>
&lt;li>ä¸èƒ½ç›´æ¥ä»£å…¥å…¬å¼çš„ï¼Œä½¿ç”¨ç”»å›¾æ³•ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æœ‰ 135 äººå‚åŠ æŸå•ä½çš„æ‹›è˜ï¼Œ31 äººæœ‰è‹±è¯­è¯ä¹¦å’Œæ™®é€šè¯è¯ä¹¦ï¼Œ37 äºº æœ‰è‹±è¯­è¯ä¹¦å’Œè®¡ç®—æœºè¯ä¹¦ï¼Œ16 äººæœ‰æ™®é€šè¯è¯ä¹¦å’Œè®¡ç®—æœºè¯ä¹¦ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†äººæœ‰ ä¸‰ç§è¯ä¹¦ï¼Œè€Œä¸€éƒ¨åˆ†äººåˆ™åªæœ‰ä¸€ç§è¯ä¹¦ã€‚è¯¥å•ä½è¦æ±‚å¿…é¡»è‡³å°‘æœ‰ä¸¤ç§ä¸Šè¿°è¯ä¹¦çš„ åº”è˜è€…æ‰æœ‰èµ„æ ¼å‚åŠ é¢è¯•ã€‚é—®è‡³å°‘æœ‰å¤šå°‘äººä¸èƒ½å‚åŠ é¢è¯•ï¼Ÿ&lt;/p>
&lt;p>Aï¼50 Bï¼51 Cï¼52 Dï¼53&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=12&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=979">ç»ƒ4&lt;/a>ï¼Œåæ¨&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å‡ ä½•é—®é¢˜">å‡ ä½•é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=12&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1907">å‡ ä½•é—®é¢˜&lt;/a>&lt;/p>
&lt;p>$\mathrm{n}$ è¾¹å½¢çš„å†…è§’å’Œä¸å¤–è§’å’Œ
å†…è§’å’Œ $=(n-2) \times 180^{\circ}$ , å¤–è§’å’Œæ’ç­‰äº $360^{\circ}$&lt;/p>
&lt;ul>
&lt;li>å¸¸ç”¨å‘¨é•¿å…¬å¼
&lt;ul>
&lt;li>æ­£æ–¹å½¢å‘¨é•¿ $C_{\text {æ­£æ–¹å½¢ }}=4 a$ ; é•¿æ–¹å½¢å‘¨é•¿ $C_{\text {é•¿æ–¹å½¢ }}=2(a+b)$ ; åœ†å½¢å‘¨é•¿ $C_{\text {åœ† }}=2 \pi R$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¸¸ç”¨é¢ç§¯å…¬å¼
&lt;ul>
&lt;li>æ­£æ–¹å½¢é¢ç§¯ $S_{\text {æ­£æ–¹å½¢ }}=a^{2}$ ; é•¿æ–¹å½¢é¢ç§¯ $S_{\text {é•¿æ–¹å½¢ }}=a b$ ; åœ†å½¢é¢ç§¯ $S_{\text {åœ† }}=\pi R^{2}$&lt;/li>
&lt;li>ä¸‰è§’å½¢é¢ç§¯ $S_{\text {ä¸‰è§’å½¢ }}=\frac{1}{2} a h$ ; åŒåº•ç­‰é«˜é¢ç§¯ç›¸ç­‰ï¼&lt;/li>
&lt;li>å¹³è¡Œå››è¾¹å½¢é¢ç§¯ $S_{\text {å¹³è¡Œå››è¾¹å½¢ }}=a h$ ;&lt;/li>
&lt;li>æ¢¯å½¢é¢ç§¯ $S_{\text {æ¢¯å½¢ }}=\frac{1}{2}(a+b) h$ ; æ‰‡å½¢é¢ç§¯ $S_{\text {æ‰‡å½¢ }}=\frac{n}{360^{Â°}} \pi R^{2}$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¸¸ç”¨è¡¨é¢ç§¯å…¬å¼
&lt;ul>
&lt;li>æ­£æ–¹ä½“çš„è¡¨é¢ç§¯ $=6 a^{2}$ ; é•¿æ–¹ä½“çš„è¡¨é¢ç§¯ $=2 \mathrm{ab}+2 \mathrm{bc}+2 \mathrm{ac}$ ;&lt;/li>
&lt;li>åœ†æŸ±çš„è¡¨é¢ç§¯ $=2 \pi \mathrm{Rh}+2 \pi R^{2}$ , ä¾§é¢ç§¯ $=2 \pi \mathrm{Rh}$ ; çƒçš„è¡¨é¢ç§¯ $=4 \pi R^{2}$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¸¸ç”¨ä½“ç§¯å…¬å¼
&lt;ul>
&lt;li>æ­£æ–¹ä½“çš„ä½“ç§¯ $=a^{3}$ ; é•¿æ–¹ä½“çš„ä½“ç§¯ $=\mathrm{abc}$ ; çƒçš„ä½“ç§¯ $=\frac{4}{3} \pi R^{3}$&lt;/li>
&lt;li>åœ†æŸ±çš„ä½“ç§¯ $=\pi R^{2} h$ ; åœ†é›‰ (æ£±é›‰) çš„ä½“ç§¯ $=\frac{1}{3} \times S_{åº•} \times h$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=12&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3139">å‹¾è‚¡å®šç†&lt;/a>
&lt;ul>
&lt;li>3ï¼š4ï¼š5&lt;/li>
&lt;li>5ï¼š12ï¼š13&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=12&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3226">è§’åº¦åŠä¸‰è§’å½¢&lt;/a>
&lt;ul>
&lt;li>ç›´è§’ä¸‰è§’å½¢30Â°ï¼š$1:\sqrt{3}:2$&lt;/li>
&lt;li>ç­‰è…°ç›´è§’ä¸‰è§’å½¢ï¼š$1:1:\sqrt{2}$&lt;/li>
&lt;li>ç­‰è¾¹ä¸‰è§’å½¢ï¼š$S=\frac{\sqrt{3}}{4}a^2$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=12&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4531">ç›¸ä¼¼ä¸‰è§’å½¢&lt;/a>
&lt;ul>
&lt;li>é¢ç§¯ä¹‹æ¯”=è¾¹é•¿ä¹‹æ¯”çš„å¹³æ–¹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=12&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4940">ç­‰æ¯”ç¼©æ”¾&lt;/a>
&lt;ul>
&lt;li>ä¸€ä¸ªå‡ ä½•å›¾å½¢ï¼Œè‹¥è¾¹é•¿å˜ä¸ºåŸæ¥çš„ n å€ï¼Œåˆ™:&lt;/li>
&lt;li>æ‰€æœ‰å¯¹åº”è§’åº¦ä¸å‘ç”Ÿå˜åŒ–&lt;/li>
&lt;li>æ‰€æœ‰å¯¹åº”çš„é¢ç§¯å˜ä¸ºåŸæ¥ $\mathrm{n}^{2}$ å€&lt;/li>
&lt;li>æ‰€æœ‰å¯¹åº”çš„ä½“ç§¯å˜ä¸ºåŸæ¥ $\mathrm{n}^{3}$ å€&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å¦‚å›¾æ‰€ç¤ºï¼Œ8 å—åŒæ ·å¤§å°çš„é•¿æ–¹å½¢é’¢æ¿æ‹¼æˆäº†ä¸€å—å¤§çš„é•¿æ–¹å½¢é’¢æ¿ï¼Œ å·²çŸ¥å¤§é•¿æ–¹å½¢é’¢æ¿å‘¨é•¿ä¸º 112 å˜ç±³ï¼Œé‚£ä¹ˆå¤§é•¿æ–¹å½¢é’¢æ¿çš„é¢ç§¯æ˜¯( )å¹³æ–¹å˜ç±³ã€‚&lt;/p>
&lt;p>Aï¼432 Bï¼588 Cï¼768 Dï¼945&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=12&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2260">ä¾‹2&lt;/a>ï¼Œæ³¨æ„å­å›¾å½¢çš„å…³ç³»&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸåœ°å¸‚åŒºæœ‰ä¸€ä¸ªé•¿æ–¹å½¢å¹¿åœºï¼Œå…¶é¢ç§¯ä¸º 1600 å¹³æ–¹ç±³ã€‚ç”±æ­¤å¯çŸ¥ï¼Œè¿™ ä¸ªå¹¿åœºçš„å‘¨é•¿è‡³å°‘æœ‰ï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;p>Aï¼160 ç±³ Bï¼200 ç±³ Cï¼240 ç±³ Dï¼320 ç±³&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=12&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2631">ä¾‹3&lt;/a>ï¼Œé•¿åº¦ä¸€å®šã€é¢ç§¯å¤§-&amp;gt;åœ†ï¼Œæ¬¡å¤§æ­£nè¾¹å½¢ï¼Œæ¬¡æ¬¡å¤§æ­£æ–¹å½¢ï¼Œæˆ–$a+b \ge 2\sqrt{ab}$&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¤ªå¤šäº†ï¼Œéƒ½ä¸ä¼š&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å¹´é¾„é—®é¢˜">å¹´é¾„é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=13&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3861">å¹´é¾„é—®é¢˜&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=13&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5869">æº¶æ¶²é—®é¢˜&lt;/a>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æ–¹æ³•ä¸€ï¼šä»£å…¥æ’é™¤æ³•&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ–¹æ³•äºŒï¼šæ–¹ç¨‹æ³•&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ ¸å¿ƒç‚¹ï¼šæ¯å¹´æ¯äººé•¿ä¸€å²ï¼Œä¸¤ä¸ªäººçš„å¹´é¾„å·®ä¸å˜&lt;/p>
&lt;/li>
&lt;li>
&lt;p>$\text { æµ“åº¦ }=\frac{\text { æº¶è´¨ }}{\text { æº¶æ¶² }}=\frac{\text { ç› }}{\text { ç›æ°´æ€»é‡é‡ }}=\frac{\text { ç³– }}{\text { ç³–æ°´æ€»é‡é‡ }}=\frac{\text { é…’ç²¾ }}{\text { é…’æ°´æ€»é‡é‡ }}$&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æº¶è´¨ = æº¶æ¶²Ã—æµ“åº¦&lt;/p>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>2014 å¹´çˆ¶äº²ã€æ¯äº²çš„å¹´é¾„ä¹‹å’Œæ˜¯å¹´é¾„ä¹‹å·®çš„ 23 å€ï¼Œå¹´é¾„ä¹‹å·®æ˜¯å„¿ å­å¹´é¾„çš„ 1/5ï¼Œ5 å¹´åæ¯äº²å’Œå„¿å­çš„å¹´é¾„éƒ½æ˜¯å¹³æ–¹æ•°ã€‚é—® 2014 å¹´çˆ¶äº²çš„å¹´é¾„æ˜¯å¤š å°‘ï¼Ÿï¼ˆå¹´é¾„éƒ½æŒ‰æ•´æ•°è®¡ç®—ï¼‰&lt;/p>
&lt;p>Aï¼36 å² Bï¼40 å² Cï¼44 å² Dï¼48 å²&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=13&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4929">ç»ƒ1&lt;/a>ï¼Œ1 4 9 16 25 36&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æœ‰ç”²ã€ä¹™ä¸¤ç§ä¸åŒæµ“åº¦çš„ç›æ°´ï¼Œå– 3 å…‹ç”²ç›æ°´å’Œ 1 å…‹ä¹™ç›æ°´æ··åˆå¯ ä»¥å¾—åˆ°æµ“åº¦ä¸ºğ‘¥%çš„ç›æ°´ï¼›ç”¨ 1 å…‹ç”²ç›æ°´å’Œ 3 å…‹ä¹™ç›æ°´æ··åˆå¯ä»¥å¾—åˆ°ä¸™ç›æ°´ã€‚é—® ç”¨å¤šå°‘å…‹ç”²ç›æ°´å’Œ 1 å…‹ä¸™ç›æ°´æ··åˆå¯ä»¥å¾—åˆ°æµ“åº¦ä¸ºğ‘¥%çš„ç›æ°´ï¼Ÿ&lt;/p>
&lt;p>Aï¼2 Bï¼4 Cï¼6 Dï¼8&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=13&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=7835">ç»ƒ2&lt;/a>ï¼ŒæŒ‰æ¯”ä¾‹è°ƒé…å¯å¾—xï¼Œåˆ™ç”²+ä¸™(ç”²+ä¹™)ä¸­ç”²ä¹™æ¯”ä¾‹å¯å¾—x&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="æé«˜ç¯‡">æé«˜ç¯‡&lt;/h2>
&lt;h3 id="ç‰›åƒè‰">ç‰›åƒè‰&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=230">ç‰›åƒè‰&lt;/a>&lt;/p>
&lt;p>ï¼ˆä¾‹ï¼‰ä¸€ç‰‡è‰åœ°ï¼ˆè‰ä»¥å‡åŒ€çš„é€Ÿåº¦ç”Ÿé•¿ï¼‰ï¼Œ240 å¤´ç‰›å¯ä»¥åƒ 6 å¤©ï¼Œ200 å¤´ç‰›å¯ ä»¥åƒ 10 å¤©ï¼Œåˆ™è¿™ç‰‡è‰åŸå¯ä¾› 190 å¤´ç‰›åƒçš„å¤©æ•°æ˜¯ï¼ˆ ï¼‰ã€‚&lt;/p>
&lt;ul>
&lt;li>ç¬¬ä¸€æ­¥ï¼Œå‡è®¾æ¯å¤´ç‰›æ¯å¤©åƒ 1 ä»½è‰ã€‚&lt;/li>
&lt;li>ç¬¬äºŒæ­¥ï¼Œå‡è®¾è‰åœºåŸæœ‰ y ä»½è‰ï¼Œæ¯å¤©è‡ªç„¶ç”Ÿé•¿ x ä»½è‰ã€‚&lt;/li>
&lt;li>ç¬¬ä¸‰æ­¥
&lt;ul>
&lt;li>ä»£å…¥ç¬¬ä¸€ä¸ªæ¡ä»¶â€œ240 å¤´ç‰›å¯ä»¥åƒ 6 å¤©â€ï¼Œè‰åœºæ¯å¤©å‡å°‘ï¼ˆ240-xï¼‰ä»½ï¼ŒyÃ·ï¼ˆ240-xï¼‰=6ï¼›&lt;/li>
&lt;li>ä»£å…¥ç¬¬äºŒä¸ªæ¡ä»¶â€œ200 å¤´ç‰›å¯ä»¥åƒ 10 å¤©â€ï¼Œè‰åœºæ¯å¤©å‡å°‘ï¼ˆ200-xï¼‰ä»½è‰ï¼ŒyÃ·ï¼ˆ200-xï¼‰=10ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç¬¬å››æ­¥ï¼Œè§£æ–¹ç¨‹ y=600ï¼Œx=140ï¼Œå³åŸè‰åœºæœ‰ 600 ä»½è‰ï¼Œæ¯å¤©é•¿ 140 ä»½è‰ã€‚&lt;/li>
&lt;li>ç¬¬äº”æ­¥ï¼Œåˆ†æè®¡ç®—ï¼Œ190 å¤´ç‰›æ¯å¤©åƒ 190 ä»½è‰ï¼Œæ¯å¤©é•¿ 140 ä»½ï¼Œäºæ˜¯è‰åœºæ¯ å¤©å®é™…å‡å°‘ 50 ä»½è‰ï¼Œ600Ã·50=12 å¤©ã€‚&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸè½®èˆ¹å‘ç”Ÿæ¼æ°´äº‹æ•…ï¼Œæ¼æ´å¤„ä¸æ–­åœ°åŒ€é€Ÿè¿›æ°´ï¼Œèˆ¹å‘˜å‘ç°é™©æƒ…åç«‹ å³å¼€å¯æŠ½æ°´æœºå‘å¤–æŠ½æ°´ã€‚å·²çŸ¥æ¯å°æŠ½æ°´æœºæ¯åˆ†é’ŸæŠ½æ°´ 20 ç«‹æ–¹ç±³ï¼Œè‹¥åŒæ—¶ä½¿ç”¨ 2 å°æŠ½æ°´æœº 15 åˆ†é’Ÿèƒ½æŠŠæ°´æŠ½å®Œï¼Œè‹¥åŒæ—¶ä½¿ç”¨ 3 å°æŠ½æ°´æœº 9 åˆ†é’Ÿèƒ½æŠŠæ°´æŠ½å®Œã€‚å½“æŠ½ æ°´æœºå¼€å§‹å‘å¤–æŠ½æ°´æ—¶ï¼Œè¯¥è½®èˆ¹å·²è¿›æ°´ï¼ˆ ï¼‰ç«‹æ–¹ç±³ã€‚&lt;/p>
&lt;p>Aï¼360 Bï¼450 Cï¼540 Dï¼600&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1416">ä¾‹4&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å¾ªç¯å‘¨æœŸé—®é¢˜">å¾ªç¯å‘¨æœŸé—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1615">å¾ªç¯å‘¨æœŸ&lt;/a>&lt;/p>
&lt;p>æ ¸å¿ƒç‚¹ï¼šè‹¥ä¸€ä¸²äº‹ç‰©ä»¥ T ä¸ºå‘¨æœŸï¼Œä¸” AÃ·T=N ä½™ aï¼Œé‚£ä¹ˆç¬¬ A é¡¹ç­‰åŒäºç¬¬ a é¡¹ã€‚æ•´é™¤æ˜¯å‘¨æœŸæœ€åä¸€é¡¹ã€‚&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸæ”¿åºœæœºæ„å†…ç”²ã€ä¹™ä¸¤éƒ¨é—¨é€šè¿‡é—¨æˆ·ç½‘ç«™å®šæœŸå‘ç¤¾ä¼šå‘å¸ƒæ¶ˆæ¯ï¼Œç”² éƒ¨é—¨æ¯éš” 2 å¤©ã€ä¹™éƒ¨é—¨æ¯éš” 3 å¤©æœ‰ä¸€ä¸ªå‘å¸ƒæ—¥ï¼ŒèŠ‚å‡æ—¥æ— ä¼‘ã€‚é—®ç”²ã€ä¹™ä¸¤éƒ¨é—¨åœ¨ ä¸€ä¸ªè‡ªç„¶æœˆå†…æœ€å¤šæœ‰å‡ å¤©åŒæ—¶ä¸ºå‘å¸ƒæ—¥ï¼Ÿ&lt;/p>
&lt;p>Aï¼5 Bï¼2 Cï¼6 Dï¼3&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2002">ä¾‹2&lt;/a>ï¼Œæ¯ä¸‰å¤©ï¼Œæ¯å››å¤©ï¼Œå…¬å€æ•°12ï¼Œä»1å·å¼€å§‹1 13 25&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸæ–°å»ºå°åŒºè®¡åˆ’åœ¨å°åŒºä¸»å¹²é“ä¸¤ä¾§ç§æ¤é“¶ææ ‘å’Œæ¢§æ¡æ ‘ç»¿åŒ–ç¯å¢ƒï¼Œ ä¸€ä¾§æ¯éš” 3 æ£µé“¶ææ ‘ç§ 1 æ£µæ¢§æ¡æ ‘ï¼Œå¦ä¸€ä¾§æ¯éš” 4 æ£µæ¢§æ¡æ ‘ç§ 1 æ£µé“¶ææ ‘ï¼Œæœ€ç»ˆ ä¸¤ä¾§å„ç§æ¤äº† 35 æ£µæ ‘ï¼Œé—®æœ€å¤šæ ½ç§äº†å¤šå°‘æ£µé“¶ææ ‘ï¼Ÿ&lt;/p>
&lt;p>Aã€33 Bã€34 Cã€36 Dã€37&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2117">ä¾‹3&lt;/a>ï¼Œæœ€å¤šï¼Œä¼˜å…ˆç§é“¶ææ ‘&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¸ºç»´æŠ¤åŠå…¬ç¯å¢ƒï¼ŒæŸåŠå…¬å®¤å››äººåœ¨å·¥ä½œæ—¥æ¯å¤©è½®æµæ‰“æ‰«å«ç”Ÿï¼Œæ¯å‘¨ ä¸€æ‰“æ‰«å«ç”Ÿçš„äººç»™æ¤ç‰©æµ‡æ°´ã€‚7 æœˆ 5 æ—¥å‘¨äº”è½®åˆ°å°ç²æ‰“æ‰«å«ç”Ÿï¼Œä¸‹ä¸€æ¬¡å°ç²ç»™æ¤ ç‰©æµ‡æ°´æ˜¯å“ªå¤©ï¼Ÿ&lt;/p>
&lt;p>Aã€7 æœˆ 15 æ—¥ Bã€7 æœˆ 22 æ—¥ Cã€7 æœˆ 29 æ—¥ Dã€8 æœˆ 5 æ—¥&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2409">ä¾‹5&lt;/a>ï¼Œç”»æ—¥å†&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ˜ŸæœŸæ—¥æœŸé—®é¢˜">æ˜ŸæœŸæ—¥æœŸé—®é¢˜&lt;/h3>
&lt;ul>
&lt;li>å¹³å¹´ä¸é—°å¹´ï¼š å››å¹´ä¸€é—°ï¼Œç™¾å¹´ä¸é—°ï¼Œå››ç™¾å¹´å†é—°ã€‚
&lt;ul>
&lt;li>$(year%4==0 &amp;amp;&amp;amp; year%100 !=0) || year%100 == 0$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¤§æœˆä¸å°æœˆï¼š å¤§æœˆ 31 å¤©(1ã€3ã€5ã€7ã€8ã€10ã€12 æœˆ)ï¼›å°æœˆ 30 å¤©(4ã€6ã€9ã€11 æœˆ)
&lt;ul>
&lt;li>æ‹³å¤´å‡¸èµ·31å¤©ï¼Œå¦åˆ™30å¤©&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>2 æœˆ
&lt;ul>
&lt;li>é—°å¹´ï¼š29 å¤© å¹³å¹´ï¼š28 å¤©&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ¯è¿‡ä¸€ä¸ªå¹³å¹´ï¼ˆ365Ã·7=52 ä½™ 1ï¼‰æ˜ŸæœŸå‡ +1ï¼Œæ¯è¿‡ä¸€ä¸ªé—°å¹´ï¼ˆ366Ã·7=52 ä½™ 2ï¼‰ æ˜ŸæœŸå‡ +2&lt;/li>
&lt;li>æ˜ŸæœŸæ—¥æœŸæ¨æ–­ï¼šæ¯è¿ç»­ 7 å¤©ä¸€å®šåŒ…å«ä¸€ä¸ªå®Œæ•´çš„æ˜ŸæœŸ&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å°æ˜ã€å°çº¢ã€å°æ¡ƒä¸‰äººå®šæœŸåˆ°æŸæ£‹é¦†å­¦å›´æ£‹ï¼Œå°æ˜æ¯éš” 3 å¤©å»ä¸€æ¬¡ï¼Œ å°çº¢æ¯éš” 4 å¤©å»ä¸€æ¬¡ï¼Œå°æ¡ƒæ¯éš” 5 å¤©å»ä¸€æ¬¡ã€‚è‹¥ 2016 å¹´ 2 æœˆ 10 æ—¥ä¸‰äººæ°å¥½åœ¨æ£‹ é¦†ç›¸é‡ï¼Œåˆ™ä¸‹æ¬¡ä¸‰äººåœ¨æ£‹é¦†ç›¸é‡çš„æ—¥æœŸæ˜¯ ï¼š&lt;/p>
&lt;p>Aï¼2016 å¹´ 4 æœˆ 8 æ—¥ Bï¼2016 å¹´ 4 æœˆ 11 æ—¥ Cï¼2016 å¹´ 4 æœˆ 9 æ—¥ Dï¼2016 å¹´ 4 æœˆ 10 æ—¥&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3804">ä¾‹2&lt;/a>ï¼Œå·©å›ºä¸ŠèŠ‚ä¾‹2ï¼Œä¸€ä¸ªæœˆä¸€ä¸ªæ¥çš„è®¡ç®—&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ ¹æ®å›½åŠ¡é™¢åŠå…¬å…éƒ¨åˆ†èŠ‚å‡æ—¥å®‰æ’çš„é€šçŸ¥ï¼ŒæŸå¹´ 8 æœˆä»½æœ‰ 22 ä¸ªå·¥ ä½œæ—¥ï¼Œé‚£ä¹ˆå½“å¹´çš„ 8 æœˆ 1 æ—¥å¯èƒ½æ˜¯ï¼š&lt;/p>
&lt;p>Aï¼å‘¨ä¸€æˆ–å‘¨ä¸‰ Bï¼å‘¨ä¸‰æˆ–å‘¨æ—¥ Cï¼å‘¨ä¸€æˆ–å‘¨å›› Dï¼å‘¨å››æˆ–å‘¨æ—¥&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4848">ä¾‹4&lt;/a>ï¼Œç®—å‰åŠéƒ¨åˆ†ï¼ŒæŠŠåé¢å˜æˆå‡ ä¸ªå®Œæ•´çš„æ˜ŸæœŸï¼Œæ¨æ–­å‰é¢ï¼›å¦‚1ï¼Œ2ï¼Œ3...4*7=28(å·¥ä½œæ—¥20å¤©)ã€‚ç®—ååŠéƒ¨åˆ†ï¼Œåä¹‹ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ¯”èµ›é—®é¢˜">æ¯”èµ›é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=5051">æ¯”èµ›é—®é¢˜&lt;/a>&lt;/p>
&lt;ul>
&lt;li>æ·˜æ±°èµ›ï¼š æ¯åœºæ¯”èµ›æ·˜æ±°ä¸€é˜Ÿï¼Œæ¯è½®æ¯”èµ›æ·˜æ±°ä¸€åŠçš„é˜Ÿä¼ï¼ˆå¦‚æœæ€»æ•°æ˜¯å¥‡æ•°ï¼Œä¾‹å¦‚ 11 ä¸ªé˜Ÿä¼ä¸€è½®æ·˜æ±° 5 ä¸ªé˜Ÿä¼ï¼Œä¸€æ”¯é˜Ÿä¼è½®ç©ºï¼Œä¿ç•™ 6 ä¸ªé˜Ÿä¼ï¼‰ã€‚&lt;/li>
&lt;li>å•å¾ªç¯èµ›ï¼Œæ¯æ”¯é˜Ÿä¼éƒ½è¦å’Œå…¶ä»–é˜Ÿä¼è¿›è¡Œä¸€æ¬¡æ¯”èµ›ï¼ŒN æ”¯é˜Ÿä¼çš„æ€»åœºæ¬¡æ˜¯$C_{N}^{2}=\frac{N \times(N-1)}{2}$&lt;/li>
&lt;li>åŒå¾ªç¯èµ›ï¼Œæ¯æ”¯é˜Ÿä¼éƒ½è¦å’Œå…¶ä»–é˜Ÿä¼è¿›è¡Œä¸¤åœºæ¯”èµ›ï¼ˆåˆ†ä¸»åœºå’Œå®¢åœºï¼‰ï¼ŒN æ”¯é˜Ÿä¼çš„æ€»åœºæ¬¡æ˜¯$A^2_N=N \times (N-1)$&lt;/li>
&lt;li>ç­”æ¡ˆå°ç›´æ¥ç”»å›¾&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸç¯®çƒæ¯”èµ›æœ‰ 12 æ”¯çƒé˜ŸæŠ¥åå‚åŠ ï¼Œæ¯”èµ›çš„ç¬¬ä¸€é˜¶æ®µä¸­ï¼Œ12 æ”¯çƒé˜Ÿ å¹³å‡åˆ†æˆ 2 ä¸ªç»„è¿›è¡Œå•å¾ªç¯æ¯”èµ›ï¼Œæ¯ç»„å‰ 4 åè¿›å…¥ç¬¬äºŒé˜¶æ®µï¼›ç¬¬äºŒé˜¶æ®µé‡‡ç”¨å•åœº æ·˜æ±°èµ›ï¼Œç›´è‡³å†³å‡ºå† å†›ã€‚é—®äºšå†›å‚åŠ çš„åœºæ¬¡å æ•´ä¸ªèµ›äº‹æ€»åœºæ¬¡çš„æ¯”é‡ä¸ºï¼š&lt;/p>
&lt;p>Aï¼10%ä»¥ä¸‹ Bï¼10%-15% Cï¼15%-20% Dï¼20%ä»¥ä¸Š&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=14&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=6154">ä¾‹3&lt;/a>ï¼Œå•å¾ªç¯æ‰“5åœºï¼Œæ·˜æ±°èµ›3åœº&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="ç»Ÿç­¹ä¼˜åŒ–">ç»Ÿç­¹ä¼˜åŒ–&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=18">æšä¸¾æ³•ã€é€»è¾‘æ¨æ–­&lt;/a>ï¼Œæœ€ä¼˜æ–¹æ³•&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸé¤å…è¦ç”¨ä¸‰ä¸ªç‚‰ç¶åšå‡º 9 é“èœè‚´ï¼Œåšå®Œå„é“èœè‚´éœ€è¦çš„æ—¶é—´åˆ†åˆ« æ˜¯ 1ã€2ã€3ã€4ã€4ã€5ã€5ã€6ã€7 åˆ†é’Ÿã€‚æ¯ä¸ªç‚‰ç¶åœ¨åŒä¸€æ—¶é—´åªèƒ½åšä¸€é“èœè‚´ã€‚é‚£ ä¹ˆï¼Œæœ€å°‘ç»è¿‡ï¼ˆï¼‰åˆ†é’Ÿï¼Œè¯¥é¤å…å¯ä»¥åšå®Œå…¨éƒ¨èœè‚´ã€‚&lt;/p>
&lt;p>A.11 B.12 C.13 D.14&lt;/p>
&lt;p>[æ¯ä¸ªç‚‰å­å¹³å‡æ”¾](&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=265">https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=265&lt;/a>ï¼‰&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=367">ç…é¥¼å…±30é¢ï¼Œä¸€æ¬¡ç…ä¸¤ä¸ªé¢ï¼Œ15min&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="é’Ÿè¡¨é—®é¢˜">é’Ÿè¡¨é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=896">è¿½åŠé—®é¢˜ &lt;/a>&lt;/p>
&lt;ul>
&lt;li>åˆ†é’ˆé€Ÿåº¦ä¸º 360Â°/60min=6Â°/minï¼›æ—¶é’ˆçš„é€Ÿåº¦ 30Â°/60min=0.5Â°/min&lt;/li>
&lt;li>ä¸€æ•´å¤©åˆ†é’ˆèµ°è¿‡ 24 åœˆï¼Œæ—¶é’ˆèµ°è¿‡ 2 åœˆï¼Œå¤šè·‘22åœˆï¼Œæ‰€ä»¥æ—¶é’ˆè¿½ä¸Šåˆ†é’ˆ 22 æ¬¡ï¼Œæ—¶é’ˆå’Œåˆ†é’ˆé‡åˆ 22 æ¬¡ï¼Œå‚ç›´ 44 æ¬¡ï¼ˆæ¯æ¬¡é‡åˆå‰åéƒ½ä¼šå‘ˆç°ä¸¤æ¬¡å‚ç›´ï¼‰&lt;/li>
&lt;li>ç»™å®šä»»æ„æ—¶é—´ï¼Œå…ˆè€ƒè™‘æ•´ç‚¹è§’åº¦ï¼Œå†è®¡ç®—è¿½å‡»è·ç¦»-(åˆ†é€Ÿ-æ—¶é€Ÿ)*æ—¶é—´çš„ç»å¯¹å€¼&lt;/li>
&lt;/ul>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ä»é’Ÿè¡¨çš„ 12 ç‚¹æ•´å¼€å§‹ï¼Œæ—¶é’ˆä¸åˆ†é’ˆçš„ç¬¬ä¸€æ¬¡å‚ç›´ä¸å†ä¸€æ¬¡é‡å ä¸­ é—´ç›¸éš”çš„æ—¶é—´çº¦ï¼ˆ ï¼‰&lt;/p>
&lt;p>A.43 åˆ†é’Ÿ B.45 åˆ†é’Ÿ C.49 åˆ†é’Ÿ D.61 åˆ†é’Ÿ&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1979">ä¾‹2&lt;/a>ï¼Œç¬¬ä¸€æ¬¡å‚ç›´åï¼Œåˆ°é‡å ä¹‹é—´çš„è·ç¦»ä¸º360-90=270ï¼Œè¿½å‡»é—®é¢˜&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¼ æŸä¸‹åˆå…­æ—¶å¤šå¤–å‡ºä¹°èœï¼Œå‡ºé—¨æ—¶çœ‹æ‰‹è¡¨ï¼Œå‘ç°è¡¨çš„æ—¶é’ˆå’Œåˆ†é’ˆçš„ å¤¹è§’ä¸º 110Â°ï¼Œä¸ƒæ—¶å‰å›å®¶æ—¶åˆçœ‹æ‰‹è¡¨ï¼Œå‘ç°æ—¶é’ˆå’Œåˆ†é’ˆçš„å¤¹è§’ä»æ˜¯ 110Â°ã€‚é‚£ä¹ˆå¼  æŸå¤–å‡ºä¹°èœç”¨æ—¶ï¼š&lt;/p>
&lt;p>Aï¼20 åˆ†é’Ÿ Bï¼30 åˆ†é’Ÿ Cï¼40 åˆ†é’Ÿ Dï¼50 åˆ†é’Ÿ&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2225">çœ¼ç›å°±æ˜¯å°º&lt;/a>ï¼Œè¿½å‡»220Â°&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ¤æ ‘é—®é¢˜">æ¤æ ‘é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2390">æ¤æ ‘é—®é¢˜&lt;/a>&lt;/p>
&lt;ul>
&lt;li>å•è¾¹çº¿æ€§æ¤æ ‘ï¼šæ£µæ•°ï¼æ€»é•¿Ã·é—´éš”ï¼‹1ï¼Œæ€»é•¿ï¼(æ£µæ•°ï¼1)Ã—é—´éš”ï¼›&lt;/li>
&lt;li>å•è¾¹ç¯å½¢æ¤æ ‘ï¼šæ£µæ•°ï¼æ€»é•¿Ã·é—´éš”ï¼Œæ€»é•¿ï¼æ£µæ•°Ã—é—´éš”ã€‚&lt;/li>
&lt;li>æ³¨æ„ï¼šåŒºåˆ†é¢˜å¹²ä¸­æ˜¯åœ¨é©¬è·¯å•è¾¹æ¤æ ‘è¿˜æ˜¯åœ¨é©¬è·¯åŒè¾¹æ¤æ ‘ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3074">å‰ªç»³é—®é¢˜&lt;/a>&lt;/p>
&lt;ul>
&lt;li>å°†ç»³å­æˆªä¸º N æ®µï¼Œéœ€è¦æˆªï¼ˆN-1ï¼‰æ¬¡ï¼Œå¯¹æŠ˜næ¬¡ï¼Œæœ‰$2^n$ä¸ªç»³å­ï¼Œå‰ªä¸€åˆ€$=2^n+1$&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸæ¡é“è·¯è¿›è¡Œç¯å…‰å¢äº®å·¥ç¨‹ï¼ŒåŸæ¥é—´éš” 35 ç±³çš„è·¯ç¯ä¸€å…±æœ‰ 21 ç›ï¼Œ ç°è¦å°†è·¯ç¯çš„é—´éš”ç¼©çŸ­ä¸º 25 ç±³ï¼Œé‚£ä¹ˆæœ‰ï¼ˆï¼‰ç›è·¯ç¯æ— éœ€ç§»åŠ¨ã€‚&lt;/p>
&lt;p>A.2 B.3 C.4 D.5&lt;/p>
&lt;p>ç®—å‡ºæ€»é•¿ï¼Œæ±‚å…¬å€æ•°&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å‡½æ•°å›¾é—®é¢˜">å‡½æ•°å›¾é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3891">å‡½æ•°å›¾å½¢é—®é¢˜&lt;/a>&lt;/p>
&lt;ul>
&lt;li>$y=kx+b$&lt;/li>
&lt;li>$y=ax^2+bx+c$, $x=-\frac{b}{2a}$ &amp;lt;=&amp;gt; $a+b=10,ab=25$&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸé›†å›¢ä¸‰ä¸ªåˆ†å…¬å¸å…±åŒä¸¾è¡ŒæŠ€èƒ½å¤§èµ›ï¼Œå…¶ä¸­æˆç»©é å‰çš„ X äººè·å¥–ã€‚ å¦‚è·å¥–äººæ•°æœ€å¤šçš„åˆ†å…¬å¸è·å¥–çš„äººæ•°ä¸º Yï¼Œé—®ä»¥ä¸‹å“ªä¸ªå›¾å½¢èƒ½åæ˜  Y çš„ä¸Šã€ä¸‹ é™åˆ†åˆ«ä¸ X çš„å…³ç³»ï¼Ÿ&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=15&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=4376">ä¾‹2&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ•°åˆ—é—®é¢˜">æ•°åˆ—é—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=617">æ•°åˆ—é—®é¢˜&lt;/a>&lt;/p>
&lt;ul>
&lt;li>å¹³å‡æ•° å…¬å¼ï¼š$\bar{a}=\frac{a_{1}+a_{2}+\cdots \cdots+a_{n}}{n}$&lt;/li>
&lt;li>ç­‰å·®æ•°åˆ—
&lt;ul>
&lt;li>é€šé¡¹å…¬å¼ï¼š$ğ‘_ğ‘› = ğ‘_1 + (ğ‘› âˆ’ 1)ğ‘‘$&lt;/li>
&lt;li>æ±‚å’Œå…¬å¼ï¼šå’Œ= $\frac{1}{2}$ Ã—ï¼ˆé¦–é¡¹+æœ«é¡¹ï¼‰Ã— é¡¹æ•°=å¹³å‡æ•°Ã—é¡¹æ•°=ä¸­ä½æ•°Ã—é¡¹æ•°&lt;/li>
&lt;li>é¡¹æ•°å…¬å¼ï¼šé¡¹æ•°=ï¼ˆæœ«é¡¹-é¦–é¡¹ï¼‰Ã· å…¬å·®+1&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åŠ å‡å¯ä»¥ç”¨å°¾æ•°æ³•ã€ä¹˜é™¤ä¸å»ºè®®&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æŸæˆè¡£å‚å¯¹ 9 åç¼çº«å·¥è¿›è¡ŒæŠ€æœ¯è¯„æ¯”ï¼Œ9 åå·¥äººçš„å¾—åˆ†æ­£å¥½æˆç­‰å·® æ•°åˆ—ï¼Œ9 äººçš„å¹³å‡å¾—åˆ†æ˜¯ 86 åˆ†ï¼Œå‰ 5 åå·¥äººçš„å¾—åˆ†ä¹‹å’Œæ˜¯ 460 åˆ†ï¼Œé‚£ä¹ˆå‰ 7 åå·¥äººçš„å¾—åˆ†ä¹‹å’Œæ˜¯å¤šå°‘ï¼š&lt;/p>
&lt;p>Aã€602 Bã€623 Cã€627 Dã€631&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=853">ä¾‹4&lt;/a>ï¼Œå¹³å‡åˆ†=ä¸­ä½æ•°&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å¤©å¹³é—®é¢˜">å¤©å¹³é—®é¢˜&lt;/h3>
&lt;p>23å¹´æµ™æ±Ÿé€‰è°ƒè€ƒåˆ°&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1178">å¤©å¹³é—®é¢˜&lt;/a>ï¼Œé€‰æœ€å°ï¼ˆç„å­¦ï¼‰&lt;/p>
&lt;p>N æ¬¡ç§°é‡å¯ä»¥ä» $3^N$ä¸ªç‰©å“ä¸­ï¼Œé€‰å‡ºå…·æœ‰å·®å¼‚çš„ç‘•ç–µå“ã€‚&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ä½“è‚²å½©ç¥¨ 22 é€‰ 5 ä½¿ç”¨çš„ 22 ä¸ªå½©çƒé™¤ç¼–å·ä¸åŒå¤–ï¼Œå…¶ä½™å®Œå…¨ä¸€æ ·ã€‚ ç”±äºç”Ÿäº§è¿‡ç¨‹ç–å¿½ï¼Œ22 ä¸ªå½©çƒä¸­æœ‰ä¸€ä¸ªçƒçš„é‡é‡ç•¥é‡äºå…¶å®ƒçƒã€‚ç°éœ€è¦å¤©å¹³å°† è¯¥çƒæ‰¾å‡ºï¼Œé‚£ä¹ˆï¼Œåœ¨æœ€ä¼˜æ–¹æ¡ˆä¸‹ï¼Œæœ€å¤šè¦ä½¿ç”¨å¤©å¹³ï¼š&lt;/p>
&lt;p>A.3 æ¬¡ B.4 æ¬¡ C.5 æ¬¡ D.6 æ¬¡&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1861">ä¾‹3&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="ç©ºç“¶æ¢é…’">ç©ºç“¶æ¢é…’&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=1899">ç©ºç“¶æ¢é…’&lt;/a>
è§£é¢˜æŠ€å·§ï¼šæˆ‘ä»¬å°†â€œM ä¸ªç©ºç“¶æ¢ 1 ç“¶é…’â€ï¼Œè½¬åŒ–ä¸ºâ€œï¼ˆM-1ï¼‰ä¸ªç©ºç“¶æ¢ 1 ä¸ªï¼ˆæ—  ç“¶ï¼‰é…’â€æ¥å®Œæˆç­”é¢˜ï¼Œè¿™æ ·çš„é¢˜ç›®æˆ‘ä»¬é»˜è®¤æ˜¯å¯ä»¥â€œå€Ÿç“¶å†æ¢ç“¶â€çš„ã€‚&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>31 ä¸ªå°è¿åŠ¨å‘˜åœ¨å‚åŠ å®Œæ¯”èµ›åï¼Œå£æ¸´éš¾è€ï¼Œå»å°åº—ä¹°é¥®æ–™ï¼Œé¥®æ–™åº— æä¿ƒé”€ï¼Œå‡­ä¸‰ä¸ªç©ºç“¶å­å¯ä»¥å†æ¢ä¸€ç“¶ï¼Œå®ƒä»¬æœ€å°‘ä¹°å¤šå°‘ç“¶é¥®æ–™æ‰èƒ½ä¿è¯ä¸€äººä¸€ç“¶ï¼Ÿ&lt;/p>
&lt;p>Aï¼21 Bï¼23 Cï¼25 Dï¼27&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2301">ä¾‹2&lt;/a>ï¼Œåé¢æ±‚ å¸¦ç­”æ¡ˆ&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ–¹é˜µé—®é¢˜">æ–¹é˜µé—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=2410">æ–¹é˜µé—®é¢˜&lt;/a>
è‹¥æ­£æ–¹å½¢æ–¹é˜µè¾¹é•¿ä¸º Nï¼Œé•¿æ–¹å½¢æ–¹é˜µè¾¹é•¿åˆ†åˆ«ä¸º Mã€Nï¼Œåˆ™ï¼š&lt;/p>
&lt;ul>
&lt;li>æ­£æ–¹å½¢å®å¿ƒæ–¹é˜µçš„æ€»æ•°ä¸º $N^2$ï¼Œé•¿æ–¹å½¢å®å¿ƒæ–¹é˜µçš„æ€»æ•°ä¸º MNã€‚&lt;/li>
&lt;li>æ­£æ–¹å½¢æ–¹é˜µæœ€å¤–å±‚æ•° 4N-4ï¼Œé•¿æ–¹å½¢æ–¹é˜µæœ€å¤–å±‚æ•° 2ï¼ˆM+Nï¼‰- 4ã€‚ å‘¨é•¿-4&lt;/li>
&lt;li>æ–¹é˜µç›¸é‚»ä¸¤å±‚äººæ•°&lt;strong>ç›¸å·® 8 äºº&lt;/strong>ã€‚&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æœ‰ä¸€é˜Ÿå£«å…µæ’æˆè‹¥å¹²å±‚çš„ä¸­ç©ºæ–¹é˜µï¼Œå¤–å±‚äººæ•°å…±æœ‰ 68 äººï¼Œä¸­é—´ä¸€ å±‚å…± 44 äººï¼Œåˆ™è¯¥æ–¹é˜µå£«å…µçš„æ€»äººæ•°æ˜¯ï¼š&lt;/p>
&lt;p>Aã€296 äºº Bã€308 äºº Cã€324 ä¸ª Dã€348 ä¸ª&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3198">ä¾‹3&lt;/a>ï¼Œä¸­é—´ ï¼Œä¸æ˜¯æœ€å†…åœˆï¼Œç­‰å·®æ•°åˆ—&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="æ‹¿ç‰Œé—®é¢˜">æ‹¿ç‰Œé—®é¢˜&lt;/h3>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3474">æ‹¿ç‰Œé—®é¢˜&lt;/a>
ç¬¬ä¸€æ¬¡æ‹¿å®Œç‰Œåï¼Œæ°å¥½å‡‘æˆæœ€å¤§æœ€å°æ•°ä¹‹å’Œçš„å€æ•°ã€‚&lt;/p>
&lt;hr>
&lt;p>é¢˜ç›®ï¼š
ä¸€å‰¯æ‰‘å…‹ç‰Œï¼ˆå…± 54 å¼ ï¼‰ï¼Œç”²ä¹™ä¸¤äººè½®æµæ‹¿ï¼Œæ¯äººæ¯æ¬¡åªèƒ½æ‹¿ 1ã€2ã€ 3 æˆ–è€… 4 å¼ ï¼Œè°æ‹¿åˆ°æœ€åä¸€å¼ è°èµ¢ã€‚è‹¥ç”²å…ˆæ‹¿ç‰Œï¼Œåˆ™ç”²ç¬¬ä¸€æ¬¡åº”è¯¥æ‹¿å¤šå°‘å¼ ç‰Œï¼Œ æ‰èƒ½ç¡®ä¿è·èƒœï¼Ÿ&lt;/p>
&lt;p>Aï¼1 Bï¼2 Cï¼3 D&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1nE411o7qp/?p=16&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3597">ä¾‹1&lt;/a>ï¼Œæ‹¿å®Œ4å¼ åï¼Œ1+4=5çš„å€æ•°&lt;/p>
&lt;h2 id="æ•°å­—æ¨ç†">æ•°å­—æ¨ç†&lt;/h2>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1fQ4y1m7n1">é€‚ç”¨äºæµ™æ±Ÿ&lt;/a>&lt;/p>
&lt;h3 id="æ•°æ¨">æ•°æ¨&lt;/h3>
&lt;p>åšé¢˜ä¹ æƒ¯ï¼š&lt;/p>
&lt;p>å€æ•°&amp;gt;å¹‚æ¬¡&amp;gt;åˆ†æ•°&amp;gt;åšå·®&amp;gt;é€’æ¨&lt;/p>
&lt;p>ä¸€èˆ¬æ¥è¯´ï¼Œæœ€åçš„è§„å¾‹è‡³å°‘éœ€è¦ä¸‰ä¸ªæ•°ï¼Œå¹¶ä¸”å‘ˆè§„å¾‹ï¼Œå¦‚1 2 1 ç†è®ºæ¥è¯´æ˜¯ä¸è¡Œçš„ ï¼Œå¿…é¡»1 2 3\ 4 9 16...ï¼Œæ‰€ä»¥åæ¨å¯çŸ¥åˆ™é•¿åº¦è¾ƒå°çš„æ•°åˆ—ï¼Œåšä¸€æ¬¡å·®/å’Œä¸è¡Œå°±æ¢é€’æ¨ä¹‹ç±»çš„&lt;/p>
&lt;hr>
&lt;h4 id="åšå•†æ•°åˆ—">åšå•†æ•°åˆ—&lt;/h4>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1fQ4y1m7n1/?p=2&amp;amp;share_source=copy_web&amp;amp;vd_source=504045c18340a005fec8674ac78d7934&amp;amp;t=3">å•†&lt;/a>&lt;/p>
&lt;p>ç‰¹å¾ï¼šæ˜æ˜¾çš„å€æ•°å…³ç³»ï¼Œæˆ–è€…ç›¸é‚»ä¸¤é¡¹åšå•†ç»“æœå¯çº¦åˆ†ã€‚&lt;/p>
&lt;ol>
&lt;li>3 3 6 18 ()&lt;/li>
&lt;li>8 4 6 15 52*1/2 ()&lt;/li>
&lt;/ol>
&lt;h4 id="åšå·®æ•°åˆ—">åšå·®æ•°åˆ—&lt;/h4>
&lt;p>ç‰¹å¾ï¼šæ•°åˆ—æ— æ˜æ˜¾ç‰¹å¾ï¼Œå‘ˆé€’å¢/é€’å‡è¶‹åŠ¿ï¼Œä¼˜å…ˆåšå·®ã€‚&lt;/p>
&lt;p>è§£æ³•ï¼šå¤šæ¬¡åšå·®ï¼Œå¤šçº§æ•°åˆ—&lt;/p>
&lt;ol>
&lt;li>12 16 22 30 39 49 ()&lt;/li>
&lt;li>4 1 0 2 10 29 66 ()&lt;/li>
&lt;/ol>
&lt;h4 id="åšå’Œæ•°åˆ—">åšå’Œæ•°åˆ—&lt;/h4>
&lt;p>å’Œ&lt;/p>
&lt;p>ç‰¹å¾ï¼šæ•°åˆ—èµ·ä¼ä¸å®šï¼›è´Ÿæ•°æ­£æ•°äº¤æ›¿ï¼›æ­£æ•°çªç„¶æœ‰è´Ÿæ•°ï¼›åšå·®æ²¡è§„å¾‹ï¼Œç”¨åšå’Œ&lt;/p>
&lt;h4 id="åšç§¯æ•°åˆ—">åšç§¯æ•°åˆ—&lt;/h4>
&lt;p>ç§¯&lt;/p>
&lt;p>ç‰¹å¾ï¼šæ•°åˆ—ä¸­æœ‰åˆ†æ•°ï¼šåˆ†å­åˆ†æ¯å¯ä»¥çº¦åˆ†ã€æ•°ä¸åˆ†æ•°å¯çº¦åˆ†&lt;/p>
&lt;h4 id="åˆ†æ•°æ•°åˆ—">åˆ†æ•°æ•°åˆ—&lt;/h4>
&lt;p>åˆ†æ•°&lt;/p>
&lt;ul>
&lt;li>ç‰¹å¾ï¼šæ•°åˆ—ä¸­æœ‰åˆ†æ•°&lt;/li>
&lt;li>è€ƒç‚¹
&lt;ul>
&lt;li>äº¤å‰å½±å“ï¼šå¯»æ‰¾åˆ†å­ã€åˆ†æ¯è§„å¾‹
&lt;ul>
&lt;li>1/2 3/5 8/13 21/34 ()&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åçº¦åˆ†ï¼šè§‚å¯Ÿæ•°åˆ—æ•´ä½“è¶‹åŠ¿
&lt;ul>
&lt;li>5 3 7/3 2 9/5 5/3&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è´Ÿå¹‚æ¬¡ï¼šåˆ†å­ä¸º1ï¼Œæƒ³åˆ°è´Ÿå¹‚æ¬¡ $a^{-1}$
&lt;ul>
&lt;li>1 4 3 1 1/5 1/36&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>é€’æ¨ï¼šç›¸é‚»ä¸¤é¡¹ä¸ç¬¬ä¸‰é¡¹
&lt;ul>
&lt;li>1/2 1/6 1/3 2 6 3&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åšå·®ï¼šéš¾
&lt;ul>
&lt;li>0 1 3/2 11/6 25/12&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="é€’æ¨æ•°åˆ—">é€’æ¨æ•°åˆ—&lt;/h4>
&lt;p>é€’æ¨&lt;/p>
&lt;p>ç‰¹å¾ï¼šæ²¡æœ‰æ˜æ˜¾è§„å¾‹ä¸”åšå·®ã€åšå’Œæ²¡æœ‰è§„å¾‹&lt;/p>
&lt;ul>
&lt;li>ç›¸é‚»ä¸‰é¡¹ï¼ˆABCï¼‰:
&lt;ul>
&lt;li>$n(A \pm B)=C$&lt;/li>
&lt;li>$A \times B=nC$&lt;/li>
&lt;li>$A \times B+n=C$&lt;/li>
&lt;li>$A \div B=n C$&lt;/li>
&lt;li>$(A \pm B)^{2}=C$&lt;/li>
&lt;li>$\frac{A}{n} \pm B=C$&lt;/li>
&lt;li>$A^{2}+B=C$&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç›¸é‚»å››é¡¹ï¼ˆABCDï¼‰
&lt;ul>
&lt;li>A+B+C=Dï¼›A-B-C=D&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç›¸é‚»ä¸¤é¡¹
&lt;ul>
&lt;li>nA+m=B&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>A+B = D&lt;/li>
&lt;/ul>
&lt;h4 id="å¹‚æ¬¡æ•°åˆ—">å¹‚æ¬¡æ•°åˆ—&lt;/h4>
&lt;p>å¹‚æ¬¡&lt;/p>
&lt;p>ç‰¹å¾ï¼šæ˜æ˜¾çš„å¹‚æ¬¡æ•°å­—&lt;/p>
&lt;p>ä»æƒ…å†µå•ä¸€çš„æ•°å­—å…¥æ‰‹ï¼ˆ32ï¼Œ 64ï¼Œ 125ï¼‰è€ƒè™‘125=$5^3$&lt;/p>
&lt;p>éš¾ç‚¹ï¼šåˆ†å­ä¸º1ï¼Œæƒ³åˆ°å¹‚æ¬¡&lt;/p>
&lt;ul>
&lt;li>1 4 3 1 1/5 1/36 ï¼ˆï¼‰&lt;/li>
&lt;li>1 0 1 8 81&lt;/li>
&lt;/ul>
&lt;h4 id="å¹‚æ¬¡ä¿®æ­£æ•°åˆ—">å¹‚æ¬¡ä¿®æ­£æ•°åˆ—&lt;/h4>
&lt;p>å¹‚æ¬¡ä¿®æ­£&lt;/p>
&lt;p>ç‰¹å¾ï¼šåœ¨å¹‚æ¬¡æ•°å­—é™„è¿‘&lt;/p>
&lt;p>3 65 35 513 99&lt;/p>
&lt;h4 id="è´¨æ•°åˆæ•°åŠå…¶ä¿®æ­£æ•°åˆ—">è´¨æ•°ã€åˆæ•°åŠå…¶ä¿®æ­£æ•°åˆ—&lt;/h4>
&lt;p>è´¨æ•°ã€åˆæ•°åŠå…¶ä¿®æ­£æ•°åˆ—&lt;/p>
&lt;ul>
&lt;li>è´¨æ•°æ•°åˆ—ï¼š2 3 5 7 11 13 17 19 23 29 31 37 41 43&lt;/li>
&lt;li>åˆæ•°æ•°åˆ—ï¼š4 6 8 9 10 12 14 15 16&lt;/li>
&lt;li>ä¿®æ­£ï¼šè´¨æ•°åˆæ•°é™„è¿‘&lt;/li>
&lt;/ul>
&lt;h4 id="å¤šé‡æ•°åˆ—">å¤šé‡æ•°åˆ—&lt;/h4>
&lt;p>å¤šé‡æ•°åˆ—&lt;/p>
&lt;ul>
&lt;li>ç‰¹å¾ï¼šé¡¹æ•°è¾ƒå¤šï¼Œä¸€èˆ¬8é¡¹ä»¥ä¸Š&lt;/li>
&lt;li>åˆ†ç»„çœ‹ã€äº¤å‰çœ‹ï¼ˆå¥‡å¶ï¼‰&lt;/li>
&lt;/ul>
&lt;h3 id="å›¾æ¨">å›¾æ¨&lt;/h3>
&lt;p>ä¸‰è§’å½¢ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸­é—´å¤§è€ƒè™‘å€æ•°å…³ç³»&lt;/li>
&lt;li>å…¶æ¬¡è€ƒè™‘åŠ å‡å…³ç³»&lt;/li>
&lt;li>ä¸­é—´å°è€ƒè™‘å¹³æ–¹ã€ä¹˜æ³•&lt;/li>
&lt;li>å¤§çœ‹å…¬å€æ•°ï¼Œä¸´è¿‘çœ‹åŠ å‡ï¼Œç„¶åä¹˜é™¤&lt;/li>
&lt;li>å°çœ‹å…¬çº¦æ•°
åœ†å½¢ï¼š&lt;/li>
&lt;li>å¯¹è§’çº¿å…³ç³»ï¼Œæœ€å¤–åœˆå…¨å’Œå…³ç³»ï¼Œçœ‹å…¬å€æ•°&lt;/li>
&lt;/ul>
&lt;p>åŸå‹ï¼ˆå››ä¸ªæ•°å­—ï¼‰&lt;/p>
&lt;ul>
&lt;li>å…ˆè€ƒè™‘é™¤æ³•ï¼Œé™¤å®Œçœ‹åŠ å‡&lt;/li>
&lt;li>æ¬¡è€ƒè™‘ä¹˜æ³•ï¼Œä¹˜å®Œçœ‹åŠ å‡&lt;/li>
&lt;li>åè€ƒè™‘åŠ å‡&lt;/li>
&lt;/ul></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/civilservant/">CivilServant</category></item><item><title>TCP_IPç½‘ç»œç¼–ç¨‹2</title><link>https://keepjolly.com/posts/learn/tcp_ip_network_programming2/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/tcp_ip_network_programming2/</guid><pubDate>Sun, 13 Aug 2023 22:41:59 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="è¿›ç¨‹é—´é€šä¿¡">è¿›ç¨‹é—´é€šä¿¡&lt;/h2>
&lt;h3 id="è¿›ç¨‹é—´é€šä¿¡çš„åŸºæœ¬æ¦‚å¿µ">è¿›ç¨‹é—´é€šä¿¡çš„åŸºæœ¬æ¦‚å¿µ&lt;/h3>
&lt;h4 id="ç®¡é“å®ç°è¿›ç¨‹é—´é€šä¿¡">ç®¡é“å®ç°è¿›ç¨‹é—´é€šä¿¡&lt;/h4>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="">&lt;br />å¯ä»¥çœ‹å‡ºï¼Œä¸ºäº†å®Œæˆè¿›ç¨‹é—´é€šä¿¡ï¼Œéœ€è¦åˆ›å»ºç®¡é“ã€‚ç®¡é“å¹¶éå±äºè¿›ç¨‹çš„èµ„æºï¼Œè€Œæ˜¯å’Œå¥—æ¥å­—ä¸€æ ·ï¼Œå±äºæ“ä½œç³»ç»Ÿï¼ˆä¹Ÿå°±ä¸æ˜¯ fork å‡½æ•°çš„å¤åˆ¶å¯¹è±¡ï¼‰ã€‚æ‰€ä»¥ï¼Œä¸¤ä¸ªè¿›ç¨‹é€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„å†…å­˜ç©ºé—´è¿›è¡Œé€šä¿¡ã€‚ä¸‹é¢æ˜¯åˆ›å»ºç®¡é“çš„å‡½æ•°ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">pipe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">filedes&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">filedes[0]: é€šè¿‡ç®¡é“æ¥æ”¶æ•°æ®æ—¶ä½¿ç”¨çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå³ç®¡é“å‡ºå£
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">filedes[1]: é€šè¿‡ç®¡é“ä¼ è¾“æ•°æ®æ—¶ä½¿ç”¨çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå³ç®¡é“å…¥å£
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="å•å‘é€šä¿¡">å•å‘é€šä¿¡&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// è°ƒç”¨ pipe å‡½æ•°åˆ›å»ºç®¡é“ï¼Œfds æ•°ç»„ä¸­ä¿å­˜ç”¨äº I/O çš„æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">pipe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fds&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="c1">//å­è¿›ç¨‹å°†åŒæ—¶æ‹¥æœ‰åˆ›å»ºç®¡é“è·å–çš„2ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå¤åˆ¶çš„å¹¶éç®¡é“ï¼Œè€Œæ˜¯æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fds&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">str&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">str&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fds&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BUF_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-1.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="">&lt;/p>
&lt;h4 id="åŒå‘é€šä¿¡">åŒå‘é€šä¿¡&lt;/h4>
&lt;p>&lt;img src="https://cdn.nlark.com/yuque/0/2023/png/12600461/1686926856566-2572cdd9-7a1e-4f1b-b49f-1610e73b306f.png#averageHue=%23ebebeb&amp;amp;clientId=u146b6ba8-d8f8-4&amp;amp;from=paste&amp;amp;id=u7a0be122&amp;amp;originHeight=279&amp;amp;originWidth=477&amp;amp;originalType=url&amp;amp;ratio=1.25&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u0175482d-e892-498a-bc22-3038832ba0d&amp;amp;title=" alt="">&lt;br />ä¸Šè¿°å•ä¸ªpipeå¯èƒ½ä¼šå¯¼è‡´æ•°æ®æ¥æ”¶é—®é¢˜ï¼Œå³å­è¿›ç¨‹æŠŠæ‰€æœ‰æ•°æ®éƒ½è¯»å®Œï¼Œéœ€è¦sleepå‡½æ•°ã€‚é‡‡ç”¨ä¸‹è¿°æ–¹æ³•å¥½ä¸€äº›ï¼Œä½†æ˜¯å¤šåŠ ä¸€ä¸ªpipe&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-2.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">pipe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fds1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">pipe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fds2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fds1&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">str1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">str1&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fds2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BUF_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child proc output: %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fds1&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BUF_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Parent proc output: %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fds2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">str2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">str2&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="æ€»ç»“">æ€»ç»“&lt;/h4>
&lt;p>è¿›ç¨‹é—´é€šä¿¡æ„å‘³ç€ä¸¤ä¸ªä¸åŒçš„è¿›ç¨‹é—´å¯ä»¥äº¤æ¢æ•°æ®ã€‚ä»å†…å­˜ä¸Šæ¥è¯´ï¼Œå°±æ˜¯ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€ä¸ªå†…å­˜åŒºåŸŸï¼Œç„¶åé€šè¿‡è¿™ä¸ªå†…å­˜åŒºåŸŸæ•°æ®çš„å˜åŒ–æ¥è¿›è¡Œé€šä¿¡ã€‚&lt;/p>
&lt;h2 id="io-å¤ç”¨">I/O å¤ç”¨&lt;/h2>
&lt;h3 id="åŸºäº-io-å¤ç”¨çš„æœåŠ¡å™¨ç«¯">åŸºäº I/O å¤ç”¨çš„æœåŠ¡å™¨ç«¯&lt;/h3>
&lt;p>å¤šè¿›ç¨‹æœåŠ¡ç«¯çš„ç¼ºç‚¹ï¼šä¸ºäº†æ„å»ºå¹¶å‘æœåŠ¡å™¨ï¼Œåªè¦æœ‰å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚å°±ä¼šåˆ›å»ºæ–°è¿›ç¨‹ã€‚è¿™çš„ç¡®æ˜¯å®é™…æ“ä½œä¸­é‡‡ç”¨çš„ä¸€ç§æ–¹æ¡ˆï¼Œä½†å¹¶éåå…¨åç¾ï¼Œå› ä¸ºåˆ›å»ºè¿›ç¨‹è¦ä»˜å‡ºå¾ˆå¤§çš„ä»£ä»·ã€‚è¿™éœ€è¦å¤§é‡çš„è¿ç®—å’Œå†…å­˜ç©ºé—´ï¼Œç”±äºæ¯ä¸ªè¿›ç¨‹éƒ½å…·æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥ç›¸äº’é—´çš„æ•°æ®äº¤æ¢ä¹Ÿè¦é‡‡ç”¨ç›¸å¯¹å¤æ‚çš„æ–¹æ³•ï¼ˆIPC å±äºç›¸å¯¹å¤æ‚çš„é€šä¿¡æ–¹æ³•ï¼‰ã€‚&lt;br />I/O å¤ç”¨æŠ€æœ¯å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-3.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />æ— è®ºè¿æ¥å¤šå°‘å®¢æˆ·ç«¯ï¼Œæä¾›æœåŠ¡çš„è¿›ç¨‹åªæœ‰ä¸€ä¸ªã€‚&lt;/p>
&lt;h3 id="ç†è§£-select-å‡½æ•°å¹¶å®ç°æœåŠ¡ç«¯">ç†è§£ select å‡½æ•°å¹¶å®ç°æœåŠ¡ç«¯&lt;/h3>
&lt;p>select å‡½æ•°æ˜¯æœ€å…·ä»£è¡¨æ€§çš„å®ç°å¤ç”¨æœåŠ¡å™¨çš„æ–¹æ³•ã€‚åœ¨ Windows å¹³å°ä¸‹ä¹Ÿæœ‰åŒåå‡½æ•°ï¼Œæ‰€ä»¥å…·æœ‰å¾ˆå¥½çš„ç§»æ¤æ€§ã€‚&lt;br />select å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-4.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/p>
&lt;h3 id="è®¾ç½®æ–‡ä»¶æè¿°ç¬¦">è®¾ç½®æ–‡ä»¶æè¿°ç¬¦&lt;/h3>
&lt;p>åˆ©ç”¨ select å‡½æ•°å¯ä»¥&lt;strong>åŒæ—¶ç›‘è§†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦&lt;/strong>ã€‚å½“ç„¶ï¼Œç›‘è§†æ–‡ä»¶æè¿°ç¬¦å¯ä»¥è§†ä¸ºç›‘è§†å¥—æ¥å­—ã€‚æ­¤æ—¶é¦–å…ˆéœ€è¦å°†è¦ç›‘è§†çš„æ–‡ä»¶æè¿°ç¬¦é›†ä¸­åœ¨ä¸€èµ·ã€‚é›†ä¸­æ—¶ä¹Ÿè¦æŒ‰ç…§ç›‘è§†é¡¹ï¼ˆ&lt;strong>æ¥æ”¶ã€ä¼ è¾“ã€å¼‚å¸¸&lt;/strong>ï¼‰è¿›è¡ŒåŒºåˆ†ï¼Œå³æŒ‰ç…§ä¸Šè¿° 3 ç§ç›‘è§†é¡¹åˆ†æˆ 3 ç±»ã€‚&lt;br />åˆ©ç”¨ fd_set æ•°ç»„å˜é‡æ‰§è¡Œæ­¤æ“ä½œï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œè¯¥æ•°ç»„æ˜¯å­˜æœ‰0å’Œ1çš„ä½æ•°ç»„ã€‚&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-5.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />å›¾ä¸­æœ€å·¦ç«¯è¡¨ç¤ºæ–‡ä»¶æè¿°ç¬¦ 0ã€‚å¦‚æœè¯¥ä½è®¾ç½®ä¸º 1ï¼Œåˆ™è¡¨ç¤ºè¯¥æ–‡ä»¶æè¿°ç¬¦æ˜¯ç›‘è§†å¯¹è±¡ã€‚å›¾ä¸­æ–‡ä»¶æè¿°ç¬¦ 1 å’Œ 3æ˜¯ç›‘è§†å¯¹è±¡ã€‚åœ¨ fd_set å˜é‡ä¸­æ³¨å†Œæˆ–æ›´æ”¹å€¼çš„æ“ä½œéƒ½ç”±ä¸‹åˆ—å®å®Œæˆã€‚&lt;/p>
&lt;ul>
&lt;li>FD_ZERO(fd_set *fdset)ï¼šå°† fd_set å˜é‡æ‰€æŒ‡çš„ä½å…¨éƒ¨åˆå§‹åŒ–æˆ0&lt;/li>
&lt;li>FD_SET(int fd,fd_set *fdset)ï¼šåœ¨å‚æ•° fdset æŒ‡å‘çš„å˜é‡ä¸­æ³¨å†Œæ–‡ä»¶æè¿°ç¬¦ fd çš„ä¿¡æ¯&lt;/li>
&lt;li>FD_CLR(int fd,fd_set *fdset)ï¼šä»å‚æ•° fdset æŒ‡å‘çš„å˜é‡ä¸­æ¸…é™¤æ–‡ä»¶æè¿°ç¬¦ fd çš„ä¿¡æ¯&lt;/li>
&lt;li>FD_ISSET(int fd,fd_set *fdset)ï¼šè‹¥å‚æ•° fdset æŒ‡å‘çš„å˜é‡ä¸­åŒ…å«æ–‡ä»¶æè¿°ç¬¦ fd çš„ä¿¡æ¯ï¼Œåˆ™è¿”å›ã€ŒçœŸã€&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-6.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/p>
&lt;h4 id="è®¾ç½®æ£€æŸ¥ç›‘è§†èŒƒå›´åŠè¶…æ—¶">è®¾ç½®æ£€æŸ¥ï¼ˆç›‘è§†ï¼‰èŒƒå›´åŠè¶…æ—¶&lt;/h4>
&lt;p>ä¸‹é¢æ˜¯ select å‡½æ•°çš„å®šä¹‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/select.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/time.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">maxfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fd_set&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">readset&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fd_set&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">writeset&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fd_set&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">exceptset&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">timeval&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">timeout&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›å¤§äº 0 çš„å€¼ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">maxfd: ç›‘è§†å¯¹è±¡æ–‡ä»¶æè¿°ç¬¦æ•°é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">readset: å°†æ‰€æœ‰å…³æ³¨ã€Œæ˜¯å¦å­˜åœ¨å¾…è¯»å–æ•°æ®ã€çš„æ–‡ä»¶æè¿°ç¬¦æ³¨å†Œåˆ° fd_set å‹å˜é‡ï¼Œå¹¶ä¼ é€’å…¶åœ°å€å€¼ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">writeset: å°†æ‰€æœ‰å…³æ³¨ã€Œæ˜¯å¦å¯ä¼ è¾“æ— é˜»å¡æ•°æ®ã€çš„æ–‡ä»¶æè¿°ç¬¦æ³¨å†Œåˆ° fd_set å‹å˜é‡ï¼Œå¹¶ä¼ é€’å…¶åœ°å€å€¼ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">exceptset: å°†æ‰€æœ‰å…³æ³¨ã€Œæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ã€çš„æ–‡ä»¶æè¿°ç¬¦æ³¨å†Œåˆ° fd_set å‹å˜é‡ï¼Œå¹¶ä¼ é€’å…¶åœ°å€å€¼ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">timeout: è°ƒç”¨ select å‡½æ•°åï¼Œä¸ºé˜²æ­¢é™·å…¥æ— é™é˜»å¡çš„çŠ¶æ€ï¼Œä¼ é€’è¶…æ—¶(time-out)ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">è¿”å›å€¼: å‘ç”Ÿé”™è¯¯æ—¶è¿”å› -1,è¶…æ—¶æ—¶è¿”å›0,ã€‚å› å‘ç”Ÿå…³æ³¨çš„æ—¶é—´è¿”å›æ—¶ï¼Œè¿”å›å¤§äº0çš„å€¼ï¼Œè¯¥å€¼æ˜¯å‘ç”Ÿäº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦æ•°ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚ä¸Šæ‰€è¿°ï¼Œselect å‡½æ•°ç”¨æ¥éªŒè¯ 3 ç§ç›‘è§†çš„å˜åŒ–æƒ…å†µï¼Œæ ¹æ®ç›‘è§†é¡¹å£°æ˜ 3 ä¸ª fd_set å‹å˜é‡ï¼Œåˆ†åˆ«å‘å…¶æ³¨å†Œæ–‡ä»¶æè¿°ç¬¦ä¿¡æ¯ï¼Œå¹¶æŠŠå˜é‡çš„åœ°å€å€¼ä¼ é€’åˆ°ä¸Šè¿°å‡½æ•°çš„ç¬¬äºŒåˆ°ç¬¬å››ä¸ªå‚æ•°ã€‚ä½†åœ¨æ­¤ä¹‹å‰ï¼ˆè°ƒç”¨ select å‡½æ•°ä¹‹å‰ï¼‰éœ€è¦å†³å®šä¸‹é¢ä¸¤ä»¶äº‹ï¼š&lt;/p>
&lt;ol>
&lt;li>æ–‡ä»¶æè¿°ç¬¦çš„ç›‘è§†ï¼ˆæ£€æŸ¥ï¼‰èŒƒå›´æ˜¯ï¼Ÿ&lt;/li>
&lt;li>å¦‚ä½•è®¾å®š select å‡½æ•°çš„è¶…æ—¶æ—¶é—´ï¼Ÿ&lt;/li>
&lt;/ol>
&lt;p>ç¬¬ä¸€ï¼Œæ–‡ä»¶æè¿°ç¬¦çš„ç›‘è§†èŒƒå›´å’Œ select çš„ç¬¬ä¸€ä¸ªå‚æ•°æœ‰å…³ã€‚å®é™…ä¸Šï¼Œselect å‡½æ•°è¦æ±‚é€šè¿‡ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç›‘è§†å¯¹è±¡æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡ã€‚å› æ­¤ï¼Œéœ€è¦å¾—åˆ°æ³¨å†Œåœ¨ fd_set å˜é‡ä¸­çš„æ–‡ä»¶æè¿°ç¬¦æ•°ã€‚ä½†æ¯æ¬¡æ–°å»ºæ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œå…¶å€¼å°±ä¼šå¢åŠ  1 ï¼Œæ•…åªéœ€**å°†æœ€å¤§çš„æ–‡ä»¶æè¿°ç¬¦å€¼åŠ  1 **å†ä¼ é€’ç»™ select å‡½æ•°å³å¯ã€‚åŠ  1 æ˜¯å› ä¸ºæ–‡ä»¶æè¿°ç¬¦çš„å€¼æ˜¯ä» 0 å¼€å§‹çš„ã€‚&lt;br />ç¬¬äºŒï¼Œselect å‡½æ•°çš„è¶…æ—¶æ—¶é—´ä¸ select å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æœ‰å…³ï¼Œå…¶ä¸­ timeval ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">timeval&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">long&lt;/span> &lt;span class="n">tv_sec&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">long&lt;/span> &lt;span class="n">tv_usec&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æœ¬æ¥ select å‡½æ•°åªæœ‰åœ¨ç›‘è§†æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿå˜åŒ–æ—¶æ‰è¿”å›ã€‚å¦‚æœæœªå‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚æŒ‡å®šè¶…æ—¶æ—¶é—´å°±æ˜¯ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚é€šè¿‡ä¸Šè¿°ç»“æ„ä½“å˜é‡ï¼Œå°†ç§’æ•°å¡«å…¥ tv_sec çš„æˆå‘˜ï¼Œå°†å¾®ç§’æ•°å¡«å…¥ tv_usec çš„æˆå‘˜ï¼Œç„¶åå°†ç»“æ„ä½“çš„åœ°å€å€¼ä¼ é€’åˆ° select å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°ã€‚æ­¤æ—¶ï¼Œå³ä½¿æ–‡ä»¶æè¿°ç¬¦æœªå‘ç”Ÿå˜åŒ–ï¼Œåªè¦è¿‡äº†æŒ‡å®šæ—¶é—´ï¼Œä¹Ÿå¯ä»¥ä»å‡½æ•°ä¸­è¿”å›ã€‚ä¸è¿‡è¿™ç§æƒ…å†µä¸‹ï¼Œ select å‡½æ•°è¿”å› 0 ã€‚å› æ­¤ï¼Œå¯ä»¥é€šè¿‡è¿”å›å€¼äº†è§£åŸå› ã€‚å¦‚æœ&lt;strong>ä¸æƒ³è®¾ç½®è¶…æ—¶ï¼Œåˆ™ä¼ é€’ NULL å‚æ•°&lt;/strong>ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">FD_ZERO&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">reads&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">FD_SET&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">reads&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">fd_max&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">serv_sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cpy_reads&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">reads&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">timeout&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">tv_sec&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">timeout&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">tv_usec&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">fd_num&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd_max&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cpy_reads&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">timeout&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//å¼€å§‹ç›‘è§†,æ¯æ¬¡é‡æ–°ç›‘å¬
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">fd_num&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">fd_max&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">FD_ISSET&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cpy_reads&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">serv_sock&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// ç­‰äºæœåŠ¡å™¨æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">adr_sz&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_adr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clnt_sock&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clnt_adr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">adr_sz&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FD_SET&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">reads&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// åŠ å…¥å®¢æˆ·ç«¯æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">fd_max&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">fd_max&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;connect client: %d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// ç­‰äºå®¢æˆ·ç«¯æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">str_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BUF_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">str_len&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FD_CLR&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">reads&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;close client %d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">str_len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="å¤šç§-io-å‡½æ•°">å¤šç§ I/O å‡½æ•°&lt;/h2>
&lt;h3 id="send--recv-å‡½æ•°">send &amp;amp; recv å‡½æ•°&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="n">ssize_t&lt;/span> &lt;span class="nf">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size_t&lt;/span> &lt;span class="n">nbytes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">flags&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›å‘é€çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sockfd: è¡¨ç¤ºä¸æ•°æ®ä¼ è¾“å¯¹è±¡çš„è¿æ¥çš„å¥—æ¥å­—å’Œæ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">buf: ä¿å­˜å¾…ä¼ è¾“æ•°æ®çš„ç¼“å†²åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">nbytes: å¾…ä¼ è¾“å­—èŠ‚æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">flags: ä¼ è¾“æ•°æ®æ—¶æŒ‡å®šçš„å¯é€‰é¡¹ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ssize_t&lt;/span> &lt;span class="nf">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size_t&lt;/span> &lt;span class="n">nbytes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">flags&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›æ¥æ”¶çš„å­—èŠ‚æ•°ï¼ˆæ”¶åˆ° EOF è¿”å› 0ï¼‰ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sockfd: è¡¨ç¤ºæ•°æ®æ¥å—å¯¹è±¡çš„è¿æ¥çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">buf: ä¿å­˜æ¥å—æ•°æ®çš„ç¼“å†²åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">nbytes: å¯æ¥æ”¶çš„æœ€å¤§å­—èŠ‚æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">flags: æ¥æ”¶æ•°æ®æ—¶æŒ‡å®šçš„å¯é€‰é¡¹å‚æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>send å’Œ recv å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯æ”¶å‘æ•°æ®çš„å¯é€‰é¡¹ï¼Œè¯¥é€‰é¡¹å¯ä»¥ç”¨ä½æˆ–ï¼ˆbit ORï¼‰è¿ç®—ç¬¦åŒæ—¶ä¼ é€’å¤šä¸ªä¿¡æ¯ (MSG_OOB | MSG_PEEK )&lt;br />send &amp;amp; recv å‡½æ•°çš„å¯é€‰é¡¹æ„ä¹‰ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>å¯é€‰é¡¹ï¼ˆOptionï¼‰&lt;/th>
&lt;th>å«ä¹‰&lt;/th>
&lt;th>send&lt;/th>
&lt;th>recv&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>MSG_OOB&lt;/td>
&lt;td>ç”¨äºä¼ è¾“å¸¦å¤–æ•°æ®ï¼ˆOut-of-band dataï¼‰&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>MSG_PEEK&lt;/td>
&lt;td>éªŒè¯è¾“å…¥ç¼“å†²ä¸­æ˜¯å¦å­˜åœ¨æ¥å—çš„æ•°æ®ï¼Œä¸ä¼šæ¸…ç©ºç¼“å†²åŒºæ•°æ®&lt;/td>
&lt;td>X&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>MSG_DONTROUTE&lt;/td>
&lt;td>æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ä¸å‚ç…§æœ¬åœ°è·¯ç”±ï¼ˆRoutingï¼‰è¡¨ï¼Œåœ¨æœ¬åœ°ï¼ˆLocalï¼‰ç½‘ç»œä¸­å¯»æ‰¾ç›®çš„åœ°&lt;/td>
&lt;td>O&lt;/td>
&lt;td>X&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>MSG_DONTWAIT&lt;/td>
&lt;td>è°ƒç”¨ I/O å‡½æ•°æ—¶ä¸é˜»å¡ï¼Œç”¨äºä½¿ç”¨éé˜»å¡ï¼ˆNon-blockingï¼‰I/O&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>MSG_WAITALL&lt;/td>
&lt;td>é˜²æ­¢å‡½æ•°è¿”å›ï¼Œç›´åˆ°æ¥æ”¶åˆ°å…¨éƒ¨è¯·æ±‚çš„å­—èŠ‚æ•°&lt;/td>
&lt;td>X&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4 id="msg_oobå‘é€ç´§æ€¥æ¶ˆæ¯">MSG_OOBï¼šå‘é€ç´§æ€¥æ¶ˆæ¯&lt;/h4>
&lt;p>ä»£ç å‚è€ƒï¼š&lt;br />&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch13/oob_recv.c">https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch13/oob_recv.c&lt;/a>&lt;br />&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch13/oob_send.c">https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch13/oob_send.c&lt;/a>&lt;br />ä»£ç ä¸­å…³äº:&lt;/p>
&lt;blockquote>
&lt;p>fcntl(recv_sock, F_SETOWN, getpid());&lt;/p>
&lt;/blockquote>
&lt;p>çš„æ„æ€æ˜¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>æ–‡ä»¶æè¿°ç¬¦ recv_sock æŒ‡å‘çš„å¥—æ¥å­—å¼•å‘çš„ SIGURG ä¿¡å·å¤„ç†è¿›ç¨‹å˜ä¸º getpid å‡½æ•°è¿”å›å€¼ç”¨ä½œ ID è¿›ç¨‹.&lt;/p>
&lt;/blockquote>
&lt;p>ä¸Šè¿°æè¿°ä¸­çš„ã€Œå¤„ç† SIGURG ä¿¡å·ã€æŒ‡çš„æ˜¯ã€Œè°ƒç”¨ SIGURG ä¿¡å·å¤„ç†å‡½æ•°ã€ã€‚ä½†æ˜¯ä¹‹å‰è®²è¿‡ï¼Œå¤šä¸ªè¿›ç¨‹å¯ä»¥æ‹¥æœ‰ 1 ä¸ªå¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡è°ƒç”¨ fork å‡½æ•°åˆ›å»ºå­è¿›ç¨‹å¹¶åŒæ—¶å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦ã€‚æ­¤æ—¶å¦‚æœå‘ç”Ÿ SIGURG ä¿¡å·ï¼Œåº”è¯¥è°ƒç”¨å“ªä¸ªè¿›ç¨‹çš„ä¿¡å·å¤„ç†å‡½æ•°å‘¢ï¼Ÿå¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œä¸ä¼šè°ƒç”¨æ‰€æœ‰è¿›ç¨‹çš„ä¿¡å·å¤„ç†å‡½æ•°ã€‚å› æ­¤ï¼Œå¤„ç† SIGURG ä¿¡å·æ—¶å¿…é¡»æŒ‡å®šå¤„ç†ä¿¡å·æ‰€ç”¨çš„è¿›ç¨‹ï¼Œè€Œ getpid è¿”å›çš„æ˜¯è°ƒç”¨æ­¤å‡½æ•°çš„è¿›ç¨‹ ID ã€‚ä¸Šè¿°è°ƒç”¨è¯­å¥æŒ‡&lt;strong>å½“å‰ä¸ºå¤„ç† SIGURG ä¿¡å·çš„ä¸»ä½“&lt;/strong>ã€‚&lt;br />è¾“å‡ºç»“æœï¼Œå¯èƒ½å‡ºä¹æ„æ–™ï¼š&lt;/p>
&lt;blockquote>
&lt;p>é€šè¿‡ MSG_OOB å¯é€‰é¡¹ä¼ é€’æ•°æ®æ—¶åªè¿”å› 1 ä¸ªå­—èŠ‚ï¼Œè€Œä¸”ä¹Ÿä¸å¿«&lt;/p>
&lt;/blockquote>
&lt;p>çš„ç¡®ï¼Œé€šè¿‡ MSG_OOB å¹¶ä¸ä¼šåŠ å¿«ä¼ è¾“é€Ÿåº¦ï¼Œè€Œé€šè¿‡ä¿¡å·å¤„ç†å‡½æ•° urg_handler ä¹Ÿåªèƒ½è¯»å–ä¸€ä¸ªå­—èŠ‚ã€‚å‰©ä½™æ•°æ®åªèƒ½é€šè¿‡æœªè®¾ç½® MSG_OOB å¯é€‰é¡¹çš„æ™®é€šè¾“å…¥å‡½æ•°è¯»å–ã€‚å› ä¸º TCP ä¸å­˜åœ¨çœŸæ­£æ„ä¹‰ä¸Šçš„ã€Œå¤–å¸¦æ•°æ®ã€ã€‚å®é™…ä¸Šï¼ŒMSG_OOB ä¸­çš„ OOB æŒ‡çš„æ˜¯ Out-of-band ï¼Œè€Œã€Œå¤–å¸¦æ•°æ®ã€çš„å«ä¹‰æ˜¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>é€šè¿‡å®Œå…¨ä¸åŒçš„é€šä¿¡è·¯å¾„ä¼ è¾“çš„æ•°æ®&lt;/p>
&lt;/blockquote>
&lt;p>å³çœŸæ­£æ„ä¹‰ä¸Šçš„ Out-of-band éœ€è¦é€šè¿‡å•ç‹¬çš„é€šä¿¡è·¯å¾„é«˜é€Ÿä¼ è¾“æ•°æ®ï¼Œä½†æ˜¯ TCP ä¸å¦å¤–æä¾›ï¼Œåªåˆ©ç”¨ TCP çš„ç´§æ€¥æ¨¡å¼ï¼ˆUrgent modeï¼‰è¿›è¡Œä¼ è¾“ã€‚&lt;br />&lt;a href="https://github.com/Rurouni-z/TCP-IP-NetworkNote/tree/master/ch13#1313-%E7%B4%A7%E6%80%A5%E6%A8%A1%E5%BC%8F%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86">ç´§æ€¥æ¨¡å¼å·¥ä½œåŸç†&lt;/a>&lt;br />æŒ‡å®š MSG_OOB é€‰é¡¹çš„æ•°æ®åŒ…æœ¬èº«å°±æ˜¯ç´§æ€¥æ•°æ®åŒ…ï¼Œå¹¶é€šè¿‡ç´§æ€¥æŒ‡é’ˆè¡¨ç¤ºç´§æ€¥æ¶ˆæ¯æ‰€åœ¨çš„ä½ç½®ã€‚&lt;br />ç´§æ€¥æ¶ˆæ¯çš„æ„ä¹‰åœ¨äºç£ä¿ƒæ¶ˆæ¯å¤„ç†ï¼Œè€Œéç´§æ€¥ä¼ è¾“å½¢å¼å—é™çš„ä¿¡æ¯ã€‚&lt;/p>
&lt;h4 id="æ£€æŸ¥è¾“å…¥ç¼“å†²">æ£€æŸ¥è¾“å…¥ç¼“å†²&lt;/h4>
&lt;p>åŒæ—¶è®¾ç½® MSG_PEEK é€‰é¡¹å’Œ MSG_DONTWAIT é€‰é¡¹ï¼Œä»¥éªŒè¯è¾“å…¥ç¼“å†²æ˜¯å¦å­˜åœ¨æ¥æ”¶çš„æ•°æ®ã€‚è®¾ç½® MSG_PEEK é€‰é¡¹å¹¶è°ƒç”¨ recv å‡½æ•°æ—¶ï¼Œå³ä½¿&lt;strong>è¯»å–äº†è¾“å…¥ç¼“å†²çš„æ•°æ®ä¹Ÿä¸ä¼šåˆ é™¤&lt;/strong>ã€‚å› æ­¤ï¼Œè¯¥é€‰é¡¹é€šå¸¸ä¸ MSG_DONTWAIT ï¼ˆä¼šåˆ é™¤æ•°æ®ï¼‰åˆä½œï¼Œç”¨äºä»¥éé˜»å¡æ–¹å¼éªŒè¯å¾…è¯»æ•°æ®å­˜åœ¨ä¸å¦ã€‚&lt;/p>
&lt;h3 id="readv--writev-å‡½æ•°">readv &amp;amp; writev å‡½æ•°&lt;/h3>
&lt;p>readv &amp;amp; writev å‡½æ•°çš„åŠŸèƒ½å¯æ¦‚æ‹¬å¦‚ä¸‹ï¼š&lt;/p>
&lt;blockquote>
&lt;p>å¯¹æ•°æ®è¿›è¡Œæ•´åˆä¼ è¾“åŠå‘é€çš„å‡½æ•°&lt;/p>
&lt;/blockquote>
&lt;p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ writev å‡½æ•°å¯ä»¥å°†åˆ†æ•£ä¿å­˜åœ¨å¤šä¸ªç¼“å†²ä¸­çš„æ•°æ®ä¸€å¹¶å‘é€ï¼Œé€šè¿‡ readv å‡½æ•°å¯ä»¥ç”±å¤šä¸ªç¼“å†²åˆ†åˆ«æ¥æ”¶ã€‚å› æ­¤ï¼Œä½¿ç”¨è¿™ 2 ä¸ªå‡½æ•°å¯ä»¥å‡å°‘ I/O å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°ã€‚&lt;/p>
&lt;h4 id="writev-å‡½æ•°">writev å‡½æ•°&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/uio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="n">ssize_t&lt;/span> &lt;span class="nf">writev&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">filedes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">iovec&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">iov&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">iovcnt&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›å‘é€çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">filedes: è¡¨ç¤ºæ•°æ®ä¼ è¾“å¯¹è±¡çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ã€‚ä½†è¯¥å‡½æ•°å¹¶ä¸ä»…é™äºå¥—æ¥å­—ï¼Œå› æ­¤ï¼Œå¯ä»¥åƒ read ä¸€æ ·å‘å‘å…¶ä¼ é€’æ–‡ä»¶æˆ–æ ‡å‡†è¾“å‡ºæè¿°ç¬¦.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">iov: iovec ç»“æ„ä½“æ•°ç»„çš„åœ°å€å€¼ï¼Œç»“æ„ä½“ iovec ä¸­åŒ…å«å¾…å‘é€æ•°æ®çš„ä½ç½®å’Œå¤§å°ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">iovcnt: å‘ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’æ•°ç»„é•¿åº¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">iovec&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">iov_base&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//ç¼“å†²åœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">size_t&lt;/span> &lt;span class="n">iov_len&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//ç¼“å†²å¤§å°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-7.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />writev çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œå› æ­¤â€˜1â€™ä»£è¡¨å‘æ§åˆ¶å°è¾“å‡ºæ•°æ®ï¼Œptr æ˜¯å­˜æœ‰å¾…å‘é€æ•°æ®ä¿¡æ¯çš„ iovec æ•°ç»„æŒ‡é’ˆã€‚ç¬¬ä¸‰ä¸ªå‚æ•°ä¸º 2ï¼Œå› æ­¤ï¼Œä» ptr æŒ‡å‘çš„åœ°å€å¼€å§‹ï¼Œå…±æµè§ˆ 2 ä¸ª iovec ç»“æ„ä½“å˜é‡ï¼Œå‘é€è¿™äº›æŒ‡é’ˆæŒ‡å‘çš„ç¼“å†²æ•°æ®ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/uio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">iovec&lt;/span> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">buf1&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;ABCDEFG&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">buf2&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;1234567&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">str_len&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">iov_base&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">buf1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">iov_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">iov_base&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">buf2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">iov_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">str_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">writev&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">vec&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Write bytes: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">str_len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="readv-å‡½æ•°">readv å‡½æ•°&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/uio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="n">ssize_t&lt;/span> &lt;span class="nf">readv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">filedes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">iovc&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">iov&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">iovcnt&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›æ¥æ”¶çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">filedes: è¡¨ç¤ºæ•°æ®ä¼ è¾“å¯¹è±¡çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ã€‚ä½†è¯¥å‡½æ•°å¹¶ä¸ä»…é™äºå¥—æ¥å­—ï¼Œå› æ­¤ï¼Œå¯ä»¥åƒ write ä¸€æ ·å‘å‘å…¶ä¼ é€’æ–‡ä»¶æˆ–æ ‡å‡†è¾“å‡ºæè¿°ç¬¦.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">iov: iovec ç»“æ„ä½“æ•°ç»„çš„åœ°å€å€¼ï¼Œç»“æ„ä½“ iovec ä¸­åŒ…å«å¾…æ•°æ®ä¿å­˜çš„ä½ç½®å’Œå¤§å°ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">iovcnt: ç¬¬äºŒä¸ªå‚æ•°ä¸­æ•°ç»„çš„é•¿åº¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/uio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define BUF_SIZE 100
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">iovec&lt;/span> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">buf1&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">BUF_SIZE&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">buf2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">BUF_SIZE&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">str_len&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">iov_base&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">buf1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">iov_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å…ˆæ”¶å–5ä¸ª
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">iov_base&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">buf2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">vec&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">iov_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">BUF_SIZE&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å†æ¥æ”¶å‰©ä¸‹100ä¸ª
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// 0 æ§åˆ¶å°è¾“å…¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">str_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">readv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">vec&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Read bytes: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">str_len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;First message: %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Second message: %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="åˆç†ä½¿ç”¨-readv--writev-å‡½æ•°">åˆç†ä½¿ç”¨ readv &amp;amp; writev å‡½æ•°&lt;/h4>
&lt;p>å®é™…ä¸Šï¼Œèƒ½ä½¿ç”¨è¯¥å‡½æ•°çš„æ‰€æœ‰æƒ…å†µéƒ½é€‚ç”¨ã€‚ä¾‹å¦‚ï¼Œéœ€è¦ä¼ è¾“çš„æ•°æ®åˆ†åˆ«ä½äºä¸åŒç¼“å†²ï¼ˆæ•°ç»„ï¼‰æ—¶ï¼Œéœ€è¦å¤šæ¬¡è°ƒç”¨ write å‡½æ•°ã€‚æ­¤æ—¶å¯é€šè¿‡ 1 æ¬¡ writev å‡½æ•°è°ƒç”¨æ›¿ä»£æ“ä½œï¼Œå½“ç„¶ä¼šæé«˜æ•ˆç‡ã€‚åŒæ ·ï¼Œéœ€è¦å°†è¾“å…¥ç¼“å†²ä¸­çš„æ•°æ®è¯»å…¥ä¸åŒä½ç½®æ—¶ï¼Œå¯ä»¥ä¸å¿…å¤šæ¬¡è°ƒç”¨ read å‡½æ•°ï¼Œè€Œæ˜¯åˆ©ç”¨ 1 æ¬¡ readv å‡½æ•°å°±èƒ½å¤§å¤§æé«˜æ•ˆç‡ã€‚&lt;br />å…¶æ„ä¹‰åœ¨äº&lt;strong>å‡å°‘æ•°æ®åŒ…ä¸ªæ•°&lt;/strong>ã€‚å‡è®¾ä¸ºäº†æé«˜æ•ˆç‡åœ¨æœåŠ¡å™¨ç«¯æ˜ç¡®ç¦ç”¨äº† Nagle ç®—æ³•ã€‚å…¶å® writev å‡½æ•°åœ¨ä¸é‡‡ç”¨ Nagle ç®—æ³•æ—¶æ›´æœ‰ä»·å€¼ï¼Œå¦‚å›¾ï¼š&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-8.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/p>
&lt;h2 id="å¤šæ’­ä¸å¹¿æ’­">å¤šæ’­ä¸å¹¿æ’­&lt;/h2>
&lt;h3 id="å¤šæ’­">å¤šæ’­&lt;/h3>
&lt;p>å¤šæ’­ï¼ˆMulticastï¼‰æ–¹å¼çš„æ•°æ®ä¼ è¾“æ˜¯&lt;strong>åŸºäº UDP &lt;strong>å®Œæˆçš„ã€‚å› æ­¤ ï¼Œä¸ UDP æœåŠ¡å™¨ç«¯/å®¢æˆ·ç«¯çš„å®ç°æ–¹å¼éå¸¸æ¥è¿‘ã€‚åŒºåˆ«åœ¨äºï¼ŒUDP æ•°æ®ä¼ è¾“ä»¥å•ä¸€ç›®æ ‡è¿›è¡Œï¼Œè€Œå¤šæ’­æ•°æ®åŒæ—¶ä¼ é€’åˆ°åŠ å…¥ï¼ˆæ³¨å†Œï¼‰ç‰¹å®šç»„çš„å¤§é‡ä¸»æœºã€‚æ¢è¨€ä¹‹ï¼Œé‡‡ç”¨å¤šæ’­æ–¹å¼æ—¶ï¼Œå¯ä»¥&lt;/strong>åŒæ—¶å‘å¤šä¸ªä¸»æœºä¼ é€’æ•°æ®&lt;/strong>ã€‚&lt;/p>
&lt;h4 id="å¤šæ’­çš„æ•°æ®ä¼ è¾“æ–¹å¼ä»¥åŠæµé‡æ–¹é¢çš„ä¼˜ç‚¹">å¤šæ’­çš„æ•°æ®ä¼ è¾“æ–¹å¼ä»¥åŠæµé‡æ–¹é¢çš„ä¼˜ç‚¹&lt;/h4>
&lt;p>å¤šæ’­çš„æ•°æ®ä¼ è¾“ç‰¹ç‚¹å¯æ•´ç†å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>å¤šæ’­&lt;strong>æœåŠ¡å™¨ç«¯&lt;/strong>é’ˆå¯¹ç‰¹å®šå¤šæ’­ç»„ï¼Œåª&lt;strong>å‘é€ 1 æ¬¡&lt;/strong>æ•°æ®ã€‚&lt;/li>
&lt;li>å³ä½¿åªå‘é€ 1 æ¬¡æ•°æ®ï¼Œä½†è¯¥ç»„å†…çš„æ‰€æœ‰å®¢æˆ·ç«¯&lt;strong>éƒ½ä¼šæ¥æ”¶æ•°æ®&lt;/strong>&lt;/li>
&lt;li>å¤šæ’­ç»„æ•°å¯ä»¥åœ¨ IP åœ°å€èŒƒå›´å†…ä»»æ„å¢åŠ &lt;/li>
&lt;/ul>
&lt;p>å¤šæ’­ç»„æ˜¯ D ç±»IPåœ°å€ï¼ˆ224.0.0.0~239.255.255.255ï¼‰ï¼Œã€ŒåŠ å…¥å¤šæ’­ç»„ã€å¯ä»¥ç†è§£ä¸ºé€šè¿‡ç¨‹åºå®Œæˆå¦‚ä¸‹å£°æ˜ï¼š&lt;/p>
&lt;blockquote>
&lt;p>åœ¨ D ç±»IPåœ°å€ä¸­ï¼Œæˆ‘å¸Œæœ›æ¥æ”¶å‘å¾€ç›®æ ‡ 239.234.218.234 çš„å¤šæ’­æ•°æ®&lt;/p>
&lt;/blockquote>
&lt;p>å¤šæ’­æ˜¯åŸºäº UDP å®Œæˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¤šæ’­æ•°æ®åŒ…çš„æ ¼å¼ä¸ UDP æ•°æ®åŒ…ç›¸åŒã€‚åªæ˜¯ä¸ä¸€èˆ¬çš„ UDP æ•°æ®åŒ…ä¸åŒã€‚å‘ç½‘ç»œä¼ é€’ 1 ä¸ªå¤šæ’­æ•°æ®åŒ…æ—¶ï¼Œè·¯ç”±å™¨å°†å¤åˆ¶è¯¥æ•°æ®åŒ…å¹¶ä¼ é€’åˆ°å¤šä¸ªä¸»æœºã€‚åƒè¿™æ ·ï¼Œå¤šæ’­éœ€è¦å€ŸåŠ©è·¯ç”±å™¨å®Œæˆã€‚å¦‚å›¾æ‰€ç¤ºï¼š&lt;br />&lt;a href="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-9.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5">&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-9.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=FciD5&amp;amp;originHeight=319&amp;amp;originWidth=540&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;/a>&lt;br />è‹¥é€šè¿‡ TCP æˆ– UDP å‘ 1000 ä¸ªä¸»æœºå‘é€æ–‡ä»¶ï¼Œåˆ™å…±éœ€è¦ä¼ é€’ 1000 æ¬¡ã€‚ä½†æ˜¯æ­¤æ—¶å¦‚æœç”¨å¤šæ’­ç½‘ç»œä¼ è¾“æ–‡ä»¶ï¼Œåˆ™åªéœ€è¦å‘é€ä¸€æ¬¡ã€‚è¿™æ—¶ç”± 1000 å°ä¸»æœºæ„æˆçš„ç½‘ç»œä¸­çš„è·¯ç”±å™¨è´Ÿè´£å¤åˆ¶æ–‡ä»¶å¹¶ä¼ é€’åˆ°ä¸»æœºã€‚å°±å› ä¸ºè¿™ç§ç‰¹æ€§ï¼Œå¤šæ’­ä¸»è¦ç”¨äºã€Œ&lt;strong>å¤šåª’ä½“æ•°æ®å®æ—¶ä¼ è¾“&lt;/strong>ã€ã€‚&lt;br />å¦å¤–ï¼Œç†è®ºä¸Šå¯ä»¥å®Œæˆå¤šæ’­é€šä¿¡ï¼Œä½†æ˜¯ä¸å°‘è·¯ç”±å™¨å¹¶ä¸æ”¯æŒå¤šæ’­ï¼Œæˆ–å³ä¾¿æ”¯æŒä¹Ÿå› ç½‘ç»œæ‹¥å µé—®é¢˜æ•…æ„é˜»æ–­å¤šæ’­ã€‚å› æ­¤ï¼Œä¸ºäº†åœ¨ä¸æ”¯æŒå¤šæ’­çš„è·¯ç”±å™¨ä¸­å®Œæˆå¤šæ’­é€šä¿¡ï¼Œä¹Ÿä¼š&lt;strong>ä½¿ç”¨éš§é“ï¼ˆTunnelingï¼‰æŠ€æœ¯&lt;/strong>ã€‚&lt;/p>
&lt;h4 id="è·¯ç”±routingå’Œ-ttltime-to-liveç”Ÿå­˜æ—¶é—´ä»¥åŠåŠ å…¥ç»„çš„åŠæ³•">è·¯ç”±ï¼ˆRoutingï¼‰å’Œ TTLï¼ˆTime to Live,ç”Ÿå­˜æ—¶é—´ï¼‰ï¼Œä»¥åŠåŠ å…¥ç»„çš„åŠæ³•&lt;/h4>
&lt;p>ä¸ºäº†ä¼ é€’å¤šæ’­æ•°æ®åŒ…ï¼Œå¿…é¡»è®¾ç½® TTL ã€‚TTL æ˜¯ Time to Liveçš„ç®€å†™ï¼Œæ˜¯å†³å®šã€Œæ•°æ®åŒ…ä¼ é€’è·ç¦»ã€çš„ä¸»è¦å› ç´ ã€‚TTL ç”¨æ•´æ•°è¡¨ç¤ºï¼Œå¹¶ä¸”&lt;strong>æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨å°±å‡ä¸€&lt;/strong>ã€‚TTL å˜ä¸º 0 æ—¶ï¼Œè¯¥æ•°æ®åŒ…å°±æ— æ³•å†è¢«ä¼ é€’ï¼Œåªèƒ½é”€æ¯ã€‚å› æ­¤ï¼ŒTTL çš„å€¼è®¾ç½®è¿‡å¤§å°†å½±å“ç½‘ç»œæµé‡ã€‚å½“ç„¶ï¼Œè®¾ç½®è¿‡å°ï¼Œä¹Ÿæ— æ³•ä¼ é€’åˆ°ç›®æ ‡ã€‚&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-10.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />TTL æ˜¯å¯ä»¥é€šè¿‡ç¬¬ä¹ç« çš„å¥—æ¥å­—å¯é€‰é¡¹å®Œæˆçš„ã€‚ä¸è®¾ç½® TTL ç›¸å…³çš„åè®®å±‚ä¸º IPPROTO_IP ï¼Œé€‰é¡¹åä¸º IP_MULTICAST_TTLã€‚ç”¨å¦‚ä¸‹ä»£ç æŠŠ TTL è®¾ç½®ä¸º 64:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">send_sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">time_live&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">64&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_sock&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PF_INET&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">SOCK_DGRAM&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">send_sock&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">IPPROTO_IP&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">IP_MULTICAST_TTL&lt;/span>&lt;span class="p">,(&lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">time_live&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">time_live&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åŠ å…¥å¤šæ’­ç»„ä¹Ÿé€šè¿‡è®¾ç½®å¥—æ¥å­—å¯é€‰é¡¹æ¥å®Œæˆã€‚åŠ å…¥å¤šæ’­ç»„ç›¸å…³çš„åè®®å±‚ä¹Ÿä¸º IPPROTO_IPï¼Œé€‰é¡¹åä¸º IP_ADD_MEMBERSHIP ã€‚å¯é€šè¿‡å¦‚ä¸‹ä»£ç åŠ å…¥å¤šæ’­ç»„ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">recv_sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">ip_mreq&lt;/span> &lt;span class="n">join_adr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">recv_sock&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PF_INET&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">SOCK_DGRAM&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">join_adr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">imr_multiaddr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;å¤šæ’­ç»„åœ°å€ä¿¡æ¯&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">join_adr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">imr_interface&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;åŠ å…¥å¤šæ’­ç»„çš„ä¸»æœºåœ°å€ä¿¡æ¯&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">recv_sock&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">IPPROTO_IP&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">IP_ADD_MEMBERSHIP&lt;/span>&lt;span class="p">,(&lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">join_adr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">join_adr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">ip_mreq&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">in_addr&lt;/span> &lt;span class="n">imr_multiaddr&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å¤šæ’­ç»„çš„IPåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">in_addr&lt;/span> &lt;span class="n">imr_interface&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å¾…åŠ å…¥çš„IPåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="å®ç°å¤šæ’­-sender-å’Œ-receiver">å®ç°å¤šæ’­ Sender å’Œ Receiver&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch14/news_sender.c">news_sender.c&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch14/news_receiver.c">news_receiver.c&lt;/a>&lt;/li>
&lt;li>ä»£ç ä¸­recviverä¸ä¼šåœæ­¢ï¼Œé˜»å¡ç­‰å¾…senderæ¶ˆæ¯&lt;/li>
&lt;li>å»¶è¿Ÿè¿è¡Œ receiver å°†æ— æ³•æ¥å—ä¹‹å‰å‘é€çš„ä¿¡æ¯ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="å¹¿æ’­">å¹¿æ’­&lt;/h3>
&lt;p>å¤šæ’­å³ä½¿åœ¨è·¨è¶Šä¸åŒç½‘ç»œçš„æƒ…å†µä¸‹ï¼Œåªè¦åŠ å…¥å¤šæ’­ç»„å°±èƒ½æ¥å—æ•°æ®ã€‚ç›¸åï¼Œå¹¿æ’­åªèƒ½å‘åŒä¸€ç½‘ç»œä¸­çš„ä¸»æœºä¼ è¾“æ•°æ®ã€‚å¤šæ’­ä¼ è¾“æ•°æ®çš„èŒƒå›´æœ‰åŒºåˆ«ã€‚&lt;/p>
&lt;h4 id="å¹¿æ’­çš„ç†è§£å’Œå®ç°æ–¹å¼">å¹¿æ’­çš„ç†è§£å’Œå®ç°æ–¹å¼&lt;/h4>
&lt;p>å¹¿æ’­æ˜¯å‘åŒä¸€ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºä¼ è¾“æ•°æ®çš„æ–¹æ³•ã€‚ä¸å¤šæ’­ç›¸åŒï¼Œå¹¿æ’­ä¹Ÿæ˜¯é€šè¿‡ UDP æ¥å®Œæˆçš„ã€‚æ ¹æ®ä¼ è¾“æ•°æ®æ—¶ä½¿ç”¨çš„IPåœ°å€å½¢å¼ï¼Œå¹¿æ’­åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§ï¼š&lt;/p>
&lt;ul>
&lt;li>ç›´æ¥å¹¿æ’­ï¼ˆDirected Broadcastï¼‰&lt;/li>
&lt;li>æœ¬åœ°å¹¿æ’­ï¼ˆLocal Broadcastï¼‰&lt;/li>
&lt;/ul>
&lt;p>äºŒè€…åœ¨å®ç°ä¸Šçš„å·®åˆ«ä¸»è¦åœ¨äºIPåœ°å€ã€‚ç›´æ¥å¹¿æ’­çš„IPåœ°å€ä¸­é™¤äº†ç½‘ç»œåœ°å€å¤–ï¼Œ&lt;strong>å…¶ä½™ä¸»æœºåœ°å€å…¨éƒ¨è®¾ç½®æˆ 1&lt;/strong>ã€‚ä¾‹å¦‚ï¼Œå¸Œæœ›å‘ç½‘ç»œåœ°å€ 192.12.34 ä¸­çš„æ‰€æœ‰ä¸»æœºä¼ è¾“æ•°æ®æ—¶ï¼Œå¯ä»¥å‘ 192.12.34.255 ä¼ è¾“ã€‚æ¢è¨€ä¹‹ï¼Œå¯ä»¥é‡‡å–ç›´æ¥å¹¿æ’­çš„æ–¹å¼&lt;strong>å‘ç‰¹å®šåŒºåŸŸå†…æ‰€æœ‰ä¸»æœºä¼ è¾“æ•°æ®&lt;/strong>ã€‚&lt;br />åä¹‹ï¼Œæœ¬åœ°å¹¿æ’­ä¸­ä½¿ç”¨çš„IPåœ°å€é™å®šä¸º 255.255.255.255 ã€‚ä¾‹å¦‚ï¼Œ192.32.24 &lt;strong>ç½‘ç»œä¸­çš„ä¸»æœº&lt;/strong>å‘ 255.255.255.255 ä¼ è¾“æ•°æ®æ—¶ï¼Œæ•°æ®å°†ä¼ è¾“åˆ° 192.32.24 &lt;strong>ç½‘ç»œä¸­æ‰€æœ‰ä¸»æœº&lt;/strong>ã€‚&lt;br />&lt;strong>æ•°æ®é€šä¿¡ä¸­ä½¿ç”¨çš„IPåœ°å€æ˜¯ä¸ UDP ç¤ºä¾‹çš„å”¯ä¸€åŒºåˆ«ã€‚é»˜è®¤ç”Ÿæˆçš„å¥—æ¥å­—ä¼šé˜»æ­¢å¹¿æ’­ï¼Œå› æ­¤ï¼Œåªéœ€é€šè¿‡å¦‚ä¸‹ä»£ç æ›´æ”¹é»˜è®¤è®¾ç½®ã€‚&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">send_sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">bcast&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">send_sock&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PF_INET&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">SOCK_DGRAM&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">send_sock&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">SO_BROADCAST&lt;/span>&lt;span class="p">,(&lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">bcast&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bcast&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸‹é¢æ˜¯å¹¿æ’­æ•°æ®çš„ Sender å’Œ Receiverçš„ä»£ç ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch14/news_sender_brd.c">news_sender_brd.c&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch14/news_receiver_brd.c">news_receiver_brd.c&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="å¥—æ¥å­—å’Œæ ‡å‡†io">å¥—æ¥å­—å’Œæ ‡å‡†I/O&lt;/h2>
&lt;h3 id="æ ‡å‡†-io-çš„ä¼˜ç¼ºç‚¹">æ ‡å‡† I/O çš„ä¼˜ç¼ºç‚¹&lt;/h3>
&lt;ul>
&lt;li>ä¼˜ç‚¹
&lt;ul>
&lt;li>æ ‡å‡† I/O å‡½æ•°å…·æœ‰è‰¯å¥½çš„ç§»æ¤æ€§&lt;/li>
&lt;li>æ ‡å‡† I/O å‡½æ•°å¯ä»¥åˆ©ç”¨ç¼“å†²æé«˜æ€§èƒ½&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç¼ºç‚¹
&lt;ul>
&lt;li>ä¸å®¹æ˜“è¿›è¡ŒåŒå‘é€šä¿¡&lt;/li>
&lt;li>æœ‰æ—¶å¯èƒ½é¢‘ç¹è°ƒç”¨ fflush å‡½æ•°&lt;/li>
&lt;li>éœ€è¦ä»¥ FILE ç»“æ„ä½“æŒ‡é’ˆçš„å½¢å¼è¿”å›æ–‡ä»¶æè¿°ç¬¦ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>åˆ›å»ºå¥—æ¥å­—æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå‡†å¤‡ I/O ç¼“å†²ã€‚æ­¤ç¼“å†²åœ¨æ‰§è¡Œ TCP åè®®æ—¶å‘æŒ¥ç€éå¸¸é‡è¦çš„ä½œç”¨ã€‚æ­¤æ—¶è‹¥ä½¿ç”¨æ ‡å‡† I/O å‡½æ•°ï¼Œå°†å¾—åˆ°&lt;strong>é¢å¤–çš„ç¼“å†²æ”¯æŒ&lt;/strong>ã€‚å¦‚ä¸‹å›¾ï¼š&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-11.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />å‡è®¾ä½¿ç”¨ fputs å‡½æ•°è¿›è¡Œä¼ è¾“å­—ç¬¦ä¸² ã€ŒHelloã€æ—¶ï¼Œé¦–å…ˆå°†æ•°æ®ä¼ é€’åˆ°æ ‡å‡† I/O ç¼“å†²ï¼Œç„¶åå°†æ•°æ®ç§»åŠ¨åˆ°å¥—æ¥å­—è¾“å‡ºç¼“å†²ï¼Œæœ€åfflushå°†å­—ç¬¦ä¸²å‘é€åˆ°å¯¹æ–¹ä¸»æœºã€‚&lt;/p>
&lt;h3 id="ä½¿ç”¨æ ‡å‡†-io-å‡½æ•°">ä½¿ç”¨æ ‡å‡† I/O å‡½æ•°&lt;/h3>
&lt;h4 id="åˆ©ç”¨-fdopen-å‡½æ•°è½¬æ¢ä¸º-file-ç»“æ„ä½“æŒ‡é’ˆ">åˆ©ç”¨ fdopen å‡½æ•°è½¬æ¢ä¸º FILE ç»“æ„ä½“æŒ‡é’ˆ&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="n">FILE&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nf">fdopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fildes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">mode&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">å°†æ–‡ä»¶æè¿°ç¬¦è½¬æ¢ä¸ºæ ‡å‡†IO
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›è½¬æ¢çš„ FILE ç»“æ„ä½“æŒ‡é’ˆï¼Œå¤±è´¥æ—¶è¿”å› NULL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">fildes ï¼š éœ€è¦è½¬æ¢çš„æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">mode ï¼š å°†è¦åˆ›å»ºçš„ FILE ç»“æ„ä½“æŒ‡é’ˆçš„æ¨¡å¼ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="åˆ©ç”¨-fileno-å‡½æ•°è½¬æ¢ä¸ºæ–‡ä»¶æè¿°ç¬¦">åˆ©ç”¨ fileno å‡½æ•°è½¬æ¢ä¸ºæ–‡ä»¶æè¿°ç¬¦&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">fileno&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">FILE&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">stream&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="åŸºäºå¥—æ¥å­—çš„æ ‡å‡†-io-å‡½æ•°ä½¿ç”¨">åŸºäºå¥—æ¥å­—çš„æ ‡å‡† I/O å‡½æ•°ä½¿ç”¨&lt;/h3>
&lt;p>æŠŠç¬¬å››ç« çš„å›å£°å®¢æˆ·ç«¯å’Œå›å£°æœåŠ¡ç«¯çš„å†…å®¹æ”¹ä¸ºåŸºäºæ ‡å‡† I/O å‡½æ•°çš„æ•°æ®äº¤æ¢å½¢å¼ã€‚&lt;br />ä»£ç å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch15/echo_client.c">echo_client.c&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch15/echo_stdserv.c">echo_stdserv.c&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="io-æµåˆ†ç¦»çš„å…¶ä»–å†…å®¹">I/O æµåˆ†ç¦»çš„å…¶ä»–å†…å®¹&lt;/h2>
&lt;p>ä¹‹å‰ä¸¤ç§åˆ†ç¦»æ–¹æ³•ï¼š&lt;/p>
&lt;ul>
&lt;li>ç¬¬ä¸€ç§æ˜¯ã€ŒTCP I/O è¿‡ç¨‹ã€åˆ†ç¦»ã€‚é€šè¿‡&lt;strong>è°ƒç”¨ fork å‡½æ•°&lt;/strong>å¤åˆ¶å‡ºä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œä»¥åŒºåˆ†è¾“å…¥å’Œè¾“å‡ºä¸­ä½¿ç”¨çš„æ–‡ä»¶æè¿°ç¬¦ã€‚è™½ç„¶æ–‡ä»¶æè¿°ç¬¦æœ¬èº«ä¸ä¼šæ ¹æ®è¾“å…¥å’Œè¾“å‡ºè¿›è¡ŒåŒºåˆ†ï¼Œä½†æˆ‘ä»¬åˆ†å¼€äº† 2 ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„ç”¨é€”ï¼Œå› æ­¤ï¼Œè¿™ä¹Ÿå±äºã€Œæµã€çš„åˆ†ç¦»ã€‚&lt;/li>
&lt;li>ç¬¬äºŒç§åˆ†ç¦»æ˜¯é€šè¿‡ 2 æ¬¡&lt;strong>è°ƒç”¨fdopen å‡½æ•°&lt;/strong>ï¼Œåˆ›å»ºè¯»æ¨¡å¼ FILE æŒ‡é’ˆï¼ˆFILE ç»“æ„ä½“æŒ‡é’ˆï¼‰å’Œå†™æ¨¡å¼ FILE æŒ‡é’ˆã€‚æ¢è¨€ä¹‹ï¼Œæˆ‘ä»¬åˆ†ç¦»äº†è¾“å…¥å·¥å…·å’Œè¾“å‡ºå·¥å…·ï¼Œå› æ­¤ä¹Ÿå¯è§†ä¸ºã€Œæµã€çš„åˆ†ç¦»ã€‚ä¸‹é¢æ˜¯åˆ†ç¦»çš„ç†ç”±ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="åˆ†ç¦»æµçš„å¥½å¤„">åˆ†ç¦»ã€Œæµã€çš„å¥½å¤„&lt;/h4>
&lt;p>é¦–å…ˆæ˜¯forkçš„åˆ†ç¦»ç›®çš„ï¼š&lt;/p>
&lt;ul>
&lt;li>é€šè¿‡åˆ†å¼€è¾“å…¥è¿‡ç¨‹ï¼ˆä»£ç ï¼‰å’Œè¾“å‡ºè¿‡ç¨‹é™ä½å®ç°éš¾åº¦&lt;/li>
&lt;li>ä¸è¾“å…¥æ— å…³çš„è¾“å‡ºæ“ä½œå¯ä»¥æé«˜é€Ÿåº¦&lt;/li>
&lt;/ul>
&lt;p>ä¸‹é¢æ˜¯fdopenåˆ†ç¦»çš„ç›®çš„ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸ºäº†å°† FILE æŒ‡é’ˆæŒ‰è¯»æ¨¡å¼å’Œå†™æ¨¡å¼åŠ ä»¥åŒºåˆ†&lt;/li>
&lt;li>å¯ä»¥é€šè¿‡åŒºåˆ†è¯»å†™æ¨¡å¼é™ä½å®ç°éš¾åº¦&lt;/li>
&lt;li>é€šè¿‡åŒºåˆ† I/O ç¼“å†²æé«˜ç¼“å†²æ€§èƒ½&lt;/li>
&lt;/ul>
&lt;h4 id="æµåˆ†ç¦»å¸¦æ¥çš„-eof-é—®é¢˜">ã€Œæµã€åˆ†ç¦»å¸¦æ¥çš„ EOF é—®é¢˜&lt;/h4>
&lt;p>close()ä¸€ä¸ªfdopenä¼šå…³é—­æ•´ä¸ªå¥—æ¥å­—&lt;br />&lt;img src="https://cdn.nlark.com/yuque/0/2023/png/12600461/1689249181825-0c3d1dcb-c148-4a37-895c-3847e35814bf.png#averageHue=%23d5d5d5&amp;amp;clientId=ud362a5e0-75d0-4&amp;amp;from=paste&amp;amp;height=165&amp;amp;id=u340713e9&amp;amp;originHeight=198&amp;amp;originWidth=470&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=70970&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=udc8d66f8-5e2c-407e-a380-e88a9cae3d2&amp;amp;title=&amp;amp;width=391.6666666666667" alt="å›¾ç‰‡.png">&lt;br />&lt;img src="https://cdn.nlark.com/yuque/0/2023/png/12600461/1689249194614-bbc5b267-3632-412f-8403-8be5fd246c3d.png#averageHue=%23d6d6d6&amp;amp;clientId=ud362a5e0-75d0-4&amp;amp;from=paste&amp;amp;height=174&amp;amp;id=ubec88290&amp;amp;originHeight=209&amp;amp;originWidth=463&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=80887&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u58c328a6-bafc-40a1-b08b-011ea96fef9&amp;amp;title=&amp;amp;width=385.83333333333337" alt="å›¾ç‰‡.png">&lt;br />åªéœ€è¦åˆ›å»º FILE æŒ‡é’ˆå‰&lt;strong>å…ˆå¤åˆ¶æ–‡ä»¶æè¿°ç¬¦&lt;/strong>å³å¯ã€‚å¤åˆ¶åå¦å¤–åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œç„¶ååˆ©ç”¨å„è‡ªçš„æ–‡ä»¶æè¿°ç¬¦ç”Ÿæˆè¯»æ¨¡å¼çš„ FILE æŒ‡é’ˆå’Œå†™æ¨¡å¼çš„ FILE æŒ‡é’ˆã€‚&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-12.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />è¿™å°±ä¸ºåŠå…³é—­åˆ›é€ å¥½äº†ç¯å¢ƒï¼Œå› ä¸ºå¥—æ¥å­—å’Œæ–‡ä»¶æè¿°ç¬¦å…·æœ‰å¦‚ä¸‹å…³ç³»ï¼š&lt;/p>
&lt;blockquote>
&lt;p>é”€æ¯æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦å€™æ‰èƒ½é”€æ¯å¥—æ¥å­—&lt;/p>
&lt;/blockquote>
&lt;p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé’ˆå¯¹å†™æ¨¡å¼ FILE æŒ‡é’ˆè°ƒç”¨ fclose å‡½æ•°æ—¶ï¼Œåªèƒ½é”€æ¯ä¸è¯¥ FILE æŒ‡é’ˆç›¸å…³çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ— æ³•é”€æ¯å¥—æ¥å­—ã€‚&lt;br />é‚£ä¹ˆè°ƒç”¨ fclose å‡½æ•°å€™è¿˜å‰©ä¸‹ 1 ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå› æ­¤æ²¡æœ‰é”€æ¯å¥—æ¥å­—ã€‚é‚£æ­¤æ—¶çš„çŠ¶æ€æ˜¯å¦ä¸ºåŠå…³é—­çŠ¶æ€ï¼Ÿä¸æ˜¯ï¼åªæ˜¯å‡†å¤‡å¥½äº†è¿›å…¥åŠå…³é—­çŠ¶æ€ï¼Œè€Œä¸æ˜¯å·²ç»è¿›å…¥äº†åŠå…³é—­çŠ¶æ€ã€‚ä»”ç»†è§‚å¯Ÿï¼Œè¿˜å‰©ä¸‹ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚è€Œè¯¥æ–‡ä»¶æè¿°ç¬¦å¯ä»¥åŒæ—¶è¿›è¡Œ I/O ã€‚å› æ­¤ï¼Œä¸ä½†æ²¡æœ‰å‘é€ EOF ï¼Œè€Œä¸”ä»ç„¶å¯ä»¥åˆ©ç”¨æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œè¾“å‡ºã€‚&lt;/p>
&lt;h5 id="æµçš„åˆ†ç¦»">æµçš„åˆ†ç¦»&lt;/h5>
&lt;ol>
&lt;li>å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦ï¼Œä½¿ç”¨dup/dup2å‡½æ•°&lt;/li>
&lt;/ol>
&lt;p>ä¸è°ƒç”¨ fork å‡½æ•°ä¸åŒï¼Œè°ƒç”¨ fork å‡½æ•°å°†å¤åˆ¶æ•´ä¸ªè¿›ç¨‹ï¼Œæ­¤å¤„è®¨è®ºçš„æ˜¯åŒä¸€è¿›ç¨‹å†…å®Œæˆå¯¹å®Œæˆæè¿°ç¬¦çš„å¤åˆ¶ã€‚å¦‚å›¾ï¼š&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-13.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">dup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fildes&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">dup2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fildes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">fildes2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›å¤åˆ¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">fildes : éœ€è¦å¤åˆ¶çš„æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">fildes2 : æ˜ç¡®æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦çš„æ•´æ•°å€¼ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">dup2 å‡½æ•°æ˜ç¡®æŒ‡å®šå¤åˆ¶çš„æ–‡ä»¶æè¿°ç¬¦çš„æ•´æ•°å€¼ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">å‘å…¶ä¼ é€’å¤§äº 0 ä¸”å°äºè¿›ç¨‹èƒ½ç”Ÿæˆçš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦å€¼æ—¶ï¼Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">è¯¥å€¼å°†æˆä¸ºå¤åˆ¶å‡ºçš„æ–‡ä»¶æè¿°ç¬¦å€¼ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">0 stdinï¼›1 stdoutï¼›2 error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>ä½¿ç”¨shutdownï¼ŒåŠå…³é—­æè¿°ç¬¦
&lt;ol>
&lt;li>shutdown(fileno(writefp), SHUT_WR);&lt;/li>
&lt;li>close(writefp)&lt;/li>
&lt;li>&lt;a href="https://beej.us/guide/bgnet/html/#close-and-shutdownget-outta-my-face">It's important to note &lt;/a>that shutdown() doesn't actually close the file descriptorâ€”it just &lt;strong>changes its usability&lt;/strong>. To free a socket descriptor, you need to use close().&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h2 id="ä¼˜äº-select-çš„-epoll">ä¼˜äº select çš„ epoll&lt;/h2>
&lt;h3 id="epoll-ç†è§£åŠåº”ç”¨">epoll ç†è§£åŠåº”ç”¨&lt;/h3>
&lt;p>select å¤ç”¨æ–¹æ³•ç”±æ¥å·²ä¹…ï¼Œå› æ­¤ï¼Œåˆ©ç”¨è¯¥æŠ€æœ¯åï¼Œæ— è®ºå¦‚ä½•ä¼˜åŒ–ç¨‹åºæ€§èƒ½ä¹Ÿ&lt;strong>æ— æ³•åŒæ—¶ä»‹å…¥ä¸Šç™¾ä¸ªå®¢æˆ·ç«¯&lt;/strong>ã€‚&lt;/p>
&lt;h4 id="åŸºäº-select-çš„-io-å¤ç”¨æŠ€æœ¯é€Ÿåº¦æ…¢çš„åŸå› ">åŸºäº select çš„ I/O å¤ç”¨æŠ€æœ¯é€Ÿåº¦æ…¢çš„åŸå› &lt;/h4>
&lt;p>ç¬¬ 12 ç« å®ç°äº†åŸºäº select çš„ I/O å¤ç”¨æŠ€æœ¯æœåŠ¡ç«¯ï¼Œå…¶ä¸­æœ‰ä¸åˆç†çš„è®¾è®¡å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>è°ƒç”¨ select å‡½æ•°åå¸¸è§çš„é’ˆå¯¹æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦çš„å¾ªç¯è¯­å¥&lt;/li>
&lt;li>æ¯æ¬¡è°ƒç”¨ select å‡½æ•°æ—¶éƒ½éœ€è¦å‘è¯¥å‡½æ•°ä¼ é€’ç›‘è§†å¯¹è±¡ä¿¡æ¯&lt;/li>
&lt;/ul>
&lt;p>ä¸Šè¿°ä¸¤ç‚¹å¯ä»¥ä» &lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch12/echo_selectserv.c">echo_selectserv.c&lt;/a> å¾—åˆ°ç¡®è®¤ï¼Œè°ƒç”¨ select å‡½æ•°åï¼Œå¹¶ä¸æ˜¯æŠŠå‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶æè¿°ç¬¦å•ç‹¬é›†ä¸­åœ¨ä¸€èµ·ï¼Œè€Œæ˜¯é€šè¿‡&lt;strong>ä½œä¸ºç›‘è§†å¯¹è±¡çš„ fd_set å˜é‡çš„å˜åŒ–ï¼Œæ‰¾å‡ºå‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶æè¿°ç¬¦&lt;/strong>ï¼ˆ54,56è¡Œï¼‰ï¼Œå› æ­¤æ— æ³•é¿å…é’ˆå¯¹æ‰€æœ‰ç›‘è§†å¯¹è±¡çš„å¾ªç¯è¯­å¥ã€‚è€Œä¸”ï¼Œä½œä¸ºç›‘è§†å¯¹è±¡çš„ fd_set ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥è°ƒç”¨ select å‡½æ•°å‰åº”è¯¥å¤åˆ¶å¹¶ä¿å­˜åŸæœ‰ä¿¡æ¯ï¼Œå¹¶åœ¨æ¯æ¬¡è°ƒç”¨ select å‡½æ•°æ—¶&lt;strong>ä¼ é€’æ–°çš„ç›‘è§†å¯¹è±¡ä¿¡æ¯&lt;/strong>ã€‚&lt;br />select æ€§èƒ½ä¸Šæœ€å¤§çš„å¼±ç‚¹æ˜¯ï¼š&lt;strong>æ¯æ¬¡ä¼ é€’ç›‘è§†å¯¹è±¡ä¿¡æ¯&lt;/strong>ï¼Œå‡†ç¡®çš„è¯´ï¼Œselect æ˜¯ç›‘è§†å¥—æ¥å­—å˜åŒ–çš„å‡½æ•°ã€‚è€Œå¥—æ¥å­—æ˜¯æ“ä½œç³»ç»Ÿç®¡ç†çš„ï¼Œæ‰€ä»¥ select å‡½æ•°è¦å€ŸåŠ©æ“ä½œç³»ç»Ÿæ‰èƒ½å®ŒæˆåŠŸèƒ½ã€‚select å‡½æ•°çš„è¿™ä¸€ç¼ºç‚¹å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼å¼¥è¡¥ï¼š&lt;/p>
&lt;blockquote>
&lt;p>ä»…å‘æ“ä½œç³»ç»Ÿä¼ é€’ä¸€æ¬¡ç›‘è§†å¯¹è±¡ï¼Œç›‘è§†èŒƒå›´æˆ–å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶åªé€šçŸ¥å‘ç”Ÿå˜åŒ–çš„äº‹é¡¹&lt;/p>
&lt;/blockquote>
&lt;p>è¿™æ ·å°±æ— éœ€æ¯æ¬¡è°ƒç”¨ select å‡½æ•°æ—¶éƒ½å‘æ“ä½œç³»ç»Ÿä¼ é€’ç›‘è§†å¯¹è±¡ä¿¡æ¯ï¼Œä½†æ˜¯å‰ææ“ä½œç³»ç»Ÿæ”¯æŒè¿™ç§å¤„ç†æ–¹å¼ã€‚Linux çš„æ”¯æŒæ–¹å¼æ˜¯ epoll ï¼ŒWindows çš„æ”¯æŒæ–¹å¼æ˜¯ IOCPã€‚&lt;/p>
&lt;h4 id="select-ä¼˜ç‚¹">select ä¼˜ç‚¹&lt;/h4>
&lt;p>select çš„å…¼å®¹æ€§æ¯”è¾ƒé«˜ï¼Œè¿™æ ·å°±å¯ä»¥æ”¯æŒå¾ˆå¤šçš„æ“ä½œç³»ç»Ÿï¼Œä¸å—å¹³å°çš„é™åˆ¶ï¼Œæ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ä½¿å¯ä»¥ä½¿ç”¨ select å‡½æ•°ï¼š&lt;/p>
&lt;ul>
&lt;li>æœåŠ¡å™¨æ¥å…¥è€…å°‘&lt;/li>
&lt;li>ç¨‹åºåº”è¯¥å…·æœ‰å…¼å®¹æ€§&lt;/li>
&lt;/ul>
&lt;h4 id="å®ç°-epoll-æ—¶å¿…è¦çš„å‡½æ•°å’Œç»“æ„ä½“">å®ç° epoll æ—¶å¿…è¦çš„å‡½æ•°å’Œç»“æ„ä½“&lt;/h4>
&lt;p>èƒ½å¤Ÿå…‹æœ select å‡½æ•°ç¼ºç‚¹çš„ epoll å‡½æ•°å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼Œè¿™äº›ä¼˜ç‚¹æ­£å¥½ä¸ä¹‹å‰çš„ select å‡½æ•°ç¼ºç‚¹ç›¸åã€‚&lt;/p>
&lt;ul>
&lt;li>æ— éœ€ç¼–å†™ä»¥ç›‘è§†çŠ¶æ€å˜åŒ–ä¸ºç›®çš„çš„é’ˆå¯¹æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦çš„å¾ªç¯è¯­å¥&lt;/li>
&lt;li>è°ƒç”¨å¯¹åº”äº select å‡½æ•°çš„ epoll_wait å‡½æ•°æ—¶æ— éœ€æ¯æ¬¡ä¼ é€’ç›‘è§†å¯¹è±¡ä¿¡æ¯ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¸‹é¢æ˜¯ epoll å‡½æ•°çš„åŠŸèƒ½ï¼š&lt;/p>
&lt;ul>
&lt;li>epoll_createï¼šåˆ›å»ºä¿å­˜ epoll æ–‡ä»¶æè¿°ç¬¦çš„ç©ºé—´&lt;/li>
&lt;li>epoll_ctlï¼šå‘ç©ºé—´æ³¨å†Œå¹¶æ³¨é”€æ–‡ä»¶æè¿°ç¬¦&lt;/li>
&lt;li>epoll_waitï¼šä¸ select å‡½æ•°ç±»ä¼¼ï¼Œç­‰å¾…æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿå˜åŒ–&lt;/li>
&lt;/ul>
&lt;p>select å‡½æ•°ä¸­ä¸ºäº†ä¿å­˜ç›‘è§†å¯¹è±¡çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œç›´æ¥å£°æ˜äº† fd_set å˜é‡ï¼Œä½†epollæ–¹å¼è®©æ“ä½œç³»ç»Ÿè´Ÿè´£ä¿å­˜ç›‘è§†å¯¹è±¡æ–‡ä»¶æè¿°ç¬¦ï¼Œå› æ­¤éœ€è¦å‘æ“ä½œç³»ç»Ÿè¯·æ±‚åˆ›å»ºä¿å­˜æ–‡ä»¶æè¿°ç¬¦çš„ç©ºé—´ï¼Œæ­¤æ—¶ç”¨çš„å‡½æ•°å°±æ˜¯ epoll_create ã€‚&lt;br />æ­¤å¤–ï¼Œä¸ºäº†&lt;strong>æ·»åŠ å’Œåˆ é™¤ç›‘è§†å¯¹è±¡æ–‡ä»¶æè¿°ç¬¦&lt;/strong>ï¼Œselect æ–¹å¼ä¸­éœ€è¦ FD_SETã€FD_CLR å‡½æ•°ã€‚ä½†åœ¨ epoll æ–¹å¼ä¸­ï¼Œ&lt;strong>é€šè¿‡ epoll_ctl å‡½æ•°è¯·æ±‚æ“ä½œç³»ç»Ÿå®Œæˆ&lt;/strong>ã€‚æœ€åï¼Œselect æ–¹å¼ä¸‹è°ƒç”¨ select å‡½æ•°ç­‰å¾…æ–‡ä»¶æè¿°ç¬¦çš„å˜åŒ–ï¼Œè€Œ epoll_wait è°ƒç”¨ epoll_wait å‡½æ•°ã€‚è¿˜æœ‰ï¼Œselect æ–¹å¼ä¸­é€šè¿‡ fd_set å˜é‡æŸ¥çœ‹ç›‘è§†å¯¹è±¡çš„çŠ¶æ€å˜åŒ–ï¼Œè€Œ epoll æ–¹å¼é€šè¿‡å¦‚ä¸‹ç»“æ„ä½“ epoll_event å°†å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶æè¿°ç¬¦å•ç‹¬é›†ä¸­åœ¨ä¸€èµ·ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">epoll_event&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">__uint32_t&lt;/span> &lt;span class="n">events&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">epoll_data_t&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">typedef&lt;/span> &lt;span class="k">union&lt;/span> &lt;span class="nc">epoll_data&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">ptr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">__uint32_t&lt;/span> &lt;span class="n">u32&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">__uint64_t&lt;/span> &lt;span class="n">u64&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span> &lt;span class="n">epoll_data_t&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å£°æ˜è¶³å¤Ÿå¤§çš„ epoll_event ç»“æ„ä½“æ•°ç»„åï¼Œä¼ é€’ç»™ epoll_wait å‡½æ•°æ—¶ï¼Œå‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶æè¿°ç¬¦ä¿¡æ¯å°†è¢«å¡«å…¥æ•°ç»„ã€‚å› æ­¤ï¼Œæ— éœ€åƒ select å‡½æ•°é‚£æ ·é’ˆå¯¹æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œå¾ªç¯ã€‚&lt;/p>
&lt;h4 id="epoll_create">epoll_create&lt;/h4>
&lt;p>epoll æ˜¯ä» Linux çš„ 2.5.44 ç‰ˆå†…æ ¸å¼€å§‹å¼•å…¥çš„ã€‚é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹ Linux å†…æ ¸ç‰ˆæœ¬ï¼ˆè€å¼æœºå­éœ€è¦æ£€æŸ¥ï¼‰ï¼š&lt;/p>
&lt;blockquote>
&lt;p>cat /proc/sys/kernel/osrelease&lt;/p>
&lt;/blockquote>
&lt;p>epoll_create åŸå‹&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/epoll.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">epoll_create&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› epoll çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sizeï¼šepoll å®ä¾‹çš„å¤§å°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è°ƒç”¨ epoll_create å‡½æ•°æ—¶åˆ›å»ºçš„æ–‡ä»¶æè¿°ç¬¦ä¿å­˜ç©ºé—´ç§°ä¸ºã€Œ&lt;strong>epoll ä¾‹ç¨‹&lt;/strong>ã€ï¼Œä½†æœ‰äº›æƒ…å†µä¸‹åç§°ä¸åŒï¼Œéœ€è¦ç¨åŠ æ³¨æ„ã€‚é€šè¿‡å‚æ•° size ä¼ é€’çš„å€¼å†³å®š epoll ä¾‹ç¨‹çš„å¤§å°ï¼Œä½†è¯¥å€¼åªæ˜¯å‘æ“ä½œç³»ç»Ÿæå‡ºçš„å»ºè®®ã€‚æ¢è¨€ä¹‹ï¼Œsize å¹¶ä¸ç”¨æ¥å†³å®š epoll çš„å¤§å°ï¼Œè€Œä»…ä¾›æ“ä½œç³»ç»Ÿå‚è€ƒï¼ˆLinux3.6.8å&lt;strong>å®Œå…¨å¿½ç•¥sizeå»ºè®®&lt;/strong>ï¼‰ã€‚&lt;br />epoll_create å‡½æ•°åˆ›å»ºçš„èµ„æºä¸å¥—æ¥å­—ç›¸åŒï¼Œä¹Ÿç”±æ“ä½œç³»ç»Ÿç®¡ç†ã€‚å› æ­¤ï¼Œè¯¥å‡½æ•°å’Œåˆ›å»ºå¥—æ¥å­—çš„æƒ…å†µç›¸åŒï¼Œä¹Ÿä¼šè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œä¹Ÿå°±æ˜¯è¯´è¿”å›çš„æ–‡ä»¶æè¿°ç¬¦ä¸»è¦ç”¨äºåŒºåˆ† epoll ä¾‹ç¨‹ã€‚éœ€è¦ç»ˆæ­¢æ—¶ï¼Œä¸å…¶ä»–æ–‡ä»¶æè¿°ç¬¦ç›¸åŒï¼Œä¹Ÿ&lt;strong>è¦è°ƒç”¨ close å‡½æ•°ã€‚&lt;/strong>&lt;/p>
&lt;h4 id="epoll_ctl">epoll_ctl&lt;/h4>
&lt;p>ç”Ÿæˆä¾‹ç¨‹åï¼Œåº”åœ¨å…¶å†…éƒ¨æ³¨å†Œç›‘è§†å¯¹è±¡æ–‡ä»¶æè¿°ç¬¦ï¼Œæ­¤æ—¶ä½¿ç”¨ epoll_ctl å‡½æ•°ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/epoll.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">epoll_ctl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">epfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">op&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">epoll_event&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">event&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">epfdï¼šç”¨äºæ³¨å†Œç›‘è§†å¯¹è±¡çš„ epoll ä¾‹ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">opï¼šç”¨äºæŒ‡å®šç›‘è§†å¯¹è±¡çš„æ·»åŠ ã€åˆ é™¤æˆ–æ›´æ”¹ç­‰æ“ä½œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">fdï¼šéœ€è¦æ³¨å†Œçš„ç›‘è§†å¯¹è±¡æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">eventï¼šç›‘è§†å¯¹è±¡çš„äº‹ä»¶ç±»å‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">op:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">EPOLL_CTL_ADDï¼šå°†æ–‡ä»¶æè¿°ç¬¦æ³¨å†Œåˆ° epoll ä¾‹ç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">EPOLL_CTL_DELï¼šä» epoll ä¾‹ç¨‹ä¸­åˆ é™¤æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">EPOLL_CTL_MODï¼šæ›´æ”¹æ³¨å†Œçš„æ–‡ä»¶æè¿°ç¬¦çš„å…³æ³¨äº‹ä»¶å‘ç”Ÿæƒ…å†µ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸å…¶ä»– epoll å‡½æ•°ç›¸æ¯”ï¼Œè¯¥å‡½æ•°çœ‹èµ·æ¥æœ‰äº›å¤æ‚ï¼Œä½†é€šè¿‡è°ƒç”¨è¯­å¥å°±å¾ˆå®¹æ˜“ç†è§£ï¼Œå‡è®¾æŒ‰ç…§å¦‚ä¸‹å½¢å¼è°ƒç”¨ epoll_ctl å‡½æ•°ï¼š&lt;/p>
&lt;blockquote>
&lt;p>epoll_ctl(A,EPOLL_CTL_ADD,B,C);
epoll ä¾‹ç¨‹ A ä¸­&lt;strong>æ³¨å†Œ&lt;/strong>æ–‡ä»¶æè¿°ç¬¦ B ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ç›‘è§†å‚æ•° C ä¸­çš„äº‹ä»¶&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>epoll_ctl(A,EPOLL_CTL_DEL,B,NULL);
ä» epoll ä¾‹ç¨‹ A ä¸­åˆ é™¤æ–‡ä»¶æè¿°ç¬¦ B&lt;/p>
&lt;/blockquote>
&lt;p>epoll_event ç»“æ„ä½“ç”¨äºå’Œä¿å­˜äº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ç»“åˆã€‚ä½†ä¹Ÿå¯ä»¥åœ¨ epoll_ctlä¸­æ³¨å†Œæ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œç”¨äºæ³¨å†Œå…³æ³¨çš„äº‹ä»¶ã€‚è¯¥å‡½æ•°ä¸­ epoll_event ç»“æ„ä½“çš„å®šä¹‰å¹¶ä¸æ˜¾çœ¼ï¼Œå› æ­¤é€šè¿‡è°ƒç”¨è¯­å¥è¯´æ˜è¯¥ç»“æ„ä½“åœ¨ epoll_ctl å‡½æ•°ä¸­çš„åº”ç”¨ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">epoll_event&lt;/span> &lt;span class="n">event&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">events&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">EPOLLIN&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//å‘ç”Ÿéœ€è¦è¯»å–æ•°æ®çš„æƒ…å†µæ—¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">epoll_ctl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">epfd&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">EPOLL_CTL_ADD&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">event&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šè¿°ä»£ç å°† sockfd æ³¨å†Œåˆ° epoll ä¾‹ç¨‹ epfd ä¸­ï¼Œå¹¶åœ¨éœ€è¦è¯»å–æ•°æ®çš„æƒ…å†µä¸‹äº§ç”Ÿç›¸åº”äº‹ä»¶ã€‚æ¥ä¸‹æ¥ç»™å‡º epoll_event çš„æˆå‘˜ events ä¸­å¯ä»¥ä¿å­˜çš„å¸¸é‡åŠæ‰€æŒ‡çš„äº‹ä»¶ç±»å‹ã€‚&lt;/p>
&lt;ul>
&lt;li>EPOLLINï¼šéœ€è¦è¯»å–æ•°æ®çš„æƒ…å†µ&lt;/li>
&lt;li>EPOLLOUTï¼šè¾“å‡ºç¼“å†²ä¸ºç©ºï¼Œå¯ä»¥ç«‹å³å‘é€æ•°æ®çš„æƒ…å†µ&lt;/li>
&lt;li>EPOLLPRIï¼šæ”¶åˆ° OOB æ•°æ®çš„æƒ…å†µ&lt;/li>
&lt;li>EPOLLRDHUPï¼šæ–­å¼€è¿æ¥æˆ–åŠå…³é—­çš„æƒ…å†µï¼Œè¿™åœ¨è¾¹ç¼˜è§¦å‘æ–¹å¼ä¸‹éå¸¸æœ‰ç”¨&lt;/li>
&lt;li>EPOLLERRï¼šå‘ç”Ÿé”™è¯¯çš„æƒ…å†µ&lt;/li>
&lt;li>EPOLLETï¼šä»¥è¾¹ç¼˜è§¦å‘çš„æ–¹å¼å¾—åˆ°äº‹ä»¶é€šçŸ¥&lt;/li>
&lt;li>EPOLLONESHOTï¼šå‘ç”Ÿä¸€æ¬¡äº‹ä»¶åï¼Œç›¸åº”æ–‡ä»¶æè¿°ç¬¦ä¸å†æ”¶åˆ°äº‹ä»¶é€šçŸ¥ã€‚å› æ­¤éœ€è¦å‘ epoll_ctl å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ EPOLL_CTL_MOD ï¼Œå†æ¬¡è®¾ç½®äº‹ä»¶ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¯é€šè¿‡ä½æˆ–è¿ç®— | åŒæ—¶ä¼ é€’å¤šä¸ªä¸Šè¿°å‚æ•°ã€‚&lt;/p>
&lt;h4 id="epoll_wait">epoll_wait&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/epoll.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">epoll_wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">epfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">epoll_event&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">events&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">maxevents&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">timeout&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›å‘ç”Ÿäº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ä¸ªæ•°ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">epfd : è¡¨ç¤ºäº‹ä»¶å‘ç”Ÿç›‘è§†èŒƒå›´çš„ epoll ä¾‹ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">events : ä¿å­˜å‘ç”Ÿäº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦é›†åˆçš„ç»“æ„ä½“åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">maxevents : ç¬¬äºŒä¸ªå‚æ•°ä¸­å¯ä»¥ä¿å­˜çš„æœ€å¤§äº‹ä»¶æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">timeout : ä»¥ 1/1000 ç§’ä¸ºå•ä½çš„ç­‰å¾…æ—¶é—´ï¼Œä¼ é€’ -1 æ—¶ï¼Œä¸€ç›´ç­‰å¾…ç›´åˆ°å‘ç”Ÿäº‹ä»¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¯¥å‡½æ•°è°ƒç”¨æ–¹å¼å¦‚ä¸‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬äºŒä¸ªå‚æ•°æ‰€æŒ‡ç¼“å†²éœ€è¦åŠ¨æ€åˆ†é…ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">event_cnt&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">epoll_event&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">ep_events&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ep_events&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">epoll_event&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">EPOLL_SIZE&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="c1">//EPOLL_SIZEæ˜¯å®å¸¸é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">event_cnt&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">epoll_wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">epfd&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">ep_events&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">EPOLL_SIZE&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è°ƒç”¨å‡½æ•°åï¼Œè¿”å›å‘ç”Ÿäº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ä¸ªæ•°ï¼ŒåŒæ—¶åœ¨ç¬¬äºŒä¸ªå‚æ•°æŒ‡å‘çš„ç¼“å†²ä¸­ä¿å­˜å‘ç”Ÿäº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦é›†åˆã€‚å› æ­¤ï¼Œæ— éœ€åƒ select ä¸€æ ·æ’å…¥é’ˆå¯¹æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦çš„å¾ªç¯ã€‚&lt;/p>
&lt;h4 id="åŸºäº-epoll-çš„å›å£°æœåŠ¡å™¨ç«¯">åŸºäº epoll çš„å›å£°æœåŠ¡å™¨ç«¯&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define EPOLL_SIZE 100
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">epoll_event&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">ep_events&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ç”¨æŒ‡é’ˆå¯ä»¥å­˜å‚¨å¤šä¸ªevent
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">epoll_event&lt;/span> &lt;span class="n">event&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å•ä¸ªeventç”¨äºæŒ‡æ˜äº‹ä»¶ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">epfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">epoll_create&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EPOLL_SIZE&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//å¯ä»¥å¿½ç•¥è¿™ä¸ªå‚æ•°ï¼Œå¡«å…¥çš„å‚æ•°ä¸ºæ“ä½œç³»ç»Ÿå‚è€ƒ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">ep_events&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">epoll_event&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">EPOLL_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">events&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">EPOLLIN&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//éœ€è¦è¯»å–æ•°æ®çš„æƒ…å†µ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">serv_sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">epoll_ctl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">epfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">EPOLL_CTL_ADD&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">serv_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">event&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//ä¾‹ç¨‹epfd ä¸­æ·»åŠ æ–‡ä»¶æè¿°ç¬¦ serv_sockï¼Œç›®çš„æ˜¯ç›‘å¬ enevt ä¸­çš„äº‹ä»¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">event_cnt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">epoll_wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">epfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ep_events&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">EPOLL_SIZE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//è·å–æ”¹å˜äº†çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿”å›æ•°é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">event_cnt&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;epoll_wait() error&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">event_cnt&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// å¾ªç¯æ¬¡æ•°å˜å°‘ï¼Œåªæœ‰å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ep_events&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fd&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">serv_sock&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//å®¢æˆ·ç«¯è¯·æ±‚è¿æ¥æ—¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">adr_sz&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_adr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// (struct sockaddr *)&amp;amp;clnt_sock å¯ä»¥è¿æ¥ä¸Šç¬¬ä¸€æ¬¡ä½†æ˜¯ä¸‹ä¸€æ¬¡å°±é‡å¤å¾ªç¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">clnt_sock&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clnt_adr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">adr_sz&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">events&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">EPOLLIN&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//æŠŠå®¢æˆ·ç«¯å¥—æ¥å­—æ·»åŠ è¿›å»
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">epoll_ctl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">epfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">EPOLL_CTL_ADD&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">event&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;connected client : %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="c1">//æ˜¯å®¢æˆ·ç«¯å¥—æ¥å­—æ—¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">str_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ep_events&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BUF_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">str_len&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">epoll_ctl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">epfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">EPOLL_CTL_DEL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ep_events&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//ä»epollä¸­åˆ é™¤å¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ep_events&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;closed client : %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ep_events&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ep_events&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">str_len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_sock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">epfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ€»ç»“ä¸€ä¸‹ epoll çš„æµç¨‹ï¼š&lt;/p>
&lt;ol>
&lt;li>epoll_create åˆ›å»ºä¸€ä¸ªä¿å­˜ epoll æ–‡ä»¶æè¿°ç¬¦çš„ç©ºé—´ï¼Œå¯ä»¥æ²¡æœ‰å‚æ•°&lt;/li>
&lt;li>åŠ¨æ€åˆ†é…å†…å­˜ï¼Œç»™å°†è¦ç›‘è§†çš„ epoll_wait&lt;/li>
&lt;li>åˆ©ç”¨ epoll_ctl æ§åˆ¶ æ·»åŠ  åˆ é™¤ï¼Œç›‘å¬äº‹ä»¶&lt;/li>
&lt;li>åˆ©ç”¨ epoll_wait æ¥è·å–æ”¹å˜çš„æ–‡ä»¶æè¿°ç¬¦,æ¥æ‰§è¡Œç¨‹åº&lt;/li>
&lt;/ol>
&lt;p>select å’Œ epoll çš„åŒºåˆ«ï¼š&lt;/p>
&lt;ul>
&lt;li>æ¯æ¬¡è°ƒç”¨ select å‡½æ•°éƒ½ä¼šå‘æ“ä½œç³»ç»Ÿä¼ é€’ç›‘è§†å¯¹è±¡ä¿¡æ¯ï¼Œæµªè´¹å¤§é‡æ—¶é—´&lt;/li>
&lt;li>epoll ä»…å‘æ“ä½œç³»ç»Ÿä¼ é€’ä¸€æ¬¡ç›‘è§†å¯¹è±¡ï¼Œç›‘è§†èŒƒå›´æˆ–å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶åªé€šçŸ¥å‘ç”Ÿå˜åŒ–çš„äº‹é¡¹&lt;/li>
&lt;/ul>
&lt;h3 id="æ¡ä»¶è§¦å‘å’Œè¾¹ç¼˜è§¦å‘">æ¡ä»¶è§¦å‘å’Œè¾¹ç¼˜è§¦å‘&lt;/h3>
&lt;p>&lt;strong>æ¡ä»¶è§¦å‘çš„ç‰¹æ€§&lt;/strong>(epollé»˜è®¤)ï¼š&lt;/p>
&lt;blockquote>
&lt;p>æ¡ä»¶è§¦å‘æ–¹å¼ä¸­ï¼Œåªè¦è¾“å…¥ç¼“å†²ä¸€æœ‰æ•°æ®å°±ä¼šä¸€ç›´é€šçŸ¥è¯¥äº‹ä»¶&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>è¾¹ç¼˜è§¦å‘ç‰¹æ€§&lt;/strong>ï¼š&lt;/p>
&lt;blockquote>
&lt;p>è¾¹ç¼˜è§¦å‘ä¸­è¾“å…¥ç¼“å†²æ”¶åˆ°æ•°æ®æ—¶ä»…æ³¨å†Œï¼ˆé€šçŸ¥ï¼‰ 1 æ¬¡è¯¥äº‹ä»¶ã€‚å³ä½¿è¾“å…¥ç¼“å†²ä¸­è¿˜ç•™æœ‰æ•°æ®ï¼Œä¹Ÿä¸ä¼šå†è¿›è¡Œæ³¨å†Œã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æ²¡çœ‹æ‡‚&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch17/echo_EDGEserv.c">ä»£ç &lt;/a>ï¼Œæœ‰æ—¶å€™é‡å¤è¿æ¥æˆ–è€…æ²¡æ¥æ”¶å®Œå®¢æˆ·ç«¯æ•°æ®å°±ç«‹é©¬åœæ­¢æœåŠ¡ç«¯&lt;/p>
&lt;h4 id="è¾¹ç¼˜è§¦å‘çš„æœåŠ¡å™¨ç«¯å¿…çŸ¥çš„ä¸¤ç‚¹">è¾¹ç¼˜è§¦å‘çš„æœåŠ¡å™¨ç«¯å¿…çŸ¥çš„ä¸¤ç‚¹&lt;/h4>
&lt;ul>
&lt;li>é€šè¿‡ errno å˜é‡éªŒè¯é”™è¯¯åŸå› &lt;/li>
&lt;li>ä¸ºäº†å®Œæˆéé˜»å¡ï¼ˆNon-blockingï¼‰I/O ï¼Œæ›´æ”¹äº†å¥—æ¥å­—ç‰¹æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;p>Linux å¥—æ¥å­—ç›¸å…³å‡½æ•°ä¸€èˆ¬é€šè¿‡ -1 é€šçŸ¥å‘ç”Ÿäº†é”™è¯¯ã€‚è™½ç„¶çŸ¥é“å‘ç”Ÿäº†é”™è¯¯ï¼Œä½†ä»…å‡­è¿™äº›å†…å®¹æ— æ³•å¾—çŸ¥äº§ç”Ÿé”™è¯¯çš„åŸå› ã€‚å› æ­¤ï¼Œä¸ºäº†åœ¨å‘ç”Ÿé”™è¯¯çš„æ—¶å€™æä¾›é¢å¤–çš„ä¿¡æ¯ï¼ŒLinux å£°æ˜äº†å¦‚ä¸‹å…¨å±€å˜é‡ï¼š&lt;/p>
&lt;blockquote>
&lt;p>int errno;&lt;/p>
&lt;/blockquote>
&lt;p>ä¸ºäº†è®¿é—®è¯¥å˜é‡ï¼Œéœ€è¦å¼•å…¥ error.h å¤´æ–‡ä»¶ã€‚å¦å¤–ï¼Œæ¯ç§å‡½æ•°å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¿å­˜åœ¨ errno å˜é‡ä¸­çš„å€¼éƒ½ä¸åŒã€‚&lt;/p>
&lt;blockquote>
&lt;p>read å‡½æ•°å‘ç°è¾“å…¥ç¼“å†²ä¸­æ²¡æœ‰æ•°æ®å¯è¯»æ—¶è¿”å› -1ï¼ŒåŒæ—¶åœ¨ errno ä¸­ä¿å­˜ EAGAIN å¸¸é‡&lt;/p>
&lt;/blockquote>
&lt;h4 id="æ”¹å˜æ–‡ä»¶å±æ€§">æ”¹å˜æ–‡ä»¶å±æ€§&lt;/h4>
&lt;p>ä¸‹é¢æ˜¯ Linux ä¸­æä¾›çš„æ”¹å˜å’Œæ›´æ”¹æ–‡ä»¶å±æ€§çš„åŠæ³•ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;fcntl.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">fcntl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fields&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cmd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">...);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› cmd å‚æ•°ç›¸å…³å€¼ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">filedes : å±æ€§æ›´æ”¹ç›®æ ‡çš„æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">cmd : è¡¨ç¤ºå‡½æ•°è°ƒç”¨ç›®çš„
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä»ä¸Šè¿°å£°æ˜å¯ä»¥çœ‹å‡º fcntl æœ‰å¯å˜å‚æ•°çš„å½¢å¼ã€‚å¦‚æœå‘ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ F_GETFL ï¼Œå¯ä»¥è·å¾—ç¬¬ä¸€ä¸ªå‚æ•°æ‰€æŒ‡çš„æ–‡ä»¶æè¿°ç¬¦å±æ€§ï¼ˆint å‹ï¼‰ã€‚åä¹‹ï¼Œå¦‚æœä¼ é€’ F_SETFL ï¼Œå¯ä»¥æ›´æ”¹æ–‡ä»¶æè¿°ç¬¦å±æ€§ã€‚è‹¥å¸Œæœ›å°†å¥—æ¥å­—æ”¹ä¸ºéé˜»å¡æ¨¡å¼ï¼Œéœ€è¦å¦‚ä¸‹ 2 æ¡è¯­å¥ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">flag&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fcntl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">F_GETFL&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">fcntl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">F_SETFL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">flag&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">O_NONBLOCK&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é€šè¿‡ç¬¬ä¸€æ¡è¯­å¥ï¼Œè·å–ä¹‹å‰è®¾ç½®çš„å±æ€§ä¿¡æ¯ï¼Œé€šè¿‡ç¬¬äºŒæ¡è¯­å¥åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ éé˜»å¡ O_NONBLOCK æ ‡å¿—ã€‚è°ƒç”¨ read/write å‡½æ•°æ—¶ï¼Œæ— è®ºæ˜¯å¦å­˜åœ¨æ•°æ®ï¼Œéƒ½ä¼šå½¢æˆéé˜»å¡æ–‡ä»¶æè¿°ç¬¦ï¼ˆå¥—æ¥å­—ï¼‰ã€‚fcntl å‡½æ•°çš„é€‚ç”¨èŒƒå›´å¾ˆå¹¿ã€‚&lt;/p>
&lt;h4 id="å®ç°è¾¹ç¼˜è§¦å‘å›å£°æœåŠ¡å™¨ç«¯">å®ç°è¾¹ç¼˜è§¦å‘å›å£°æœåŠ¡å™¨ç«¯&lt;/h4>
&lt;p>é€šè¿‡ errno ç¡®è®¤é”™è¯¯çš„åŸå› æ˜¯ï¼šè¾¹ç¼˜è§¦å‘æ–¹å¼ä¸­ï¼Œæ¥æ”¶æ•°æ®ä»…æ³¨å†Œä¸€æ¬¡è¯¥äº‹ä»¶ã€‚&lt;br />å› ä¸ºè¿™ç§ç‰¹ç‚¹ï¼Œä¸€æ—¦å‘ç”Ÿè¾“å…¥ç›¸å…³äº‹ä»¶æ—¶ï¼Œå°±åº”è¯¥è¯»å–è¾“å…¥ç¼“å†²ä¸­çš„å…¨éƒ¨æ•°æ®ã€‚å› æ­¤éœ€è¦éªŒè¯è¾“å…¥ç¼“å†²æ˜¯å¦ä¸ºç©ºã€‚&lt;/p>
&lt;blockquote>
&lt;p>read å‡½æ•°è¿”å› -1ï¼Œå˜é‡ errno ä¸­çš„å€¼å˜æˆ EAGAIN æ—¶ï¼Œè¯´æ˜æ²¡æœ‰æ•°æ®å¯è¯»ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æ—¢ç„¶å¦‚æ­¤ï¼Œä¸ºä»€ä¹ˆè¦å°†å¥—æ¥å­—å˜æˆéé˜»å¡æ¨¡å¼ï¼Ÿè¾¹ç¼˜è§¦å‘æ¡ä»¶ä¸‹ï¼Œä»¥é˜»å¡æ–¹å¼å·¥ä½œçš„ read &amp;amp; write å‡½æ•°æœ‰å¯èƒ½å¼•èµ·æœåŠ¡ç«¯çš„é•¿æ—¶é—´åœé¡¿ã€‚å› æ­¤ï¼Œè¾¹ç¼˜è§¦å‘æ–¹å¼ä¸­ä¸€å®šè¦é‡‡ç”¨éé˜»å¡ read &amp;amp; write å‡½æ•°ã€‚&lt;br />è¿˜æ˜¯çœ‹ä¸æ‡‚ï¼Œä»¥åå†è€ƒè™‘è¾¹ç¼˜è§¦å‘ã€‚&lt;/p>
&lt;h4 id="æ¡ä»¶è§¦å‘å’Œè¾¹ç¼˜è§¦å‘å­°ä¼˜å­°åŠ£">æ¡ä»¶è§¦å‘å’Œè¾¹ç¼˜è§¦å‘å­°ä¼˜å­°åŠ£&lt;/h4>
&lt;p>è¾¹ç¼˜è§¦å‘æ–¹å¼å¯ä»¥åšåˆ°è¿™ç‚¹ï¼š&lt;/p>
&lt;blockquote>
&lt;p>å¯ä»¥åˆ†ç¦»æ¥æ”¶æ•°æ®å’Œå¤„ç†æ•°æ®çš„æ—¶é—´ç‚¹ï¼&lt;/p>
&lt;/blockquote>
&lt;p>ä¸‹é¢æ˜¯è¾¹ç¼˜è§¦å‘çš„å›¾&lt;br />&lt;a href="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-14.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5">&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-14.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=WmjF3&amp;amp;originHeight=303&amp;amp;originWidth=377&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;/a>&lt;br />è¿è¡Œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>æœåŠ¡å™¨ç«¯åˆ†åˆ«ä» A B C æ¥æ”¶æ•°æ®&lt;/li>
&lt;li>æœåŠ¡å™¨ç«¯æŒ‰ç…§ A B C çš„é¡ºåºé‡æ–°ç»„åˆæ¥æ”¶åˆ°çš„æ•°æ®&lt;/li>
&lt;li>ç»„åˆçš„æ•°æ®å°†å‘é€ç»™ä»»æ„ä¸»æœºã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¸ºäº†å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œå¦‚æœå¯ä»¥æŒ‰ç…§å¦‚ä¸‹æµç¨‹è¿è¡Œï¼ŒæœåŠ¡ç«¯çš„å®ç°å¹¶ä¸éš¾ï¼š&lt;/p>
&lt;ul>
&lt;li>å®¢æˆ·ç«¯æŒ‰ç…§ A B C çš„é¡ºåºè¿æ¥æœåŠ¡å™¨ï¼Œå¹¶ä¸”æŒ‰ç…§æ¬¡åºå‘æœåŠ¡å™¨å‘é€æ•°æ®&lt;/li>
&lt;li>éœ€è¦æ¥æ”¶æ•°æ®çš„å®¢æˆ·ç«¯åº”åœ¨å®¢æˆ·ç«¯ A B C ä¹‹å‰è¿æ¥åˆ°æœåŠ¡å™¨ç«¯å¹¶ç­‰å¾…&lt;/li>
&lt;/ul>
&lt;p>ä½†æ˜¯å®é™…æƒ…å†µä¸­å¯èƒ½æ˜¯ä¸‹é¢è¿™æ ·ï¼š&lt;/p>
&lt;ul>
&lt;li>å®¢æˆ·ç«¯ C å’Œ B æ­£åœ¨å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œä½†æ˜¯ A å¹¶æ²¡æœ‰è¿æ¥åˆ°æœåŠ¡å™¨&lt;/li>
&lt;li>å®¢æˆ·ç«¯ A B C ä¹±åºå‘é€æ•°æ®&lt;/li>
&lt;li>æœåŠ¡ç«¯å·²ç»æ¥æ”¶åˆ°æ•°æ®ï¼Œä½†æ˜¯è¦æ¥æ”¶æ•°æ®çš„ç›®æ ‡å®¢æˆ·ç«¯å¹¶æ²¡æœ‰è¿æ¥åˆ°æœåŠ¡å™¨ç«¯ã€‚&lt;/li>
&lt;/ul>
&lt;p>å› æ­¤ï¼Œä½¿ç”¨è¾¹ç¼˜è§¦å‘ï¼Œå³ä½¿è¾“å…¥ç¼“å†²æ”¶åˆ°æ•°æ®ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿèƒ½å†³å®šè¯»å–å’Œå¤„ç†è¿™äº›æ•°æ®çš„æ—¶é—´ç‚¹ï¼Œè¿™æ ·å°±ç»™æœåŠ¡å™¨ç«¯çš„å®ç°å¸¦æ¥å¾ˆå¤§çµæ´»æ€§ã€‚&lt;/p>
&lt;h2 id="å¤šçº¿ç¨‹æœåŠ¡å™¨ç«¯çš„å®ç°">å¤šçº¿ç¨‹æœåŠ¡å™¨ç«¯çš„å®ç°&lt;/h2>
&lt;h3 id="ç†è§£çº¿ç¨‹çš„æ¦‚å¿µ">ç†è§£çº¿ç¨‹çš„æ¦‚å¿µ&lt;/h3>
&lt;p>å¤šè¿›ç¨‹çš„ç¼ºç‚¹å¯æ¦‚æ‹¬ä¸ºï¼š&lt;/p>
&lt;ul>
&lt;li>åˆ›å»ºè¿›ç¨‹çš„è¿‡ç¨‹ä¼šå¸¦æ¥ä¸€å®šçš„å¼€é”€&lt;/li>
&lt;li>ä¸ºäº†å®Œæˆè¿›ç¨‹é—´æ•°æ®äº¤æ¢ï¼Œéœ€è¦ç‰¹æ®Šçš„ IPC æŠ€æœ¯ã€‚&lt;/li>
&lt;li>&lt;strong>æ¯ç§’å°‘åˆ™ 10 æ¬¡ï¼Œå¤šåˆ™åƒæ¬¡çš„ã€Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€æ˜¯åˆ›å»ºè¿›ç¨‹çš„æœ€å¤§å¼€é”€&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>çº¿ç¨‹æ¯”è¿›ç¨‹å…·æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>çº¿ç¨‹çš„åˆ›å»ºå’Œä¸Šä¸‹æ–‡åˆ‡æ¢æ¯”è¿›ç¨‹çš„åˆ›å»ºå’Œä¸Šä¸‹æ–‡åˆ‡æ¢&lt;strong>æ›´å¿«ï¼ˆä¸æ˜¯æ¶ˆé™¤ï¼‰&lt;/strong>&lt;/li>
&lt;li>çº¿ç¨‹é—´äº¤æ¢æ•°æ®æ— éœ€ç‰¹æ®ŠæŠ€æœ¯ï¼ˆè¿›ç¨‹pipeï¼‰&lt;/li>
&lt;/ul>
&lt;h4 id="çº¿ç¨‹å’Œè¿›ç¨‹çš„å·®å¼‚">çº¿ç¨‹å’Œè¿›ç¨‹çš„å·®å¼‚&lt;/h4>
&lt;p>çº¿ç¨‹æ˜¯ä¸ºäº†è§£å†³ï¼šä¸ºäº†å¾—åˆ°å¤šæ¡ä»£ç æ‰§è¡Œæµè€Œå¤åˆ¶æ•´ä¸ªå†…å­˜åŒºåŸŸçš„è´Ÿæ‹…å¤ªé‡ã€‚&lt;br />æ¯ä¸ªè¿›ç¨‹çš„å†…å­˜ç©ºé—´éƒ½ç”±ä¿å­˜å…¨å±€å˜é‡çš„ã€Œæ•°æ®åŒºã€ã€å‘ malloc ç­‰å‡½æ•°åŠ¨æ€åˆ†é…æä¾›ç©ºé—´çš„å †ï¼ˆHeapï¼‰ã€å‡½æ•°è¿è¡Œæ—¶ä½¿ç”¨çš„æ ˆï¼ˆStackï¼‰æ„æˆã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„è¿™ç§ç©ºé—´ï¼Œå¤šä¸ªè¿›ç¨‹çš„å†…å­˜ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š&lt;br />&lt;a href="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-15.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5">&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-15.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=fc3E9&amp;amp;originHeight=270&amp;amp;originWidth=404&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;/a>&lt;br />ä½†å¦‚æœä»¥è·å¾—å¤šä¸ªä»£ç æ‰§è¡Œæµä¸ºç›®çš„ï¼Œåˆ™ä¸åº”è¯¥åƒä¸Šå›¾é‚£æ ·å®Œå…¨åˆ†ç¦»å†…å­˜ç»“æ„ï¼Œè€Œåªéœ€åˆ†ç¦»æ ˆåŒºåŸŸã€‚é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥è·å¾—å¦‚ä¸‹ä¼˜åŠ¿ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ä¸éœ€è¦åˆ‡æ¢æ•°æ®åŒºå’Œå †&lt;/li>
&lt;li>å¯ä»¥åˆ©ç”¨æ•°æ®åŒºå’Œå †äº¤æ¢æ•°æ®&lt;/li>
&lt;/ul>
&lt;p>å®é™…ä¸Šè¿™å°±æ˜¯çº¿ç¨‹ã€‚çº¿ç¨‹ä¸ºäº†ä¿æŒå¤šæ¡ä»£ç æ‰§è¡Œæµè€Œéš”å¼€äº†æ ˆåŒºåŸŸï¼Œå› æ­¤å…·æœ‰å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å†…å­˜ç»“æ„ï¼š&lt;br />&lt;a href="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-16.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5">&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-16.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=YP0bE&amp;amp;originHeight=327&amp;amp;originWidth=311&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;/a>&lt;br />å¦‚å›¾æ‰€ç¤ºï¼Œå¤šä¸ªçº¿ç¨‹å…±äº«æ•°æ®åŒºå’Œå †ã€‚ä¸ºäº†ä¿æŒè¿™ç§ç»“æ„ï¼Œçº¿ç¨‹å°†åœ¨è¿›ç¨‹å†…åˆ›å»ºå¹¶è¿è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿›ç¨‹å’Œçº¿ç¨‹å¯ä»¥å®šä¹‰ä¸ºå¦‚ä¸‹å½¢å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>è¿›ç¨‹ï¼šåœ¨æ“ä½œç³»ç»Ÿæ„æˆå•ç‹¬æ‰§è¡Œæµçš„å•ä½&lt;/li>
&lt;li>çº¿ç¨‹ï¼šåœ¨è¿›ç¨‹æ„æˆå•ç‹¬æ‰§è¡Œæµçš„å•ä½&lt;/li>
&lt;/ul>
&lt;p>å¦‚æœè¯´è¿›ç¨‹åœ¨æ“ä½œç³»ç»Ÿå†…éƒ¨ç”Ÿæˆå¤šä¸ªæ‰§è¡Œæµï¼Œé‚£ä¹ˆçº¿ç¨‹å°±åœ¨åŒä¸€è¿›ç¨‹å†…éƒ¨åˆ›å»ºå¤šæ¡æ‰§è¡Œæµã€‚å› æ­¤ï¼Œæ“ä½œç³»ç»Ÿã€è¿›ç¨‹ã€çº¿ç¨‹ä¹‹é—´çš„å…³ç³»å¯ä»¥è¡¨ç¤ºä¸ºä¸‹å›¾ï¼š&lt;br />&lt;a href="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-17.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5">&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-17.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=ZsCJA&amp;amp;originHeight=223&amp;amp;originWidth=343&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;/a>&lt;/p>
&lt;h3 id="çº¿ç¨‹åˆ›å»ºåŠè¿è¡Œ">çº¿ç¨‹åˆ›å»ºåŠè¿è¡Œ&lt;/h3>
&lt;h4 id="posixçš„ç”±æ¥">posixçš„ç”±æ¥&lt;/h4>
&lt;p>å¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ï¼ˆè‹±è¯­ï¼šPortable Operating System Interfaceï¼Œç¼©å†™ä¸ºPOSIXï¼‰æ˜¯IEEEä¸ºè¦åœ¨å„ç§UNIXæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œè½¯ä»¶ï¼Œè€Œå®šä¹‰APIçš„ä¸€ç³»åˆ—äº’ç›¸å…³è”çš„æ ‡å‡†çš„æ€»ç§°ï¼Œå…¶æ­£å¼ç§°å‘¼ä¸ºIEEE Std 1003ï¼Œè€Œå›½é™…æ ‡å‡†åç§°ä¸ºISO/IEC 9945ã€‚æ­¤æ ‡å‡†æºäºä¸€ä¸ªå¤§çº¦å¼€å§‹äº1985å¹´çš„é¡¹ç›®ã€‚POSIXè¿™ä¸ªåç§°æ˜¯ç”±ç†æŸ¥å¾·Â·æ–¯æ‰˜æ›¼ï¼ˆRMSï¼‰åº”IEEEçš„è¦æ±‚è€Œæè®®çš„ä¸€ä¸ªæ˜“äºè®°å¿†çš„åç§°ã€‚å®ƒåŸºæœ¬ä¸Šæ˜¯Portable Operating System Interfaceï¼ˆå¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ï¼‰çš„ç¼©å†™ï¼Œè€ŒXåˆ™è¡¨æ˜å…¶å¯¹Unix APIçš„ä¼ æ‰¿ã€‚&lt;br />LinuxåŸºæœ¬ä¸Šé€æ­¥å®ç°äº†POSIXå…¼å®¹ï¼Œä½†å¹¶æ²¡æœ‰å‚åŠ æ­£å¼çš„POSIXè®¤è¯ã€‚&lt;br />å¾®è½¯çš„Windows NTå£°ç§°éƒ¨åˆ†å®ç°äº†POSIXæ ‡å‡†ã€‚&lt;br />å½“å‰çš„POSIXä¸»è¦åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼šBase Definitionsã€System Interfacesã€Shell and Utilitieså’ŒRationaleã€‚&lt;/p>
&lt;h4 id="çº¿ç¨‹çš„åˆ›å»ºå’Œæ‰§è¡Œæµç¨‹">çº¿ç¨‹çš„åˆ›å»ºå’Œæ‰§è¡Œæµç¨‹&lt;/h4>
&lt;p>çº¿ç¨‹å…·æœ‰å•ç‹¬çš„æ‰§è¡Œæµï¼Œå› æ­¤éœ€è¦å•ç‹¬å®šä¹‰çº¿ç¨‹çš„ main å‡½æ•°ï¼Œè¿˜éœ€è¦è¯·æ±‚æ“ä½œç³»ç»Ÿåœ¨å•ç‹¬çš„æ‰§è¡Œæµä¸­æ‰§è¡Œè¯¥å‡½æ•°ï¼Œå®Œæˆå‡½æ•°åŠŸèƒ½çš„å‡½æ•°å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;pthread.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">pthread_create&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pthread_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="k">restrict&lt;/span> &lt;span class="kr">thread&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">const&lt;/span> &lt;span class="n">pthread_attr_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="k">restrict&lt;/span> &lt;span class="n">attr&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">start_routine&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="k">restrict&lt;/span> &lt;span class="n">arg&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">thread : ä¿å­˜æ–°åˆ›å»ºçº¿ç¨‹ ID çš„å˜é‡åœ°å€å€¼ã€‚çº¿ç¨‹ä¸è¿›ç¨‹ç›¸åŒï¼Œä¹Ÿéœ€è¦ç”¨äºåŒºåˆ†ä¸åŒçº¿ç¨‹çš„ ID
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">attr : ç”¨äºä¼ é€’çº¿ç¨‹å±æ€§çš„å‚æ•°ï¼Œä¼ é€’ NULL æ—¶ï¼Œåˆ›å»ºé»˜è®¤å±æ€§çš„çº¿ç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">start_routine : ç›¸å½“äºçº¿ç¨‹ main å‡½æ•°çš„ã€åœ¨å•ç‹¬æ‰§è¡Œæµä¸­æ‰§è¡Œçš„å‡½æ•°åœ°å€å€¼ï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">arg : é€šè¿‡ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’çš„è°ƒç”¨å‡½æ•°æ—¶åŒ…å«ä¼ é€’å‚æ•°ä¿¡æ¯çš„å˜é‡åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch18/thread1.c">thread1.c&lt;/a>&lt;/li>
&lt;li>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-18.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/li>
&lt;li>å¦‚æœä¸»è¿›æ²¡æœ‰ç­‰å¾…åç§’ï¼Œè€Œæ˜¯ç›´æ¥ç»“æŸï¼Œè¿™æ ·ä¹Ÿä¼šå¼ºåˆ¶ç»“æŸçº¿ç¨‹ï¼Œä¸è®ºçº¿ç¨‹æœ‰æ²¡æœ‰è¿è¡Œå®Œæ¯•ã€‚&lt;/li>
&lt;/ul>
&lt;p>è°ƒç”¨è¯¥å‡½æ•°çš„è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰å°†è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªå‚æ•°ä¸º ID çš„çº¿ç¨‹ç»ˆæ­¢ä¸ºæ­¢ã€‚è€Œä¸”å¯ä»¥å¾—åˆ°çº¿ç¨‹çš„** main å‡½æ•°çš„è¿”å›å€¼**ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;pthread.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">pthread_join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pthread_t&lt;/span> &lt;span class="kr">thread&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="o">**&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">thread : è¯¥å‚æ•°å€¼ ID çš„çº¿ç¨‹ç»ˆæ­¢åæ‰ä¼šä»è¯¥å‡½æ•°è¿”å›
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">status : ä¿å­˜çº¿ç¨‹çš„ main å‡½æ•°è¿”å›å€¼çš„æŒ‡é’ˆçš„å˜é‡åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch18/thread2.c">thread2.c&lt;/a>&lt;/li>
&lt;li>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-19.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/li>
&lt;/ul>
&lt;h4 id="å¯åœ¨ä¸´ç•ŒåŒºå†…è°ƒç”¨çš„å‡½æ•°">å¯åœ¨ä¸´ç•ŒåŒºå†…è°ƒç”¨çš„å‡½æ•°&lt;/h4>
&lt;p>åœ¨åŒæ­¥çš„ç¨‹åºè®¾è®¡ä¸­ï¼Œä¸´ç•ŒåŒºå—ï¼ˆCritical sectionï¼‰æŒ‡çš„æ˜¯ä¸€ä¸ªè®¿é—®å…±äº«èµ„æºï¼ˆä¾‹å¦‚ï¼šå…±äº«è®¾å¤‡æˆ–æ˜¯å…±äº«å­˜å‚¨å™¨ï¼‰çš„ç¨‹åºç‰‡æ®µï¼Œè€Œè¿™äº›å…±äº«èµ„æºæœ‰&lt;strong>æ— æ³•åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®&lt;/strong>çš„ç‰¹æ€§ã€‚&lt;br />æ ¹æ®ä¸´ç•ŒåŒºæ˜¯å¦å¼•èµ·é—®é¢˜ï¼Œå‡½æ•°å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ 2 ç±»ï¼š&lt;/p>
&lt;ul>
&lt;li>çº¿ç¨‹å®‰å…¨å‡½æ•°ï¼ˆThread-safe functionï¼‰&lt;/li>
&lt;li>éçº¿ç¨‹å®‰å…¨å‡½æ•°ï¼ˆThread-unsafe functionï¼‰&lt;/li>
&lt;/ul>
&lt;p>çº¿ç¨‹å®‰å…¨å‡½æ•°è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨ä¹Ÿä¸ä¼šå‘ç”Ÿé—®é¢˜ã€‚åä¹‹ï¼Œéçº¿ç¨‹å®‰å…¨å‡½æ•°è¢«åŒæ—¶è°ƒç”¨æ—¶ä¼šå¼•å‘é—®é¢˜ã€‚ä½†è¿™å¹¶éæœ‰å…³äºä¸´ç•ŒåŒºçš„è®¨è®ºï¼Œçº¿ç¨‹å®‰å…¨çš„å‡½æ•°ä¸­åŒæ ·å¯èƒ½å­˜åœ¨ä¸´ç•ŒåŒºã€‚åªæ˜¯åœ¨çº¿ç¨‹å®‰å…¨çš„å‡½æ•°ä¸­ï¼ŒåŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹è°ƒç”¨æ—¶å¯é€šè¿‡ä¸€äº›æªæ–½é¿å…é—®é¢˜ã€‚&lt;br />çº¿ç¨‹å®‰å…¨å‡½æ•°ç»“å°¾é€šå¸¸æ˜¯ _r ã€‚ä½†æ˜¯ä½¿ç”¨çº¿ç¨‹å®‰å…¨å‡½æ•°ä¼šç»™ç¨‹åºå‘˜å¸¦æ¥é¢å¤–çš„è´Ÿæ‹…ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•è‡ªåŠ¨æ›´æ”¹ä¸ºçº¿ç¨‹å®‰å…¨å‡½æ•°è°ƒç”¨ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜å¤´æ–‡ä»¶å‰å®šä¹‰ &lt;a href="https://stackoverflow.com/questions/2601753/what-is-the-reentrant-flag">_REENTRANT&lt;/a> å®ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¹Ÿæ— éœ€ç‰¹æ„æ›´æ”¹æºä»£ç ï¼Œå¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™æŒ‡å®šç¼–è¯‘å‚æ•°æ¥å®šä¹‰å®ã€‚&lt;br />gcc -D_REENTRANT mythread.c -o mthread -lpthread&lt;/p>
&lt;h4 id="å·¥ä½œworkerçº¿ç¨‹æ¨¡å‹">å·¥ä½œï¼ˆWorkerï¼‰çº¿ç¨‹æ¨¡å‹&lt;/h4>
&lt;p>è®¡ç®—ä» 1 åˆ° 10 çš„å’Œï¼Œä½†å¹¶ä¸æ˜¯é€šè¿‡ main å‡½æ•°è¿›è¡Œè¿ç®—ï¼Œè€Œæ˜¯åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹è®¡ç®— 1 åˆ° 5 çš„å’Œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è®¡ç®— 6 åˆ° 10 çš„å’Œï¼Œmain å‡½æ•°&lt;strong>åªè´Ÿè´£è¾“å‡ºè¿ç®—ç»“æœ&lt;/strong>ã€‚è¿™ç§æ–¹å¼çš„çº¿ç¨‹æ¨¡å‹ç§°ä¸ºã€Œå·¥ä½œçº¿ç¨‹ã€ã€‚æ˜¾ç¤ºè¯¥ç¨‹åºçš„æ‰§è¡Œæµç¨‹å›¾ï¼š&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-20.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/p>
&lt;h3 id="çº¿ç¨‹å­˜åœ¨çš„é—®é¢˜å’Œä¸´ç•ŒåŒº">çº¿ç¨‹å­˜åœ¨çš„é—®é¢˜å’Œä¸´ç•ŒåŒº&lt;/h3>
&lt;p>è¿™ç§æ–¹å¼å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼š&lt;/p>
&lt;blockquote>
&lt;p>2 ä¸ªçº¿ç¨‹æ­£åœ¨åŒæ—¶è®¿é—®å…¨å±€å˜é‡ num&lt;/p>
&lt;/blockquote>
&lt;p>ä»»ä½•å†…å­˜ç©ºé—´ï¼Œåªè¦è¢«åŒæ—¶è®¿é—®ï¼Œéƒ½æœ‰å¯èƒ½å‘ç”Ÿé—®é¢˜ã€‚&lt;br />å› æ­¤ï¼Œçº¿ç¨‹è®¿é—®å˜é‡ num æ—¶åº”è¯¥é˜»æ­¢å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œç›´åˆ°çº¿ç¨‹ 1 è¿ç®—å®Œæˆã€‚è¿™å°±æ˜¯åŒæ­¥ï¼ˆSynchronizationï¼‰&lt;/p>
&lt;h4 id="ä¸´ç•ŒåŒºä½ç½®">ä¸´ç•ŒåŒºä½ç½®&lt;/h4>
&lt;p>å‡½æ•°å†…åŒæ—¶è¿è¡Œå¤šä¸ªçº¿ç¨‹æ“ä½œ&lt;strong>åŒä¸€å˜é‡&lt;/strong>æ—¶å¼•å‘é—®é¢˜çš„å¤šæ¡è¯­å¥æ„æˆçš„ä»£ç å—&lt;/p>
&lt;h3 id="çº¿ç¨‹åŒæ­¥">çº¿ç¨‹åŒæ­¥&lt;/h3>
&lt;p>çº¿ç¨‹åŒæ­¥ç”¨äºè§£å†³çº¿ç¨‹è®¿é—®é¡ºåºå¼•å‘çš„é—®é¢˜ã€‚éœ€è¦åŒæ­¥çš„æƒ…å†µå¯ä»¥ä»å¦‚ä¸‹ä¸¤æ–¹é¢è€ƒè™‘ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>åŒæ—¶è®¿é—®&lt;/strong>åŒä¸€å†…å­˜ç©ºé—´æ—¶å‘ç”Ÿçš„æƒ…å†µ&lt;/li>
&lt;li>éœ€è¦æŒ‡å®šè®¿é—®åŒä¸€å†…å­˜ç©ºé—´çš„&lt;strong>çº¿ç¨‹é¡ºåº&lt;/strong>çš„æƒ…å†µ&lt;/li>
&lt;/ul>
&lt;h4 id="äº’æ–¥é‡">äº’æ–¥é‡&lt;/h4>
&lt;p>äº’æ–¥é”ï¼ˆè‹±è¯­ï¼šè‹±è¯­ï¼šMutual exclusionï¼Œç¼©å†™ Mutexï¼‰æ˜¯ä¸€ç§ç”¨äºå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œé˜²æ­¢ä¸¤æ¡çº¿ç¨‹åŒæ—¶å¯¹åŒä¸€å…¬å…±èµ„æºï¼ˆæ¯”å¦‚å…¨å±€å˜é‡ï¼‰è¿›è¡Œè¯»å†™çš„æœºåˆ¶ã€‚&lt;br />ä¸‹é¢æ˜¯äº’æ–¥é‡çš„&lt;strong>åˆ›å»ºåŠé”€æ¯&lt;/strong>å‡½æ•°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;pthread.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">pthread_mutex_init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pthread_mutex_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">mutex&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">const&lt;/span> &lt;span class="n">pthread_mutexattr_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">attr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">pthread_mutex_destroy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pthread_mutex_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">mutex&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0ï¼Œå¤±è´¥æ—¶è¿”å›å…¶ä»–å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">mutex : åˆ›å»ºäº’æ–¥é‡æ—¶ä¼ é€’ä¿å­˜äº’æ–¥é‡çš„å˜é‡åœ°å€å€¼ï¼Œé”€æ¯æ—¶ä¼ é€’éœ€è¦é”€æ¯çš„äº’æ–¥é‡åœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">attr : ä¼ é€’å³å°†åˆ›å»ºçš„äº’æ–¥é‡å±æ€§ï¼Œæ²¡æœ‰ç‰¹åˆ«éœ€è¦æŒ‡å®šçš„å±æ€§æ—¶ä¼ é€’ NULL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä»ä¸Šè¿°å‡½æ•°å£°æ˜ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸ºäº†åˆ›å»ºç›¸å½“äºé”ç³»ç»Ÿçš„äº’æ–¥é‡ï¼Œéœ€è¦å£°æ˜å¦‚ä¸‹ pthread_mutex_t å‹å˜é‡ï¼š&lt;/p>
&lt;blockquote>
&lt;p>pthread_mutex_t mutex&lt;/p>
&lt;/blockquote>
&lt;p>è¯¥å˜é‡çš„åœ°å€å€¼ä¼ é€’ç»™ pthread_mutex_init å‡½æ•°ï¼Œç”¨æ¥ä¿å­˜æ“ä½œç³»ç»Ÿåˆ›å»ºçš„äº’æ–¥é‡ï¼ˆé”ç³»ç»Ÿï¼‰ã€‚è°ƒç”¨ pthread_mutex_destroy å‡½æ•°æ—¶åŒæ ·éœ€è¦è¯¥ä¿¡æ¯ã€‚å¦‚æœä¸éœ€è¦é…ç½®ç‰¹æ®Šçš„äº’æ–¥é‡å±æ€§ï¼Œåˆ™å‘ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ NULL æ—¶ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ PTHREAD_MUTEX_INITIALIZER è¿›è¡Œå®åˆå§‹åŒ–ï¼š&lt;/p>
&lt;blockquote>
&lt;p>pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;&lt;/p>
&lt;/blockquote>
&lt;p>æ¨èå°½å¯èƒ½çš„ä½¿ç”¨ pthread_mutex_init å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œå› ä¸ºé€šè¿‡å®è¿›è¡Œåˆå§‹åŒ–æ—¶å¾ˆéš¾å‘ç°å‘ç”Ÿçš„é”™è¯¯ã€‚&lt;br />ä¸‹é¢æ˜¯åˆ©ç”¨äº’æ–¥é‡&lt;strong>é”ä½æˆ–é‡Šæ”¾&lt;/strong>ä¸´ç•ŒåŒºæ—¶ä½¿ç”¨çš„å‡½æ•°ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;pthread.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">pthread_mutex_lock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pthread_mutex_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">mutex&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pthread_mutex_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">mutex&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å›å…¶ä»–å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä½¿ç”¨æ–¹æ³•ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">pthread_mutex_lock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">mutex&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//ä¸´ç•ŒåŒºå¼€å§‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//ä¸´ç•ŒåŒºç»“æŸ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">mutex&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="err">#&lt;/span> &lt;span class="err">ä¸è§£é”ä¼šå‡ºç°&lt;/span> &lt;span class="err">æ­»é”&lt;/span> &lt;span class="err">æƒ…å†µ&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä½¿ç”¨mutexæ³¨æ„&lt;/p>
&lt;blockquote>
&lt;p>æœ€å¤§é™åº¦å‡å°‘äº’æ–¥é‡ lock unlock å‡½æ•°çš„&lt;strong>è°ƒç”¨&lt;/strong>æ¬¡æ•°ï¼Œå°½é‡ä¸è¦åœ¨forä¸­åŠ é”&lt;/p>
&lt;/blockquote>
&lt;h4 id="ä¿¡å·é‡">ä¿¡å·é‡&lt;/h4>
&lt;p>ä¿¡å·é‡ï¼ˆè‹±è¯­ï¼šSemaphoreï¼‰åˆç§°ä¸ºä¿¡å·æ ‡ï¼Œæ˜¯ä¸€ä¸ªåŒæ­¥å¯¹è±¡ï¼Œç”¨äºä¿æŒåœ¨0è‡³æŒ‡å®šæœ€å¤§å€¼ä¹‹é—´çš„ä¸€ä¸ªè®¡æ•°å€¼ã€‚å½“çº¿ç¨‹å®Œæˆä¸€æ¬¡å¯¹è¯¥semaphoreå¯¹è±¡çš„&lt;strong>ç­‰å¾…ï¼ˆwaitï¼‰æ—¶ï¼Œè¯¥è®¡æ•°å€¼å‡ä¸€&lt;/strong>ï¼›å½“çº¿ç¨‹å®Œæˆä¸€æ¬¡å¯¹semaphoreå¯¹è±¡çš„&lt;strong>é‡Šæ”¾ï¼ˆreleaseï¼‰æ—¶ï¼Œè®¡æ•°å€¼åŠ ä¸€&lt;/strong>ã€‚å½“è®¡æ•°å€¼ä¸º0ï¼Œåˆ™çº¿ç¨‹ç­‰å¾…è¯¥semaphoreå¯¹è±¡ä¸å†èƒ½æˆåŠŸï¼Œç›´è‡³è¯¥semaphoreå¯¹è±¡å˜æˆsignaledçŠ¶æ€ã€‚semaphoreå¯¹è±¡çš„è®¡æ•°å€¼å¤§äº0ï¼Œä¸ºsignaledçŠ¶æ€ï¼›è®¡æ•°å€¼ç­‰äº0ï¼Œä¸ºnonsignaledçŠ¶æ€.&lt;br />semaphoreå¯¹è±¡é€‚ç”¨äºæ§åˆ¶ä¸€ä¸ªä»…æ”¯æŒæœ‰é™ä¸ªç”¨æˆ·çš„å…±äº«èµ„æºï¼Œæ˜¯ä¸€ç§ä¸éœ€è¦ä½¿ç”¨å¿™ç¢Œç­‰å¾…ï¼ˆbusy waitingï¼‰çš„æ–¹æ³•ã€‚&lt;br />ä¸‹é¢æ˜¯ä¿¡å·é‡çš„åˆ›å»ºåŠé”€æ¯æ–¹æ³•ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;semaphore.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">sem_init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sem_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">sem&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">pshared&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">sem_destroy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sem_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">sem&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å›å…¶ä»–å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sem : åˆ›å»ºä¿¡å·é‡æ—¶ä¿å­˜ä¿¡å·é‡çš„å˜é‡åœ°å€å€¼ï¼Œé”€æ¯æ—¶ä¼ é€’éœ€è¦é”€æ¯çš„ä¿¡å·é‡å˜é‡åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">pshared : ä¼ é€’å…¶ä»–å€¼æ—¶ï¼Œåˆ›å»ºå¯ç”±å¤šä¸ªç»§æ‰¿å…±äº«çš„ä¿¡å·é‡ï¼›ä¼ é€’ 0 æ—¶ï¼Œåˆ›å»ºåªå…è®¸ 1 ä¸ªè¿›ç¨‹å†…éƒ¨ä½¿ç”¨çš„ä¿¡å·é‡ã€‚éœ€è¦å®ŒæˆåŒä¸€è¿›ç¨‹çš„çº¿ç¨‹åŒæ­¥ï¼Œæ•…ä¸º0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">value : æŒ‡å®šåˆ›å»ºä¿¡å·é‡çš„åˆå§‹å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¿¡å·é‡ä¸­ç›¸å½“äºäº’æ–¥é‡ lock unlock çš„å‡½æ•°ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;semaphore.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">sem_post&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sem_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">sem&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">sem_wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sem_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">sem&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å›å…¶ä»–å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sem : ä¼ é€’ä¿å­˜ä¿¡å·é‡è¯»å–å€¼çš„å˜é‡åœ°å€å€¼ï¼Œä¼ é€’ç»™ sem_post çš„ä¿¡å·é‡å¢1ï¼Œä¼ é€’ç»™ sem_wait æ—¶ä¿¡å·é‡å‡ä¸€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è°ƒç”¨ sem_init å‡½æ•°æ—¶ï¼Œæ“ä½œç³»ç»Ÿå°†åˆ›å»ºä¿¡å·é‡å¯¹è±¡ï¼Œæ­¤å¯¹è±¡ä¸­è®°å½•è¿™ã€Œä¿¡å·é‡å€¼ã€ï¼ˆSemaphore Valueï¼‰æ•´æ•°ã€‚è¯¥å€¼åœ¨è°ƒç”¨ sem_post å‡½æ•°æ—¶å¢åŠ  1 ï¼Œè°ƒç”¨ wait_wait å‡½æ•°æ—¶å‡ä¸€ã€‚ä½†ä¿¡å·é‡çš„å€¼ä¸èƒ½å°äº 0 ï¼Œå› æ­¤ï¼Œåœ¨ä¿¡å·é‡ä¸º 0 çš„æƒ…å†µä¸‹è°ƒç”¨ sem_wait å‡½æ•°æ—¶ï¼Œè°ƒç”¨çš„çº¿ç¨‹å°†è¿›å…¥é˜»å¡çŠ¶æ€ï¼ˆå› ä¸ºå‡½æ•°æœªè¿”å›ï¼‰ã€‚å½“ç„¶ï¼Œæ­¤æ—¶å¦‚æœæœ‰å…¶ä»–çº¿ç¨‹è°ƒç”¨ sem_post å‡½æ•°ï¼Œä¿¡å·é‡çš„å€¼å°†å˜ä¸º 1 ï¼Œè€ŒåŸæœ¬é˜»å¡çš„çº¿ç¨‹å¯ä»¥å°†è¯¥ä¿¡å·é‡æ–°å‡ä¸º 0 å¹¶è·³å‡ºé˜»å¡çŠ¶æ€ã€‚&lt;br />äºŒè¿›åˆ¶ä¿¡å·é‡çš„ä½¿ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">sem_wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">sem&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="c1">//ä¿¡å·é‡å˜ä¸º0...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ä¸´ç•ŒåŒºçš„å¼€å§‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//ä¸´ç•ŒåŒºçš„ç»“æŸ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">sem_post&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">sem&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="c1">//ä¿¡å·é‡å˜ä¸º1...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="çº¿ç¨‹çš„é”€æ¯å’Œå¤šçº¿ç¨‹å¹¶å‘æœåŠ¡å™¨ç«¯çš„å®ç°">çº¿ç¨‹çš„é”€æ¯å’Œå¤šçº¿ç¨‹å¹¶å‘æœåŠ¡å™¨ç«¯çš„å®ç°&lt;/h3>
&lt;h4 id="é”€æ¯çº¿ç¨‹çš„-3-ç§æ–¹æ³•">é”€æ¯çº¿ç¨‹çš„ 3 ç§æ–¹æ³•&lt;/h4>
&lt;ul>
&lt;li>è°ƒç”¨ pthread_join å‡½æ•°&lt;/li>
&lt;/ul>
&lt;p>è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œä¸ä»…ä¼šç­‰å¾…çº¿ç¨‹ç»ˆæ­¢ï¼Œè¿˜ä¼šå¼•å¯¼çº¿ç¨‹é”€æ¯ã€‚ä½†è¯¥å‡½æ•°çš„é—®é¢˜æ˜¯ï¼Œçº¿ç¨‹ç»ˆæ­¢å‰ï¼Œ&lt;strong>è°ƒç”¨è¯¥å‡½æ•°çš„çº¿ç¨‹&lt;/strong>å°†è¿›å…¥é˜»å¡çŠ¶æ€ã€‚å› æ­¤ï¼Œé€šè¿‡å¦‚ä¸‹å‡½æ•°è°ƒç”¨å¼•å¯¼çº¿ç¨‹é”€æ¯ã€‚&lt;/p>
&lt;ul>
&lt;li>è°ƒç”¨ pthread_detach å‡½æ•°&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;pthread.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">pthread_detach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pthread_t&lt;/span> &lt;span class="n">th&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å›å…¶ä»–å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">thread : ç»ˆæ­¢çš„åŒæ—¶éœ€è¦é”€æ¯çš„çº¿ç¨‹ ID
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è°ƒç”¨ä¸Šè¿°å‡½æ•°ä¸ä¼šå¼•èµ·çº¿ç¨‹ç»ˆæ­¢æˆ–è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡è¯¥å‡½æ•°å¼•å¯¼é”€æ¯çº¿ç¨‹åˆ›å»ºçš„å†…å­˜ç©ºé—´ã€‚è°ƒç”¨è¯¥å‡½æ•°åä¸èƒ½å†é’ˆå¯¹ç›¸åº”çº¿ç¨‹è°ƒç”¨ pthread_join å‡½æ•°ã€‚&lt;/p>
&lt;h4 id="å¤šçº¿ç¨‹å¹¶å‘æœåŠ¡å™¨ç«¯çš„å®ç°">å¤šçº¿ç¨‹å¹¶å‘æœåŠ¡å™¨ç«¯çš„å®ç°&lt;/h4>
&lt;p>ä¸‹é¢æ˜¯å¤šä¸ªå®¢æˆ·ç«¯ä¹‹é—´å¯ä»¥äº¤æ¢ä¿¡æ¯çš„ç®€å•èŠå¤©ç¨‹åºã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch18/chat_server.c">chat_server.c&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch18/chat_clnt.c">chat_clnt.c&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>ä¸Šé¢çš„æœåŠ¡ç«¯ç¤ºä¾‹ä¸­ï¼Œéœ€è¦æŒæ¡ä¸´ç•ŒåŒºçš„æ„æˆï¼Œè®¿é—®å…¨å±€å˜é‡ clnt_cnt å’Œæ•°ç»„ clnt_socks çš„ä»£ç å°†æ„æˆä¸´ç•ŒåŒºï¼Œæ·»åŠ å’Œåˆ é™¤å®¢æˆ·ç«¯æ—¶ï¼Œå˜é‡ clnt_cnt å’Œæ•°ç»„ clnt_socks å°†åŒæ—¶å‘ç”Ÿå˜åŒ–ã€‚å› æ­¤ä¸‹åˆ—æƒ…å½¢ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼Œä»è€Œå¼•å‘é”™è¯¯ï¼š&lt;/p>
&lt;ul>
&lt;li>çº¿ç¨‹ A ä»æ•°ç»„ clnt_socks ä¸­åˆ é™¤å¥—æ¥å­—ä¿¡æ¯ï¼ŒåŒæ—¶çº¿ç¨‹ B è¯»å– clnt_cnt å˜é‡&lt;/li>
&lt;li>çº¿ç¨‹ A è¯»å–å˜é‡ clnt_cnt ï¼ŒåŒæ—¶çº¿ç¨‹ B å°†å¥—æ¥å­—ä¿¡æ¯æ·»åŠ åˆ° clnt_socks æ•°ç»„&lt;/li>
&lt;/ul>
&lt;h2 id="åˆ¶ä½œ-http-æœåŠ¡å™¨ç«¯">åˆ¶ä½œ HTTP æœåŠ¡å™¨ç«¯&lt;/h2>
&lt;h3 id="http-æ¦‚è¦">HTTP æ¦‚è¦&lt;/h3>
&lt;p>æœ¬ç« å°†ç¼–å†™ HTTPï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰æœåŠ¡å™¨ç«¯ï¼Œå³ Web æœåŠ¡å™¨ç«¯ã€‚&lt;/p>
&lt;h4 id="ç†è§£-web-æœåŠ¡å™¨ç«¯">ç†è§£ Web æœåŠ¡å™¨ç«¯&lt;/h4>
&lt;p>webæœåŠ¡å™¨ç«¯å°±æ˜¯è¦åŸºäº HTTP åè®®ï¼Œå°†ç½‘é¡µå¯¹åº”æ–‡ä»¶ä¼ è¾“ç»™å®¢æˆ·ç«¯çš„æœåŠ¡å™¨ç«¯ã€‚&lt;/p>
&lt;h4 id="http">HTTP&lt;/h4>
&lt;p>æ— çŠ¶æ€çš„ Stateless åè®®&lt;br />&lt;a href="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-21.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5">&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-21.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=XcoFX&amp;amp;originHeight=374&amp;amp;originWidth=309&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;/a>&lt;br />ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒæœåŠ¡å™¨ç«¯ç›¸åº”å®¢æˆ·ç«¯è¯·æ±‚åç«‹å³æ–­å¼€è¿æ¥ã€‚æ¢è¨€ä¹‹ï¼ŒæœåŠ¡å™¨ç«¯ä¸ä¼šç»´æŒå®¢æˆ·ç«¯çŠ¶æ€ã€‚å³ä½¿åŒä¸€å®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿæ— æ³•è¾¨è®¤å‡ºæ˜¯åŸå…ˆé‚£ä¸ªï¼Œè€Œä¼šä»¥ç›¸åŒæ–¹å¼å¤„ç†æ–°è¯·æ±‚ã€‚å› æ­¤ï¼ŒHTTP åˆç§°ã€Œæ— çŠ¶æ€çš„ Stateless åè®®ã€&lt;/p>
&lt;h4 id="è¯·æ±‚æ¶ˆæ¯request-messageçš„ç»“æ„">è¯·æ±‚æ¶ˆæ¯ï¼ˆRequest Messageï¼‰çš„ç»“æ„&lt;/h4>
&lt;p>ä¸‹é¢æ˜¯&lt;strong>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯&lt;/strong>å‘èµ·è¯·æ±‚æ¶ˆæ¯çš„ç»“æ„ï¼š&lt;br />&lt;a href="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-22.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5">&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-22.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=CMVff&amp;amp;originHeight=292&amp;amp;originWidth=391&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;/a>&lt;br />ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¯·æ±‚æ¶ˆæ¯å¯ä»¥åˆ†ä¸º&lt;strong>è¯·æ±‚å¤´ã€æ¶ˆæ¯å¤´ã€æ¶ˆæ¯ä½“&lt;/strong> 3 ä¸ªéƒ¨åˆ†ã€‚å…¶ä¸­ï¼Œè¯·æ±‚è¡Œå«æœ‰è¯·æ±‚æ–¹å¼ï¼ˆè¯·æ±‚ç›®çš„ï¼‰ä¿¡æ¯ã€‚å…¸å‹çš„è¯·æ±‚æ–¹å¼æœ‰ GET å’Œ POST ï¼ŒGET ä¸»è¦ç”¨äºè¯·æ±‚æ•°æ®ï¼ŒPOST ä¸»è¦ç”¨äºä¼ è¾“æ•°æ®ã€‚ä¸ºäº†é™ä½å¤æ‚åº¦ï¼Œæˆ‘ä»¬å®ç°åªèƒ½å“åº” GET è¯·æ±‚çš„ Web æœåŠ¡å™¨ç«¯ï¼Œä¸‹é¢è§£é‡Šå›¾ä¸­çš„è¯·æ±‚è¡Œä¿¡æ¯ã€‚å…¶ä¸­ã€ŒGET/index.html HTTP/1.1ã€ å…·æœ‰å¦‚ä¸‹å«ä¹‰ï¼š&lt;br />è¯·æ±‚ï¼ˆGETï¼‰index.html æ–‡ä»¶ï¼Œé€šå¸¸ä»¥ 1.1 ç‰ˆæœ¬çš„ HTTP åè®®è¿›è¡Œé€šä¿¡ã€‚&lt;br />&lt;strong>è¯·æ±‚è¡Œåªèƒ½é€šè¿‡ 1 è¡Œï¼ˆlineï¼‰å‘é€&lt;/strong>ï¼Œå› æ­¤ï¼ŒæœåŠ¡å™¨ç«¯å¾ˆå®¹æ˜“ä» HTTP è¯·æ±‚ä¸­æå–ç¬¬ä¸€è¡Œï¼Œå¹¶åˆ†åˆ«åˆ†æè¯·æ±‚è¡Œä¸­çš„ä¿¡æ¯ã€‚&lt;br />è¯·æ±‚è¡Œä¸‹é¢çš„&lt;strong>æ¶ˆæ¯å¤´ä¸­åŒ…å«å‘é€è¯·æ±‚çš„æµè§ˆå™¨ä¿¡æ¯ã€ç”¨æˆ·è®¤è¯ä¿¡æ¯ç­‰å…³äº HTTP æ¶ˆæ¯çš„é™„åŠ ä¿¡æ¯&lt;/strong>ã€‚æœ€åçš„&lt;strong>æ¶ˆæ¯ä½“ä¸­è£…æœ‰å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯ä¼ è¾“çš„æ•°æ®&lt;/strong>ï¼Œä¸ºäº†è£…å…¥æ•°æ®ï¼Œéœ€è¦ä»¥ POST æ–¹å¼å‘é€è¯·æ±‚ã€‚ä½†æ˜¯æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å®ç° GET æ–¹å¼çš„æœåŠ¡å™¨ç«¯ï¼Œæ‰€ä»¥å¯ä»¥å¿½ç•¥è¿™éƒ¨åˆ†å†…å®¹ã€‚å¦å¤–ï¼Œæ¶ˆæ¯ä½“å’Œæ¶ˆæ¯å¤´ä¸ä¹‹é—´ä»¥ç©ºè¡Œéš”å¼€ï¼Œå› æ­¤ä¸ä¼šå‘ç”Ÿè¾¹ç•Œé—®é¢˜ã€‚&lt;/p>
&lt;h4 id="2414-å“åº”æ¶ˆæ¯response-messageçš„ç»“æ„">24.1.4 å“åº”æ¶ˆæ¯ï¼ˆResponse Messageï¼‰çš„ç»“æ„&lt;/h4>
&lt;p>ä¸‹é¢æ˜¯ Web &lt;strong>æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯&lt;/strong>ä¼ é€’çš„å“åº”ä¿¡æ¯çš„ç»“æ„ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¯¥å“åº”æ¶ˆæ¯ç”±çŠ¶æ€è¡Œã€å¤´ä¿¡æ¯ã€æ¶ˆæ¯ä½“ç­‰ 3 ä¸ªéƒ¨åˆ†ç»„æˆã€‚çŠ¶æ€è¡Œä¸­æœ‰å…³äºè¯·æ±‚çš„çŠ¶æ€ä¿¡æ¯ï¼Œè¿™æ˜¯ä¸è¯·æ±‚æ¶ˆæ¯ç›¸æ¯”æœ€ä¸ºæ˜¾è‘—åœ°åŒºåˆ«ã€‚&lt;br />&lt;a href="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-23.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5">&lt;img src="https://pic.keepjolly.com/halo/blog/2023/08/20230813224506-23.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=uKMdm&amp;amp;originHeight=287&amp;amp;originWidth=387&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;/a>&lt;br />ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²&lt;strong>çŠ¶æ€è¡Œä¸­å«æœ‰å…³äºå®¢æˆ·ç«¯è¯·æ±‚çš„å¤„ç†ç»“æœ&lt;/strong>ã€‚ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯è¯·æ±‚ index.html æ–‡ä»¶æ—¶ï¼Œè¡¨ç¤º index.html æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€æœåŠ¡ç«¯æ˜¯å¦å‘ç”Ÿé—®é¢˜è€Œæ— æ³•å“åº”ç­‰ä¸åŒæƒ…å†µçš„ä¿¡æ¯å†™å…¥çŠ¶æ€è¡Œã€‚å›¾ä¸­çš„ã€ŒHTTP/1.1 200 OKã€å…·æœ‰å¦‚ä¸‹å«ä¹‰ï¼š&lt;/p>
&lt;ul>
&lt;li>200 OK : æˆåŠŸå¤„ç†äº†è¯·æ±‚!&lt;/li>
&lt;li>404 Not Found : è¯·æ±‚çš„æ–‡ä»¶ä¸å­˜åœ¨!&lt;/li>
&lt;li>400 Bad Request : è¯·æ±‚æ–¹å¼é”™è¯¯ï¼Œè¯·æ£€æŸ¥ï¼&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>æ¶ˆæ¯å¤´ä¸­å«æœ‰ä¼ è¾“çš„æ•°æ®ç±»å‹å’Œé•¿åº¦ç­‰ä¿¡æ¯&lt;/strong>ã€‚å›¾ä¸­çš„æ¶ˆæ¯å¤´å«æœ‰å¦‚ä¸‹ä¿¡æ¯ï¼š&lt;br />æœåŠ¡ç«¯åä¸º SimpleWebServer ï¼Œä¼ è¾“çš„æ•°æ®ç±»å‹ä¸º text/htmlã€‚æ•°æ®é•¿åº¦ä¸è¶…è¿‡ 2048 ä¸ªå­—èŠ‚ã€‚&lt;br />æœ€åæ’å…¥ä¸€ä¸ªç©ºè¡Œåï¼Œé€šè¿‡æ¶ˆæ¯ä½“&lt;strong>å‘é€å®¢æˆ·ç«¯è¯·æ±‚çš„æ–‡ä»¶æ•°æ®&lt;/strong>ã€‚ä»¥ä¸Šå°±æ˜¯å®ç° Web æœåŠ¡ç«¯è¿‡ç¨‹ä¸­å¿…è¦çš„ HTTP åè®®ã€‚&lt;/p></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/tcp/">TCP</category><category domain="https://keepjolly.com/tags/c-/">C++</category><category domain="https://keepjolly.com/tags/network/">Network</category></item><item><title>TCP_IPç½‘ç»œç¼–ç¨‹</title><link>https://keepjolly.com/posts/learn/tcp_ip_network_programming/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/tcp_ip_network_programming/</guid><pubDate>Sun, 13 Aug 2023 22:41:54 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—">ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—&lt;/h2>
&lt;p>serverï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">serv_addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">clnt_addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆ›å»ºå¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">sockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ç«¯å£å¤ç”¨ï¼Œé˜²æ­¢address in use
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">one&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_REUSEADDR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">one&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">one&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// bindåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">serv_addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockaddr_in&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serv_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AF_INET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serv_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htonl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">INADDR_ANY&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serv_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8888&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">serv_addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_addr&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å¼€å§‹ç›‘å¬å®¢æˆ·ç«¯è¿å…¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å¯ä»¥ä¸å®¢æˆ·ç«¯é€šä¿¡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">clnt_addr_size&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clnt_addr_size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_addr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ä¸èƒ½ä½¿ç”¨(socklen_t*)clnt_addr_sizeä½¿ç”¨(socklen_t*)&amp;amp;clnt_addr_size
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">clnt_sock&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clnt_addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clnt_addr_size&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å‘é€æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;Hello!&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>clientï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[]){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">serv_addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">str_len&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆ›å»ºå¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">sock&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// connectè¿æ¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">serv_addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serv_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AF_INET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serv_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8888&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serv_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inet_addr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">connect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="n">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">serv_addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è¯»å–serveræ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">str_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Message : %s&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="åœ°å€æ—ä¸æ•°æ®åºåˆ—">åœ°å€æ—ä¸æ•°æ®åºåˆ—&lt;/h3>
&lt;p>åªéœ€é€šè¿‡IPåœ°å€çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å³å¯åˆ¤æ–­ç½‘ç»œåœ°å€å ç”¨çš„æ€»å­—èŠ‚æ•°ï¼Œå› ä¸ºæˆ‘ä»¬æ ¹æ®IPåœ°å€çš„è¾¹ç•ŒåŒºåˆ†ç½‘ç»œåœ°å€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;ul>
&lt;li>A ç±»åœ°å€çš„é¦–å­—èŠ‚èŒƒå›´ä¸ºï¼š0~127&lt;/li>
&lt;li>B ç±»åœ°å€çš„é¦–å­—èŠ‚èŒƒå›´ä¸ºï¼š128~191&lt;/li>
&lt;li>C ç±»åœ°å€çš„é¦–å­—èŠ‚èŒƒå›´ä¸ºï¼š192~223&lt;/li>
&lt;/ul>
&lt;p>è¿˜æœ‰å¦‚ä¸‹è¿™ç§è¡¨ç¤ºæ–¹å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>A ç±»åœ°å€çš„é¦–ä½ä»¥ 0 å¼€å§‹&lt;/li>
&lt;li>B ç±»åœ°å€çš„å‰2ä½ä»¥ 10 å¼€å§‹&lt;/li>
&lt;li>C ç±»åœ°å€çš„å‰3ä½ä»¥ 110 å¼€å§‹&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>ç«¯å£å·ç”± 16 ä½æ„æˆï¼Œå¯åˆ†é…çš„ç«¯å£å·èŒƒå›´é™¤ 0-1023ï¼Œè¿™äº›æ˜¯çŸ¥åç«¯å£ï¼Œä¸€èˆ¬åˆ†é…ç»™ç‰¹å®šçš„åº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥åº”å½“åˆ†é…ç»™æ­¤èŒƒå›´ä¹‹å¤–çš„å€¼ã€‚HTTP çš„ç«¯å£å·æ˜¯ 80 ï¼ŒFTP çš„ç«¯å£å·æ˜¯20å’Œ21
&lt;ol>
&lt;li>è™½ç„¶ç«¯å£å·ä¸èƒ½é‡å¤ï¼Œä½†æ˜¯ TCP å¥—æ¥å­—å’Œ UDP å¥—æ¥å­—ä¸ä¼šå…±ç”¨ç«¯æ¥å£å·ï¼Œæ‰€ä»¥å…è®¸é‡å¤ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* Structure describing an Internet socket address. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">__SOCKADDR_COMMON&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sin_&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">in_port_t&lt;/span> &lt;span class="n">sin_port&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="cm">/* Port number. uint16_t 16bits*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">in_addr&lt;/span> &lt;span class="n">sin_addr&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="cm">/* Internet address. uint32_t*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* Pad to size of `struct sockaddr&amp;#39;. 8 = 16-2-2-4ï¼Œ ç”¨äºå¼ºåˆ¶è½¬æ¢æˆsockaddr*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="n">sin_zero&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="k">sizeof&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="c1">// 16byte
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">__SOCKADDR_COMMON_SIZE&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="c1">// 2byte
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">sizeof&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">in_port_t&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="c1">// 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">sizeof&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">in_addr&lt;/span>&lt;span class="p">)];&lt;/span> &lt;span class="c1">// 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>sa_family_t&lt;/th>
&lt;th>åœ°å€æ—ï¼ˆaddress familyï¼‰&lt;/th>
&lt;th>sys/socket.h&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>socklen_t&lt;/td>
&lt;td>é•¿åº¦ï¼ˆlength of structï¼‰&lt;/td>
&lt;td>sys/socket.h&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>in_addr_t&lt;/td>
&lt;td>IPåœ°å€ï¼Œå£°æ˜ä¸º uint_32_t&lt;/td>
&lt;td>netinet/in.h&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>in_port_t&lt;/td>
&lt;td>ç«¯å£å·ï¼Œå£°æ˜ä¸º uint_16_t&lt;/td>
&lt;td>netinet/in.h&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>int 8_t è¿™ç§ç±»å‹éƒ½æ˜¯åœ¨è¯¥å¤´æ–‡ä»¶&lt;/td>
&lt;td>signed 8-bit int&lt;/td>
&lt;td>sys/types.h&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;ul>
&lt;li>
&lt;p>å¤§ç«¯åºï¼ˆBig Endianï¼‰ï¼šé«˜ä½å­—èŠ‚å­˜æ”¾åˆ°ä½ä½åœ°å€ï¼Œç½‘ç»œå­—èŠ‚åº&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å°ç«¯åºï¼ˆLittle Endianï¼‰ï¼šé«˜ä½å­—èŠ‚å­˜æ”¾åˆ°é«˜ä½åœ°å€&lt;/p>
&lt;/li>
&lt;li>
&lt;p>h to n s çš„ h ä»£è¡¨ä¸»æœºï¼ˆhostï¼‰å­—èŠ‚åºã€‚é€šå¸¸å°ç«¯åº&lt;/p>
&lt;/li>
&lt;li>
&lt;p>htons çš„ n ä»£è¡¨ç½‘ç»œï¼ˆnetworkï¼‰å­—èŠ‚åºã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>s ä»£è¡¨ä¸¤ä¸ªå­—èŠ‚çš„ short =uint16=2å­—èŠ‚ï¼Œå› æ­¤ä»¥ s ä¸ºåç¼€çš„å‡½æ•°ç”¨äºç«¯å£è½¬æ¢&lt;/p>
&lt;/li>
&lt;li>
&lt;p>l ä»£è¡¨å››ä¸ªå­—èŠ‚çš„ long ç±»å‹ï¼Œæ‰€ä»¥ä»¥ l ä¸ºåç¼€çš„å‡½æ•°ç”¨äº IP åœ°å€è½¬æ¢ï¼ˆlongåœ¨64ä½ç³»ç»Ÿä¸‹ä»æ˜¯4å­—èŠ‚ï¼Œå› ä¸ºæ˜¯uint32ï¼‰&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">in_addr_t&lt;/span> &lt;span class="nf">inet_addr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ç‚¹/æ•°å­—ç¬¦ä¸²å½¢å¼çš„IPåœ°å€è½¬æ¢æˆæ•´æ•°å‹çš„IPåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//æˆåŠŸæ—¶è¿”å› 32 ä½å¤§ç«¯åºæ•´æ•°å‹å€¼ï¼Œå¤±è´¥æ—¶è¿”å› INADDR_NONEï¼Œä»¥ä¾¿å­˜å…¥æ˜¯sockaddr_inä¸­
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">inet_aton&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">in_addr&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// more use
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 1 ï¼Œå¤±è´¥æ—¶è¿”å› 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">string: å«æœ‰éœ€è¦è½¬æ¢çš„IPåœ°å€ä¿¡æ¯çš„å­—ç¬¦ä¸²åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">addr: ä¿å­˜è½¬æ¢ç»“æœçš„ in_addr ç»“æ„ä½“å˜é‡çš„åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nf">inet_ntoa&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">in_addr&lt;/span> &lt;span class="n">adr&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ç½‘ç»œå­—èŠ‚åºæ•´æ•°å‹IPåœ°å€è½¬æ¢æˆå­—ç¬¦ä¸²å½¢å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//æˆåŠŸæ—¶è¿”å›ä¿å­˜è½¬æ¢ç»“æœçš„å­—ç¬¦ä¸²åœ°å€å€¼ï¼Œå¤±è´¥æ—¶è¿”å› NULL ç©ºæŒ‡é’ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="é—®é¢˜">é—®é¢˜&lt;/h3>
&lt;ol>
&lt;li>ç«¯å£ä¸ä¸€è‡´ä¼šå¯¼è‡´ä¹±ç 
&lt;ol>
&lt;li>htonl(8888) != htons(8888)ï¼Œ&lt;a href="https://www.cnblogs.com/sddai/p/5790479.html">htons&lt;/a>&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/qq_45831156/article/details/107469716">Linux æ–‡ä»¶ 1.4â€”æ–‡ä»¶æè¿°ç¬¦0 1 2ï¼ˆæ–‡ä»¶æ“ä½œç®€è¿°ï¼‰&lt;/a>
&lt;ol>
&lt;li>å› æ­¤æ–‡ä»¶openä¹‹åçš„æ–‡ä»¶æè¿°ç¬¦ä»3å¼€å§‹&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;p>&lt;a href="https://blog.csdn.net/owen7500/article/details/53263981">åº•å±‚æ–‡ä»¶I/Oå’ŒANSIæ ‡å‡†I/Oçš„åŒºåˆ«&lt;/a> é€šè¿‡æ–‡ä»¶I/Oè¯»å†™æ–‡ä»¶æ—¶ï¼Œæ¯æ¬¡æ“ä½œéƒ½ä¼šæ‰§è¡Œç›¸å…³ç³»ç»Ÿè°ƒç”¨ã€‚è¿™æ ·å¤„ç†çš„å¥½å¤„æ˜¯ç›´æ¥è¯»å†™å®é™…æ–‡ä»¶ï¼Œåå¤„æ˜¯é¢‘ç¹çš„ç³»ç»Ÿè°ƒç”¨ä¼šå¢åŠ ç³»ç»Ÿå¼€é”€ï¼Œæ ‡å‡†I/Oå¯ä»¥çœ‹æˆæ˜¯åœ¨æ–‡ä»¶I/Oçš„åŸºç¡€ä¸Šå°è£…äº†ç¼“å†²æœºåˆ¶ã€‚å…ˆè¯»å†™ç¼“å†²åŒºï¼Œå¿…è¦æ—¶å†è®¿é—®å®é™…æ–‡ä»¶ï¼Œä»è€Œå‡å°‘äº†ç³»ç»Ÿè°ƒç”¨çš„æ¬¡æ•°ã€‚&lt;/p>
&lt;h2 id="åŸºäºtcpçš„å®¢æˆ·ç«¯æœåŠ¡ç«¯">åŸºäºTCPçš„å®¢æˆ·ç«¯/æœåŠ¡ç«¯&lt;/h2>
&lt;h3 id="tcpip-åè®®æ ˆ">TCP/IP åè®®æ ˆ&lt;/h3>
&lt;p>TCP/IP åè®®æ ˆå…±åˆ†ä¸º 4 å±‚ï¼Œå¯ä»¥ç†è§£ä¸ºæ•°æ®æ”¶å‘åˆ†æˆäº† 4 ä¸ªå±‚æ¬¡åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡å±‚æ¬¡åŒ–çš„æ–¹å¼æ¥è§£å†³é—®é¢˜&lt;/p>
&lt;ol>
&lt;li>é“¾è·¯å±‚&lt;/li>
&lt;/ol>
&lt;p>é“¾è·¯å±‚æ˜¯&lt;strong>ç‰©ç†é“¾æ¥é¢†åŸŸæ ‡å‡†åŒ–&lt;/strong>çš„ç»“æœï¼Œä¹Ÿæ˜¯æœ€åŸºæœ¬çš„é¢†åŸŸï¼Œä¸“é—¨å®šä¹‰LANã€WANã€MANç­‰ç½‘ç»œæ ‡å‡†ã€‚è‹¥ä¸¤å°ä¸»æœºé€šè¿‡ç½‘ç»œè¿›è¡Œæ•°æ®äº¤æ¢ï¼Œåˆ™éœ€è¦ç‰©ç†è¿æ¥ï¼Œé“¾è·¯å±‚å°±è´Ÿè´£è¿™äº›æ ‡å‡†ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>IP å±‚&lt;/li>
&lt;/ol>
&lt;p>å‡†å¤‡å¥½ç‰©ç†è¿æ¥åå°±è¦ä¼ è¾“æ•°æ®ã€‚ä¸ºäº†åœ¨å¤æ‚ç½‘ç»œä¸­ä¼ è¾“æ•°æ®ï¼Œé¦–å…ˆè¦&lt;strong>è€ƒè™‘è·¯å¾„çš„é€‰æ‹©&lt;/strong>ã€‚å‘ç›®æ ‡ä¼ è¾“æ•°æ®éœ€è¦ç»è¿‡å“ªæ¡è·¯å¾„ï¼Ÿè§£å†³æ­¤é—®é¢˜çš„å°±æ˜¯IPå±‚ï¼Œè¯¥å±‚ä½¿ç”¨çš„åè®®å°±æ˜¯IPã€‚&lt;br />IP æ˜¯&lt;strong>é¢å‘æ¶ˆæ¯çš„ã€ä¸å¯é &lt;/strong>çš„åè®®ã€‚æ¯æ¬¡ä¼ è¾“æ•°æ®æ—¶ä¼šå¸®æˆ‘ä»¬é€‰æ‹©è·¯å¾„ï¼Œä½†å¹¶ä¸ä¸€è‡´ã€‚å¦‚æœä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œåˆ™é€‰æ‹©å…¶ä»–è·¯å¾„ï¼Œä½†æ˜¯å¦‚æœå‘ç”Ÿæ•°æ®ä¸¢å¤±æˆ–é”™è¯¯ï¼Œåˆ™æ— æ³•è§£å†³ã€‚æ¢è¨€ä¹‹ï¼ŒIPåè®®æ— æ³•åº”å¯¹æ•°æ®é”™è¯¯ã€‚&lt;/p>
&lt;ol start="3">
&lt;li>TCP/UDP å±‚&lt;/li>
&lt;/ol>
&lt;p>IP å±‚è§£å†³æ•°æ®ä¼ è¾“ä¸­çš„è·¯å¾„é€‰æ‹©é—®é¢˜ï¼Œåªéœ€ç…§æ­¤è·¯å¾„ä¼ è¾“æ•°æ®å³å¯ã€‚TCP å’Œ UDP å±‚ä»¥ IP å±‚æä¾›çš„è·¯å¾„ä¿¡æ¯ä¸ºåŸºç¡€å®Œæˆ&lt;strong>å®é™…çš„æ•°æ®ä¼ è¾“&lt;/strong>ï¼Œæ•…è¯¥å±‚åˆç§°ä¸ºä¼ è¾“å±‚ ã€‚ TCP å¯ä»¥ä¿è¯æ•°æ®çš„å¯é ä¼ è¾“ï¼Œä½†æ˜¯å®ƒå‘é€æ•°æ®æ—¶ä»¥ IP å±‚ä¸ºåŸºç¡€ï¼ˆè¿™ä¹Ÿæ˜¯åè®®æ ˆå±‚æ¬¡åŒ–çš„åŸå› ï¼‰ã€‚&lt;br />IP å±‚åªå…³æ³¨&lt;strong>ä¸€ä¸ªæ•°æ®åŒ…ï¼ˆæ•°æ®ä¼ è¾“åŸºæœ¬å•ä½ï¼‰çš„ä¼ è¾“è¿‡ç¨‹&lt;/strong>ã€‚å› æ­¤ï¼Œå³ä½¿ä¼ è¾“å¤šä¸ªæ•°æ®åŒ…ï¼Œæ¯ä¸ªæ•°æ®åŒ…ä¹Ÿæ˜¯ç”± IP å±‚å®é™…ä¼ è¾“çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼ è¾“é¡ºåºåŠä¼ è¾“æœ¬èº«æ˜¯ä¸å¯é çš„ã€‚è‹¥åªåˆ©ç”¨IPå±‚ä¼ è¾“æ•°æ®ï¼Œæ˜¯ä¸å¯é çš„ï¼Œéœ€è¦åˆ©ç”¨TCPæ¥è§£å†³æ•°æ®ä¸¢å¤±ï¼Œé¡ºåºä¸ä¸€è‡´ç­‰é—®é¢˜ã€‚&lt;/p>
&lt;ol start="4">
&lt;li>åº”ç”¨å±‚&lt;/li>
&lt;/ol>
&lt;p>ä¸Šè¿°å†…å®¹æ˜¯å¥—æ¥å­—é€šä¿¡è¿‡ç¨‹ä¸­è‡ªåŠ¨å¤„ç†çš„ã€‚é€‰æ‹©æ•°æ®ä¼ è¾“è·¯å¾„ã€æ•°æ®ç¡®è®¤è¿‡ç¨‹éƒ½è¢«&lt;strong>éšè—åˆ°å¥—æ¥å­—å†…éƒ¨&lt;/strong>ã€‚å‘ç¨‹åºå‘˜æä¾›çš„å·¥å…·å°±æ˜¯å¥—æ¥å­—ï¼Œåªéœ€è¦åˆ©ç”¨å¥—æ¥å­—ç¼–å‡ºç¨‹åºå³å¯ã€‚ç¼–å†™è½¯ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ ¹æ®ç¨‹åºçš„ç‰¹ç‚¹æ¥&lt;strong>å†³å®šæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„æ•°æ®ä¼ è¾“è§„åˆ™&lt;/strong>ï¼Œè¿™ä¾¿æ˜¯åº”ç”¨å±‚åè®®ã€‚&lt;/p>
&lt;h3 id="tcpæµç¨‹">TCPæµç¨‹&lt;/h3>
&lt;h4 id="æœåŠ¡ç«¯">æœåŠ¡ç«¯&lt;/h4>
&lt;p>#include &amp;lt;sys/socket.h&amp;gt;&lt;/p>
&lt;ol>
&lt;li>
&lt;p>socket(AF_INET, SOCKEt_STREAM, 0) åˆ›å»ºå¥—æ¥å­—&lt;/p>
&lt;/li>
&lt;li>
&lt;p>bind(sockfd, (struct sockaddr *)&amp;amp;serv_adr, sizeof(serv_adr)) åˆ†é…å¥—æ¥å­—åœ°å€&lt;/p>
&lt;/li>
&lt;li>
&lt;p>listen(sockfd, è¯·æ±‚æ•°backlog) ç­‰å¾…è¿æ¥è¯·æ±‚çŠ¶æ€ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯æ‰èƒ½å‘é€connetè¯·æ±‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>accept(int sockfd, struct sockaddr *addr, socklen_t *addrlen) å…è®¸è¿æ¥ï¼Œäº§ç”Ÿç”¨äºæ•°æ®IOçš„å¥—æ¥å­—ï¼Œéœ€è¦close()&lt;/p>
&lt;/li>
&lt;li>
&lt;p>read() / write() æ•°æ®äº¤æ¢&lt;/p>
&lt;/li>
&lt;li>
&lt;p>close() æ–­å¼€è¿æ¥&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æœåŠ¡ç«¯å®ç°è¿‡ç¨‹ä¸­é¦–å…ˆè¦åˆ›å»ºå¥—æ¥å­—ï¼Œæ­¤æ—¶çš„å¥—æ¥å­—å¹¶éæ˜¯çœŸæ­£çš„æœåŠ¡ç«¯å¥—æ¥å­—&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¸ºäº†å®Œæˆå¥—æ¥å­—åœ°å€çš„åˆ†é…ï¼Œåˆå§‹åŒ–ç»“æ„ä½“å˜é‡å¹¶è°ƒç”¨ bind å‡½æ•°ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è°ƒç”¨ listen å‡½æ•°è¿›å…¥ç­‰å¾…è¿æ¥è¯·æ±‚çŠ¶æ€ã€‚è¿æ¥è¯·æ±‚çŠ¶æ€é˜Ÿåˆ—çš„é•¿åº¦è®¾ç½®ä¸º5.æ­¤æ—¶çš„å¥—æ¥å­—æ‰æ˜¯æœåŠ¡ç«¯å¥—æ¥å­—ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è°ƒç”¨ accept å‡½æ•°ä»é˜Ÿå¤´å– 1 ä¸ªè¿æ¥è¯·æ±‚ä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œå¹¶è¿”å›åˆ›å»ºçš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ã€‚å¦å¤–ï¼Œè°ƒç”¨ accept å‡½æ•°æ—¶è‹¥ç­‰å¾…é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™ &lt;strong>accept å‡½æ•°ä¸ä¼šè¿”å›&lt;/strong>ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­å‡ºç°æ–°çš„å®¢æˆ·ç«¯è¿æ¥ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è°ƒç”¨ write å‡½æ•°å‘å®¢æˆ·ç«¯ä¼ é€æ•°æ®ï¼Œè°ƒç”¨ close å…³é—­è¿æ¥&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="å®¢æˆ·ç«¯">å®¢æˆ·ç«¯&lt;/h4>
&lt;ol>
&lt;li>åˆ›å»ºå‡†å¤‡è¿æ¥æœåŠ¡å™¨çš„å¥—æ¥å­—ï¼Œæ­¤æ—¶åˆ›å»ºçš„æ˜¯ TCP å¥—æ¥å­—&lt;/li>
&lt;li>ç»“æ„ä½“å˜é‡ serv_addr ä¸­åˆå§‹åŒ–IPå’Œç«¯å£ä¿¡æ¯ã€‚åˆå§‹åŒ–å€¼ä¸º&lt;strong>ç›®æ ‡æœåŠ¡å™¨ç«¯å¥—æ¥å­—&lt;/strong>çš„IPå’Œç«¯å£ä¿¡æ¯ã€‚&lt;/li>
&lt;li>è°ƒç”¨ connect å‡½æ•°å‘æœåŠ¡ç«¯å‘èµ·è¿æ¥è¯·æ±‚ï¼Œè‡ªåŠ¨åˆ†é…å®¢æˆ·ç«¯IPåœ°å€å’Œç«¯å£&lt;/li>
&lt;li>å®Œæˆè¿æ¥åï¼Œæ¥æ”¶æœåŠ¡ç«¯ä¼ è¾“çš„æ•°æ®&lt;/li>
&lt;li>æ¥æ”¶æ•°æ®åè°ƒç”¨ close å‡½æ•°å…³é—­å¥—æ¥å­—ï¼Œç»“æŸä¸æœåŠ¡å™¨ç«¯çš„è¿æ¥ã€‚(å¯¹å¥—æ¥å­—è°ƒç”¨closeå‡½æ•°ï¼Œå¯¹åº”äºå‘å»ºç«‹è¿æ¥çš„å¯¹åº”å¥—æ¥å­—å‘é€EOFã€‚å³ï¼Œå¦‚æœå®¢æˆ·ç«¯çš„å¥—æ¥å­—è°ƒç”¨äº†closeå‡½æ•°ï¼ŒæœåŠ¡ç«¯&lt;strong>readæ—¶å€™ä¼šè¿”å›0&lt;/strong>ã€‚)&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>å®¢æˆ·ç«¯åªèƒ½ç­‰åˆ°æœåŠ¡ç«¯è°ƒç”¨ listen å‡½æ•°åæ‰èƒ½è°ƒç”¨ connect å‡½æ•°&lt;/li>
&lt;li>æœåŠ¡å™¨ç«¯å¯èƒ½ä¼šåœ¨å®¢æˆ·ç«¯è°ƒç”¨ connect ä¹‹å‰è°ƒç”¨ accept å‡½æ•°ï¼Œè¿™æ—¶æœåŠ¡å™¨ç«¯è¿›å…¥&lt;strong>é˜»å¡ï¼ˆblockingï¼‰çŠ¶æ€&lt;/strong>ï¼Œç›´åˆ°å®¢æˆ·ç«¯è°ƒç”¨ connect å‡½æ•°åæ¥æ”¶åˆ°è¿æ¥è¯·æ±‚ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="echo-serverclient">echo server/client&lt;/h4>
&lt;p>ä½¿ç”¨forå¾ªç¯å¤„ç†å¤šä¸ªè¿æ¥ï¼Œä¼šå‡ºç°æœåŠ¡ç«¯å‘é€å¤šä¸ªæ•°æ®ç»™ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå¹¶ä¸”å¯èƒ½æ•°æ®å¤ªå¤šï¼Œéœ€è¦åˆ†å¼€å‘é€ï¼Œä½†å®¢æˆ·ç«¯åªè°ƒç”¨ä¸€æ¬¡readã€‚ä¸Šè¿°åŸå› ä¸ºTCP ä¸å­˜åœ¨æ•°æ®è¾¹ç•Œã€‚&lt;/p>
&lt;h3 id="é—®é¢˜-1">é—®é¢˜&lt;/h3>
&lt;p>åˆ†å±‚çš„å¥½å¤„ï¼šâ‘ éš”å±‚ä¹‹é—´æ˜¯ç‹¬ç«‹çš„â‘¡çµæ´»æ€§å¥½â‘¢ç»“æ„ä¸Šå¯ä»¥åˆ†éš”å¼€â‘£æ˜“äºå®ç°å’Œç»´æŠ¤â‘¤èƒ½ä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œã€‚&lt;/p>
&lt;h2 id="åŸºäº-tcp-çš„æœåŠ¡ç«¯å®¢æˆ·ç«¯2">åŸºäº TCP çš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯ï¼ˆ2ï¼‰&lt;/h2>
&lt;h3 id="echo-clientçš„å®Œç¾å®ç°">echo clientçš„å®Œç¾å®ç°&lt;/h3>
&lt;h4 id="å·²çŸ¥æ¥æ”¶æ•°æ®çš„å¤§å°">å·²çŸ¥æ¥æ”¶æ•°æ®çš„å¤§å°&lt;/h4>
&lt;p>echo clientå¦‚æœå¯ä»¥çŸ¥é“æ¥æ”¶æ•°æ®çš„å¤§å°ï¼Œåˆ™å¯ä»¥åˆ©ç”¨forå¾ªç¯æ¥æ¥æ”¶ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ä¸ç¡®å®šã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">str_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">recv_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">recv_len&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">str_len&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recv_cnt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">recv_len&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">BUF_SIZE&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">recv_cnt&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error_handling&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;read() error&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recv_len&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">recv_cnt&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="é—®é¢˜ä¸åœ¨äºå›å£°å®¢æˆ·ç«¯å®šä¹‰åº”ç”¨å±‚åè®®">é—®é¢˜ä¸åœ¨äºå›å£°å®¢æˆ·ç«¯ï¼šå®šä¹‰åº”ç”¨å±‚åè®®&lt;/h4>
&lt;p>åœ¨æ”¶å‘è¿‡ç¨‹ä¸­å®šå¥½è§„åˆ™ï¼ˆåè®®ï¼‰ä»¥è¡¨ç¤ºæ•°æ®è¾¹ç•Œï¼Œæˆ–è€…æå‰å‘ŠçŸ¥éœ€è¦å‘é€çš„æ•°æ®çš„å¤§å°ã€‚æœåŠ¡ç«¯/å®¢æˆ·ç«¯å®ç°è¿‡ç¨‹ä¸­é€æ­¥å®šä¹‰çš„è§„åˆ™é›†åˆå°±æ˜¯åº”ç”¨å±‚åè®®ã€‚&lt;/p>
&lt;h3 id="tcp-åŸç†">TCP åŸç†&lt;/h3>
&lt;h4 id="tcp-å¥—æ¥å­—ä¸­çš„-io-ç¼“å†²">TCP å¥—æ¥å­—ä¸­çš„ I/O ç¼“å†²&lt;/h4>
&lt;p>å®é™…ä¸Šï¼Œwrite å‡½æ•°è°ƒç”¨åå¹¶éç«‹å³ä¼ è¾“æ•°æ®ï¼Œ read å‡½æ•°è°ƒç”¨åä¹Ÿå¹¶éé©¬ä¸Šæ¥æ”¶æ•°æ®ã€‚&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;br />I/O ç¼“å†²ç‰¹æ€§å¯ä»¥æ•´ç†å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>I/O ç¼“å†²åœ¨æ¯ä¸ª TCP å¥—æ¥å­—ä¸­å•ç‹¬å­˜åœ¨&lt;/li>
&lt;li>I/O ç¼“å†²åœ¨åˆ›å»ºå¥—æ¥å­—æ—¶è‡ªåŠ¨ç”Ÿæˆ&lt;/li>
&lt;li>å³ä½¿å…³é—­å¥—æ¥å­—ä¹Ÿä¼šç»§ç»­ä¼ é€’è¾“å‡ºç¼“å†²ä¸­é—ç•™çš„æ•°æ®&lt;/li>
&lt;li>å…³é—­å¥—æ¥å­—å°†ä¸¢å¤±è¾“å…¥ç¼“å†²ä¸­çš„æ•°æ®&lt;/li>
&lt;/ul>
&lt;h4 id="tcp-å†…éƒ¨å·¥ä½œåŸç†">TCP å†…éƒ¨å·¥ä½œåŸç†&lt;/h4>
&lt;p>TCP å¥—æ¥å­—ä»åˆ›å»ºåˆ°æ¶ˆå¤±æ‰€ç»è¿‡çš„è¿‡ç¨‹åˆ†ä¸ºå¦‚ä¸‹ä¸‰æ­¥ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸å¯¹æ–¹å¥—æ¥å­—å»ºç«‹è¿æ¥&lt;/li>
&lt;li>ä¸å¯¹æ–¹å¥—æ¥å­—è¿›è¡Œæ•°æ®äº¤æ¢&lt;/li>
&lt;li>æ–­å¼€ä¸å¯¹æ–¹å¥—æ¥å­—çš„è¿æ¥&lt;/li>
&lt;/ul>
&lt;h5 id="1-ä¸å¯¹æ–¹å¥—æ¥å­—çš„è¿æ¥">1 ä¸å¯¹æ–¹å¥—æ¥å­—çš„è¿æ¥&lt;/h5>
&lt;ul>
&lt;li>&lt;strong>Three-way handshaking&lt;/strong>&lt;/li>
&lt;li>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-1.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">
&lt;ul>
&lt;li>ç¬¬ä¸€æ¬¡å®¢æˆ·ç«¯å‘é€SYNï¼Œè¡¨ç¤ºå‘é€SEQä¸º1000çš„æ•°æ®åŒ…&lt;/li>
&lt;li>ç¬¬äºŒæ¬¡æœåŠ¡ç«¯å‘é€SYN+ACKï¼Œè¡¨ç¤ºæ¥æ”¶åå‘é€ACKï¼ˆ1000+1ï¼‰çš„æ•°æ®åŒ…ï¼Œå¹¶å‘é€SEQä¸º2000çš„æ•°æ®åŒ…&lt;/li>
&lt;li>ç¬¬ä¸‰æ¬¡å®¢æˆ·ç«¯å‘é€SYN+ACKï¼Œè¡¨ç¤ºæ¥æ”¶åˆ°æœåŠ¡ç«¯çš„æ•°æ®åŒ…ï¼Œå¹¶å‘é€ä¸‹ä¸€ä¸ªæ•°æ®åŒ…&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h5 id="2ä¸å¯¹æ–¹ä¸»æœºçš„æ•°æ®äº¤æ¢">2ä¸å¯¹æ–¹ä¸»æœºçš„æ•°æ®äº¤æ¢&lt;/h5>
&lt;ul>
&lt;li>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-2.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">
&lt;ul>
&lt;li>é¦–å…ˆä¸»æœºAå‘é€100å­—èŠ‚çš„æ•°æ®åŒ…ï¼ŒSEQä¸º1200ï¼Œä¸»æœºBç¡®è®¤æ”¶åˆ°å‘é€ACKï¼ˆSEQ+ä¼ é€’å­—èŠ‚æ•°+1ï¼‰=1301ç»™ä¸»æœºBï¼Œé˜²æ­¢ä¸¢å¤±æ•°æ®&lt;/li>
&lt;li>ç¬¬äºŒæ¬¡å‘é€æ—¶ä¸»æœºAå¤±è´¥ï¼Œä¸»æœºBæœªå‘é€ACKï¼Œä¸»æœºAå¯åŠ¨è®¡æ—¶å™¨ç­‰å¾…ACKåº”ç­”ï¼Œè¶…æ—¶åˆ™é‡ä¼ æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h5 id="3ä¸å¯¹æ–¹ä¸»æœºçš„æ•°æ®äº¤æ¢">3ä¸å¯¹æ–¹ä¸»æœºçš„æ•°æ®äº¤æ¢&lt;/h5>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-3.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />å›¾ä¸­æ•°æ®åŒ…å†…çš„ FIN è¡¨ç¤ºæ–­å¼€è¿æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒæ–¹å„å‘é€ 1 æ¬¡ FIN æ¶ˆæ¯åæ–­å¼€è¿æ¥ã€‚å›¾ä¸­ï¼Œä¸»æœº A ä¼ é€’äº†ä¸¤æ¬¡ ACK 5001ï¼Œä¹Ÿè®¸è¿™é‡Œä¼šæœ‰å›°æƒ‘ã€‚å…¶å®ï¼Œç¬¬äºŒæ¬¡ FIN æ•°æ®åŒ…ä¸­çš„ ACK 5001 åªæ˜¯å› ä¸ºå‘é€äº† ACK æ¶ˆæ¯åæœªæ¥æ”¶åˆ°çš„æ•°æ®é‡ä¼ çš„ã€‚&lt;/p>
&lt;h2 id="åŸºäºudpçš„æœåŠ¡ç«¯å®¢æˆ·ç«¯">åŸºäºUDPçš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯&lt;/h2>
&lt;h3 id="udpåŸç†">UDPåŸç†&lt;/h3>
&lt;p>å¯„ä¿¡å‰åº”å…ˆåœ¨ä¿¡å°ä¸Šå¡«å¥½å¯„ä¿¡äººipå’Œæ”¶ä¿¡äººçš„åœ°å€portï¼Œä¹‹åè´´ä¸Šé‚®ç¥¨æ”¾è¿›é‚®ç­’writeå³å¯ã€‚å½“ç„¶ï¼Œä¿¡ä»¶çš„ç‰¹ç‚¹ä½¿æˆ‘ä»¬æ— æ³•ç¡®è®¤ä¿¡ä»¶æ˜¯å¦è¢«æ”¶åˆ°ã€‚é‚®å¯„è¿‡ç¨‹ä¸­ä¹Ÿå¯èƒ½å‘ç”Ÿä¿¡ä»¶ä¸¢å¤±çš„æƒ…å†µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¿¡ä»¶æ˜¯ä¸€ç§ä¸å¯é çš„ä¼ è¾“æ–¹å¼ï¼ŒUDP ä¹Ÿæ˜¯ä¸€ç§ä¸å¯é çš„æ•°æ®ä¼ è¾“æ–¹å¼ã€‚&lt;/p>
&lt;h3 id="udpå·¥ä½œåŸç†">UDPå·¥ä½œåŸç†&lt;/h3>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-4.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />IP çš„ä½œç”¨å°±æ˜¯è®©ç¦»å¼€ä¸»æœº B çš„ UDP æ•°æ®åŒ…å‡†ç¡®ä¼ é€’åˆ°ä¸»æœº A ã€‚ä½†æ˜¯æŠŠ UDP æ•°æ®åŒ…æœ€ç»ˆäº¤ç»™ä¸»æœº A çš„æŸä¸€ UDP å¥—æ¥å­—çš„è¿‡ç¨‹æ˜¯ç”± UDP å®Œæˆçš„ã€‚UDP çš„æœ€é‡è¦çš„ä½œç”¨å°±æ˜¯æ ¹æ®ç«¯å£å·å°†ä¼ åˆ°ä¸»æœºçš„æ•°æ®åŒ…äº¤ä»˜ç»™æœ€ç»ˆçš„ UDP å¥—æ¥å­—ã€‚&lt;br />TCP æ¯” UDP æ…¢çš„åŸå› ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>æ”¶å‘æ•°æ®å‰åè¿›è¡Œçš„è¿æ¥è®¾ç½®åŠæ¸…é™¤è¿‡ç¨‹ã€‚&lt;/li>
&lt;li>æ”¶å‘è¿‡ç¨‹ä¸­ä¸ºä¿è¯å¯é æ€§è€Œæ·»åŠ çš„æµæ§åˆ¶ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¦‚æœæ”¶å‘çš„æ•°æ®é‡å°ä½†æ˜¯éœ€è¦é¢‘ç¹è¿æ¥æ—¶ï¼ŒUDP æ¯” TCP æ›´é«˜æ•ˆã€‚&lt;/p>
&lt;ul>
&lt;li>TCPéœ€è¦listenã€acceptï¼Œè€ŒUDPåªéœ€è¦åªæœ‰åˆ›å»ºå¥—æ¥å­—å’Œæ•°æ®äº¤æ¢è¿‡ç¨‹ã€‚&lt;/li>
&lt;li>TCPåªèƒ½ä¸€ä¸€å¯¹åº”æœåŠ¡ç«¯å®¢æˆ·ç«¯ï¼ŒUDPå¯ä»¥ä¸€å¯¹å¤šä¼ è¾“&lt;/li>
&lt;/ul>
&lt;h3 id="ä»£ç å®ç°">ä»£ç å®ç°&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="n">ssize_t&lt;/span> &lt;span class="nf">sendto&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">buff&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size_t&lt;/span> &lt;span class="n">nbytes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">flags&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">to&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">addrlen&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›å‘é€çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sock: ç”¨äºä¼ è¾“æ•°æ®çš„ UDP å¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">buff: ä¿å­˜å¾…ä¼ è¾“æ•°æ®çš„ç¼“å†²åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">nbytes: å¾…ä¼ è¾“çš„æ•°æ®é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">flags: å¯é€‰é¡¹å‚æ•°ï¼Œè‹¥æ²¡æœ‰åˆ™ä¼ é€’ 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">to: å­˜æœ‰ç›®æ ‡åœ°å€çš„ sockaddr ç»“æ„ä½“å˜é‡çš„åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">addrlen: ä¼ é€’ç»™å‚æ•° to çš„åœ°å€å€¼ç»“æ„ä½“å˜é‡é•¿åº¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">è°ƒç”¨ sendto å‡½æ•°æ—¶è‡ªåŠ¨ç»™clientåˆ†é…IPå’Œç«¯å£å·
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ssize_t&lt;/span> &lt;span class="nf">recvfrom&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">buff&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size_t&lt;/span> &lt;span class="n">nbytes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">flags&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">from&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">socklen_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">addrlen&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›æ¥æ”¶çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sock: ç”¨äºä¼ è¾“æ•°æ®çš„ UDP å¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">buff: ä¿å­˜å¾…ä¼ è¾“æ•°æ®çš„ç¼“å†²åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">nbytes: å¾…ä¼ è¾“çš„æ•°æ®é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">flags: å¯é€‰é¡¹å‚æ•°ï¼Œè‹¥æ²¡æœ‰åˆ™ä¼ é€’ 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">from: å­˜æœ‰**å‘é€ç«¯**åœ°å€ä¿¡æ¯çš„ sockaddr ç»“æ„ä½“å˜é‡çš„åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">addrlen: ä¿å­˜å‚æ•° from çš„ç»“æ„ä½“å˜é‡é•¿åº¦çš„å˜é‡åœ°å€å€¼ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="udp-çš„æ•°æ®ä¼ è¾“ç‰¹æ€§å’Œè°ƒç”¨-connect-å‡½æ•°">UDP çš„æ•°æ®ä¼ è¾“ç‰¹æ€§å’Œè°ƒç”¨ connect å‡½æ•°&lt;/h3>
&lt;ul>
&lt;li>è¾“å…¥å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°å’Œè¾“å‡ºå‡½æ•°çš„è°ƒç”¨æ¬¡æ•°åº”è¯¥&lt;strong>å®Œå…¨ä¸€è‡´&lt;/strong>&lt;/li>
&lt;li>æ¯æ¬¡è°ƒç”¨ sendto å‡½æ•°æ—¶æ¯æ¬¡éƒ½å˜æ›´ç›®æ ‡åœ°å€ï¼Œå› æ­¤å¯ä»¥é‡å¤åˆ©ç”¨åŒä¸€ UDP å¥—æ¥å­—å‘ä¸åŒç›®æ ‡ä¼ é€’æ•°æ®ã€‚è¿™ç§æœªæ³¨å†Œç›®æ ‡åœ°å€ä¿¡æ¯çš„å¥—æ¥å­—ç§°ä¸ºæœªè¿æ¥å¥—æ¥å­—ï¼Œåä¹‹ï¼Œæ³¨å†Œäº†ç›®æ ‡åœ°å€çš„å¥—æ¥å­—ç§°ä¸ºè¿æ¥ connected å¥—æ¥å­—ã€‚
&lt;ul>
&lt;li>sendtoæµç¨‹&lt;/li>
&lt;li>ç¬¬ 1 é˜¶æ®µï¼šå‘ UDP å¥—æ¥å­—æ³¨å†Œç›®æ ‡ IP å’Œç«¯å£å·&lt;/li>
&lt;li>ç¬¬ 2 é˜¶æ®µï¼šä¼ è¾“æ•°æ®&lt;/li>
&lt;li>ç¬¬ 3 é˜¶æ®µï¼šåˆ é™¤ UDP å¥—æ¥å­—ä¸­æ³¨å†Œçš„ç›®æ ‡åœ°å€ä¿¡æ¯ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>python -c &amp;quot;import socket;print([(s.connect(('8.8.8.8', 53)), s.getsockname()[0], s.close()) for s in [socket.socket(socket.AF_INET, socket.SOCK_DGRAM)]][0][1])&amp;quot;&lt;/p>
&lt;/blockquote>
&lt;p>ç»ˆç«¯è¾“å…¥ä¸Šè¿°å‘½ä»¤è·å–æœ¬åœ°ip&lt;/p>
&lt;h2 id="ä¼˜é›…çš„æ–­å¼€å¥—æ¥å­—çš„è¿æ¥">ä¼˜é›…çš„æ–­å¼€å¥—æ¥å­—çš„è¿æ¥&lt;/h2>
&lt;h3 id="åŸºäº-tcp-çš„åŠå…³é—­">åŸºäº TCP çš„åŠå…³é—­&lt;/h3>
&lt;p>TCP çš„æ–­å¼€è¿‡ç¨‹å¯èƒ½å‘ç”Ÿé¢„æƒ³ä¸åˆ°çš„æƒ…å†µï¼Œéœ€è¦æŒæ¡åŠå…³é—­ï¼ˆhalf-closeï¼‰ã€‚Linux å’Œ Windows çš„ closesocket å‡½æ•°æ„å‘³ç€å®Œå…¨æ–­å¼€è¿æ¥ã€‚å®Œå…¨æ–­å¼€ä¸ä»…æŒ‡æ— æ³•ä¼ è¾“æ•°æ®ï¼Œè€Œä¸”ä¹Ÿä¸èƒ½æ¥æ”¶æ•°æ®ã€‚&lt;br />ä¸€æ—¦ä¸¤å°ä¸»æœºä¹‹é—´å»ºç«‹äº†å¥—æ¥å­—è¿æ¥ï¼Œæ¯ä¸ªä¸»æœºå°±ä¼šæ‹¥æœ‰å•ç‹¬çš„è¾“å…¥æµå’Œè¾“å‡ºæµã€‚&lt;/p>
&lt;h4 id="é’ˆå¯¹ä¼˜é›…æ–­å¼€çš„-shutdown-å‡½æ•°">é’ˆå¯¹ä¼˜é›…æ–­å¼€çš„ shutdown å‡½æ•°&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">shutdown&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">howto&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sock: éœ€è¦æ–­å¼€å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">howto: ä¼ é€’æ–­å¼€æ–¹å¼ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> SHUT_RD : æ–­å¼€è¾“å…¥æµ 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> SHUT_WR : æ–­å¼€è¾“å‡ºæµ 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> SHUT_RDWR : åŒæ—¶æ–­å¼€ I/O æµ 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;a href="https://www.cnblogs.com/JohnABC/p/7238241.html">Linux-socketçš„closeå’ŒshutdownåŒºåˆ«åŠåº”ç”¨åœºæ™¯&lt;/a>ï¼ˆä¹Ÿæœ‰åç»­ç« èŠ‚çš„å¤šè¿›ç¨‹ä¼ è¾“ä¸­ä½¿ç”¨shutdownçš„åŸå› ï¼Œä¼šä¸ç®¡è®¡æ•°ï¼Œç›´æ¥å…³é—­è¾“å…¥è¾“å‡ºæµï¼‰&lt;/p>
&lt;h4 id="ä¸ºä½•è¦åŠå…³é—­">ä¸ºä½•è¦åŠå…³é—­&lt;/h4>
&lt;p>ä¸ºäº†å…³é—­æœåŠ¡å™¨åï¼Œä»å¯ä»¥æ¥æ”¶å®¢æˆ·ç«¯çš„æ•°æ®ã€‚è°ƒç”¨ shutdown å‡½æ•°ï¼Œåªå…³é—­æœåŠ¡å™¨çš„è¾“å‡ºæµã€‚è¿™æ ·æ—¢å¯ä»¥å‘é€ EOF ï¼ŒåŒæ—¶åˆä¿ç•™äº†è¾“å…¥æµã€‚&lt;/p>
&lt;h4 id="ä¸€ä¸ªä¼˜é›…çš„æµç¨‹">ä¸€ä¸ªä¼˜é›…çš„æµç¨‹&lt;/h4>
&lt;p>å½“æœåŠ¡ç«¯å‘é€å®Œæ•°æ®åï¼Œshutdownå…³é—­å‘é€æµï¼Œå½“æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„å›å¤ä¿¡æ¯ï¼Œåˆ™closeå¥—æ¥å­—ï¼ŒåŒæ—¶å®¢æˆ·ç«¯å‘é€å®Œæ¶ˆæ¯åå…³é—­å¥—æ¥å­—ã€‚&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-5.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/p>
&lt;h2 id="åŸŸååŠç½‘ç»œåœ°å€">åŸŸååŠç½‘ç»œåœ°å€&lt;/h2>
&lt;h3 id="åŸŸåç³»ç»Ÿ">åŸŸåç³»ç»Ÿ&lt;/h3>
&lt;p>DNS æ˜¯å¯¹IPåœ°å€å’ŒåŸŸåè¿›è¡Œç›¸äº’è½¬æ¢çš„ç³»ç»Ÿï¼Œå…¶æ ¸å¿ƒæ˜¯ DNS æœåŠ¡å™¨&lt;br />åŸŸåæ˜¯IPåœ°å€çš„åˆ«åï¼Œå¯ä»¥é€šè¿‡DNSæœåŠ¡å™¨æŸ¥è¯¢åˆ°å¯¹åº”IPåœ°å€&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-6.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />å½“åœ¨ç”µè„‘æµè§ˆå™¨ä¸Šè¾“å…¥ä¸€ä¸ªåŸŸåï¼Œä¼šé€šè¿‡ä¸€ç³»åˆ—çš„DNSæœåŠ¡å™¨çš„æ˜ å°„æ‰¾åˆ°æœ€ç»ˆçš„ç›®æ ‡æœåŠ¡å™¨ã€‚&lt;/p>
&lt;h3 id="ipåœ°å€å’ŒåŸŸåä¹‹é—´çš„è½¬æ¢">IPåœ°å€å’ŒåŸŸåä¹‹é—´çš„è½¬æ¢&lt;/h3>
&lt;h4 id="é€šè¿‡åŸŸåè·å¾—ip">é€šè¿‡åŸŸåè·å¾—ip&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;netdb.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">hostent&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nf">gethostbyname&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">hostname&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› hostent ç»“æ„ä½“åœ°å€ï¼Œå¤±è´¥æ—¶è¿”å› NULL æŒ‡é’ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">hostent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">h_name&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="cm">/* Official name of host. å®˜æ–¹åŸŸå*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">**&lt;/span>&lt;span class="n">h_aliases&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="cm">/* Alias list. åŸŸååˆ«ç§°*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">h_addrtype&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="cm">/* Host address type. IPåœ°å€*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">h_length&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="cm">/* Length of address. IPåœ°å€é•¿åº¦*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">**&lt;/span>&lt;span class="n">h_addr_list&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="cm">/* List of addresses from name server. åŸŸåå¯¹åº”IPåœ°å€ */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-7.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />linuxä¸‹å¯ä»¥ä½¿ç”¨dig @8.8.8.8 +trace baidu.comå‘½ä»¤è¿½è¸ªDNSæŸ¥è¯¢è·¯å¾„&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;netdb.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">error_handling&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">hostent&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">argc&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Usage : %s &amp;lt;addr&amp;gt;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æŠŠå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œè¿”å›ç»“æ„ä½“
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">host&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">gethostbyname&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// IP to host
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// struct sockaddr_in addr;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// memset(&amp;amp;addr, 0, sizeof(addr));
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// addr.sin_addr.s_addr = inet_addr(argv[1]);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// host = gethostbyaddr((char *)&amp;amp;addr.sin_addr, 4, AF_INET);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;gethost... error&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è¾“å‡ºå®˜æ–¹åŸŸå
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Official name: %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">h_name&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Aliases è²Œä¼¼æ˜¯è§£æçš„ cname åŸŸåï¼Ÿ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">h_aliases&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">];&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Aliases %d: %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">h_aliases&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//çœ‹çœ‹æ˜¯ä¸æ˜¯ipv4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Address type: %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">h_addrtype&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">AF_INET&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">?&lt;/span> &lt;span class="s">&amp;#34;AF_INET&amp;#34;&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="s">&amp;#34;AF_INET6&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è¾“å‡ºipåœ°å€ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">h_addr_list&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">];&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å¯¹in_addr*æŒ‡é’ˆå–å€¼ç”¨*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;IP addr %d: %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">inet_ntoa&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">in_addr&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">h_addr_list&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="åˆ©ç”¨ipåœ°å€è·å–åŸŸå">åˆ©ç”¨IPåœ°å€è·å–åŸŸå&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;netdb.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">hostent&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nf">gethostbyaddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">len&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">family&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› hostent ç»“æ„ä½“å˜é‡åœ°å€å€¼ï¼Œå¤±è´¥æ—¶è¿”å› NULL æŒ‡é’ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">addr: å«æœ‰IPåœ°å€ä¿¡æ¯çš„ in_addr ç»“æ„ä½“æŒ‡é’ˆã€‚ä¸ºäº†åŒæ—¶ä¼ é€’ IPV4 åœ°å€ä¹‹å¤–çš„å…¨éƒ¨ä¿¡æ¯ï¼Œè¯¥å˜é‡çš„ç±»å‹å£°æ˜ä¸º char æŒ‡é’ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">len: å‘ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’çš„åœ°å€ä¿¡æ¯çš„å­—èŠ‚æ•°ï¼ŒIPV4æ—¶ä¸º 4 ï¼ŒIPV6 æ—¶ä¸º16.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">family: ä¼ é€’åœ°å€æ—ä¿¡æ¯ï¼Œipv4 æ˜¯ AF_INET ï¼ŒIPV6æ˜¯ AF_INET6
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;a href="https://www.zhihu.com/question/34873227/answer/518086565">åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ä¸€ä¸ªURLåå›è½¦ï¼ŒèƒŒåä¼šè¿›è¡Œå“ªäº›æŠ€æœ¯æ­¥éª¤ï¼Ÿ&lt;/a>&lt;/p>
&lt;h2 id="å¥—æ¥å­—çš„å¤šç§å¯é€‰é¡¹">å¥—æ¥å­—çš„å¤šç§å¯é€‰é¡¹&lt;/h2>
&lt;h3 id="å¥—æ¥å­—å¯é€‰é¡¹å’Œ-io-ç¼“å†²å¤§å°">å¥—æ¥å­—å¯é€‰é¡¹å’Œ I/O ç¼“å†²å¤§å°&lt;/h3>
&lt;p>æˆ‘ä»¬ä¹‹å‰å†™å¾—ç¨‹åºéƒ½æ˜¯åˆ›å»ºå¥½å¥—æ¥å­—ä¹‹åç›´æ¥ä½¿ç”¨çš„ï¼Œæ­¤æ—¶é€šè¿‡é»˜è®¤çš„å¥—æ¥å­—ç‰¹æ€§è¿›è¡Œæ•°æ®é€šä¿¡ï¼Œè¿™é‡Œåˆ—å‡ºäº†ä¸€äº›å¥—æ¥å­—å¯é€‰é¡¹ã€‚&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>åè®®å±‚&lt;/th>
&lt;th>é€‰é¡¹å&lt;/th>
&lt;th>getsockopt&lt;/th>
&lt;th>setsockopt&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>SOL_SOCKET&lt;/td>
&lt;td>SO_SNDBUF&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SOL_SOCKET&lt;/td>
&lt;td>SO_RCVBUF&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SOL_SOCKET&lt;/td>
&lt;td>SO_REUSEADDR&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SOL_SOCKET&lt;/td>
&lt;td>SO_KEEPALIVE&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SOL_SOCKET&lt;/td>
&lt;td>SO_BROADCAST&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SOL_SOCKET&lt;/td>
&lt;td>SO_DONTROUTE&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SOL_SOCKET&lt;/td>
&lt;td>SO_OOBINLINE&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SOL_SOCKET&lt;/td>
&lt;td>SO_ERROR&lt;/td>
&lt;td>O&lt;/td>
&lt;td>X&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SOL_SOCKET&lt;/td>
&lt;td>SO_TYPE&lt;/td>
&lt;td>O&lt;/td>
&lt;td>X&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IPPROTO_IP&lt;/td>
&lt;td>IP_TOS&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IPPROTO_IP&lt;/td>
&lt;td>IP_TTL&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IPPROTO_IP&lt;/td>
&lt;td>IP_MULTICAST_TTL&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IPPROTO_IP&lt;/td>
&lt;td>IP_MULTICAST_LOOP&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IPPROTO_IP&lt;/td>
&lt;td>IP_MULTICAST_IF&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IPPROTO_TCP&lt;/td>
&lt;td>TCP_KEEPALIVE&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IPPROTO_TCP&lt;/td>
&lt;td>TCP_NODELAY&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IPPROTO_TCP&lt;/td>
&lt;td>TCP_MAXSEG&lt;/td>
&lt;td>O&lt;/td>
&lt;td>O&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¥—æ¥å­—å¯é€‰é¡¹æ˜¯åˆ†å±‚çš„ã€‚&lt;/p>
&lt;ul>
&lt;li>IPPROTO_IP å¯é€‰é¡¹æ˜¯IPåè®®ç›¸å…³äº‹é¡¹&lt;/li>
&lt;li>IPPROTO_TCP å±‚å¯é€‰é¡¹æ˜¯ TCP åè®®çš„ç›¸å…³äº‹é¡¹&lt;/li>
&lt;li>SOL_SOCKET å±‚æ˜¯å¥—æ¥å­—çš„é€šç”¨å¯é€‰é¡¹ã€‚&lt;/li>
&lt;li>ç”¨äºéªŒè¯å¥—æ¥ç±»å‹çš„ SO_TYPE æ˜¯åªè¯»å¯é€‰é¡¹ï¼Œå› ä¸º&lt;strong>å¥—æ¥å­—ç±»å‹åªèƒ½åœ¨åˆ›å»º(è°ƒç”¨socket()æ–¹æ³•æ—¶)æ—¶å†³å®šï¼Œä»¥åä¸èƒ½å†æ›´æ”¹&lt;/strong>ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="getsockopt--setsockopt">getsockopt &amp;amp; setsockopt&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="c1">// è¯»å–å¥—æ¥å­—å¯é€‰é¡¹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">getsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">level&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">optname&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">optval&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">socklen_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">optlen&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sock: ç”¨äºæŸ¥çœ‹é€‰é¡¹å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">level: è¦æŸ¥çœ‹çš„å¯é€‰é¡¹åè®®å±‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">optname: è¦æŸ¥çœ‹çš„å¯é€‰é¡¹å
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">optval: ä¿å­˜æŸ¥çœ‹ç»“æœçš„ç¼“å†²åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">optlen: å‘ç¬¬å››ä¸ªå‚æ•°ä¼ é€’çš„ç¼“å†²å¤§å°ã€‚è°ƒç”¨å‡½æ•°åï¼Œè¯¥å˜é‡ä¸­ä¿å­˜é€šè¿‡ç¬¬å››ä¸ªå‚æ•°è¿”å›çš„å¯é€‰é¡¹ä¿¡æ¯çš„å­—èŠ‚æ•°ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="c1">// æ›´æ”¹å¯é€‰é¡¹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">level&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">optname&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">optval&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">optlen&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">sock: ç”¨äºæ›´æ”¹é€‰é¡¹å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">level: è¦æ›´æ”¹çš„å¯é€‰é¡¹åè®®å±‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">optname: è¦æ›´æ”¹çš„å¯é€‰é¡¹å
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">optval: ä¿å­˜æ›´æ”¹ç»“æœçš„ç¼“å†²åœ°å€å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">optlen: å‘ç¬¬å››ä¸ªå‚æ•°ä¼ é€’çš„ç¼“å†²å¤§å°ã€‚è°ƒç”¨å‡½æ•°åï¼Œè¯¥å˜é‡ä¸­ä¿å­˜é€šè¿‡ç¬¬å››ä¸ªå‚æ•°è¿”å›çš„å¯é€‰é¡¹ä¿¡æ¯çš„å­—èŠ‚æ•°ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">tcp_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">udp_sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sock_type&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">optlen&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">state&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">optlen&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sock_type&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">tcp_sock&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">udp_sock&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_DGRAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;SOCK_STREAM: %d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;SOCK_DGRAM: %d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_DGRAM&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">state&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">getsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tcp_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_TYPE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">sock_type&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">optlen&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Socket type one: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sock_type&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">state&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">getsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">udp_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_TYPE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">sock_type&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">optlen&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Socket type two: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sock_type&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="so_sndbuf--so_rcvbuf">SO_SNDBUF &amp;amp; SO_RCVBUF&lt;/h4>
&lt;p>è®¾ç½®ç¼“å†²åŒºä¸ä¼šæŒ‰ç…§ä»£ç æ‰€è¦æ±‚çš„ç¼“å†²åŒºå¤§å°ï¼Œæ‰€ä»¥å®ç°è¦å°å¿ƒã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* Set socket FD&amp;#39;s option OPTNAME at protocol level LEVEL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> to *OPTVAL (which is OPTLEN bytes long).
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> Returns 0 on success, -1 for errors. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">extern&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">setsockopt&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">__fd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">__level&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">__optname&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">const&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">__optval&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">__optlen&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">__THROW&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* Put the current value for socket FD&amp;#39;s option OPTNAME at protocol level LEVEL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> into OPTVAL (which is *OPTLEN bytes long), and set *OPTLEN to the value&amp;#39;s
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> actual length. Returns 0 on success, -1 for errors. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">extern&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">getsockopt&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">__fd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">__level&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">__optname&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">__restrict&lt;/span> &lt;span class="n">__optval&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socklen_t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">__restrict&lt;/span> &lt;span class="n">__optlen&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">__THROW&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="so_reuseaddrimportant">SO_REUSEADDRï¼ˆimportantï¼‰&lt;/h3>
&lt;h4 id="time-wait-çŠ¶æ€">Time-wait çŠ¶æ€&lt;/h4>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-8.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />å‡è®¾å›¾ä¸­ä¸»æœº A æ˜¯æœåŠ¡å™¨ï¼Œå› ä¸ºæ˜¯ä¸»æœº A å‘ B å‘é€ FIN æ¶ˆæ¯ï¼Œå³æœåŠ¡å™¨ä½¿ç”¨ CTRL+Cå¼ºåˆ¶ç»ˆæ­¢ ã€‚ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œå¥—æ¥å­—ç»è¿‡å››æ¬¡æ¡æ‰‹åå¹¶æ²¡æœ‰ç«‹å³æ¶ˆé™¤ï¼Œè€Œæ˜¯è¦ç»è¿‡ä¸€æ®µæ—¶é—´çš„ Time-wait çŠ¶æ€ã€‚å½“ç„¶ï¼Œåªæœ‰&lt;strong>å…ˆæ–­å¼€è¿æ¥&lt;/strong>çš„ï¼ˆ&lt;strong>å…ˆå‘é€ FIN æ¶ˆæ¯&lt;/strong>çš„ï¼‰ä¸»æœºæ‰ç»è¿‡ Time-wait çŠ¶æ€ã€‚å› æ­¤ï¼Œè‹¥æœåŠ¡å™¨ç«¯å…ˆæ–­å¼€è¿æ¥ï¼Œåˆ™æ— æ³•ç«‹å³é‡æ–°è¿è¡Œã€‚å¥—æ¥å­—å¤„åœ¨ Time-wait è¿‡ç¨‹æ—¶ï¼Œç›¸åº”ç«¯å£æ˜¯æ­£åœ¨ä½¿ç”¨çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œå°±åƒä¹‹å‰éªŒè¯è¿‡çš„ï¼Œbind å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿé”™è¯¯ã€‚&lt;br />å®é™…ä¸Šï¼Œä¸è®ºæ˜¯æœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œéƒ½è¦ç»è¿‡ä¸€æ®µæ—¶é—´çš„ Time-wait è¿‡ç¨‹ã€‚å…ˆæ–­å¼€è¿æ¥çš„å¥—æ¥å­—å¿…ç„¶ä¼šç»è¿‡ Time-wait è¿‡ç¨‹ï¼Œä½†æ˜¯ç”±äº&lt;strong>å®¢æˆ·ç«¯å¥—æ¥å­—çš„ç«¯å£æ˜¯ä»»æ„æŒ‡å®š&lt;/strong>çš„ï¼Œæ‰€ä»¥æ— éœ€è¿‡å¤šå…³æ³¨ Time-wait çŠ¶æ€ã€‚&lt;br />é‚£åˆ°åº•ä¸ºä»€ä¹ˆä¼šæœ‰ Time-wait çŠ¶æ€å‘¢ï¼Œåœ¨å›¾ä¸­å‡è®¾ï¼Œä¸»æœº A å‘ä¸»æœº B ä¼ è¾“ ACK æ¶ˆæ¯ï¼ˆSEQ 5001 , ACK 7502 ï¼‰åç«‹åˆ»æ¶ˆé™¤å¥—æ¥å­—ã€‚ä½†æ˜¯æœ€åè¿™æ¡ ACK æ¶ˆæ¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­ä¸¢å¤±ï¼Œæ²¡æœ‰ä¼ é€’ä¸»æœº B ï¼Œè¿™æ—¶ä¸»æœº B å°±ä¼šè¯•å›¾é‡ä¼ ã€‚ä½†æ˜¯æ­¤æ—¶ä¸»æœº A å·²ç»æ˜¯å®Œå…¨ç»ˆæ­¢çŠ¶æ€ï¼Œå› æ­¤ä¸»æœº B æ°¸è¿œæ— æ³•æ”¶åˆ°ä»ä¸»æœº A æœ€åä¼ æ¥çš„ ACK æ¶ˆæ¯ã€‚é˜²æ­¢æ•°æ®ä¸¢å¤±åï¼Œæ— æ³•å†æ¬¡é€šä¿¡ï¼Œæ‰€ä»¥è¦è®¾è®¡ Time-wait çŠ¶æ€ã€‚&lt;/p>
&lt;h4 id="åœ°å€å†åˆ†é…">åœ°å€å†åˆ†é…&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">socklen_t&lt;/span> &lt;span class="n">optlen&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">option&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_REUSEADDR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">option&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">optlen&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="tcp_nodelay">TCP_NODELAY&lt;/h3>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-9.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="åªæœ‰æ¥æ”¶åˆ°å‰ä¸€æ•°æ®çš„ ACK æ¶ˆæ¯ï¼Œ Nagle ç®—æ³•æ‰å‘é€ä¸‹ä¸€æ•°æ®ã€‚" title="åªæœ‰æ¥æ”¶åˆ°å‰ä¸€æ•°æ®çš„ ACK æ¶ˆæ¯ï¼Œ Nagle ç®—æ³•æ‰å‘é€ä¸‹ä¸€æ•°æ®ã€‚">&lt;br />TCP å¥—æ¥å­—é»˜è®¤ä½¿ç”¨ Nagle ç®—æ³•äº¤æ¢æ•°æ®ï¼Œå› æ­¤æœ€å¤§é™åº¦çš„è¿›è¡Œç¼“å†²ï¼Œç›´åˆ°æ”¶åˆ° ACK ã€‚å·¦å›¾ä¹Ÿå°±æ˜¯è¯´ä¸€å…±ä¼ é€’ 4 ä¸ªæ•°æ®åŒ…ä»¥ä¼ è¾“ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä»å³å›¾å¯ä»¥çœ‹å‡ºï¼Œå‘é€æ•°æ®åŒ…ä¸€å…±ä½¿ç”¨äº† 10 ä¸ªæ•°æ®åŒ…ã€‚ç”±æ­¤å¯çŸ¥ï¼Œä¸ä½¿ç”¨ Nagle ç®—æ³•å°†å¯¹ç½‘ç»œæµé‡äº§ç”Ÿè´Ÿé¢å½±å“ã€‚å³ä½¿åªä¼ è¾“ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œå…¶å¤´ä¿¡æ¯éƒ½å¯èƒ½æ˜¯å‡ åä¸ªå­—èŠ‚ã€‚å› æ­¤ï¼Œä¸ºäº†æé«˜ç½‘ç»œä¼ è¾“æ•ˆç‡ï¼Œå¿…é¡»ä½¿ç”¨ Nagle ç®—æ³•ã€‚&lt;br />Nagle ç®—æ³•å¹¶ä¸æ˜¯ä»€ä¹ˆæƒ…å†µä¸‹éƒ½é€‚ç”¨ï¼Œ&lt;strong>ç½‘ç»œæµé‡æœªå—å¤ªå¤§å½±å“æ—¶&lt;/strong>ï¼Œä¸ä½¿ç”¨ Nagle ç®—æ³•è¦æ¯”ä½¿ç”¨å®ƒæ—¶ä¼ è¾“é€Ÿåº¦å¿«ã€‚æœ€å…¸å‹çš„å°±æ˜¯ã€Œ&lt;strong>ä¼ è¾“å¤§æ–‡æ•°æ®&lt;/strong>ã€ã€‚å°†æ–‡ä»¶æ•°æ®ä¼ å…¥è¾“å‡ºç¼“å†²ä¸ä¼šèŠ±å¤ªå¤šæ—¶é—´ï¼Œå› æ­¤ï¼Œä¸ä½¿ç”¨ Nagle ç®—æ³•ï¼Œä¹Ÿä¼šåœ¨è£…æ»¡è¾“å‡ºç¼“å†²æ—¶ä¼ è¾“æ•°æ®åŒ…ã€‚è¿™ä¸ä»…ä¸ä¼šå¢åŠ æ•°æ®åŒ…çš„æ•°é‡ï¼Œåè€Œåœ¨æ— éœ€ç­‰å¾… ACK çš„å‰æä¸‹è¿ç»­ä¼ è¾“ï¼Œå› æ­¤å¯ä»¥å¤§å¤§æé«˜ä¼ è¾“é€Ÿåº¦ã€‚&lt;br />æ‰€ä»¥ï¼Œæœªå‡†ç¡®åˆ¤æ–­æ•°æ®æ€§è´¨æ—¶ä¸åº”ç¦ç”¨ Nagle ç®—æ³•ã€‚&lt;/p>
&lt;h4 id="ç¦ç”¨-nagle-ç®—æ³•">ç¦ç”¨ Nagle ç®—æ³•&lt;/h4>
&lt;p>ç¦ç”¨ Nagle ç®—æ³•åº”è¯¥ä½¿ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;netinet/tcp.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;netinet/in.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">opt_val&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IPPROTO_TCP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">TCP_NODELAY&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">opt_val&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">opt_val&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é€šè¿‡ TCP_NODELAY çš„å€¼æ¥æŸ¥çœ‹Nagle ç®—æ³•çš„è®¾ç½®çŠ¶æ€ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">opt_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">opt_val&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">getsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IPPROTO_TCP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">TCP_NODELAY&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">opt_val&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">opt_len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚æœæ­£åœ¨ä½¿ç”¨Nagle ç®—æ³•ï¼Œé‚£ä¹ˆ opt_val å€¼ä¸º 0ï¼ˆé»˜è®¤å¯ç”¨ï¼‰ï¼Œå¦‚æœç¦ç”¨åˆ™ä¸º 1.&lt;br />å…³äºè¿™ä¸ªç®—æ³•ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªå›ç­”ï¼š&lt;a href="https://www.zhihu.com/question/42308970/answer/246334766">TCPè¿æ¥ä¸­å¯ç”¨å’Œç¦ç”¨TCP_NODELAYæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ&lt;/a>&lt;/p>
&lt;h2 id="å¤šè¿›ç¨‹æœåŠ¡å™¨ç«¯">å¤šè¿›ç¨‹æœåŠ¡å™¨ç«¯&lt;/h2>
&lt;p>é€šè¿‡æ”¹è¿›æœåŠ¡ç«¯ï¼Œä½¿å…¶åŒæ—¶å‘æ‰€æœ‰å‘èµ·è¯·æ±‚çš„å®¢æˆ·ç«¯æä¾›æœåŠ¡ï¼Œä»¥æé«˜å¹³å‡æ»¡æ„åº¦ã€‚è€Œä¸”ï¼Œç½‘ç»œç¨‹åºä¸­æ•°æ®é€šä¿¡æ—¶é—´æ¯” CPU è¿ç®—æ—¶é—´å æ¯”æ›´å¤§ï¼Œå› æ­¤ï¼Œå‘å¤šä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡æ˜¯ä¸€ç§æœ‰æ•ˆçš„åˆ©ç”¨ CPU çš„æ–¹å¼ã€‚&lt;/p>
&lt;ul>
&lt;li>å¤šè¿›ç¨‹æœåŠ¡å™¨ï¼šé€šè¿‡åˆ›å»ºå¤šä¸ªè¿›ç¨‹æä¾›æœåŠ¡&lt;/li>
&lt;li>å¤šè·¯å¤ç”¨æœåŠ¡å™¨ï¼šé€šè¿‡æ†ç»‘å¹¶ç»Ÿä¸€ç®¡ç† I/O å¯¹è±¡æä¾›æœåŠ¡&lt;/li>
&lt;li>å¤šçº¿ç¨‹æœåŠ¡å™¨ï¼šé€šè¿‡ç”Ÿæˆä¸å®¢æˆ·ç«¯ç­‰é‡çš„çº¿ç¨‹æä¾›æœåŠ¡&lt;/li>
&lt;/ul>
&lt;h3 id="è¿›ç¨‹æ¦‚å¿µåŠåº”ç”¨">è¿›ç¨‹æ¦‚å¿µåŠåº”ç”¨&lt;/h3>
&lt;h4 id="ç†è§£è¿›ç¨‹">ç†è§£è¿›ç¨‹&lt;/h4>
&lt;p>è¿›ç¨‹çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p>
&lt;blockquote>
&lt;p>å ç”¨å†…å­˜ç©ºé—´çš„æ­£åœ¨è¿è¡Œçš„ç¨‹åº&lt;/p>
&lt;/blockquote>
&lt;p>æ‰€æœ‰çš„è¿›ç¨‹éƒ½ä¼šè¢«æ“ä½œç³»ç»Ÿåˆ†é…ä¸€ä¸ª IDã€‚æ­¤ ID è¢«ç§°ä¸ºã€Œè¿›ç¨‹IDã€ï¼Œå…¶å€¼ä¸ºå¤§äº 2 çš„æ•´æ•°ã€‚1 è¦åˆ†é…ç»™æ“ä½œç³»ç»Ÿå¯åŠ¨åçš„ï¼ˆç”¨äºååŠ©æ“ä½œç³»ç»Ÿï¼‰é¦–ä¸ªè¿›ç¨‹ã€‚&lt;br />linuxè¿è¡Œ ps au å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ã€‚&lt;/p>
&lt;h4 id="è°ƒç”¨-fork-å‡½æ•°åˆ›å»ºè¿›ç¨‹">è°ƒç”¨ fork å‡½æ•°åˆ›å»ºè¿›ç¨‹&lt;/h4>
&lt;p>åˆ›å»ºè¿›ç¨‹çš„æ–¹å¼å¾ˆå¤šï¼Œæ­¤å¤„åªä»‹ç»ç”¨äºåˆ›å»ºå¤šè¿›ç¨‹æœåŠ¡ç«¯çš„ fork å‡½æ•°ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="n">pid_t&lt;/span> &lt;span class="nf">fork&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>fork å‡½æ•°å°†åˆ›å»ºè°ƒç”¨çš„è¿›ç¨‹å‰¯æœ¬ï¼Œå¤åˆ¶æ­£åœ¨è¿è¡Œçš„ã€è°ƒç”¨ fork å‡½æ•°çš„è¿›ç¨‹ã€‚å¦å¤–ï¼Œä¸¤ä¸ªè¿›ç¨‹éƒ½æ‰§è¡Œ fork å‡½æ•°è°ƒç”¨åçš„æ‰€æœ‰è¯­å¥ã€‚ä½†å› ä¸ºæ˜¯é€šè¿‡åŒä¸€ä¸ªè¿›ç¨‹ã€å¤åˆ¶ç›¸åŒçš„å†…å­˜ç©ºé—´ï¼Œä¹‹åçš„ç¨‹åºæµè¦æ ¹æ® fork å‡½æ•°çš„è¿”å›å€¼ç”¨if/elseåŠ ä»¥åŒºåˆ†ã€‚å³åˆ©ç”¨ fork å‡½æ•°çš„å¦‚ä¸‹ç‰¹ç‚¹åŒºåˆ†ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚&lt;/p>
&lt;ul>
&lt;li>çˆ¶è¿›ç¨‹ï¼šfork å‡½æ•°è¿”å›å­è¿›ç¨‹ ID&lt;/li>
&lt;li>å­è¿›ç¨‹ï¼šfork å‡½æ•°è¿”å› 0&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">gval&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid_t&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">lval&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">gval&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">lval&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å…ˆå‰gval=11, lval = 25
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// å­è¿›ç¨‹æ“ä½œval
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">gval&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">lval&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="c1">// çˆ¶è¿›ç¨‹æ“ä½œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">gval&lt;/span> &lt;span class="o">-=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">lval&lt;/span> &lt;span class="o">-=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child Proc: [%d,%d] &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">gval&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">lval&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// [13, 27]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Parent Proc: [%d,%d] &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">gval&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">lval&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// [9, 23]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="åƒµå°¸è¿›ç¨‹">åƒµå°¸è¿›ç¨‹&lt;/h3>
&lt;blockquote>
&lt;p>åƒµå°¸è¿›ç¨‹æ˜¯å½“å­è¿›ç¨‹æ¯”çˆ¶è¿›ç¨‹å…ˆç»“æŸï¼Œè€Œçˆ¶è¿›ç¨‹åˆæ²¡æœ‰å›æ”¶å­è¿›ç¨‹ï¼Œé‡Šæ”¾å­è¿›ç¨‹å ç”¨çš„èµ„æºï¼Œæ­¤æ—¶å­è¿›ç¨‹å°†æˆä¸ºä¸€ä¸ªåƒµå°¸è¿›ç¨‹ã€‚å¦‚æœçˆ¶è¿›ç¨‹å…ˆé€€å‡º ï¼Œå­è¿›ç¨‹è¢«initæ¥ç®¡ï¼Œå­è¿›ç¨‹é€€å‡ºåinitä¼šå›æ”¶å…¶å ç”¨çš„ç›¸å…³èµ„æº&lt;/p>
&lt;/blockquote>
&lt;p>ä½¿ç”¨ps au æŸ¥çœ‹åƒµå°¸è¿›ç¨‹æ—¶ï¼Œå…¶statä¸ºZï¼Œä»¥ä¸‹æ˜¯å¸¸ç”¨statï¼Œå¯ç»„åˆä½¿ç”¨&lt;/p>
&lt;blockquote>
&lt;p>D //æ— æ³•ä¸­æ–­çš„ä¼‘çœ çŠ¶æ€ï¼ˆé€šå¸¸ IO çš„è¿›ç¨‹ï¼‰ï¼› &lt;br />R //æ­£åœ¨è¿è¡Œå¯ä¸­åœ¨é˜Ÿåˆ—ä¸­å¯è¿‡è¡Œçš„ï¼› &lt;br />S //å¤„äºä¼‘çœ çŠ¶æ€ï¼› &lt;br />T //åœæ­¢æˆ–è¢«è¿½è¸ªï¼› &lt;br />W //è¿›å…¥å†…å­˜äº¤æ¢ ï¼ˆä»å†…æ ¸2.6å¼€å§‹æ— æ•ˆï¼‰ï¼› &lt;br />X //æ­»æ‰çš„è¿›ç¨‹ ï¼ˆåŸºæœ¬å¾ˆå°‘è§ï¼‰ï¼› &lt;br />Z //åƒµå°¸è¿›ç¨‹ï¼› &lt;br />&amp;lt; //ä¼˜å…ˆçº§é«˜çš„è¿›ç¨‹ &lt;br />N //ä¼˜å…ˆçº§è¾ƒä½çš„è¿›ç¨‹ &lt;br />L //æœ‰äº›é¡µè¢«é”è¿›å†…å­˜ï¼› &lt;br />s //è¿›ç¨‹çš„é¢†å¯¼è€…ï¼ˆåœ¨å®ƒä¹‹ä¸‹æœ‰å­è¿›ç¨‹ï¼‰ï¼› &lt;br />l //å¤šçº¿ç¨‹ï¼Œå…‹éš†çº¿ç¨‹ï¼ˆä½¿ç”¨ CLONE_THREAD, ç±»ä¼¼ NPTL pthreadsï¼‰ï¼› &lt;br />+ //ä½äºåå°çš„è¿›ç¨‹ç»„ï¼›ï¼ˆæ­£åœ¨ä½¿ç”¨çš„è¿›ç¨‹ï¼Ÿï¼‰&lt;/p>
&lt;/blockquote>
&lt;h4 id="äº§ç”Ÿåƒµå°¸è¿›ç¨‹çš„åŸå› ">äº§ç”Ÿåƒµå°¸è¿›ç¨‹çš„åŸå› &lt;/h4>
&lt;p>å‘ exit å‡½æ•°ä¼ é€’çš„å‚æ•°å€¼(e.g. 0)å’Œ main å‡½æ•°çš„ return è¯­å¥è¿”å›çš„å€¼(e.g. 0)éƒ½ä¼šä¼ é€’ç»™æ“ä½œç³»ç»Ÿã€‚è€Œæ“ä½œç³»ç»Ÿä¸ä¼šé”€æ¯å­è¿›ç¨‹ï¼Œ&lt;strong>ç›´åˆ°æŠŠè¿™äº›å€¼ä¼ é€’ç»™äº§ç”Ÿè¯¥å­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹&lt;/strong>ã€‚å¤„åœ¨è¿™ç§çŠ¶æ€ä¸‹çš„è¿›ç¨‹å°±æ˜¯åƒµå°¸è¿›ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´å°†å­è¿›ç¨‹å˜æˆåƒµå°¸è¿›ç¨‹çš„æ­£æ˜¯æ“ä½œç³»ç»Ÿã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œåƒµå°¸è¿›ç¨‹ä½•æ—¶è¢«é”€æ¯å‘¢ï¼Ÿçˆ¶è¿›ç¨‹ä¸»åŠ¨å‘èµ·è¯·æ±‚ï¼ˆwaitå‡½æ•°è°ƒç”¨ï¼‰çš„æ—¶å€™ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid_t&lt;/span> &lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Hi, I am a child Process&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child Process ID: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ä½¿å­è¿›ç¨‹å˜åƒµå°¸ï¼Œ30såå†ç»ˆæ­¢å­è¿›ç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;End child proess&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;End parent process&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>åˆ©ç”¨ ./zombie &amp;amp;å¯ä»¥ä½¿ç¨‹åºåœ¨åå°è¿è¡Œï¼Œä¸ç”¨æ‰“å¼€æ–°çš„å‘½ä»¤è¡Œçª—å£ã€‚è¾“å…¥ps auæŸ¥çœ‹Z&lt;/p>
&lt;/blockquote>
&lt;h4 id="é”€æ¯åƒµå°¸è¿›ç¨‹-1åˆ©ç”¨-wait-å‡½æ•°">é”€æ¯åƒµå°¸è¿›ç¨‹ 1ï¼šåˆ©ç”¨ wait å‡½æ•°&lt;/h4>
&lt;p>ä¸ºäº†é”€æ¯å­è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹åº”è¯¥ä¸»åŠ¨è¯·æ±‚è·å–å­è¿›ç¨‹çš„è¿”å›å€¼ã€‚ä¸‹é¢æ˜¯å‘èµ·è¯·æ±‚çš„å…·ä½“æ–¹æ³•ï¼Œæœ‰ä¸¤ç§ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/wait.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="n">pid_t&lt;/span> &lt;span class="nf">wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">statloc&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›ç»ˆæ­¢çš„å­è¿›ç¨‹ ID ,å¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è°ƒç”¨æ­¤å‡½æ•°æ—¶å¦‚æœå·²æœ‰å­è¿›ç¨‹ç»ˆæ­¢ï¼Œé‚£ä¹ˆå­è¿›ç¨‹ç»ˆæ­¢æ—¶ä¼ é€’çš„è¿”å›å€¼ï¼ˆexit å‡½æ•°çš„å‚æ•°è¿”å›å€¼ï¼Œmain å‡½æ•°çš„ return è¿”å›å€¼ï¼‰å°†ä¿å­˜åˆ°è¯¥å‡½æ•°çš„å‚æ•°æ‰€æŒ‡çš„å†…å­˜ç©ºé—´ã€‚ä½†å‡½æ•°å‚æ•°æŒ‡å‘çš„å†…å­˜ç©ºé—´ä¸­è¿˜åŒ…å«å…¶ä»–ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦ç”¨ä¸‹åˆ—å®è¿›è¡Œåˆ†ç¦»ï¼š&lt;/p>
&lt;ul>
&lt;li>WIFEXITED å­è¿›ç¨‹æ­£å¸¸ç»ˆæ­¢æ—¶è¿”å›ã€ŒçœŸã€&lt;/li>
&lt;li>WEXITSTATUS è¿”å›å­è¿›ç¨‹æ—¶çš„è¿”å›å€¼&lt;/li>
&lt;/ul>
&lt;p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå‘ wait å‡½æ•°ä¼ é€’å˜é‡ status çš„åœ°å€æ—¶ï¼Œè°ƒç”¨ wait å‡½æ•°ååº”ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š&lt;br />WIFIEXITEDï¼š((status) &amp;amp; 0x7f) == 0&lt;br />WEXITSTATUSï¼š(((status) &amp;amp; 0xff00) &amp;gt;&amp;gt; 8)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/wait.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid_t&lt;/span> &lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="c1">//è¿™é‡Œçš„å­è¿›ç¨‹å°†åœ¨ç¬¬13è¡Œé€šè¿‡ return è¯­å¥ç»ˆæ­¢
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child PID: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="c1">//è¿™é‡Œçš„å­è¿›ç¨‹å°†åœ¨ 21 è¡Œé€šè¿‡ exit() å‡½æ•°ç»ˆæ­¢
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child PID: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//ä¹‹é—´ç»ˆæ­¢çš„å­è¿›ç¨‹ç›¸å…³ä¿¡æ¯å°†è¢«ä¿å­˜åˆ° status ä¸­ï¼ŒåŒæ—¶ç›¸å…³å­è¿›ç¨‹è¢«å®Œå…¨é”€æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">WIFEXITED&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">//é€šè¿‡ WIFEXITED æ¥éªŒè¯å­è¿›ç¨‹æ˜¯å¦æ­£å¸¸ç»ˆæ­¢ã€‚å¦‚æœæ­£å¸¸ç»ˆæ­¢ï¼Œåˆ™è°ƒç”¨ WEXITSTATUS å®è¾“å‡ºå­è¿›ç¨‹è¿”å›å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child send one: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">WEXITSTATUS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//å› ä¸ºä¹‹å‰åˆ›å»ºäº†ä¸¤ä¸ªè¿›ç¨‹ï¼Œæ‰€ä»¥å†æ¬¡è°ƒç”¨ wait å‡½æ•°å’Œå®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">WIFEXITED&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child send two: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">WEXITSTATUS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™å°±æ˜¯é€šè¿‡ wait å‡½æ•°æ¶ˆç­åƒµå°¸è¿›ç¨‹çš„æ–¹æ³•ï¼Œè°ƒç”¨ wait å‡½æ•°æ—¶ï¼Œå¦‚æœæ²¡æœ‰å·²ç»ç»ˆæ­¢çš„å­è¿›ç¨‹ï¼Œé‚£ä¹ˆç¨‹åºå°†&lt;strong>é˜»å¡ï¼ˆBlockingï¼‰ç›´åˆ°æœ‰å­è¿›ç¨‹ç»ˆæ­¢&lt;/strong>ï¼Œå› æ­¤è¦è°¨æ…è°ƒç”¨è¯¥å‡½æ•°ã€‚&lt;/p>
&lt;h4 id="é”€æ¯åƒµå°¸è¿›ç¨‹-2ä½¿ç”¨-waitpid-å‡½æ•°">é”€æ¯åƒµå°¸è¿›ç¨‹ 2ï¼šä½¿ç”¨ waitpid å‡½æ•°&lt;/h4>
&lt;p>wait å‡½æ•°ä¼šå¼•èµ·ç¨‹åºé˜»å¡ï¼Œè¿˜å¯ä»¥è€ƒè™‘è°ƒç”¨ waitpid å‡½æ•°ã€‚è¿™æ˜¯é˜²æ­¢åƒµå°¸è¿›ç¨‹çš„ç¬¬äºŒç§æ–¹æ³•ï¼Œä¹Ÿæ˜¯é˜²æ­¢é˜»å¡çš„æ–¹æ³•ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/wait.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="n">pid_t&lt;/span> &lt;span class="nf">waitpid&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pid_t&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">statloc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">options&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å›ç»ˆæ­¢çš„å­è¿›ç¨‹ID æˆ– 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">pid: ç­‰å¾…ç»ˆæ­¢çš„ç›®æ ‡å­è¿›ç¨‹çš„ID,è‹¥ä¼  -1ï¼Œåˆ™ä¸ wait å‡½æ•°ç›¸åŒï¼Œå¯ä»¥ç­‰å¾…ä»»æ„å­è¿›ç¨‹ç»ˆæ­¢
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">statloc: ä¸ wait å‡½æ•°çš„ statloc å‚æ•°å…·æœ‰ç›¸åŒå«ä¹‰
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">options: ä¼ é€’å¤´æ–‡ä»¶ sys/wait.h å£°æ˜çš„å¸¸é‡ WNOHANG ,å³ä½¿æ²¡æœ‰ç»ˆæ­¢çš„å­è¿›ç¨‹ä¹Ÿä¸ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯è¿”å› 0 é€€å‡ºå‡½æ•°ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/wait.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid_t&lt;/span> &lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//ç”¨ sleep æ¨è¿Ÿå­è¿›ç¨‹çš„æ‰§è¡Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">24&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//è°ƒç”¨waitpid ä¼ é€’å‚æ•° WNOHANG ï¼Œè¿™æ ·æ²¡æœ‰ç»ˆæ­¢çš„å­è¿›ç¨‹è¿”å›0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">waitpid&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">WNOHANG&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;sleep 3 sec.&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">WIFEXITED&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child send %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">WEXITSTATUS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ä¿¡å·å¤„ç†">ä¿¡å·å¤„ç†&lt;/h3>
&lt;p>æˆ‘ä»¬å·²ç»çŸ¥é“äº†è¿›ç¨‹çš„åˆ›å»ºåŠé”€æ¯çš„åŠæ³•ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å­è¿›ç¨‹ç©¶ç«Ÿä½•æ—¶ç»ˆæ­¢ï¼Ÿè°ƒç”¨ waitpid å‡½æ•°åè¦æ— ä¼‘æ­¢çš„ç­‰å¾…å—ï¼Ÿ&lt;/p>
&lt;/blockquote>
&lt;p>å­è¿›ç¨‹ç»ˆæ­¢çš„è¯†åˆ«ä¸»é¢˜æ˜¯æ“ä½œç³»ç»Ÿï¼Œå› æ­¤ï¼Œè‹¥æ“ä½œç³»ç»Ÿèƒ½æŠŠå­è¿›ç¨‹ç»“æŸçš„ä¿¡æ¯å‘Šè¯‰æ­£å¿™äºå·¥ä½œçš„çˆ¶è¿›ç¨‹ï¼Œå°†æœ‰åŠ©äºæ„å»ºæ›´é«˜æ•ˆçš„ç¨‹åº&lt;br />ä¸ºäº†å®ç°ä¸Šè¿°çš„åŠŸèƒ½ï¼Œå¼•å…¥ä¿¡å·å¤„ç†æœºåˆ¶ï¼ˆSignal Handingï¼‰ã€‚æ­¤å¤„ã€Œä¿¡å·ã€æ˜¯åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶ç”±æ“ä½œç³»ç»Ÿå‘è¿›ç¨‹å‘é€çš„æ¶ˆæ¯ã€‚å¦å¤–ï¼Œä¸ºäº†å“åº”è¯¥æ¶ˆæ¯ï¼Œæ‰§è¡Œä¸æ¶ˆæ¯ç›¸å…³çš„è‡ªå®šä¹‰æ“ä½œçš„è¿‡ç¨‹è¢«ç§°ä¸ºã€Œå¤„ç†ã€æˆ–ã€Œä¿¡å·å¤„ç†ã€ï¼ˆQTä¿¡å·æ§½ï¼Ÿï¼‰ã€‚&lt;/p>
&lt;h4 id="ä¿¡å·ä¸-signal-å‡½æ•°">ä¿¡å·ä¸ signal å‡½æ•°&lt;/h4>
&lt;p>ä¸‹é¢è¿›ç¨‹å’Œæ“ä½œç³»ç»Ÿçš„å¯¹è¯å¯ä»¥å¸®åŠ©ç†è§£ä¿¡å·å¤„ç†ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è¿›ç¨‹ï¼šæ“ä½œç³»ç»Ÿï¼Œå¦‚æœæˆ‘ä¹‹å‰åˆ›å»ºçš„å­è¿›ç¨‹ç»ˆæ­¢ï¼Œå°±å¸®æˆ‘è°ƒç”¨ zombie_handler å‡½æ•°ã€‚
æ“ä½œç³»ç»Ÿï¼šå¥½çš„ï¼Œå¦‚æœä½ çš„å­è¿›ç¨‹ç»ˆæ­¢ï¼Œæˆ‘å°±å¸®ä½ è°ƒç”¨ zombie_handler å‡½æ•°ï¼Œä½ å…ˆæŠŠå‡½æ•°è¦æ‰§è¡Œçš„è¯­å¥å†™å¥½ã€‚&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>ä¸Šè¿°çš„å¯¹è¯ï¼Œç›¸å½“äºã€Œæ³¨å†Œä¿¡å·ã€çš„è¿‡ç¨‹ã€‚&lt;/li>
&lt;/ol>
&lt;p>å³è¿›ç¨‹å‘ç°è‡ªå·±çš„å­è¿›ç¨‹ç»“æŸæ—¶ï¼Œè¯·æ±‚æ“ä½œç³»ç»Ÿè°ƒç”¨ç‰¹å®šçš„å‡½æ•°ã€‚è¯¥è¯·æ±‚å¯ä»¥é€šè¿‡å¦‚ä¸‹å‡½æ•°è°ƒç”¨å®Œæˆï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;signal.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">signal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">signo&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">func&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">)))(&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">ä¸ºäº†åœ¨äº§ç”Ÿä¿¡å·æ—¶è°ƒç”¨ï¼Œè¿”å›ä¹‹å‰æ³¨å†Œçš„å‡½æ•°æŒ‡é’ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">å‡½æ•°å: signal
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">å‚æ•°ï¼šint signo,void(*func)(int)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">è¿”å›ç±»å‹ï¼šå‚æ•°ç±»å‹ä¸ºintå‹ï¼Œè¿”å› void å‹å‡½æ•°æŒ‡é’ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è°ƒç”¨ä¸Šè¿°å‡½æ•°æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç‰¹æ®Šæƒ…å†µï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºç‰¹æ®Šæƒ…å†µä¸‹å°†è¦&lt;strong>è°ƒç”¨çš„å‡½æ•°çš„åœ°å€å€¼&lt;/strong>ï¼ˆæŒ‡é’ˆï¼‰ã€‚å‘ç”Ÿç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨çš„æƒ…å†µæ—¶ï¼Œè°ƒç”¨ç¬¬äºŒä¸ªå‚æ•°æ‰€æŒ‡çš„å‡½æ•°ã€‚ä¸‹é¢ç»™å‡ºå¯ä»¥åœ¨ signal å‡½æ•°ä¸­æ³¨å†Œçš„éƒ¨åˆ†ç‰¹æ®Šæƒ…å†µã€‚&lt;/p>
&lt;ul>
&lt;li>SIGALRMï¼šå·²åˆ°é€šè¿‡è°ƒç”¨ alarm å‡½æ•°æ³¨å†Œæ—¶é—´&lt;/li>
&lt;li>SIGINTï¼šè¾“å…¥ ctrl+c&lt;/li>
&lt;li>SIGCHLDï¼šå­è¿›ç¨‹ç»ˆæ­¢&lt;/li>
&lt;/ul>
&lt;p>è°ƒç”¨çš„å‡½æ•°çš„å‚æ•°åº”ä¸º int ï¼Œè¿”å›å€¼ç±»å‹åº”ä¸º void ã€‚åªæœ‰è¿™æ ·æ‰èƒ½æˆä¸º signal å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>æ¥ä¸‹æ¥ç¼–å†™ signal å‡½æ•°çš„è°ƒç”¨è¯­å¥ï¼Œåˆ†åˆ«å®Œæˆå¦‚ä¸‹ä¸¤ä¸ªè¯·æ±‚ï¼š
&lt;ol>
&lt;li>å·²åˆ°é€šè¿‡ alarm å‡½æ•°æ³¨å†Œæ—¶é—´ï¼Œè¯·è°ƒç”¨ timeout å‡½æ•°&lt;/li>
&lt;li>è¾“å…¥ ctrl+c æ—¶è°ƒç”¨ keycontrol å‡½æ•°&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;p>ä»£è¡¨è¿™ 2 ç§æƒ…å†µçš„å¸¸æ•°åˆ†åˆ«ä¸º SIGALRM å’Œ SIGINT ï¼Œå› æ­¤æŒ‰å¦‚ä¸‹æ–¹å¼è°ƒç”¨ signal å‡½æ•°ã€‚&lt;/p>
&lt;blockquote>
&lt;p>signal(SIGALRM , timeout);
signal(SIGINT , keycontrol);&lt;/p>
&lt;/blockquote>
&lt;ol start="3">
&lt;li>æ³¨å†Œå¥½ä¿¡å·ä¹‹åï¼Œå‘å°„æ³¨å†Œä¿¡å·æ—¶ï¼ˆæ³¨å†Œçš„æƒ…å†µå‘ç”Ÿæ—¶ï¼‰ï¼Œæ“ä½œç³»ç»Ÿå°†è°ƒç”¨è¯¥ä¿¡å·å¯¹åº”çš„å‡½æ•°ã€‚&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">alarm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">seconds&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// è¿”å›0æˆ–ä»¥ç§’ä¸ºå•ä½çš„è· SIGALRM ä¿¡å·å‘ç”Ÿæ‰€å‰©æ—¶é—´
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å¦‚æœè°ƒç”¨è¯¥å‡½æ•°çš„åŒæ—¶å‘å®ƒä¼ é€’ä¸€ä¸ªæ­£æ•´å‹å‚æ•°ï¼Œç›¸åº”æ—¶é—´åï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰å°†äº§ç”Ÿ SIGALRM ä¿¡å·ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// è‹¥å‘è¯¥å‡½æ•°ä¼ é€’ä¸º 0 ï¼Œåˆ™ä¹‹å‰å¯¹ SIGALRM ä¿¡å·çš„é¢„çº¦å°†å–æ¶ˆã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å¦‚æœé€šè¿‡è¯¥å‡½æ•°é¢„çº¦ä¿¡å·åæœªæŒ‡å®šè¯¥ä¿¡å·å¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// åˆ™ï¼ˆé€šè¿‡è°ƒç”¨ signal å‡½æ•°ï¼‰ç»ˆæ­¢è¿›ç¨‹ï¼Œä¸åšä»»ä½•å¤„ç†ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;signal.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">timeout&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sig&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">//ä¿¡å·å¤„ç†å™¨
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sig&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">SIGALRM&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Time out!&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">alarm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//ä¸ºäº†æ¯éš” 2 ç§’é‡å¤äº§ç”Ÿ SIGALRM ä¿¡å·ï¼Œåœ¨ä¿¡å·å¤„ç†å™¨ä¸­è°ƒç”¨ alarm å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">keycontrol&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sig&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">//ä¿¡å·å¤„ç†å™¨
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sig&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">SIGINT&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;CTRL+C pressed&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">signal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SIGALRM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">timeout&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//æ³¨å†Œä¿¡å·åŠç›¸åº”å¤„ç†å‡½æ•°ï¼Œæ³¨é‡Šè¯¥è¡Œ2såè¾“å‡ºalarm clockï¼Œç»ˆæ­¢è¿›ç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">signal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SIGINT&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">keycontrol&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">alarm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//é¢„çº¦ 2 ç§’å€™å‘å°„ SIGALRM ä¿¡å·
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;wait...&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// sleep 100s
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>äº§ç”Ÿä¿¡å·æ—¶ï¼Œä¸ºäº†è°ƒç”¨ä¿¡å·å¤„ç†å™¨ï¼Œå°†å”¤é†’ç”±äºè°ƒç”¨ sleep å‡½æ•°è€Œè¿›å…¥é˜»å¡çŠ¶æ€çš„è¿›ç¨‹ã€‚&lt;br />æœ¬æ¥ç³»ç»Ÿè¦ç¡çœ 100ç§’ï¼Œä½†æ˜¯åˆ°äº† alarm(2) è§„å®šçš„ä¸¤ç§’ä¹‹åï¼Œå°±ä¼šå”¤é†’ç¡çœ çš„è¿›ç¨‹ï¼Œ&lt;strong>è¿›ç¨‹è¢«å”¤é†’äº†å°±ä¸ä¼šå†è¿›å…¥ç¡çœ çŠ¶æ€äº†&lt;/strong>ï¼Œæ‰€ä»¥å°±ä¸ç”¨ç­‰å¾…100ç§’ã€‚å¦‚æœæŠŠ timeout() å‡½æ•°ä¸­çš„ alarm(2) æ³¨é‡Šæ‰ï¼Œå°±ä¼šå…ˆè¾“å‡ºwait...ï¼Œç„¶åå†è¾“å‡ºTime out! (è¿™æ—¶å·²ç»è·³è¿‡äº†ç¬¬ä¸€æ¬¡çš„ sleep(100) ç§’),ç„¶åå°±çœŸçš„ä¼šç¡çœ 100ç§’ï¼Œå› ä¸ºæ²¡æœ‰å†å‘å‡º alarm(2) çš„ä¿¡å·ã€‚&lt;/p>
&lt;h4 id="åˆ©ç”¨-sigaction-å‡½æ•°è¿›è¡Œä¿¡å·å¤„ç†">åˆ©ç”¨ sigaction å‡½æ•°è¿›è¡Œä¿¡å·å¤„ç†&lt;/h4>
&lt;blockquote>
&lt;p>signal å‡½æ•°åœ¨ Unix ç³»åˆ—çš„ä¸åŒæ“ä½œç³»ç»Ÿå¯èƒ½å­˜åœ¨åŒºåˆ«ï¼Œä½† sigaction å‡½æ•°å®Œå…¨ç›¸åŒ&lt;/p>
&lt;/blockquote>
&lt;p>å®é™…ä¸Šç°åœ¨å¾ˆå°‘ç”¨ signal å‡½æ•°ç¼–å†™ç¨‹åºï¼Œå®ƒåªæ˜¯ä¸ºäº†ä¿æŒå¯¹æ—§ç¨‹åºçš„å…¼å®¹ï¼Œä¸‹é¢ä»‹ç» sigaction å‡½æ•°ï¼Œåªè®²è§£å¯ä»¥æ›¿æ¢ signal å‡½æ•°çš„åŠŸèƒ½ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;signal.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">sigaction&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">signo&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sigaction&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">act&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sigaction&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">oldact&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">act: å¯¹äºç¬¬ä¸€ä¸ªå‚æ•°çš„ä¿¡å·å¤„ç†å‡½æ•°ï¼ˆä¿¡å·å¤„ç†å™¨ï¼‰ä¿¡æ¯ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">oldact: é€šè¿‡æ­¤å‚æ•°è·å–ä¹‹å‰æ³¨å†Œçš„ä¿¡å·å¤„ç†å‡½æ•°æŒ‡é’ˆï¼Œè‹¥ä¸éœ€è¦åˆ™ä¼ é€’ 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// struct sigaction // sigactionç»“æ„ä½“
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// {
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// void (*sa_handler)(int); // ä¿å­˜ä¿¡å·å¤„ç†çš„å‡½æ•°æŒ‡é’ˆå€¼ï¼ˆåœ°å€å€¼ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// sigset_t sa_mask; // é˜²æ­¢åƒµå°¸è¿›ç¨‹ç½®0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// int sa_flags; // å¯çœ‹æºç çš„æ‰€æœ‰flag
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// };
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;signal.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">timeout&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sig&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sig&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">SIGALRM&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Time out!&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">alarm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sigaction&lt;/span> &lt;span class="n">act&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">act&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sa_handler&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">timeout&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ä¿å­˜å‡½æ•°æŒ‡é’ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">sigemptyset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">act&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sa_mask&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// sig empty setå°† sa_mask æˆå‘˜çš„æ‰€æœ‰ä½åˆå§‹åŒ–æˆ0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">act&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sa_flags&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//sa_flags åŒæ ·åˆå§‹åŒ–æˆ 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">sigaction&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SIGALRM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">act&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// æ³¨å†Œ SIGALRM ä¿¡å·çš„å¤„ç†å™¨ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">alarm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//2 ç§’åå‘ç”Ÿ SIGALRM ä¿¡å·
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;wait...&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="åˆ©ç”¨ä¿¡å·å¤„ç†æŠ€æœ¯æ¶ˆç­åƒµå°¸è¿›ç¨‹">åˆ©ç”¨ä¿¡å·å¤„ç†æŠ€æœ¯æ¶ˆç­åƒµå°¸è¿›ç¨‹&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;signal.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/wait.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">read_childproc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sig&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// é”€æ¯å­è¿›ç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid_t&lt;/span> &lt;span class="n">id&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">waitpid&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">WNOHANG&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">WIFEXITED&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Removed proc id: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">id&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//å­è¿›ç¨‹çš„ pid
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child send: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">WEXITSTATUS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">));&lt;/span> &lt;span class="c1">//å­è¿›ç¨‹çš„è¿”å›å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid_t&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sigaction&lt;/span> &lt;span class="n">act&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">act&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sa_handler&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">read_childproc&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sigemptyset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">act&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sa_mask&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">act&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sa_flags&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sigaction&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SIGCHLD&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">act&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Hi I&amp;#39;m child process 1&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child 1 proc id: %d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Hi! I&amp;#39;m child process 2&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">24&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Child 2 proc id: %d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;wait&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç¨‹åºæ˜¯å…ˆåˆ›å»ºäº†ä¸¤ä¸ªå­è¿›ç¨‹ï¼Œå¹¶ä¸”çˆ¶è¿›ç¨‹æ¯”å­è¿›ç¨‹æ‰§è¡Œå¿«ã€‚&lt;/p>
&lt;blockquote>
&lt;ol>
&lt;li>wait&lt;/li>
&lt;li>5s -&amp;gt; wait&lt;/li>
&lt;li>5s -&amp;gt; wait&lt;/li>
&lt;li>ä¸¤ä¸ªå­è¿›ç¨‹ç»ˆæ­¢ï¼Œå”¤é†’çˆ¶è¿›ç¨‹ -&amp;gt; wait -&amp;gt; wait ï¼ˆå”¤é†’åä¸ä¼‘çœ ï¼Œæ‰€ä»¥ç›´æ¥è·³è¿‡ä¸¤æ¬¡forå¾ªç¯ï¼Œè¿›å…¥æœ€åä¸€æ¬¡ä¼‘çœ ï¼‰&lt;/li>
&lt;li>5s -&amp;gt; ç¨‹åºä¸­æ­¢&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;h3 id="åŸºäºå¤šä»»åŠ¡çš„å¹¶å‘æœåŠ¡å™¨">åŸºäºå¤šä»»åŠ¡çš„å¹¶å‘æœåŠ¡å™¨&lt;/h3>
&lt;h4 id="åŸºäºè¿›ç¨‹çš„å¹¶å‘æœåŠ¡å™¨æ¨¡å‹">åŸºäºè¿›ç¨‹çš„å¹¶å‘æœåŠ¡å™¨æ¨¡å‹&lt;/h4>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-10.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;br />ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¯å½“æœ‰å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼ˆè¿æ¥è¯·æ±‚ï¼‰ï¼Œå›å£°æœåŠ¡å™¨éƒ½åˆ›å»ºå­è¿›ç¨‹ä»¥æä¾›æœåŠ¡ã€‚å¦‚æœè¯·æ±‚çš„å®¢æˆ·ç«¯æœ‰ 5 ä¸ªï¼Œåˆ™å°†åˆ›å»º 5 ä¸ªå­è¿›ç¨‹æ¥æä¾›æœåŠ¡ï¼Œä¸ºäº†å®Œæˆè¿™äº›ä»»åŠ¡ï¼Œéœ€è¦ç»è¿‡å¦‚ä¸‹è¿‡ç¨‹ï¼š&lt;/p>
&lt;ul>
&lt;li>ç¬¬ä¸€é˜¶æ®µï¼šå›å£°æœåŠ¡å™¨ç«¯ï¼ˆçˆ¶è¿›ç¨‹ï¼‰é€šè¿‡è°ƒç”¨ accept å‡½æ•°å—ç†è¿æ¥è¯·æ±‚&lt;/li>
&lt;li>ç¬¬äºŒé˜¶æ®µï¼šæ­¤æ—¶è·å–çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦åˆ›å»ºå¹¶ä¼ é€’ç»™å­è¿›ç¨‹&lt;/li>
&lt;li>ç¬¬ä¸‰é˜¶æ®µï¼šè¿›ç¨‹åˆ©ç”¨ä¼ é€’æ¥çš„æ–‡ä»¶æè¿°ç¬¦æä¾›æœåŠ¡&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch10/echo_mpserv.c">å®Œæ•´ä»£ç &lt;/a>ï¼Œå¯ä½¿ç”¨å¯¹åº”çš„&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch04/echo_client.c">echo_client&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">adr_sz&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_adr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clnt_sock&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clnt_adr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">adr_sz&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;new client connected...&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fork&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="c1">//æ­¤æ—¶ï¼Œçˆ¶å­è¿›ç¨‹åˆ†åˆ«å¸¦æœ‰ä¸€ä¸ªå¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// åˆ†é…å¤±è´¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">//å­è¿›ç¨‹è¿è¡ŒåŒºåŸŸ, æ­¤éƒ¨åˆ†å‘å®¢æˆ·ç«¯æä¾›å›å£°æœåŠ¡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serv_sock&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//å…³é—­æœåŠ¡å™¨å¥—æ¥å­—ï¼Œå› ä¸ºä»çˆ¶è¿›ç¨‹ä¼ é€’åˆ°äº†å­è¿›ç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">str_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BUFSIZ&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">str_len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;client disconnected...&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clnt_sock&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//é€šè¿‡ accept å‡½æ•°åˆ›å»ºçš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦å·²ç»å¤åˆ¶ç»™å­è¿›ç¨‹ï¼Œå› æ­¤æœåŠ¡å™¨ç«¯è¦é”€æ¯è‡ªå·±çš„
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="é€šè¿‡-fork-å‡½æ•°å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦">é€šè¿‡ fork å‡½æ•°å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦&lt;/h4>
&lt;p>ç¤ºä¾‹ä¸­ç»™å‡ºäº†é€šè¿‡ fork å‡½æ•°å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦çš„è¿‡ç¨‹ã€‚çˆ¶è¿›ç¨‹å°† 2 ä¸ªå¥—æ¥å­—ï¼ˆä¸€ä¸ªæ˜¯æœåŠ¡ç«¯å¥—æ¥å­—å¦ä¸€ä¸ªæ˜¯å®¢æˆ·ç«¯å¥—æ¥å­—ï¼‰æ–‡ä»¶æè¿°ç¬¦å¤åˆ¶ç»™äº†å­è¿›ç¨‹ã€‚&lt;br />è°ƒç”¨ fork å‡½æ•°æ—¶èµ‹å€¼&lt;strong>çˆ¶è¿›ç¨‹çš„æ‰€æœ‰èµ„æº&lt;/strong>ï¼Œä½†æ˜¯å¥—æ¥å­—ä¸æ˜¯å½’è¿›ç¨‹æ‰€æœ‰çš„ï¼Œè€Œæ˜¯&lt;strong>å½’æ“ä½œç³»ç»Ÿæ‰€æœ‰&lt;/strong>ï¼Œåªæ˜¯è¿›ç¨‹æ‹¥æœ‰ä»£è¡¨ç›¸åº”å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦ã€‚&lt;br />&lt;img src="https://camo.githubusercontent.com/e8059964da650325509a86c00916dc588b147221b21e0355ca13e6ee8126f667/68747470733a2f2f73322e617831782e636f6d2f323031392f30312f32312f6b5037526a782e706e67#from=url&amp;amp;id=SMxPg&amp;amp;originHeight=363&amp;amp;originWidth=513&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;br />å¦‚å›¾æ‰€ç¤ºï¼Œ1 ä¸ªå¥—æ¥å­—å­˜åœ¨ 2 ä¸ªæ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œåªæœ‰ 2 ä¸ªæ–‡ä»¶æè¿°ç¬¦éƒ½ç»ˆæ­¢ï¼ˆé”€æ¯ï¼‰åï¼Œæ‰èƒ½é”€æ¯å¥—æ¥å­—ã€‚å¦‚æœç»´æŒå›¾ä¸­çš„çŠ¶æ€ï¼Œå³ä½¿&lt;strong>å­è¿›ç¨‹é”€æ¯äº†ä¸å®¢æˆ·ç«¯è¿æ¥çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ï¼Œä¹Ÿæ— æ³•é”€æ¯å¥—æ¥å­—&lt;/strong>ï¼ˆæœåŠ¡å™¨å¥—æ¥å­—åŒæ ·å¦‚æ­¤ï¼‰ã€‚å› æ­¤è°ƒç”¨ fork å‡½æ•°åï¼Œè¦å°†&lt;strong>æ— å…³ç´§è¦çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦å…³æ‰&lt;/strong>ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-11.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=dsY6g&amp;amp;originHeight=356&amp;amp;originWidth=505&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;/p>
&lt;h3 id="åˆ†å‰²-tcp-çš„-io-ç¨‹åº">åˆ†å‰² TCP çš„ I/O ç¨‹åº&lt;/h3>
&lt;p>æˆ‘ä»¬å·²ç»å®ç°çš„å›å£°&lt;strong>å®¢æˆ·ç«¯&lt;/strong>çš„æ•°æ®å›å£°æ–¹å¼å¦‚ä¸‹ï¼š&lt;/p>
&lt;blockquote>
&lt;p>å‘æœåŠ¡å™¨ä¼ è¾“æ•°æ®ï¼Œå¹¶ç­‰å¾…æœåŠ¡å™¨ç«¯å›å¤ã€‚æ— æ¡ä»¶ç­‰å¾…ï¼Œç›´åˆ°æ¥æ”¶å®ŒæœåŠ¡å™¨ç«¯çš„å›å£°æ•°æ®åï¼Œæ‰èƒ½ä¼ è¾“ä¸‹ä¸€æ‰¹æ•°æ®ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¼ è¾“æ•°æ®åè¦ç­‰å¾…æœåŠ¡å™¨ç«¯è¿”å›çš„æ•°æ®ï¼Œå› ä¸ºç¨‹åºä»£ç ä¸­é‡å¤è°ƒç”¨äº† read å’Œ write å‡½æ•°ã€‚åªèƒ½è¿™ä¹ˆå†™çš„åŸå› ä¹‹ä¸€æ˜¯ï¼Œç¨‹åºåœ¨ 1 ä¸ªè¿›ç¨‹ä¸­è¿è¡Œï¼Œç°åœ¨å¯ä»¥åˆ›å»ºå¤šä¸ªè¿›ç¨‹ï¼Œå› æ­¤å¯ä»¥åˆ†å‰²æ•°æ®æ”¶å‘è¿‡ç¨‹ã€‚åˆ†å‰²åè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;br />&lt;img src="https://camo.githubusercontent.com/60042284b80365905816ec0f9ca8bcf8695895916bad37b1d6d30a716e85ba0f/68747470733a2f2f73322e617831782e636f6d2f323031392f30312f32312f6b5062686b442e706e67#from=url&amp;amp;id=Qy4jl&amp;amp;originHeight=295&amp;amp;originWidth=459&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;br />ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå®¢æˆ·ç«¯çš„çˆ¶è¿›ç¨‹è´Ÿè´£æ¥æ”¶æ•°æ®ï¼Œé¢å¤–åˆ›å»ºçš„å­è¿›ç¨‹è´Ÿè´£å‘é€æ•°æ®ï¼Œåˆ†å‰²åï¼Œçˆ¶å­è¿›ç¨‹åˆ†åˆ«è´Ÿè´£è¾“å…¥è¾“å‡ºï¼Œè¿™æ ·ï¼Œæ— è®ºå®¢æˆ·ç«¯æ˜¯å¦ä»æœåŠ¡å™¨ç«¯æ¥æ”¶å®Œæ•°æ®éƒ½å¯ä»¥è¿›ç¨‹ä¼ è¾“ã€‚&lt;br />åˆ†å‰² I/O ç¨‹åºçš„å¦å¤–ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå¯ä»¥æé«˜é¢‘ç¹äº¤æ¢æ•°æ®çš„ç¨‹åºæ€§èƒ½ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220100-12.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5#from=url&amp;amp;id=EtW4z&amp;amp;originHeight=374&amp;amp;originWidth=612&amp;amp;originalType=binary&amp;amp;ratio=1.2&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;status=done&amp;amp;style=none&amp;amp;title=" alt="">&lt;br />æ ¹æ®ä¸Šå›¾æ˜¾ç¤ºå¯ä»¥çœ‹å‡ºï¼Œåœ¨ç½‘ç»œä¸å¥½çš„æƒ…å†µä¸‹ï¼Œæ˜æ˜¾æå‡é€Ÿåº¦ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch10/echo_mpclient.c">å›å£°å®¢æˆ·ç«¯çš„ I/O åˆ†å‰²çš„ä»£ç å®ç°&lt;/a>&lt;/li>
&lt;/ul></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/tcp/">TCP</category><category domain="https://keepjolly.com/tags/c-/">C++</category><category domain="https://keepjolly.com/tags/network/">Network</category></item><item><title>MySQLå­¦ä¹ </title><link>https://keepjolly.com/posts/learn/mysql-tutorial/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/mysql-tutorial/</guid><pubDate>Thu, 10 Aug 2023 23:13:48 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="æ•°æ®åº“æ¦‚è¿°">æ•°æ®åº“æ¦‚è¿°&lt;/h2>
&lt;p>&lt;a href="https://pan.baidu.com/s/18W0ZRYaCR60mQWFP92CJsg?pwd=2you">èµ„æ–™&lt;/a>+&lt;a href="https://www.bilibili.com/video/BV1Vy4y1z7EX">è§†é¢‘&lt;/a>&lt;/p>
&lt;h3 id="mysqlå¸¸ç”¨å‘½ä»¤">MySQLå¸¸ç”¨å‘½ä»¤&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>é€€å‡º&lt;/th>
&lt;th>exit&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>æŸ¥çœ‹æ•°æ®åº“&lt;/td>
&lt;td>show databases;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ä½¿ç”¨æŸæ•°æ®åº“&lt;/td>
&lt;td>use xxx;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>åˆ›å»ºæ•°æ®åº“&lt;/td>
&lt;td>create databse xxx;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æŸ¥çœ‹æ•°æ®åº“ä¸­çš„è¡¨&lt;/td>
&lt;td>show tables;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>å¯¼å…¥è¡¨&lt;/td>
&lt;td>source path/xxx.sql&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„æ•°æ®åº“&lt;/td>
&lt;td>select database()&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æ‰¹é‡æ‰§è¡Œsqlè„šæœ¬&lt;/td>
&lt;td>source xxx.sql(æˆ–è€…windowsç›´æ¥sqlæ–‡ä»¶æ‹–è¿›æ¥)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="https://www.cnblogs.com/kevingrace/p/6150748.html">å»ºè®®éƒ½å°å†™&lt;/a>ï¼Œä¸åŒæ“ä½œç³»ç»Ÿå¤„ç†æ–¹å¼ä¸ä¸€è‡´&lt;/td>
&lt;td>ä»¥;ç»“å°¾æ‰ä¼šæ‰§è¡Œ&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="è¡¨çš„ç†è§£">è¡¨çš„ç†è§£&lt;/h3>
&lt;ul>
&lt;li>æ•°æ®åº“ä¸­æœ€åŸºæœ¬çš„å•ä½æ˜¯è¡¨&lt;/li>
&lt;li>æ•°æ®åº“ä¸­ä»¥è¡¨æ ¼çš„å½¢å¼è¡¨ç¤ºæ•°æ®&lt;/li>
&lt;li>ä»»ä½•ä¸€å¼ è¡¨éƒ½æœ‰è¡Œå’Œåˆ—ï¼š
&lt;ul>
&lt;li>è¡Œï¼šæ•°æ®/è®°å½•&lt;/li>
&lt;li>åˆ—ï¼šå­—æ®µï¼ˆåŒ…å«å­—æ®µåã€æ•°æ®ç±»å‹ã€çº¦æŸç­‰å±æ€§ï¼‰&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ•°æ®åº“ä¸­çš„æœ‰ä¸€æ¡å‘½åè§„èŒƒï¼šæ‰€æœ‰çš„æ ‡è¯†ç¬¦éƒ½æ˜¯å…¨éƒ¨å°å†™ï¼Œå•è¯å’Œå•è¯ä¹‹é—´ä½¿ç”¨ä¸‹åˆ’çº¿è¿›è¡Œè¡”æ¥ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="sqlè¯­å¥çš„åˆ†ç±»">SQLè¯­å¥çš„åˆ†ç±»&lt;/h3>
&lt;ul>
&lt;li>DQLï¼šæ•°æ®æŸ¥è¯¢è¯­è¨€ï¼ˆæœ‰selectå…³é”®å­—ï¼‰&lt;/li>
&lt;li>DMLï¼šæ•°æ®&lt;strong>æ“ä½œ&lt;/strong>è¯­è¨€ï¼ˆå¢åˆ æ”¹è¡¨ä¸­çš„æ•°æ®ï¼ˆinsert intoã€deleteã€updateï¼‰ï¼‰&lt;/li>
&lt;li>DDLï¼šæ•°æ®&lt;strong>å®šä¹‰&lt;/strong>è¯­è¨€ï¼ˆå¢åˆ æ”¹è¡¨ï¼ˆcreateã€dropã€alterï¼‰ï¼‰&lt;/li>
&lt;li>TCLï¼šäº‹åŠ¡æ§åˆ¶è¯­è¨€ï¼ˆäº‹åŠ¡æäº¤commitã€äº‹åŠ¡å›æ»šrollbackï¼‰&lt;/li>
&lt;li>DCLï¼šæ•°æ®æ§åˆ¶è¯­è¨€ï¼ˆæˆæƒgrantã€æ’¤æƒrevokeï¼‰&lt;/li>
&lt;/ul>
&lt;h3 id="æŸ¥çœ‹è¡¨ä¿¡æ¯">æŸ¥çœ‹è¡¨ä¿¡æ¯&lt;/h3>
&lt;ul>
&lt;li>select * from table_name æŸ¥çœ‹è¡¨å†…æ•°æ®&lt;/li>
&lt;li>desc table_name æŸ¥çœ‹è¡¨ç»“æ„&lt;/li>
&lt;/ul>
&lt;h2 id="sqlæŸ¥è¯¢">SQLæŸ¥è¯¢&lt;/h2>
&lt;h3 id="ç®€å•æŸ¥è¯¢">ç®€å•æŸ¥è¯¢&lt;/h3>
&lt;p>æŸ¥è¯¢ä¸€ä¸ªå­—æ®µï¼š&lt;/p>
&lt;ul>
&lt;li>select å­—æ®µå from è¡¨å;
&lt;ul>
&lt;li>select/fromæ˜¯å…³é”®å­—&lt;/li>
&lt;li>å­—æ®µåå’Œè¡¨åæ˜¯æ ‡è¯†ç¬¦&lt;/li>
&lt;li>å­—æ®µåå¤„ä¹Ÿå¯ä»¥ä¸ºå­—é¢é‡/å­—é¢å€¼ï¼Œæ­¤æ—¶è¾“å‡º å€¼ä¸ºä¸€æ ·çš„æ‰€æœ‰è¡Œ
&lt;ul>
&lt;li>select 1000 as num from EMP;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>æŸ¥è¯¢å¤šä¸ªå­—æ®µï¼š&lt;/p>
&lt;ul>
&lt;li>select å­—æ®µå1,å­—æ®µå2 from è¡¨å&lt;/li>
&lt;/ul>
&lt;p>æŸ¥è¯¢å…¨éƒ¨å­—æ®µï¼š&lt;/p>
&lt;ul>
&lt;li>select å…¨éƒ¨å­—æ®µ from è¡¨å&lt;/li>
&lt;li>or&lt;/li>
&lt;li>select * from è¡¨å
&lt;ul>
&lt;li>æ•ˆç‡æ¯”è¾ƒä½ï¼Œå¯è¯»æ€§å·®&lt;/li>
&lt;li>ä¸å»ºè®®å†™åˆ°ç¨‹åºé‡Œ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>èµ·åˆ«åï¼š&lt;/p>
&lt;ul>
&lt;li>select å­—æ®µå as åˆ«å from è¡¨å
&lt;ul>
&lt;li>åªæ˜¯å°†æŸ¥è¯¢ç»“æœçš„åˆ—è¡¨æ˜¾ç¤ºä¸ºåˆ«åï¼Œä¸ä¼šä¿®æ”¹è¡¨å­—æ®µå&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ä¾‹ï¼š&lt;/p>
&lt;ul>
&lt;li>-- mysqlæ³¨é‡Š&lt;/li>
&lt;li>select deptno, dname deptname from dept; -- å»é™¤as&lt;/li>
&lt;li>select deptno, dname 'dept name' from dept -- åˆ«ååŠ ç©ºæ ¼/ä¸­æ–‡ç”¨å•å¼•å·;
&lt;ul>
&lt;li>æ³¨æ„æ•°æ®åº“ä¸­ä½¿ç”¨å•å¼•å·ï¼ŒåŒå¼•å·ä¸æ ‡å‡†&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>select ename, sal*10 as 'å¹´è–ª' from EMP -- ä½¿ç”¨æ•°å­¦è¡¨è¾¾å¼ ;&lt;/li>
&lt;/ul>
&lt;h3 id="æ¡ä»¶æŸ¥è¯¢">æ¡ä»¶æŸ¥è¯¢&lt;/h3>
&lt;p>è¯­æ³•æ ¼å¼ï¼š&lt;br />select å­—æ®µ1, å­—æ®µ2&lt;br />from è¡¨å&lt;br />where æ¡ä»¶;&lt;br />æ¯”è¾ƒç¬¦å·ï¼š&lt;/p>
&lt;ul>
&lt;li>= ã€&amp;lt;&amp;gt;æˆ–!= ã€&amp;lt; ã€&amp;lt;= ã€&amp;gt; ã€&amp;gt;=ã€betweenâ€¦and â€¦ ï¼ˆé—­åŒºé—´ï¼Œå·¦å°å³å¤§ï¼‰&lt;/li>
&lt;li>select empno, enmae, sal from EMP where sal &amp;lt; 1000;&lt;/li>
&lt;/ul>
&lt;p>åˆ¤æ–­ç¬¦å·ï¼š&lt;/p>
&lt;ul>
&lt;li>is null ä¸ºç©ºï¼ˆ is not null ä¸ä¸ºç©ºï¼‰&lt;br />and ã€or &lt;br />in åŒ…å«ï¼Œç›¸å½“äºå¤šä¸ª or ï¼ˆ not in ä¸åœ¨è¿™ä¸ªèŒƒå›´ä¸­ï¼‰&lt;br />not å¯ä»¥å–éï¼Œä¸»è¦ç”¨åœ¨ is æˆ– in ä¸­&lt;/li>
&lt;li>select empno,ename,sal,comm from emp where comm &lt;strong>is null&lt;/strong>;&lt;/li>
&lt;li>select * from emp where (job='MANAGER' &lt;strong>or&lt;/strong> job = 'SALESMAN') &lt;strong>and&lt;/strong> sal &amp;gt; 3000;
&lt;ul>
&lt;li>and ä¼˜å…ˆçº§é«˜&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>select empno,ename,job from emp where job &lt;strong>in&lt;/strong> ('MANAGER', 'SALESMAN');&lt;/li>
&lt;/ul>
&lt;p>æ¨¡ç³ŠæŸ¥è¯¢ï¼š&lt;/p>
&lt;ul>
&lt;li>like ç§°ä¸ºæ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ”¯æŒ%æˆ–ä¸‹åˆ’çº¿åŒ¹é…&lt;/li>
&lt;li>ç‰¹æ®Šç¬¦å·ï¼š% åŒ¹é…ä»»æ„ä¸ªå­—ç¬¦ã€_ åªåŒ¹é…ä¸€ä¸ªå­—ç¬¦&lt;/li>
&lt;li>select ename from emp where ename like '%T' -- æœ€åä¸€ä¸ªæ˜¯T&lt;/li>
&lt;li>select ename from emp where ename like '__R%' -- ç¬¬ä¸‰ä¸ªå­—æ¯æ˜¯R&lt;/li>
&lt;li>select name from t_student where name like '%_%' -- \è½¬ä¹‰å­—ç¬¦&lt;/li>
&lt;/ul>
&lt;h3 id="æ’åº">æ’åº&lt;/h3>
&lt;p>è¯­æ³•æ ¼å¼ï¼š&lt;br />select * from tablename &lt;br />order by sal -- é»˜è®¤å‡åº;&lt;br />order by sal desc -- é™åº æˆ–è€…-sal;&lt;br />order by sal asc -- å‡åº æˆ–è€…+sal;&lt;br />è¯­å¥é¡ºåºä¸º from -&amp;gt; where -&amp;gt; order by&lt;br />å¤šå­—æ®µæ’åºï¼š&lt;/p>
&lt;ul>
&lt;li>select ename,sal from emp&lt;br />order by &lt;br /> sal asc, ename asc; // salåœ¨å‰ï¼Œèµ·ä¸»å¯¼ï¼Œåªæœ‰salç›¸ç­‰çš„æ—¶å€™ï¼Œæ‰ä¼šè€ƒè™‘å¯ç”¨enameæ’åºã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="æ•°æ®å¤„ç†å‡½æ•°">æ•°æ®å¤„ç†å‡½æ•°&lt;/h3>
&lt;p>åˆç§°ä¸ºå•è¡Œå¤„ç†å‡½æ•°ã€‚ç‰¹ç‚¹ï¼šä¸€ä¸ªè¾“å…¥å¯¹åº”ä¸€ä¸ªè¾“å‡ºã€‚&lt;br />å¸¸è§å‡½æ•°ï¼š&lt;/p>
&lt;ul>
&lt;li>Lower è½¬æ¢å°å†™ã€upper è½¬æ¢å¤§å†™
&lt;ul>
&lt;li>select lower(ename) as ename from EMP;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>substr å–å­ä¸² (substr(è¢«æˆªå–çš„å­—ç¬¦ä¸²,èµ·å§‹ä¸‹æ ‡,æˆªå–çš„é•¿åº¦))
&lt;ul>
&lt;li>select ename from EMP where substr(ename, 1, 1) = 'A' -- ä¸‹æ ‡ä»1å¼€å§‹&lt;/li>
&lt;li>select concat(lower(substr(ename,1,1)), substr(ename, 2)) as result from EMP -- é¦–å­—æ¯å°å†™&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>length å–é•¿åº¦
&lt;ul>
&lt;li>select length(ename) enamelength from EMP;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>trim å»ç©ºæ ¼
&lt;ul>
&lt;li>select * from EMP where ename = trim(' KING');&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>str_to_date å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ—¥æœŸ
&lt;ul>
&lt;li>str_to_date('å­—ç¬¦ä¸²æ—¥æœŸ', 'æ—¥æœŸæ ¼å¼')&lt;/li>
&lt;li>%Y å¹´ %m æœˆ %d æ—¥ %h æ—¶ %i åˆ† %s ç§’&lt;/li>
&lt;li>%Y-%m-%d ä¸éœ€è¦å†™æ—¥æœŸæ ¼å¼&lt;/li>
&lt;li>é€šå¸¸ä½¿ç”¨åœ¨æ’å…¥insertæ–¹é¢ï¼Œå› ä¸ºæ’å…¥çš„æ—¶å€™éœ€è¦ä¸€ä¸ªæ—¥æœŸç±»å‹çš„æ•°æ®&lt;/li>
&lt;li>insert into t_user(id,name,birth) values(1, 'zhangsan', str_to_date('01-10-1990','%d-%m-%Y'));&lt;/li>
&lt;li>é»˜è®¤æ ¼å¼ %Y-%m-%d&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>date_format æ ¼å¼åŒ–æ—¥æœŸ
&lt;ul>
&lt;li>date_format(birth, '%m/%d/%Y')&lt;/li>
&lt;li>é€šå¸¸ä½¿ç”¨åœ¨æŸ¥è¯¢æ—¥æœŸæ–¹é¢ã€‚è®¾ç½®å±•ç¤ºçš„æ—¥æœŸæ ¼å¼ã€‚&lt;/li>
&lt;li>select id,name,date_format(birth,'%Y/%m/%d') as birth from t_user;&lt;/li>
&lt;li>é»˜è®¤çš„æ—¥æœŸæ ¼å¼ï¼š'%Y-%m-%d'&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>format è®¾ç½®åƒåˆ†ä½
&lt;ul>
&lt;li>select ename, format(sal, '$999,9999') as sal from EMP; // ä¸å†™999æ²¡äº‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>round å››èˆäº”å…¥
&lt;ul>
&lt;li>select round(1236.5567, -1) as res from EMP; // ä¸ªä½æ•°å››èˆäº”å…¥&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>rand() ç”Ÿæˆéšæœºæ•°
&lt;ul>
&lt;li>select round(rand()*100,0) from emp; // 100ä»¥å†…çš„éšæœºæ•°&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Ifnull å¯ä»¥å°† null è½¬æ¢æˆä¸€ä¸ªå…·ä½“å€¼
&lt;ul>
&lt;li>ifnullæ˜¯ç©ºå¤„ç†å‡½æ•°ã€‚ä¸“é—¨å¤„ç†NULLçš„ã€‚&lt;br />åœ¨æ‰€æœ‰æ•°æ®åº“å½“ä¸­ï¼Œåªè¦æœ‰NULLå‚ä¸çš„æ•°å­¦è¿ç®—ï¼Œæœ€ç»ˆç»“æœå°±æ˜¯NULLã€‚&lt;/li>
&lt;li>select ename, (sal + ifnull(comm, 0)) * 12 as yearsal from emp;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>case ... when ... then ... when ... then ... else ... end
&lt;ul>
&lt;li>select ename, job, sal as oldsal,&lt;br />(case job when 'MANAGER' then sal * 1.1 when 'SALESMAN' then sal * 1.5 else sal end) as newsal &lt;br />from emp;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="åˆ†ç»„å‡½æ•°">åˆ†ç»„å‡½æ•°&lt;/h3>
&lt;p>åˆåå¤šè¡Œå¤„ç†å‡½æ•°ï¼Œç‰¹ç‚¹ï¼šè¾“å…¥å¤šè¡Œï¼Œè¾“å‡ºä¸€è¡Œã€‚&lt;br />åˆ†ç»„å‡½æ•°åœ¨ä½¿ç”¨çš„æ—¶å€™å…ˆåˆ†ç»„ï¼Œå†ä½¿ç”¨ï¼Œé»˜è®¤ä¸€å¼ è¡¨ä¸ºä¸€ç»„ã€‚&lt;/p>
&lt;ul>
&lt;li>count è®¡æ•°
&lt;ul>
&lt;li>select count(ename) from EMP;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>sum æ±‚å’Œ&lt;/li>
&lt;li>avg å¹³å‡å€¼&lt;/li>
&lt;li>max æœ€å¤§å€¼&lt;/li>
&lt;li>min æœ€å°å€¼&lt;/li>
&lt;/ul>
&lt;p>æ³¨æ„äº‹é¡¹ï¼š&lt;/p>
&lt;ul>
&lt;li>åˆ†ç»„å‡½æ•°è‡ªåŠ¨å¿½ç•¥NULLï¼Œä¸éœ€è¦æå‰å¤„ç†NULL&lt;/li>
&lt;li>åˆ†ç»„å‡½æ•°ä¸­count(*)å’Œcount(å…·ä½“å­—æ®µ)çš„åŒºåˆ«
&lt;ul>
&lt;li>å…·ä½“å­—æ®µï¼šç»Ÿè®¡è¯¥å­—æ®µä¸‹æ‰€æœ‰ä¸ä¸ºNULLçš„å…ƒç´ çš„æ€»æ•°&lt;/li>
&lt;li>*ï¼šç»Ÿè®¡è¡¨ä¸­æ‰€æœ‰è¡Œã€‚ä¸€è¡Œä¸å¯èƒ½å…¨ä¸ºNULL&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åˆ†ç»„å‡½æ•°ä¸èƒ½ç›´æ¥ç”¨åœ¨whereå­å¥ä¸­
&lt;ul>
&lt;li>select ename,sal from emp where sal &amp;gt; min(sal); // error&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ‰€æœ‰åˆ†ç»„å‡½æ•°å¯ä»¥ç»„åˆèµ·æ¥ä½¿ç”¨ï¼Œä¸èƒ½åµŒå¥—ä½¿ç”¨&lt;/li>
&lt;/ul>
&lt;h4 id="åˆ†ç»„æŸ¥è¯¢">åˆ†ç»„æŸ¥è¯¢&lt;/h4>
&lt;p>select ... from ... &lt;strong>group by&lt;/strong> ...&lt;/p>
&lt;h5 id="æ‰§è¡Œé¡ºåº">æ‰§è¡Œé¡ºåº&lt;/h5>
&lt;ul>
&lt;li>from -&amp;gt; where -&amp;gt; group by -&amp;gt; having -&amp;gt; select -&amp;gt; order by&lt;/li>
&lt;/ul>
&lt;p>ä¸ºä»€ä¹ˆåˆ†ç»„å‡½æ•°ä¸èƒ½ç›´æ¥ä½¿ç”¨åœ¨whereåé¢ï¼Ÿ&lt;br />select ename,sal from emp where sal &amp;gt; min(sal); //æŠ¥é”™ã€‚&lt;br />å› ä¸ºåˆ†ç»„å‡½æ•°åœ¨ä½¿ç”¨çš„æ—¶å€™å¿…é¡»&lt;strong>å…ˆåˆ†ç»„ä¹‹åæ‰èƒ½ä½¿ç”¨&lt;/strong>ã€‚&lt;br />whereæ‰§è¡Œçš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰åˆ†ç»„ã€‚æ‰€ä»¥whereåé¢ä¸èƒ½å‡ºç°åˆ†ç»„å‡½æ•°ã€‚&lt;br />select sum(sal) from emp; è¿™ä¸ªæ²¡æœ‰åˆ†ç»„ï¼Œä¸ºå•¥sum()å‡½æ•°å¯ä»¥ç”¨å‘¢ï¼Ÿ&lt;br />å› ä¸ºselectåœ¨group byä¹‹åæ‰§è¡Œã€‚ä¸åˆ†ç»„é»˜è®¤ä¸€å¼ è¡¨ä¸€ç»„&lt;br />ä¾‹ï¼š&lt;/p>
&lt;ul>
&lt;li>select job,sum(sal) from emp group by job;
&lt;ul>
&lt;li>å…ˆä»empè¡¨ä¸­æŸ¥è¯¢æ•°æ®ã€‚æ ¹æ®jobå­—æ®µè¿›è¡Œåˆ†ç»„ã€‚ç„¶åå¯¹æ¯ä¸€ç»„çš„æ•°æ®è¿›è¡Œsum(sal)&lt;/li>
&lt;li>åœ¨ä¸€æ¡selectè¯­å¥å½“ä¸­ï¼Œå¦‚æœæœ‰group byè¯­å¥çš„è¯ï¼Œselectåé¢åªèƒ½è·Ÿï¼š&lt;strong>å‚åŠ åˆ†ç»„çš„å­—æ®µï¼Œä»¥åŠåˆ†ç»„å‡½æ•°&lt;/strong>ã€‚å…¶å®ƒçš„ä¸€å¾‹ä¸èƒ½è·Ÿï¼Œsqlæ—§ç‰ˆæœ¬ä¸ä¼šæŠ¥é”™ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>select deptno, job, max(sal) from emp group by deptno, job;
&lt;ul>
&lt;li>è”åˆåˆ†ç»„æŸ¥è¯¢ï¼Œæ¯ä¸ªéƒ¨é—¨ï¼Œä¸åŒå·¥ä½œå²—ä½çš„æœ€é«˜è–ªèµ„&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ä½¿ç”¨&lt;strong>having&lt;/strong> &lt;br />è¿›ä¸€æ­¥è¿‡æ»¤ ï¼ˆä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œåªèƒ½é…å¥—group byï¼‰&lt;br />whereå’Œhavingï¼Œä¼˜å…ˆé€‰æ‹©whereï¼Œwhereå®åœ¨å®Œæˆä¸äº†ï¼Œå†é€‰æ‹©havingã€‚&lt;br />ä¾‹ï¼š&lt;/p>
&lt;ul>
&lt;li>select job, avg(sal) avgsal from EMP where job &amp;lt;&amp;gt; 'MANAGER' group by job having avg(sal) &amp;gt; 1500 order by avgsal desc;
&lt;ul>
&lt;li>æœ€å¥½ä½¿ç”¨descè€Œä¸æ˜¯-avgsal ä¼šæŠ¥é”™&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="è¿æ¥æŸ¥è¯¢">è¿æ¥æŸ¥è¯¢&lt;/h3>
&lt;ul>
&lt;li>å»é™¤é‡å¤è®°å½• distinct
&lt;ul>
&lt;li>// distinctå‡ºç°åœ¨job,deptnoä¸¤ä¸ªå­—æ®µä¹‹å‰ï¼Œè¡¨ç¤ºä¸¤ä¸ªå­—æ®µè”åˆèµ·æ¥å»é‡ã€‚&lt;/li>
&lt;li>select distinct job,deptno from emp;&lt;/li>
&lt;li>select count(distinct job) from emp; // å¾—åˆ°å·¥ä½œç§ç±»æ•°&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>æ¦‚å¿µï¼šå¤šå¼ è¡¨è”åˆæŸ¥è¯¢ã€‚&lt;br />è¿æ¥æŸ¥è¯¢çš„åˆ†ç±»ï¼š&lt;/p>
&lt;ul>
&lt;li>è¯­æ³•çš„å¹´ä»£
&lt;ul>
&lt;li>sql92&lt;/li>
&lt;li>sql99 ï¼ˆæœ¬æ–‡ä½¿ç”¨ï¼‰&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¿æ¥çš„æ–¹å¼
&lt;ul>
&lt;li>å†…è¿æ¥
&lt;ul>
&lt;li>ç­‰å€¼è¿æ¥&lt;/li>
&lt;li>éç­‰å€¼è¿æ¥&lt;/li>
&lt;li>è‡ªè¿æ¥&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¤–è¿æ¥
&lt;ul>
&lt;li>å·¦å¤–è¿æ¥ï¼ˆå·¦è¿æ¥ï¼‰&lt;/li>
&lt;li>å³å¤–è¿æ¥ï¼ˆå³è¿æ¥ï¼‰&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="ç¬›å¡å°”ç§¯">ç¬›å¡å°”ç§¯&lt;/h4>
&lt;p>å½“ä¸¤å¼ è¡¨è¿›è¡Œè¿æ¥æŸ¥è¯¢ï¼Œæ²¡æœ‰ä»»ä½•æ¡ä»¶é™åˆ¶çš„æ—¶å€™ï¼Œæœ€ç»ˆæŸ¥è¯¢ç»“æœæ¡æ•°ï¼Œæ˜¯ä¸¤å¼ è¡¨è¡Œæ•°çš„ä¹˜ç§¯ï¼Œè¿™ç§ç°è±¡è¢«ç§°ä¸ºï¼šç¬›å¡å°”ç§¯ç°è±¡ã€‚&lt;br />åŠ å…¥æ¡ä»¶é™åˆ¶ï¼šselect ename, dname from EMP, DEPT where EMP.ename = DEPT.dname&lt;br />åŒ¹é…æ¬¡æ•°æ²¡å‡å°‘ï¼Œæ˜¾ç¤ºæ¡æ•°å‡å°‘ï¼Œæ·»åŠ ç­›é€‰&lt;br />ä¼˜åŒ–ï¼ˆè¡¨èµ·åˆ«åï¼‰ï¼š&lt;/p>
&lt;blockquote>
&lt;p>select e.ename, d.dname from EMP e, DEPT d where e.deptno = d.deptno; //92è¯­æ³•&lt;/p>
&lt;/blockquote>
&lt;p>æ³¨æ„ï¼šé€šè¿‡ç¬›å¡å°”ç§¯ç°è±¡å¾—å‡ºï¼Œ&lt;strong>è¡¨çš„è¿æ¥æ¬¡æ•°è¶Šå¤šæ•ˆç‡è¶Šä½&lt;/strong>ï¼Œå°½é‡é¿å…è¡¨çš„è¿æ¥æ¬¡æ•°ã€‚&lt;/p>
&lt;h4 id="å†…è¿æ¥">å†…è¿æ¥&lt;/h4>
&lt;p>sql92çš„ç¼ºç‚¹ï¼šç»“æ„ä¸æ¸…æ™°ï¼Œè¡¨çš„è¿æ¥æ¡ä»¶ï¼Œå’ŒåæœŸè¿›ä¸€æ­¥ç­›é€‰çš„æ¡ä»¶ï¼Œéƒ½æ”¾åˆ°äº†whereåé¢ã€‚&lt;br />sql99çš„ä¼˜ç‚¹ï¼šè¡¨è¿æ¥çš„æ¡ä»¶æ˜¯ç‹¬ç«‹çš„ï¼Œè¿æ¥ä¹‹åï¼Œå¦‚æœè¿˜éœ€è¦è¿›ä¸€æ­¥ç­›é€‰ï¼Œå†å¾€åç»§ç»­æ·»åŠ whereã€‚&lt;br />sql99çš„è¯­æ³•ï¼šselect ... from a &lt;strong>join&lt;/strong> b &lt;strong>on&lt;/strong> aå’Œbçš„è¿æ¥æ¡ä»¶ where ç­›é€‰æ¡ä»¶ ï¼ˆé»˜è®¤å†…è¿æ¥ inner joinï¼‰&lt;/p>
&lt;p>å†…è¿æ¥ç‰¹ç‚¹ï¼šAå’ŒBè¿æ¥ï¼ŒABä¸¤å¼ è¡¨æ²¡æœ‰ä¸»æ¬¡å…³ç³»ã€‚å¹³ç­‰çš„ã€‚&lt;/p>
&lt;ul>
&lt;li>ç­‰å€¼è¿æ¥
&lt;ul>
&lt;li>æ¡ä»¶æ˜¯ç­‰é‡å…³ç³»ï¼Œæ‰€ä»¥è¢«ç§°ä¸ºç­‰å€¼è¿æ¥ã€‚&lt;/li>
&lt;li>select e.ename,d.dname from emp e inner join dept d on &lt;strong>e.deptno = d.deptno&lt;/strong>;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>éç­‰å€¼è¿æ¥
&lt;ul>
&lt;li>æ¡ä»¶ä¸æ˜¯ä¸€ä¸ªç­‰é‡å…³ç³»ï¼Œç§°ä¸ºéç­‰å€¼è¿æ¥ã€‚&lt;/li>
&lt;li>select e.ename, e.sal, s.grade from emp e inner join salgrade s on &lt;strong>e.sal between s.losal and s.hisal;&lt;/strong>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è‡ªè¿æ¥
&lt;ul>
&lt;li>ä¸€å¼ è¡¨çœ‹åšä¸¤å¼ è¡¨ã€‚&lt;/li>
&lt;li>select a.ename, b.ename from EMP a join EMP b on a.mgr = b.empno;&lt;/li>
&lt;li>æ³¨æ„ nullä¸æ˜¾ç¤º&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="å¤–è¿æ¥">å¤–è¿æ¥&lt;/h4>
&lt;ul>
&lt;li>å³è¿æ¥
&lt;ul>
&lt;li>select e.ename,d.dname from emp e &lt;strong>right outer join&lt;/strong> dept d on e.deptno = d.deptno;&lt;/li>
&lt;li>rightè¡¨ç¤ºå°†joinå…³é”®å­—&lt;strong>å³è¾¹çš„è¿™å¼ è¡¨çœ‹æˆä¸»è¡¨&lt;/strong>ï¼Œä¸»è¦æ˜¯ä¸ºäº†å°†è¿™å¼ è¡¨çš„æ•°æ®å…¨éƒ¨æŸ¥è¯¢å‡ºæ¥ï¼Œæå¸¦ç€å…³è”æŸ¥è¯¢å·¦è¾¹çš„è¡¨ã€‚åœ¨å¤–è¿æ¥å½“ä¸­ï¼Œä¸¤å¼ è¡¨è¿æ¥ï¼Œäº§ç”Ÿäº†ä¸»æ¬¡å…³ç³»ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å·¦è¿æ¥
&lt;ul>
&lt;li>select a.ename as 'å‘˜å·¥å', b.ename as 'é¢†å¯¼å' from emp a &lt;strong>left join&lt;/strong> emp b on a.mgr = b.empno;&lt;/li>
&lt;li>å†…è¿æ¥ä¸æ˜¾ç¤ºnull&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¤–è¿æ¥çš„æŸ¥è¯¢ç»“æœæ¡æ•°ä¸€å®šæ˜¯ &amp;gt;= å†…è¿æ¥çš„æŸ¥è¯¢ç»“æœæ¡æ•°&lt;/li>
&lt;/ul>
&lt;h4 id="å¤šè¡¨è¿æ¥">å¤šè¡¨è¿æ¥&lt;/h4>
&lt;p>è¯­æ³•ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">join&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">on&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">aå’Œbçš„è¿æ¥æ¡ä»¶&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">join&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">c&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">on&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">aå’Œcçš„è¿æ¥æ¡ä»¶&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">right&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">join&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">on&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">aå’Œdçš„è¿æ¥æ¡ä»¶&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">æ¯ä¸ªå‘˜å·¥çš„éƒ¨é—¨åç§°ä»¥åŠå·¥èµ„ç­‰çº§ï¼Œè¿˜æœ‰ä¸Šçº§é¢†å¯¼ï¼Œå‘˜å·¥ä¿¡æ¯&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ename&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sal&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">dname&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">grade&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">l&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ename&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">emp&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">join&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">dept&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">on&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">deptno&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">deptno&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">join&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">salgrade&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">on&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sal&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">between&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">losal&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">and&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">hisal&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">left&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">join&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">emp&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">l&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">on&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mgr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">l&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">empno&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="å­æŸ¥è¯¢">å­æŸ¥è¯¢&lt;/h3>
&lt;p>å®šä¹‰ï¼šselectè¯­å¥ä¸­åµŒå¥—selectè¯­å¥ï¼Œè¢«åµŒå¥—çš„è¯­å¥ç§°ä¸ºå­æŸ¥è¯¢&lt;br />å­æŸ¥è¯¢å¯ä»¥å‡ºç°åœ¨select ...(select) from ... (select) where ... (select)&lt;/p>
&lt;ul>
&lt;li>whereä¸­çš„å­æŸ¥è¯¢
&lt;ul>
&lt;li>select ename,sal from emp where sal &amp;gt; (select min(sal) from emp);&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>fromä¸­çš„å­æŸ¥è¯¢
&lt;ul>
&lt;li>å¯ä»¥å°†å­æŸ¥è¯¢çš„ç»“æœä½œä¸ºä¸´æ—¶è¡¨&lt;/li>
&lt;li>select t.*, s.grade from&lt;br />(select job,avg(sal) as avgsal from emp group by job) t &lt;br />join salgrade s on t.avgsal between s.losal and s.hisal;
&lt;ul>
&lt;li>å­æŸ¥è¯¢ä¸­avgè¦èµ·åˆ«å&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>selectä¸­çš„å­æŸ¥è¯¢ ï¼ˆäº†è§£å³å¯ï¼‰
&lt;ul>
&lt;li>selectå­æŸ¥è¯¢å¿…é¡»è¿”å›ä¸€æ¡ç»“æœ&lt;/li>
&lt;li>select e.ename,e.deptno,(select d.dname from dept d where e.deptno = d.deptno) as dname from emp e;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="union">union&lt;/h3>
&lt;p>unionçš„æ•ˆç‡è¦é«˜ä¸€äº›ã€‚å¯¹äºè¡¨è¿æ¥æ¥è¯´ï¼Œæ¯è¿æ¥ä¸€æ¬¡æ–°è¡¨ï¼Œåˆ™åŒ¹é…çš„æ¬¡æ•°æ»¡è¶³ç¬›å¡å°”ç§¯ï¼Œæˆå€çš„ç¿»ã€‚ã€‚&lt;br />ä½†æ˜¯unionå¯ä»¥å‡å°‘åŒ¹é…çš„æ¬¡æ•°ã€‚åœ¨å‡å°‘åŒ¹é…æ¬¡æ•°çš„æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥å®Œæˆä¸¤ä¸ªç»“æœé›†çš„æ‹¼æ¥ã€‚&lt;br />a è¿æ¥ b è¿æ¥ c&lt;br />a 10æ¡è®°å½•&lt;br />b 10æ¡è®°å½•&lt;br />c 10æ¡è®°å½•&lt;br />åŒ¹é…æ¬¡æ•°æ˜¯ï¼š1000&lt;/p>
&lt;p>a è¿æ¥ bä¸€ä¸ªç»“æœï¼š10 * 10 --&amp;gt; 100æ¬¡&lt;br />a è¿æ¥ cä¸€ä¸ªç»“æœï¼š10 * 10 --&amp;gt; 100æ¬¡&lt;br />ä½¿ç”¨unionçš„è¯æ˜¯ï¼š100æ¬¡ + 100æ¬¡ = 200æ¬¡ã€‚ï¼ˆunionæŠŠä¹˜æ³•å˜æˆäº†åŠ æ³•è¿ç®—ï¼‰&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ename&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">job&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">EMP&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">job&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;MANAGER&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">union&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ename&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">EMP&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">job&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;SALESMAN&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">-- éœ€è¦åŠ ä¸Šjob
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">-- å¦åˆ™oracle,mysql8æŠ¥é”™ï¼Œè¦æ±‚ï¼šç»“æœé›†åˆå¹¶æ—¶åˆ—å’Œåˆ—çš„æ•°æ®ç±»å‹ä¹Ÿè¦ä¸€è‡´ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="limit-important">limit (!important)&lt;/h3>
&lt;p>limitä½œç”¨ï¼šå°†æŸ¥è¯¢ç»“æœé›†çš„ä¸€éƒ¨åˆ†å–å‡ºæ¥ã€‚é€šå¸¸ä½¿ç”¨åœ¨åˆ†é¡µæŸ¥è¯¢å½“ä¸­ã€‚&lt;br />å®Œæ•´ç”¨æ³•ï¼šlimit startIndex, length&lt;br />åªèƒ½åŠ &lt;a href="https://stackoverflow.com/questions/53234654/how-to-set-the-value-of-limit-using-select-countid-from-another-table-mysql">æ•°å­—&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>The LIMIT clause can be used to constrain the number of rows returned by the &lt;a href="https://dev.mysql.com/doc/refman/8.0/en/select.html">SELECT&lt;/a> statement. LIMIT takes one or two numeric arguments, which must both be nonnegative integer constants, with these exceptions:&lt;/p>
&lt;ul>
&lt;li>Within prepared statements, LIMIT parameters can be specified using ? placeholder markers.&lt;/li>
&lt;li>Within stored programs, LIMIT parameters can be specified using integer-valued routine parameters or local variables.&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>startIndexæ˜¯èµ·å§‹ä¸‹æ ‡ä»0å¼€å§‹ï¼Œlengthæ˜¯é•¿åº¦ã€‚&lt;br />ç¼ºçœç”¨æ³•ï¼šlimit 5; è¿™æ˜¯å–å‰5.&lt;/p>
&lt;ul>
&lt;li>æ‰§è¡Œé¡ºåºåœ¨order by ä¹‹å&lt;/li>
&lt;li>select ename, sal from EMP order by sal limit 2, 3;&lt;/li>
&lt;/ul>
&lt;h4 id="åˆ†é¡µ">åˆ†é¡µ&lt;/h4>
&lt;p>æ¯é¡µæ˜¾ç¤ºpageSizeæ¡è®°å½•&lt;br /> ç¬¬pageNoé¡µï¼šlimit (pageNo - 1) * pageSize , pageSize&lt;/p>
&lt;h3 id="dqlæ€»ç»“">DQLæ€»ç»“&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">group&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">by&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">having&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">order&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">by&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">limit&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">æ‰§è¡Œé¡ºåºï¼š&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">group&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">by&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">having&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">order&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">by&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">limit&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="sqlå¢åˆ æ”¹">SQLå¢åˆ æ”¹&lt;/h2>
&lt;h3 id="mysqlä¸­çš„æ•°æ®ç±»å‹">mysqlä¸­çš„æ•°æ®ç±»å‹&lt;/h3>
&lt;ul>
&lt;li>varchar(æœ€é•¿255) å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²
&lt;ul>
&lt;li>æ¯”è¾ƒæ™ºèƒ½ï¼ŒèŠ‚çœç©ºé—´ã€‚ä¼šæ ¹æ®å®é™…çš„æ•°æ®é•¿åº¦åŠ¨æ€åˆ†é…ç©ºé—´ã€‚&lt;/li>
&lt;li>ä¼˜ç‚¹ï¼šèŠ‚çœç©ºé—´ã€‚ç¼ºç‚¹ï¼šéœ€è¦åŠ¨æ€åˆ†é…ç©ºé—´ï¼Œé€Ÿåº¦æ…¢ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>char(æœ€é•¿255) å®šé•¿å­—ç¬¦ä¸²
&lt;ul>
&lt;li>ä¸ç®¡å®é™…çš„æ•°æ®é•¿åº¦æ˜¯å¤šå°‘ã€‚åˆ†é…å›ºå®šé•¿åº¦çš„ç©ºé—´å»å­˜å‚¨æ•°æ®ã€‚ä½¿ç”¨ä¸æ°å½“çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç©ºé—´çš„æµªè´¹ã€‚&lt;/li>
&lt;li>ä¼˜ç‚¹ï¼šä¸éœ€è¦åŠ¨æ€åˆ†é…ç©ºé—´ï¼Œé€Ÿåº¦å¿«ã€‚ç¼ºç‚¹ï¼šä½¿ç”¨ä¸å½“å¯èƒ½ä¼šå¯¼è‡´ç©ºé—´çš„æµªè´¹ã€‚&lt;/li>
&lt;li>varcharå’Œcharæˆ‘ä»¬åº”è¯¥æ€ä¹ˆé€‰æ‹©ï¼Ÿ&lt;/li>
&lt;li>æ€§åˆ«å­—æ®µä½ é€‰ä»€ä¹ˆï¼Ÿå› ä¸ºæ€§åˆ«æ˜¯å›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥é€‰æ‹©charã€‚&lt;br />å§“åå­—æ®µä½ é€‰ä»€ä¹ˆï¼Ÿæ¯ä¸€ä¸ªäººçš„åå­—é•¿åº¦ä¸åŒï¼Œæ‰€ä»¥é€‰æ‹©varcharã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>int æ•´æ•°å‹ã€‚(æœ€é•¿11)ã€‚&lt;/li>
&lt;li>bigint é•¿æ•´å‹ã€‚&lt;/li>
&lt;li>float å•ç²¾åº¦æµ®ç‚¹å‹æ•°æ®&lt;/li>
&lt;li>double åŒç²¾åº¦æµ®ç‚¹å‹æ•°æ®&lt;/li>
&lt;li>date çŸ­æ—¥æœŸç±»å‹
&lt;ul>
&lt;li>é»˜è®¤æ ¼å¼ï¼š%Y-%m-%d&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>datetime é•¿æ—¥æœŸç±»å‹
&lt;ul>
&lt;li>é»˜è®¤æ ¼å¼ï¼š%Y-%m-%d %h:%i:%s&lt;/li>
&lt;li>è·å–å½“å‰æ—¶é—´ now()å‡½æ•°&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>clob å­—ç¬¦å¤§å¯¹è±¡ Character Large OBject
&lt;ul>
&lt;li>æœ€å¤šå¯ä»¥å­˜å‚¨4Gçš„å­—ç¬¦ä¸²ã€‚è¶…è¿‡255ä¸ªå­—ç¬¦çš„éƒ½è¦é‡‡ç”¨CLOBå­—ç¬¦å¤§å¯¹è±¡æ¥å­˜å‚¨ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>blob äºŒè¿›åˆ¶å¤§å¯¹è±¡ Binary Large Object
&lt;ul>
&lt;li>ä¸“é—¨ç”¨æ¥å­˜å‚¨&lt;strong>å›¾ç‰‡ã€å£°éŸ³ã€è§†é¢‘&lt;/strong>ç­‰æµåª’ä½“æ•°æ®ã€‚&lt;/li>
&lt;li>å¾€BLOBç±»å‹çš„å­—æ®µä¸Šæ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œä¾‹å¦‚æ’å…¥ä¸€ä¸ªå›¾ç‰‡ã€è§†é¢‘ç­‰ï¼Œéœ€è¦ä½¿ç”¨IOæµã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="å¢åˆ æ”¹è¡¨ddl">å¢åˆ æ”¹è¡¨ï¼ˆDDLï¼‰&lt;/h3>
&lt;ul>
&lt;li>create table è¡¨å(å­—æ®µå1 æ•°æ®ç±»å‹, å­—æ®µå2 æ•°æ®ç±»å‹, ...);
&lt;ul>
&lt;li>è¡¨åï¼šå»ºè®®ä»¥t_ æˆ–è€… tbl_å¼€å§‹ï¼Œå¯è¯»æ€§å¼ºã€‚è§åçŸ¥æ„ã€‚&lt;/li>
&lt;li>å­—æ®µåï¼šè§åçŸ¥æ„ã€‚&lt;/li>
&lt;li>è¡¨åå’Œå­—æ®µåéƒ½å±äº&lt;strong>æ ‡è¯†ç¬¦&lt;/strong>ã€‚&lt;/li>
&lt;li>å¿«é€Ÿå»ºè¡¨ï¼šcreate table emp as select * from EMP; //äº†è§£
&lt;ul>
&lt;li>å°†æŸ¥è¯¢ç»“æœå½“åšä¸€ä¸ªè¡¨æ–°å»ºï¼Œå®Œæˆå¿«é€Ÿå¤åˆ¶&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">create&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">table&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">t_student&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">no&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">varchar&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">sex&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">char&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">default&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;m&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">age&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">email&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">varchar&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">255&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>drop table è¡¨å; // ä¸å­˜åœ¨åˆ™åˆ é™¤æŠ¥é”™
&lt;ul>
&lt;li>drop table if exists è¡¨å; // ä¸æŠ¥é”™&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>truncate table è¡¨å
&lt;ul>
&lt;li>æ¯”delete å¿«ï¼Œä½†æ˜¯ä¸æ”¯æŒå›æ»šï¼Œæ˜¯ç‰©ç†åˆ é™¤ï¼Œéœ€è¦ä»”ç»†ç¡®è®¤ã€‚&lt;/li>
&lt;li>åˆ é™¤è¡¨æ•°æ®ï¼Œä¸æ˜¯åˆ é™¤è¡¨&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="å¢åˆ æ”¹æ•°æ®dml">å¢åˆ æ”¹æ•°æ®ï¼ˆDMLï¼‰&lt;/h3>
&lt;ul>
&lt;li>insert into è¡¨å(å­—æ®µå1,å­—æ®µå2,å­—æ®µå3...) values(å€¼1,å€¼2,å€¼3), (å€¼1, å€¼2, å€¼3), (...);
&lt;ul>
&lt;li>æ³¨æ„ï¼šå­—æ®µåå’Œå€¼è¦ä¸€ä¸€å¯¹åº”ã€‚æ•°é‡è¦å¯¹åº”ã€‚æ•°æ®ç±»å‹è¦å¯¹åº”ã€‚&lt;/li>
&lt;li>insertè¯­å¥æ‰§è¡ŒæˆåŠŸäº†ï¼Œå¿…ç„¶ä¼šå¤šä¸€æ¡è®°å½•ã€‚æ²¡æœ‰ç»™å…¶å®ƒå­—æ®µæŒ‡å®šå€¼çš„è¯ï¼Œé»˜è®¤å€¼æ˜¯NULLã€‚&lt;/li>
&lt;li>insert into t_student values(2, 'lisi', 'f', 20, 'lisi@123.com'); // ä¸å†™å­—æ®µåï¼Œéœ€è¦è·Ÿè¡¨å­—æ®µåä¸€ä¸€å¯¹åº”&lt;/li>
&lt;li>å¿«é€Ÿå¤åˆ¶ï¼šinsert into emp_bak select * from emp; //äº†è§£&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>update è¡¨å set å­—æ®µå1=å€¼1, å­—æ®µå2=å€¼2,...** where æ¡ä»¶**;
&lt;ul>
&lt;li>ä¸åŠ æ¡ä»¶é™åˆ¶ä¼šæ›´æ–°æ‰€æœ‰æ•°æ®&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>delete from è¡¨å** where æ¡ä»¶**;
&lt;ul>
&lt;li>ä¸åŠ æ¡ä»¶é™åˆ¶ä¼šåˆ é™¤æ‰€æœ‰æ•°æ®&lt;/li>
&lt;li>åˆ é™¤æ•°æ®çš„åŸç†ï¼šè¡¨ä¸­çš„æ•°æ®è¢«åˆ é™¤äº†ï¼Œä½†æ˜¯ä¿å­˜åœ¨ç¡¬ç›˜å†…çš„æ•°æ®ä¸ä¼šè¢«é‡Šæ”¾ï¼›å› æ­¤æ•ˆç‡è¾ƒä½ï¼Œä½†æ˜¯å¯ä»¥å›æ»šï¼Œæ¢å¤æ•°æ®&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="å¢åˆ æ”¹è¡¨ç»“æ„">å¢åˆ æ”¹è¡¨ç»“æ„&lt;/h3>
&lt;ul>
&lt;li>å¼€å‘ä¸­å¾ˆå°‘è¿›è¡Œè¡¨ç»“æ„çš„ä¿®æ”¹ã€‚&lt;/li>
&lt;li>alterå…³é”®å­—&lt;/li>
&lt;/ul>
&lt;h3 id="çº¦æŸ">çº¦æŸ&lt;/h3>
&lt;p>ä¿è¯æ•°æ®æœ‰æ•ˆæ€§ã€å®Œæ•´æ€§&lt;br />çº¦æŸåŒ…æ‹¬ï¼š&lt;br />create tableä¸­æŒ‡å®š&lt;/p>
&lt;ul>
&lt;li>éç©ºçº¦æŸ not null
&lt;ul>
&lt;li>åˆ—çº§çº¦æŸï¼šid int &lt;strong>not null&lt;/strong>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å”¯ä¸€æ€§çº¦æŸ unique
&lt;ul>
&lt;li>nullå¯ä»¥é‡å¤&lt;/li>
&lt;li>åˆ—çº§çº¦æŸï¼šname varchar(23) &lt;strong>unique&lt;/strong>&lt;/li>
&lt;li>è¡¨çº§çº¦æŸï¼ˆå¤šå­—æ®µè”åˆçº¦æŸï¼‰ï¼š&lt;strong>unique(&lt;strong>name, email&lt;/strong>)&lt;/strong>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>ä¸»é”®çº¦æŸ primary key&lt;/strong>
&lt;ul>
&lt;li>ä¸»é”®çº¦æŸã€ä¸»é”®å­—æ®µã€ä¸»é”®å€¼&lt;/li>
&lt;li>ä¸€ä¸ªå­—æ®µåŒæ—¶éç©ºåˆä¸èƒ½é‡å¤è‡ªåŠ¨ä¸ºä¸»é”®ï¼Œoracleä¸è¡Œï¼Œä¸»é”®çº¦æŸç‰¹å¾æ˜¯not null + unique&lt;/li>
&lt;li>æ¯ä¸ªè¡¨éƒ½åº”æœ‰ä¸»é”®ï¼Œæ˜¯æ¯ä¸€è¡Œè®°å½•çš„å”¯ä¸€æ ‡è¯†&lt;/li>
&lt;li>å¯ä»¥å•ä¸€ä¸»é”®æˆ–å¤åˆä¸»é”®ï¼ˆä¸å»ºè®®ä½¿ç”¨å¤åˆï¼‰
&lt;ul>
&lt;li>int id primary key,&lt;/li>
&lt;li>primary key(id, name),&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åˆåˆ†ä¸ºè‡ªç„¶ä¸»é”®å’Œä¸šåŠ¡ä¸»é”®ï¼Œé€šå¸¸è‡ªç„¶ä¸»é”®&lt;/li>
&lt;li>ä¸»é”®çº¦æŸåªèƒ½æœ‰ä¸€ä¸ª&lt;/li>
&lt;li>å»ºè®®ä½¿ç”¨intã€bigintã€charï¼Œç­‰å®šé•¿ç±»å‹&lt;/li>
&lt;li>è‡ªåŠ¨ç»´æŠ¤ä¸»é”®å€¼ï¼šid int primary key &lt;strong>auto_increment&lt;/strong>,&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>å¤–é”®çº¦æŸ foreign key&lt;/strong>
&lt;ul>
&lt;li>å‡å°‘è¡¨å†—ä½™ï¼Œé˜²æ­¢å‡ºç°æ— æ•ˆæ•°æ®&lt;/li>
&lt;li>å¤–ç•Œçº¦æŸã€å¤–é”®å­—æ®µã€å¤–é”®å€¼&lt;/li>
&lt;li>æ ¼å¼ï¼š foreign key(å­è¡¨å­—æ®µ) references (çˆ¶è¡¨å”¯ä¸€æ€§çº¦æŸå­—æ®µï¼Œå¯ä»¥ä¸ºNULL)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ£€æŸ¥çº¦æŸ check ï¼ˆmysql ä¸æ”¯æŒï¼Œoracleæ”¯æŒï¼‰&lt;/li>
&lt;/ul>
&lt;h3 id="å­˜å‚¨å¼•æ“">å­˜å‚¨å¼•æ“&lt;/h3>
&lt;p>å­˜å‚¨å¼•æ“æ˜¯MySQLä¸­ç‰¹æœ‰çš„ä¸€ä¸ªæœ¯è¯­ï¼Œå…¶å®ƒæ•°æ®åº“ä¸­æ²¡æœ‰ã€‚ï¼ˆOracleä¸­æœ‰ï¼Œä½†æ˜¯ä¸å«è¿™ä¸ªåå­—ï¼‰&lt;br />å­˜å‚¨å¼•æ“æ˜¯ä¸€ä¸ªè¡¨&lt;strong>å­˜å‚¨/ç»„ç»‡æ•°æ®çš„æ–¹å¼&lt;/strong>ã€‚&lt;br />ä¸åŒçš„å­˜å‚¨å¼•æ“ï¼Œè¡¨å­˜å‚¨æ•°æ®çš„æ–¹å¼ä¸åŒã€‚&lt;br />ç»™è¡¨æŒ‡å®šå­˜å‚¨å¼•æ“&lt;/p>
&lt;ul>
&lt;li>æ˜¾ç¤ºå­˜å‚¨å¼•æ“ï¼šshow create table è¡¨å&lt;/li>
&lt;li>mysqlé»˜è®¤å¼•æ“æ˜¯InnoDBï¼Œå­—ç¬¦é›†utf8&lt;/li>
&lt;li>æ ¼å¼ï¼šcreate table è¡¨å() engine=InnoDB default charset=gbk;&lt;/li>
&lt;/ul>
&lt;p>æŸ¥çœ‹mysqlæ”¯æŒå­˜å‚¨å¼•æ“ï¼šshow engines \G&lt;/p>
&lt;ul>
&lt;li>MyISAMå­˜å‚¨å¼•æ“
&lt;ul>
&lt;li>å®ƒç®¡ç†çš„è¡¨å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š
&lt;ul>
&lt;li>ä½¿ç”¨ä¸‰ä¸ªæ–‡ä»¶è¡¨ç¤ºæ¯ä¸ªè¡¨ï¼š
&lt;ul>
&lt;li>æ ¼å¼æ–‡ä»¶ â€” å­˜å‚¨è¡¨ç»“æ„çš„å®šä¹‰ï¼ˆmytable.frm / frameworkï¼‰&lt;/li>
&lt;li>æ•°æ®æ–‡ä»¶ â€” å­˜å‚¨è¡¨è¡Œçš„å†…å®¹ï¼ˆmytable.MYD/ mydataï¼‰&lt;/li>
&lt;li>ç´¢å¼•æ–‡ä»¶ â€” å­˜å‚¨è¡¨ä¸Šç´¢å¼•ï¼ˆmytable.MYI / myindexï¼‰ï¼šç´¢å¼•æ˜¯ä¸€æœ¬ä¹¦çš„ç›®å½•ï¼Œç¼©å°æ‰«æèŒƒå›´ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡çš„ä¸€ç§æœºåˆ¶ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¯è¢«è½¬æ¢ä¸ºå‹ç¼©ï¼ˆåªè¯»ï¼‰è¡¨æ¥èŠ‚çœç©ºé—´&lt;/li>
&lt;li>å¯¹äºä¸€å¼ è¡¨æ¥è¯´ï¼Œåªè¦æ˜¯ä¸»é”®ï¼Œæˆ–è€…åŠ æœ‰uniqueçº¦æŸçš„å­—æ®µä¸Šä¼šè‡ªåŠ¨åˆ›å»ºç´¢å¼•ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>MyISAMå­˜å‚¨å¼•æ“ç‰¹ç‚¹ï¼š
&lt;ul>
&lt;li>å¯è¢«è½¬æ¢ä¸ºå‹ç¼©ï¼ˆåªè¯»ï¼‰è¡¨æ¥&lt;strong>èŠ‚çœç©ºé—´&lt;/strong>&lt;/li>
&lt;li>è¿™æ˜¯è¿™ç§å­˜å‚¨å¼•æ“çš„ä¼˜åŠ¿ï¼&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>MyISAMä¸æ”¯æŒäº‹åŠ¡æœºåˆ¶ï¼Œå®‰å…¨æ€§ä½ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>InnoDBå­˜å‚¨å¼•æ“
&lt;ul>
&lt;li>è¿™æ˜¯mysqlé»˜è®¤çš„å­˜å‚¨å¼•æ“ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªé‡é‡çº§çš„å­˜å‚¨å¼•æ“ã€‚&lt;/li>
&lt;li>InnoDBæ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒæ•°æ®åº“å´©æºƒåè‡ªåŠ¨æ¢å¤æœºåˆ¶ã€‚&lt;/li>
&lt;li>InnoDBå­˜å‚¨å¼•æ“æœ€ä¸»è¦çš„ç‰¹ç‚¹æ˜¯ï¼šéå¸¸å®‰å…¨ã€‚&lt;/li>
&lt;li>å®ƒç®¡ç†çš„è¡¨å…·æœ‰ä¸‹åˆ—ä¸»è¦ç‰¹å¾ï¼š
&lt;ul>
&lt;li>æ¯ä¸ª InnoDB è¡¨åœ¨æ•°æ®åº“ç›®å½•ä¸­ä»¥.frm æ ¼å¼æ–‡ä»¶è¡¨ç¤º&lt;/li>
&lt;li>InnoDB è¡¨ç©ºé—´ tablespace è¢«ç”¨äºå­˜å‚¨è¡¨çš„å†…å®¹ï¼ˆè¡¨ç©ºé—´æ˜¯ä¸€ä¸ªé€»è¾‘åç§°ã€‚è¡¨ç©ºé—´ï¼šå­˜å‚¨æ•°æ®+ç´¢å¼•ã€‚ï¼‰&lt;/li>
&lt;li>æä¾›ä¸€ç»„ç”¨æ¥è®°å½•äº‹åŠ¡æ€§æ´»åŠ¨çš„æ—¥å¿—æ–‡ä»¶&lt;/li>
&lt;li>ç”¨ COMMIT(æäº¤)ã€SAVEPOINT åŠROLLBACK(å›æ»š)æ”¯æŒ&lt;strong>äº‹åŠ¡&lt;/strong>å¤„ç†&lt;/li>
&lt;li>æä¾›å…¨ ACID å…¼å®¹&lt;/li>
&lt;li>åœ¨ MySQL æœåŠ¡å™¨å´©æºƒåæä¾›è‡ªåŠ¨æ¢å¤&lt;/li>
&lt;li>å¤šç‰ˆæœ¬ï¼ˆMVCCï¼‰å’Œè¡Œçº§é”å®š&lt;/li>
&lt;li>æ”¯æŒå¤–é”®åŠå¼•ç”¨çš„å®Œæ•´æ€§ï¼ŒåŒ…æ‹¬çº§è”åˆ é™¤å’Œæ›´æ–°&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>InnoDBæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯æ”¯æŒäº‹åŠ¡ï¼š
&lt;ul>
&lt;li>ä¿è¯æ•°æ®çš„å®‰å…¨ã€‚æ•ˆç‡ä¸æ˜¯å¾ˆé«˜ï¼Œä¸èƒ½å‹ç¼©ï¼Œä¸èƒ½è½¬æ¢ä¸ºåªè¯»ï¼Œä¸èƒ½å¾ˆå¥½çš„èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>MEMORYå­˜å‚¨å¼•æ“
&lt;ul>
&lt;li>ç”¨ MEMORY å­˜å‚¨å¼•æ“çš„è¡¨ï¼Œå…¶æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸”è¡Œçš„é•¿åº¦å›ºå®šï¼Œè¿™ä¸¤ä¸ªç‰¹ç‚¹ä½¿å¾— MEMORY å­˜å‚¨å¼•æ“éå¸¸å¿«ã€‚&lt;/li>
&lt;li>MEMORY å­˜å‚¨å¼•æ“ç®¡ç†çš„è¡¨å…·æœ‰ä¸‹åˆ—ç‰¹å¾ï¼š
&lt;ul>
&lt;li>åœ¨æ•°æ®åº“ç›®å½•å†…ï¼Œæ¯ä¸ªè¡¨å‡ä»¥.frm æ ¼å¼çš„æ–‡ä»¶è¡¨ç¤ºã€‚&lt;/li>
&lt;li>è¡¨æ•°æ®åŠç´¢å¼•è¢«å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚ï¼ˆç›®çš„å°±æ˜¯å¿«ï¼ŒæŸ¥è¯¢å¿«ï¼ï¼‰&lt;/li>
&lt;li>è¡¨çº§é”æœºåˆ¶ã€‚&lt;/li>
&lt;li>ä¸èƒ½åŒ…å« TEXT æˆ– BLOB å­—æ®µã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>MEMORY å­˜å‚¨å¼•æ“ä»¥å‰è¢«ç§°ä¸ºHEAP å¼•æ“ã€‚&lt;/li>
&lt;li>MEMORYå¼•æ“ä¼˜ç‚¹ï¼šæŸ¥è¯¢æ•ˆç‡æ˜¯æœ€é«˜çš„ã€‚ä¸éœ€è¦å’Œç¡¬ç›˜äº¤äº’ã€‚&lt;/li>
&lt;li>MEMORYå¼•æ“ç¼ºç‚¹ï¼šä¸å®‰å…¨ï¼Œå…³æœºä¹‹åæ•°æ®æ¶ˆå¤±ã€‚å› ä¸ºæ•°æ®å’Œç´¢å¼•éƒ½æ˜¯åœ¨å†…å­˜å½“ä¸­ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="äº‹åŠ¡">äº‹åŠ¡&lt;/h3>
&lt;p>ä¸€ä¸ªäº‹åŠ¡æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡é€»è¾‘ã€‚æ˜¯ä¸€ä¸ªæœ€å°çš„å·¥ä½œå•å…ƒã€‚ä¸å¯å†åˆ†ï¼ŒåŒç”ŸåŒæ­»ã€‚&lt;br />äº‹åŠ¡ï¼šå°±æ˜¯æ‰¹é‡çš„DMLè¯­å¥åŒæ—¶æˆåŠŸï¼Œæˆ–è€…åŒæ—¶å¤±è´¥ï¼&lt;br />ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡é€»è¾‘ï¼š&lt;/p>
&lt;ol>
&lt;li>å‡è®¾è½¬è´¦ï¼Œä»Aè´¦æˆ·å‘Bè´¦æˆ·ä¸­è½¬è´¦10000.&lt;/li>
&lt;li>å°†Aè´¦æˆ·çš„é’±å‡å»10000ï¼ˆupdateè¯­å¥ï¼‰&lt;/li>
&lt;li>å°†Bè´¦æˆ·çš„é’±åŠ ä¸Š10000ï¼ˆupdateè¯­å¥ï¼‰&lt;/li>
&lt;li>è¿™å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡é€»è¾‘ã€‚&lt;/li>
&lt;/ol>
&lt;p>åªæœ‰DMLè¯­å¥æœ‰äº‹åŠ¡ä¸€è¯´ï¼Œå› ä¸ºå®ƒä»¬æ¶‰åŠæ•°æ®çš„å¢åˆ æ”¹ï¼Œinsert/update/delete&lt;/p>
&lt;p>InnoDBå­˜å‚¨å¼•æ“ï¼šæä¾›ä¸€ç»„ç”¨æ¥è®°å½•äº‹åŠ¡æ€§æ´»åŠ¨çš„æ—¥å¿—æ–‡ä»¶ã€‚&lt;br />åœ¨äº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€æ¡DMLçš„æ“ä½œéƒ½ä¼šè®°å½•åˆ°â€œäº‹åŠ¡æ€§æ´»åŠ¨çš„æ—¥å¿—æ–‡ä»¶â€ä¸­ã€‚&lt;br />åœ¨äº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥æäº¤äº‹åŠ¡ï¼Œä¹Ÿå¯ä»¥å›æ»šäº‹åŠ¡ã€‚&lt;/p>
&lt;ul>
&lt;li>æäº¤äº‹åŠ¡
&lt;ul>
&lt;li>commit;&lt;/li>
&lt;li>æ¸…ç©ºäº‹åŠ¡æ€§æ´»åŠ¨çš„æ—¥å¿—æ–‡ä»¶ï¼Œå°†æ•°æ®å…¨éƒ¨å½»åº•æŒä¹…åŒ–åˆ°æ•°æ®åº“è¡¨ä¸­ã€‚æäº¤äº‹åŠ¡æ ‡å¿—ç€ï¼Œäº‹åŠ¡çš„ç»“æŸã€‚å¹¶ä¸”æ˜¯ä¸€ç§å…¨éƒ¨æˆåŠŸçš„ç»“æŸã€‚&lt;/li>
&lt;li>é»˜è®¤æ‰§è¡Œä¸€æ¡æäº¤ä¸€æ¬¡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å›æ»šäº‹åŠ¡
&lt;ul>
&lt;li>rollback;&lt;/li>
&lt;li>å°†ä¹‹å‰æ‰€æœ‰çš„DMLæ“ä½œå…¨éƒ¨æ’¤é”€ï¼Œå¹¶ä¸”æ¸…ç©ºäº‹åŠ¡æ€§æ´»åŠ¨çš„æ—¥å¿—æ–‡ä»¶ã€‚å›æ»šäº‹åŠ¡æ ‡å¿—ç€ï¼Œäº‹åŠ¡çš„ç»“æŸã€‚å¹¶ä¸”æ˜¯ä¸€ç§å…¨éƒ¨å¤±è´¥çš„ç»“æŸã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ä½¿ç”¨start transaction; å…³é—­æäº¤äº‹åŠ¡ï¼ˆé»˜è®¤ï¼‰&lt;br />commit;/rollback; åç»“æŸè¯¥æ¬¡äº‹åŠ¡ã€‚&lt;/p>
&lt;p>äº‹åŠ¡å››ä¸ªç‰¹æ€§ï¼š&lt;/p>
&lt;ul>
&lt;li>Aï¼šåŸå­æ€§ atomicity
&lt;ul>
&lt;li>è¯´æ˜äº‹åŠ¡æ˜¯æœ€å°çš„å·¥ä½œå•å…ƒã€‚ä¸å¯å†åˆ†ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Cï¼šä¸€è‡´æ€§ consistency
&lt;ul>
&lt;li>æ‰€æœ‰äº‹åŠ¡è¦æ±‚ï¼Œåœ¨åŒä¸€ä¸ªäº‹åŠ¡å½“ä¸­ï¼Œæ‰€æœ‰æ“ä½œå¿…é¡»åŒæ—¶æˆåŠŸï¼Œæˆ–è€…åŒæ—¶å¤±è´¥ï¼Œä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Iï¼šéš”ç¦»æ€§ isolation
&lt;ul>
&lt;li>éš”ç¦»ä¸¤ç§äº‹åŠ¡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Dï¼šæŒä¹…æ€§ durability
&lt;ul>
&lt;li>äº‹åŠ¡æœ€ç»ˆç»“æŸçš„ä¸€ä¸ªä¿éšœã€‚äº‹åŠ¡æäº¤ï¼Œå°±ç›¸å½“äºå°†æ²¡æœ‰ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šçš„æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>éš”ç¦»æ€§ï¼š&lt;/p>
&lt;ul>
&lt;li>è¯»æœªæäº¤ï¼šread uncommittedï¼ˆæœ€ä½çš„éš”ç¦»çº§åˆ«ï¼‰ã€Šæ²¡æœ‰æäº¤å°±è¯»åˆ°äº†ã€‹
&lt;ul>
&lt;li>äº‹åŠ¡Aå¯ä»¥è¯»å–åˆ°äº‹åŠ¡Bæœªæäº¤çš„æ•°æ®ã€‚&lt;/li>
&lt;li>è¿™ç§éš”ç¦»çº§åˆ«å­˜åœ¨çš„é—®é¢˜å°±æ˜¯ï¼š&lt;strong>è„è¯»ç°è±¡&lt;/strong>ï¼(Dirty Read)&lt;/li>
&lt;li>è¿™ç§éš”ç¦»çº§åˆ«ä¸€èˆ¬éƒ½æ˜¯ç†è®ºä¸Šçš„ï¼Œå¤§å¤šæ•°çš„æ•°æ®åº“éš”ç¦»çº§åˆ«éƒ½æ˜¯äºŒæ¡£èµ·æ­¥ï¼&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¯»å·²æäº¤ï¼šread committedã€Šæäº¤ä¹‹åæ‰èƒ½è¯»åˆ°ã€‹
&lt;ul>
&lt;li>äº‹åŠ¡Aåªèƒ½è¯»å–åˆ°äº‹åŠ¡Bæäº¤ä¹‹åçš„æ•°æ®ã€‚&lt;/li>
&lt;li>è§£å†³äº†è„è¯»çš„ç°è±¡ã€‚&lt;/li>
&lt;li>è¿™ç§éš”ç¦»çº§åˆ«å­˜åœ¨çš„é—®é¢˜ï¼š&lt;strong>ä¸å¯é‡å¤è¯»å–æ•°æ®&lt;/strong>ã€‚
&lt;ul>
&lt;li>ä»€ä¹ˆæ˜¯ä¸å¯é‡å¤è¯»å–æ•°æ®å‘¢ï¼Ÿ&lt;/li>
&lt;li>åœ¨äº‹åŠ¡å¼€å¯ä¹‹åï¼Œç¬¬ä¸€æ¬¡è¯»åˆ°çš„æ•°æ®æ˜¯3æ¡ï¼Œå½“å‰äº‹åŠ¡è¿˜æ²¡æœ‰ç»“æŸï¼Œå¯èƒ½ç¬¬äºŒæ¬¡å†è¯»å–çš„æ—¶å€™ï¼Œè¯»åˆ°çš„æ•°æ®æ˜¯4æ¡ï¼Œ3ä¸ç­‰äº4ç§°ä¸ºä¸å¯é‡å¤è¯»å–ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¿™ç§éš”ç¦»çº§åˆ«æ˜¯æ¯”è¾ƒçœŸå®çš„æ•°æ®ï¼Œæ¯ä¸€æ¬¡è¯»åˆ°çš„æ•°æ®æ˜¯ç»å¯¹çš„çœŸå®ã€‚&lt;/li>
&lt;li>oracleæ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ«æ˜¯ï¼šread committed&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¯é‡å¤è¯»ï¼šrepeatable readã€Šæäº¤ä¹‹åä¹Ÿè¯»ä¸åˆ°ï¼Œæ°¸è¿œè¯»å–çš„éƒ½æ˜¯åˆšå¼€å¯äº‹åŠ¡æ—¶çš„æ•°æ®ã€‹
&lt;ul>
&lt;li>
&lt;p>äº‹åŠ¡Aå¼€å¯ä¹‹åï¼Œä¸ç®¡æ˜¯å¤šä¹…ï¼Œæ¯ä¸€æ¬¡åœ¨äº‹åŠ¡Aä¸­è¯»å–åˆ°çš„æ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ã€‚å³ä½¿äº‹åŠ¡Bå°†æ•°æ®å·²ç»ä¿®æ”¹ï¼Œå¹¶ä¸”æäº¤äº†ï¼Œäº‹åŠ¡Aè¯»å–åˆ°çš„æ•°æ®è¿˜æ˜¯æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œè¿™å°±æ˜¯å¯é‡å¤è¯»ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è§£å†³äº†ä¸å¯é‡å¤è¯»å–æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯é‡å¤è¯»å­˜åœ¨çš„é—®é¢˜ï¼šä¼šå‡ºç°&lt;strong>å¹»å½±è¯»&lt;/strong>ã€‚æ¯ä¸€æ¬¡è¯»å–åˆ°çš„æ•°æ®éƒ½æ˜¯å¹»è±¡ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ä¸å¤ŸçœŸå®ã€‚æ—©æ™¨9ç‚¹å¼€å§‹å¼€å¯äº†äº‹åŠ¡ï¼Œåªè¦äº‹åŠ¡ä¸ç»“æŸï¼Œåˆ°æ™šä¸Š9ç‚¹ï¼Œè¯»åˆ°çš„æ•°æ®è¿˜æ˜¯é‚£æ ·ï¼&lt;/p>
&lt;pre>&lt;code>è¯»åˆ°çš„æ˜¯å‡è±¡ã€‚ä¸å¤Ÿç»å¯¹çš„çœŸå®ã€‚
&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>mysqlä¸­é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«å°±æ˜¯è¿™ä¸ªï¼&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åºåˆ—åŒ–/ä¸²è¡ŒåŒ–ï¼šserializableï¼ˆæœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼‰
&lt;ul>
&lt;li>è¿™æ˜¯æœ€é«˜éš”ç¦»çº§åˆ«ï¼Œæ•ˆç‡æœ€ä½ã€‚è§£å†³äº†æ‰€æœ‰çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>è¿™ç§éš”ç¦»çº§åˆ«è¡¨ç¤ºäº‹åŠ¡æ’é˜Ÿï¼Œä¸èƒ½å¹¶å‘ï¼&lt;/li>
&lt;li>æ¯ä¸€æ¬¡è¯»å–åˆ°çš„æ•°æ®éƒ½æ˜¯æœ€çœŸå®çš„ï¼Œå¹¶ä¸”æ•ˆç‡æ˜¯æœ€ä½çš„ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>æŸ¥çœ‹éš”ç¦»çº§åˆ«ï¼šselect @@tx_isolation;&lt;br />è®¾ç½®éš”ç¦»çº§åˆ«ï¼šset global transaction isolation level xxxx; exit;&lt;/p>
&lt;h3 id="ç´¢å¼•">ç´¢å¼•&lt;/h3>
&lt;ul>
&lt;li>ç´¢å¼•æ˜¯åœ¨æ•°æ®åº“è¡¨çš„å­—æ®µä¸Šæ·»åŠ çš„ï¼Œæ˜¯ä¸ºäº†æé«˜æŸ¥è¯¢æ•ˆç‡å­˜åœ¨çš„ä¸€ç§æœºåˆ¶ã€‚&lt;/li>
&lt;li>ä¸€å¼ è¡¨çš„ä¸€ä¸ªå­—æ®µå¯ä»¥æ·»åŠ ä¸€ä¸ªç´¢å¼•ï¼Œå¤šä¸ªå­—æ®µè”åˆèµ·æ¥å«å¤åˆç´¢å¼•ã€‚&lt;/li>
&lt;li>MySQLåœ¨æŸ¥è¯¢æ–¹é¢ä¸»è¦å°±æ˜¯ä¸¤ç§æ–¹å¼ï¼š
&lt;ul>
&lt;li>ç¬¬ä¸€ç§æ–¹å¼ï¼šå…¨è¡¨æ‰«æ&lt;/li>
&lt;li>ç¬¬äºŒç§æ–¹å¼ï¼šæ ¹æ®ç´¢å¼•æ£€ç´¢ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>mysqlç´¢å¼•æ˜¯ä¸€ä¸ªB-Treeæ•°æ®ç»“æ„ã€‚éµå¾ªå·¦å°å³å¤§åŸåˆ™å­˜æ”¾ã€‚é‡‡ç”¨ä¸­åºéå†æ–¹å¼éå†å–æ•°æ®ã€‚&lt;/li>
&lt;li>æé†’
&lt;ul>
&lt;li>æé†’1ï¼šåœ¨ä»»ä½•æ•°æ®åº“å½“ä¸­&lt;strong>ä¸»é”®&lt;/strong>ä¸Šéƒ½ä¼šè‡ªåŠ¨æ·»åŠ ç´¢å¼•å¯¹è±¡ï¼Œmysqlä¸­ä¸€ä¸ªå­—æ®µä¸Šå¦‚æœæœ‰&lt;strong>uniqueçº¦æŸ&lt;/strong>çš„è¯ï¼Œä¹Ÿä¼šè‡ªåŠ¨åˆ›å»ºç´¢å¼•å¯¹è±¡ã€‚&lt;/li>
&lt;li>æé†’2ï¼šåœ¨ä»»ä½•æ•°æ®åº“å½“ä¸­ï¼Œä»»ä½•ä¸€å¼ è¡¨çš„ä»»ä½•ä¸€æ¡è®°å½•åœ¨ç¡¬ç›˜å­˜å‚¨ä¸Š&lt;strong>éƒ½æœ‰ä¸€ä¸ªç¡¬ç›˜çš„ç‰©ç†å­˜å‚¨ç¼–å·&lt;/strong>ã€‚&lt;/li>
&lt;li>æé†’3ï¼šåœ¨mysqlå½“ä¸­ï¼Œ&lt;strong>ç´¢å¼•æ˜¯ä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡&lt;/strong>ï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“ä»¥ä¸åŒçš„å½¢å¼å­˜åœ¨ï¼Œåœ¨MyISAMå­˜å‚¨å¼•æ“ä¸­ï¼Œç´¢å¼•å­˜å‚¨åœ¨ä¸€ä¸ª.MYIæ–‡ä»¶ä¸­ã€‚åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ç´¢å¼•å­˜å‚¨åœ¨ä¸€ä¸ªé€»è¾‘åç§°å«åštablespaceçš„å½“ä¸­ã€‚åœ¨MEMORYå­˜å‚¨å¼•æ“å½“ä¸­ç´¢å¼•è¢«å­˜å‚¨åœ¨å†…å­˜å½“ä¸­ã€‚ä¸ç®¡ç´¢å¼•å­˜å‚¨åœ¨å“ªé‡Œï¼Œç´¢å¼•åœ¨mysqlå½“ä¸­éƒ½æ˜¯ä¸€ä¸ªæ ‘çš„å½¢å¼å­˜åœ¨ã€‚ï¼ˆè‡ªå¹³è¡¡äºŒå‰æ ‘ï¼šB-Treeï¼‰&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä»€ä¹ˆæ—¶å€™æ·»åŠ å­—æ®µ
&lt;ul>
&lt;li>æ•°æ®é‡åºå¤§ï¼ˆè§†ç‰©ç†è®¾å¤‡å†³å®šï¼‰&lt;/li>
&lt;li>ç»å¸¸å‡ºç°åœ¨whereåé¢ï¼Œç»å¸¸ä¼šè¢«æ‰«æåˆ°&lt;/li>
&lt;li>å¾ˆå°‘DMLæ“ä½œï¼Œå¦åˆ™éœ€è¦é‡æ–°æ’åº&lt;/li>
&lt;li>å¤ªå¤šç´¢å¼•ä¼šé™ä½æ€§èƒ½&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ·»åŠ ç´¢å¼•
&lt;ul>
&lt;li>create index emp_ename_index on emp(ename);&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åˆ é™¤ç´¢å¼•
&lt;ul>
&lt;li>drop index emp_ename_index on emp;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æŸ¥çœ‹ç´¢å¼•
&lt;ul>
&lt;li>explain select * from emp where ename='KING';&lt;/li>
&lt;li>çœ‹rowåˆ—çš„æ‰«ææ¬¡æ•°&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç´¢å¼•å¤±æ•ˆ
&lt;ul>
&lt;li>ç›®å‰ç‰ˆæœ¬ä¸ä¼šå¤±æ•ˆï¼Œå½“ä½¿ç”¨æ¨¡ç³ŠæŸ¥è¯¢ä»¥'%'å¼€å¤´&lt;/li>
&lt;li>ä½¿ç”¨orï¼ˆunionèƒ½æ¢å¤ç´¢å¼•ï¼Œå­˜ç–‘ï¼‰&lt;/li>
&lt;li>ä½¿ç”¨å¤åˆç´¢å¼•åï¼Œæ²¡æœ‰ç”¨æœ€å·¦ä¾§çš„å­—æ®µæŸ¥æ‰¾&lt;/li>
&lt;li>whereä¸­å­—æ®µå‚åŠ äº†æ•°å­¦è¿ç®—ï¼Œå­—æ®µä½¿ç”¨å‡½æ•°&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ç´¢å¼•æ˜¯å„ç§æ•°æ®åº“è¿›è¡Œä¼˜åŒ–çš„é‡è¦æ‰‹æ®µã€‚ä¼˜åŒ–çš„æ—¶å€™ä¼˜å…ˆè€ƒè™‘çš„å› ç´ å°±æ˜¯&lt;code>..ç´¢å¼•..&lt;/code>ã€‚&lt;br />ç´¢å¼•åœ¨æ•°æ®åº“çš„åˆ†ç±»&lt;br /> å•ä¸€ç´¢å¼•ï¼šä¸€ä¸ªå­—æ®µä¸Šæ·»åŠ ç´¢å¼•ã€‚&lt;br /> å¤åˆç´¢å¼•ï¼šä¸¤ä¸ªå­—æ®µæˆ–è€…æ›´å¤šçš„å­—æ®µä¸Šæ·»åŠ ç´¢å¼•ã€‚&lt;br /> ä¸»é”®ç´¢å¼•ï¼šä¸»é”®ä¸Šæ·»åŠ ç´¢å¼•ã€‚&lt;br /> å”¯ä¸€æ€§ç´¢å¼•ï¼šå…·æœ‰uniqueçº¦æŸçš„å­—æ®µä¸Šæ·»åŠ ç´¢å¼•ã€‚&lt;br /> .....&lt;br /> æ³¨æ„ï¼šå”¯ä¸€æ€§æ¯”è¾ƒå¼±çš„å­—æ®µä¸Šæ·»åŠ ç´¢å¼•ç”¨å¤„ä¸å¤§ã€‚&lt;/p>
&lt;h2 id="è§†å›¾">è§†å›¾&lt;/h2>
&lt;p>åˆ›å»ºè§†å›¾å¯¹è±¡&lt;/p>
&lt;ul>
&lt;li>create view è§†å›¾å as DQLè¯­å¥;&lt;/li>
&lt;/ul>
&lt;p>åˆ é™¤è§†å›¾å¯¹è±¡&lt;/p>
&lt;ul>
&lt;li>drop view è§†å›¾å&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥é¢å‘è§†å›¾å¯¹è±¡è¿›è¡Œå¢åˆ æ”¹æŸ¥ï¼Œå¯¹è§†å›¾å¯¹è±¡çš„å¢åˆ æ”¹æŸ¥ï¼Œä¼šå¯¼è‡´åŸè¡¨è¢«æ“ä½œï¼ï¼ˆè§†å›¾çš„ç‰¹ç‚¹ï¼šé€šè¿‡å¯¹è§†å›¾çš„æ“ä½œï¼Œä¼šå½±å“åˆ°åŸè¡¨æ•°æ®ã€‚ï¼‰&lt;br />è§†å›¾çš„ä½œç”¨ï¼šæ–¹ä¾¿ï¼Œç®€åŒ–å¼€å‘ï¼Œåˆ©äºç»´æŠ¤&lt;br />å‡è®¾æœ‰ä¸€æ¡éå¸¸å¤æ‚çš„SQLè¯­å¥ï¼Œè€Œè¿™æ¡SQLè¯­å¥éœ€è¦åœ¨ä¸åŒçš„ä½ç½®ä¸Šåå¤ä½¿ç”¨ã€‚æ¯ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªsqlè¯­å¥çš„æ—¶å€™éƒ½éœ€è¦é‡æ–°ç¼–å†™ï¼Œå¾ˆé•¿ï¼Œå¾ˆéº»çƒ¦ï¼Œæ€ä¹ˆåŠï¼Ÿ&lt;/p>
&lt;ul>
&lt;li>å¯ä»¥æŠŠè¿™æ¡å¤æ‚çš„SQLè¯­å¥ä»¥è§†å›¾å¯¹è±¡çš„å½¢å¼æ–°å»ºã€‚&lt;/li>
&lt;li>åœ¨éœ€è¦ç¼–å†™è¿™æ¡SQLè¯­å¥çš„ä½ç½®ç›´æ¥ä½¿ç”¨è§†å›¾å¯¹è±¡ï¼Œå¯ä»¥å¤§å¤§ç®€åŒ–å¼€å‘ã€‚&lt;/li>
&lt;li>å¹¶ä¸”åˆ©äºåæœŸçš„ç»´æŠ¤ï¼Œå› ä¸ºä¿®æ”¹çš„æ—¶å€™ä¹Ÿåªéœ€è¦ä¿®æ”¹ä¸€ä¸ªä½ç½®å°±è¡Œï¼Œåªéœ€è¦ä¿®æ”¹è§†å›¾å¯¹è±¡æ‰€æ˜ å°„çš„SQLè¯­å¥ã€‚&lt;/li>
&lt;li>æˆ‘ä»¬ä»¥åé¢å‘è§†å›¾å¼€å‘çš„æ—¶å€™ï¼Œä½¿ç”¨è§†å›¾çš„æ—¶å€™å¯ä»¥åƒä½¿ç”¨tableä¸€æ ·ã€‚å¯ä»¥å¯¹è§†å›¾è¿›è¡Œå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œã€‚è§†å›¾ä¸æ˜¯åœ¨å†…å­˜å½“ä¸­ï¼Œè§†å›¾å¯¹è±¡ä¹Ÿæ˜¯&lt;strong>å­˜å‚¨åœ¨ç¡¬ç›˜&lt;/strong>ä¸Šçš„ï¼Œä¸ä¼šæ¶ˆå¤±ã€‚&lt;/li>
&lt;/ul>
&lt;p>C:Createï¼ˆå¢ï¼‰&lt;br />R:Retrieveï¼ˆæŸ¥ï¼‰&lt;br />U:Updateï¼ˆæ”¹ï¼‰&lt;br />D:Deleteï¼ˆåˆ ï¼‰&lt;/p>
&lt;h2 id="dbaå‘½ä»¤">DBAå‘½ä»¤&lt;/h2>
&lt;p>é‡ç‚¹æŒæ¡ï¼š&lt;br /> æ•°æ®çš„å¯¼å…¥å’Œå¯¼å‡ºï¼ˆæ•°æ®çš„å¤‡ä»½ï¼‰&lt;br /> å…¶å®ƒå‘½ä»¤äº†è§£ä¸€ä¸‹å³å¯&lt;br />æ•°æ®å¯¼å‡º&lt;br /> ç»ˆç«¯çª—å£ï¼šmysqldump bjpowernode&amp;gt;D:\bjpowernode.sql -uroot -p123456&lt;br /> å¯¼å‡ºæŒ‡å®šçš„è¡¨ï¼šmysqldump bjpowernode &lt;strong>emp&lt;/strong>&amp;gt;D:\bjpowernode.sql -uroot -p123456&lt;br />æ•°æ®å¯¼å…¥&lt;br /> å…ˆç™»å½•åˆ°mysqlæ•°æ®åº“æœåŠ¡å™¨ä¸Šï¼šmysql -uroot -p123456ï¼›&lt;br /> ç„¶ååˆ›å»ºæ•°æ®åº“ï¼šcreate database bjpowernode;&lt;br /> ä½¿ç”¨æ•°æ®åº“ï¼šuse bjpowernode&lt;br /> ç„¶ååˆå§‹åŒ–æ•°æ®åº“ï¼šsource D:\bjpowernode.sql&lt;/p>
&lt;h2 id="æ•°æ®åº“ä¸‰èŒƒå¼">æ•°æ®åº“ä¸‰èŒƒå¼&lt;/h2>
&lt;p>æ•°æ®åº“è®¾è®¡ä¾æ®ï¼šæ•°æ®åº“è¡¨çš„è®¾è®¡ä¾æ®ã€‚æ•™ä½ æ€ä¹ˆè¿›è¡Œæ•°æ®åº“è¡¨çš„è®¾è®¡ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ç¬¬ä¸€èŒƒå¼&lt;/strong>ï¼šè¦æ±‚ä»»ä½•ä¸€å¼ è¡¨å¿…é¡»æœ‰ä¸»é”®ï¼Œæ¯ä¸€ä¸ªå­—æ®µåŸå­æ€§ä¸å¯å†åˆ†ã€‚&lt;/li>
&lt;li>&lt;strong>ç¬¬äºŒèŒƒå¼&lt;/strong>ï¼šå»ºç«‹åœ¨ç¬¬ä¸€èŒƒå¼çš„åŸºç¡€ä¹‹ä¸Šï¼Œè¦æ±‚æ‰€æœ‰éä¸»é”®å­—æ®µå®Œå…¨ä¾èµ–ä¸»é”®ï¼Œä¸è¦äº§ç”Ÿéƒ¨åˆ†ä¾èµ–ã€‚
&lt;ul>
&lt;li>å¤šå¯¹å¤šï¼Œä¸‰å¼ è¡¨ï¼Œå…³ç³»è¡¨ä¸¤ä¸ªä¸»é”® ï¼ˆå¤åˆä¸»é”®å®¹æ˜“å‡ºç°éƒ¨åˆ†ä¾èµ–ï¼‰&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>ç¬¬ä¸‰èŒƒå¼&lt;/strong>ï¼šå»ºç«‹åœ¨ç¬¬äºŒèŒƒå¼çš„åŸºç¡€ä¹‹ä¸Šï¼Œè¦æ±‚æ‰€æœ‰éä¸»é”®å­—æ®µç›´æ¥ä¾èµ–ä¸»é”®ï¼Œä¸è¦äº§ç”Ÿä¼ é€’ä¾èµ–ã€‚
&lt;ul>
&lt;li>ä¸€å¯¹'å¤š'ï¼Œä¸¤å¼ è¡¨ï¼Œ'å¤š'çš„è¡¨åŠ å¤–é”®&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä¸€å¯¹ä¸€ï¼Œå¤–é”®å”¯ä¸€ ï¼ˆå¦‚æœä¸€ä¸ªè¡¨å†…å®¹è¿‡å¤šï¼‰&lt;/li>
&lt;li>å¯ä»¥é¿å…æ•°æ®å†—ä½™ï¼Œç©ºé—´æµªè´¹ã€‚&lt;/li>
&lt;li>å®é™…å¼€å‘ä¸­æ‹¿å†—ä½™æ¢æ‰§è¡Œé€Ÿåº¦ï¼Œä¸ºäº†å®¢æˆ·éœ€æ±‚ï¼Œå‡å°‘ç¬›å¡å°”ç§¯ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="34è¯¾åé¢˜">34è¯¾åé¢˜&lt;/h2>
&lt;ol>
&lt;li>select ename,sal,deptno from emp where sal in (select max(sal) from emp group by deptno);
&lt;ul>
&lt;li>select e.ename, t.* from emp e join (select deptno,max(sal) as maxsal from emp group by deptno) t on t.deptno = e.deptno and t.maxsal = e.sal;&lt;/li>
&lt;li>è§£äºŒæ•ˆç‡ä½&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>select t.*, e.ename, e.sal from emp e join (select deptno,avg(sal) as avgsal from emp group by deptno) t on e.deptno = t.deptno and e.sal &amp;gt; t.avgsal;&lt;/li>
&lt;li>select deptno, avg(grade) from EMP join SALGRADE on sal between LOSAL and HISAL group by deptno;&lt;/li>
&lt;li>select sal from EMP group by sal desc limit 1;
&lt;ul>
&lt;li>select sal from emp where sal not in(select distinct a.sal from emp a join emp b on a.sal &amp;lt; b.sal);&lt;/li>
&lt;li>è§£äºŒçœ‹çœ‹å°±å¥½ï¼Œå¼ºè¡Œç”¨è‡ªè¿æ¥&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>select deptno, avg(sal) from emp group by deptno order by avg(sal) desc limit 1;&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>select deptno from emp group by deptno having avg(sal) = (select max(asal) from (select deptno, avg(sal) asal from emp group by deptno) t);&lt;/li>
&lt;li>è§£äºŒçœ‹çœ‹å°±è¡Œ&lt;/li>
&lt;/ul>
&lt;ol start="6">
&lt;li>select dname from dept where deptno = (select deptno from emp group by deptno order by avg(sal) desc limit 1);
&lt;ul>
&lt;li>select d.dname,avg(e.sal) as avgsal from emp e join dept d on e.deptno = d.deptno group by d.dname order by avgsal desc limit 1;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>select dname from dept d join emp e on d.deptno = e.deptno group by dname order by avg(sal) limit 1;&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>create view temp as select deptno, t.asal, grade from salgrade sg join (select deptno, avg(sal) asal from emp group by deptno) t on t.asal between losal and hisal;&lt;/li>
&lt;li>select dname,grade from dept d join temp t on d.deptno = t.deptno where grade=(select min(grade) from temp);&lt;/li>
&lt;li>drop view temp;
&lt;ul>
&lt;li>å°†å…·æœ‰&lt;strong>ç›¸åŒ&lt;/strong>æœ€å°å€¼æŸ¥å‡ºæ¥&lt;/li>
&lt;li>æ—¶é—´å¤æ‚åº¦è¾ƒé«˜&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>select grade from salgrade where (select avg(sal) as avgsal from emp group by deptno order by avgsal asc limit 1) between losal and hisal;
&lt;ul>
&lt;li>ç¨å¾®æ²¡æˆ‘çš„å¿« explain&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;ol start="8">
&lt;li>select ename, sal from EMP where sal &amp;lt; (select max(sal) from EMP where empno not in (select distinct mgr from EMP where mgr is not null)) and empno in (select distinct mgr from EMP where mgr is not null);
&lt;ul>
&lt;li>ç¨å¾®å¢åŠ éš¾åº¦ï¼Œå¯»æ‰¾æ¯”æœ€é«˜å·¥èµ„å°çš„é¢†å¯¼ï¼ˆä¿®æ”¹äº†è¡¨æ•°æ®ï¼‰&lt;/li>
&lt;li>é¢˜ç›®ç­”æ¡ˆï¼šselect ename, sal from EMP where sal &amp;gt; (select max(sal) from EMP where empno not in (select distinct mgr from EMP where mgr is not null)) and empno in (select distinct mgr from EMP where mgr is not null);&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>select ename,sal from EMP order by sal desc limit 5;&lt;/li>
&lt;li>select ename,sal from EMP order by sal desc,ename limit 5,5;&lt;/li>
&lt;li>select ename,hiredate from EMP order by hiredate desc,ename limit 5;&lt;/li>
&lt;li>select grade,count(*) from EMP join SALGRADE on sal between losal and hisal group by grade;&lt;/li>
&lt;li>select sname,sc.cno from S s join SC sc on s.sno=sc.sno where cno!=(select cno from C where cteacher='LM');&lt;/li>
&lt;li>å…ˆå»ºè¡¨&lt;/li>
&lt;li>select sname from S where sno not in (select distinct sno from SC sc join C c on sc.cno = (select cno from C where cteacher='LM')); // å…ˆæ‰¾å‡ºå­¦äº†LMçš„å­¦ç”Ÿå†æ’é™¤æ‰&lt;/li>
&lt;li>select sname, avg(scgrade) from S s join SC sc on s.sno=sc.sno where s.sno in (select sno from SC where scgrade &amp;lt; 60 group by sno having count(scgrade) &amp;gt;=2) group by sname; //å…ˆæ‰¾åˆ°ä¸åŠæ ¼çš„å­¦ç”Ÿï¼Œå†è”åˆè¡¨æŸ¥è¯¢è¿™ä¸¤ä¸ªå­¦ç”Ÿ&lt;/li>
&lt;li>select distinct sname from S join SC on S.sno=SC.sno where S.sno in (select sno from SC where cno in (1,2) group by sno having count(sno)=2);
&lt;ol>
&lt;li>ä¼˜åŒ–ï¼šselect distinct sname from S join (select sno from SC where cno in (1,2) group by sno having count(sno)=2) t on S.sno=t.sno;&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>åº”è¯¥è¿˜æœ‰å…¶ä»–è§£æ³•&lt;/li>
&lt;li>select a.ename, ifnull(b.ename, 'no leader') from emp a left join emp b on a.mgr=b.empno;&lt;/li>
&lt;li>select a.empno, a.ename,c.dname from emp a left join emp b on a.mgr=b.empno join dept c on a.deptno=c.deptno where a.hiredate &amp;lt; b.hiredate; // å…ˆå‘˜å·¥å†é¢†å¯¼çš„ä¸»æ¬¡å…³ç³»&lt;/li>
&lt;li>select dname, e.* from dept d left join emp e on e.deptno=d.deptno order by d.deptno,empno; // å…ˆéƒ¨é—¨å†å‘˜å·¥çš„ä¸»æ¬¡å…³ç³»&lt;/li>
&lt;li>select dname, count(&lt;em>) from DEPT d join EMP e on d.deptno=e.deptno group by dname having count(&lt;/em>) &amp;gt; 4;&lt;/li>
&lt;li>select * from EMP where sal &amp;gt; (select sal from EMP where ename='SMITH');&lt;/li>
&lt;li>select ename, dname, cc from EMP e join DEPT d on e.deptno=d.deptno join (select deptno, count(deptno) cc from EMP group by deptno) t on t.deptno = e.deptno where job='CLERK';&lt;/li>
&lt;li>select job,count(*) from EMP group by job having min(sal) &amp;gt; 1500;&lt;/li>
&lt;li>select ename from EMP e join DEPT d on e.deptno=d.deptno where d.dname='SALES';&lt;/li>
&lt;li>select a.ename, dname, grade, b.ename from EMP a join DEPT d on a.deptno=d.deptno join SALGRADE sg on a.sal between losal and hisal left join EMP b on a.mgr=b.empno where a.sal &amp;gt; (select avg(sal) from EMP);&lt;/li>
&lt;li>select ename, dname from EMP e join DEPT d on e.deptno=d.deptno where job=(select job from EMP where ename='SCOTT') and ename!='SCOTT';&lt;/li>
&lt;li>è¿˜æœ‰ç§éº»çƒ¦çš„æ–¹æ³•ï¼Œä¸å†™äº†&lt;/li>
&lt;li>select ename, sal from EMP where sal in (select distinct sal from EMP where deptno=30) and deptno&amp;lt;&amp;gt;30;&lt;/li>
&lt;li>select ename, sal, dname from EMP e join DEPT d on e.deptno=d.deptno where sal &amp;gt; (select max(sal) from EMP where deptno=30);&lt;/li>
&lt;li>select dname, count(ename) sum, ifnull(avg(sal),0) avg, ifnull(avg(&lt;strong>timestampdiff&lt;/strong>(YEAR, hiredate, now())), 0) time from EMP e right join DEPT d on e.deptno=d.deptno group by dname;&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>TimeStampDiff(é—´éš”ç±»å‹, å‰ä¸€ä¸ªæ—¥æœŸ, åä¸€ä¸ªæ—¥æœŸ)&lt;/li>
&lt;li>timestampdiff(YEAR, hiredate, now())&lt;/li>
&lt;li>é—´éš”ç±»å‹ï¼šSECOND ç§’ï¼ŒMINUTE åˆ†é’Ÿï¼ŒHOUR å°æ—¶ï¼ŒDAY å¤©ï¼ŒWEEK æ˜ŸæœŸï¼ŒMONTH æœˆï¼ŒQUARTER å­£åº¦ï¼ŒYEAR å¹´&lt;/li>
&lt;/ul>
&lt;ol start="27">
&lt;li>select ename, dname, sal from EMP join DEPT on EMP.deptno = DEPT.deptno order by dname;&lt;/li>
&lt;li>select d.*, count(e.deptno) from DEPT d left join EMP e on d.deptno=e.deptno group by d.deptno;&lt;/li>
&lt;li>group byå¹¶ä¸æ˜¯åªèƒ½è·Ÿdeptno&lt;/li>
&lt;li>select * from EMP where sal in (select min(sal) from EMP group by job);&lt;/li>
&lt;li>join ä¼šé€ æˆä¸å¿…è¦çš„æ•°æ®ï¼Œwhereå¯ä»¥åœ¨å•è¡¨ä¸­ç­›é€‰&lt;/li>
&lt;li>select deptno, min(sal) from (select distinct a.mgr, a.deptno, a.sal from EMP a join EMP b on a.empno=b.mgr) t group by deptno;&lt;/li>
&lt;li>select deptno, min(sal) from emp where job = 'MANAGER' group by deptno; // é¢&lt;/li>
&lt;li>select ename, (sal + ifnull(comm,0)) * 12 income from EMP order by income;&lt;/li>
&lt;li>select a.ename, b.ename, b.sal from EMP a join EMP b on a.mgr=b.empno where b.sal &amp;gt; 3000;&lt;/li>
&lt;li>select dname, ifnull(sum(sal),0) sum, count(e.deptno) num from EMP e right join DEPT d on e.deptno=d.deptno where dname like 'S%' or dname like '%S%' or dname like '%S' group by d.deptno;&lt;/li>
&lt;li>update EMP set sal=sal*1.1 where timestampdiff(year, hiredate, now()) &amp;gt; 30;&lt;/li>
&lt;/ol></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/mysql/">MySQL</category></item><item><title>æ–‡å­—æ‘˜å½•</title><link>https://keepjolly.com/posts/life/book-list/</link><guid isPermaLink="true">https://keepjolly.com/posts/life/book-list/</guid><pubDate>Mon, 31 Jul 2023 22:57:22 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="åº">åº&lt;/h2>
&lt;p>é™äºæ–‡å­—åŠŸåº•ä¸æ˜¯é‚£ä¹ˆæ·±åšï¼Œæ•…æ‘˜å½•ä¸€äº›å–œæ¬¢çš„æ–‡å­—ã€‚&lt;/p>
&lt;h2 id="ç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯">ç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2021/09/18b3d10c71-5e6c-49a2-a851-92b1123a2db5.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/30208077/" class="cute" target="_blank" rel="noreferrer">ç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:93%">&lt;/span>&lt;/span>&lt;span class="rating_nums">9.3&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">åœ¨ã€ŠæŸæ‹‰å›¾å¯¹è¯é›†ã€‹ä¸­ï¼Œæ–å¾·æ´›æ˜¯ä¸€ä¸ªçˆ±å¥½å“²å­¦çš„æ™®é€šé›…å…¸é’å¹´ã€‚è€Œåœ¨æœ¬ä¹¦ä¸­ï¼Œæ–å¾·æ´›é‡è¿”äººé—´ã€‚ä»–æ›¾ç»æ˜¯å­¦å“²å­¦çš„å­¦ç”Ÿï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ•™ä¿®è¾å­¦çš„æ•™å¸ˆï¼Œä½†æ˜¯ç”±äºå“²å­¦ç†å¿µä¸æ–‡åŒ–çš„ä¸–ç•Œè§‚å†²çªï¼Œä»–ç»ˆäºå› ç²¾ç¥å´©æºƒè€Œä½é™¢ã€‚å‡ºé™¢åï¼Œä»–å¸Œæœ›ä»ç‹­çª„è€Œå—é™çš„è‡ªæˆ‘è§£è„±ï¼Œäºæ˜¯å¼€å§‹äº†ä¸€åœºéª‘ç€æ‘©æ‰˜è½¦æ¨ªè·¨ç¾å›½å¤§é™†çš„ä¸‡é‡Œé•¿æ—…ï¼Œä¸€è·¯ç»è¿‡å¤æ‚ç»éªŒä¸åçœæ€è€ƒï¼Œç»ˆäºæš‚æ—¶æ¢å¤äº†çµæ€§çš„å®Œæ•´ä¸æ¸…é™ã€‚
è¿™ä¸€å›å½’è‡ªå·±çš„è¿‡ç¨‹ï¼Œæ˜¯é€šè¿‡ä¸æ–­å¯»æ±‚â€œè‰¯è´¨â€ï¼Œå³ä¸œæ–¹å“²å­¦é‡Œçš„ç¦…æ€ï¼Œå¹¶ç”¨æ‘©æ‰˜è½¦ç»´ä¿®ä¹‹é“å¯¹å…¶è¿›è¡Œé˜é‡Šè€Œå®ç°çš„ã€‚è¿™ä¾¿æ˜¯ã€Šç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯ã€‹ä¸€åçš„ç”±æ¥ã€‚
ä¸æ­¤åŒæ—¶ï¼Œä¹¦ä¸­è¿˜æ‰¹è¯„äº†è¥¿æ–¹ä¸–ç•Œçš„äºŒåˆ†æ³•æˆ–äºŒå…ƒè®ºï¼Œå¦‚äººæ–‡ä¸ç§‘æŠ€ã€ç²¾ç¥ä¸ç‰©è´¨ã€ç¥ç§˜ä¸»ä¹‰ä¸æœºæ¢°è®ºã€è‰ºæœ¯ä¸å·¥ä¸šã€å¿ƒçµä¸æœºæ¢°ã€ä¸œæ–¹ä¸è¥¿æ–¹ç­‰ç›¸å¯¹æ„è¯†ã€‚
************************************
ä¸€ç™¾äºŒåä¸€æ¬¡æ‹’ç¨¿ä¹‹åç»ˆè·å‡ºç‰ˆ
å…¨çƒç´¯è®¡é”€é‡è¶…è¿‡ä¸€åƒä¸‡å†Œ
æ—¶ä»£å‘¨åˆŠè¯„é€‰â€œäºŒåä¸–çºªåæœ¬*æœ‰å½±å“åŠ›çš„ä¹¦â€
å…¨æ–°å¢è¡¥æ ¡è¯‘æœ¬
é™„èµ å…­åé¡µç²¾ç¾åˆ«å†Œ
ç…§ç‰‡ã€åœ°å›¾ã€ä¹¦ä¿¡ã€æ‰‹è®°ç­‰çè´µèµ„æ–™é¦–æ¬¡æŠ«éœ²
1928å¹´ï¼Œç½—ä¼¯ç‰¹.æ³¢è¥¿æ ¼å‡ºç”Ÿåœ¨ç¾å›½æ˜å°¼è‹è¾¾å·åŒå­åŸã€‚15å²ï¼Œä»–è¿›å…¥æ˜å°¼è‹è¾¾å¤§å­¦ä¸»ä¿®åŒ–å­¦ï¼Œååˆå­¦ä¹ å“²å­¦ï¼Œä¹‹ååœ¨è¯¥æ ¡æ”»è¯»ä¼ æ’­å­¦ç¡•å£«ï¼›ä»–æ›¾å‰å¾€å°åº¦ä¼¯çº³é›·æ–¯å°åº¦å¤§å­¦å­¦ä¹ ä¸œæ–¹å“²å­¦ï¼Œå¹¶æ‹…ä»»ä¿®è¾å­¦æ•™æˆã€‚åœ¨è¿½æ±‚çœŸç†çš„è¿‡ç¨‹ä¸­ï¼Œä»–å› ä¸ºè¥¿æ–¹å€¡å¯¼çš„äºŒå…ƒå¯¹ç«‹ä¸äºŒåˆ†æ³•å¸¦æ¥çš„åˆ†è£‚è€Œå›°æ‰°ä¸å·²ï¼Œå› è€Œä¸€ç›´è¯•å›¾å¯»æ‰¾å¯¹æ”¯ç¦»ç ´ç¢çš„æ–‡åŒ–çš„æ•´åˆä¹‹é“ï¼Œå¹¶è¯•å›¾å»ºç«‹è‡ªå·±â€œè‰¯è´¨çš„å½¢è€Œä¸Šå­¦ï¼ˆmetaphysics of qualityï¼‰â€çš„ç†è®ºæ¶æ„ã€‚ä¸åœåœ°æ€è€ƒè¿™äº›é—®é¢˜ä½¿ä»–é•¿æœŸé¥±å—æŠ˜ç£¨å’ŒæŸç¼šã€‚1961å¹´ï¼Œä»–è¢«è¯Šæ–­ä¸ºåæ‰§å‹ç²¾ç¥åˆ†è£‚ç—‡å’Œä¸´åºŠå¿§éƒç—‡ï¼Œè¢«å¤šæ¬¡é€è¿›åŒ»é™¢ã€‚1963å¹´èµ·ï¼ŒåŒ»é™¢å¯¹ä»–è¿›è¡Œäº†å¤šè¾¾28æ¬¡çš„ç”µä¼‘å…‹ç–—æ³•ï¼Œåœ¨æ­¤æœŸé—´å¦»å­ä¸ä»–ç¦»å©šã€‚åæ¥ï¼Œä»–ç»ˆäºä¸å†æ‰§ç€äºè‡ªå·±çš„ç†è®ºå¹¶ä¸”å‡ºäº†é™¢ï¼Œè½¬è€Œå¼€å§‹æ½œå¿ƒå†™ä½œæ¥è¡¨è¾¾è‡ªå·±çš„æƒ³æ³•ã€‚
1968å¹´ï¼Œä»–ä¸é•¿å­å…‹é‡Œæ–¯ä¸€èµ·éª‘ç€æ‘©æ‰˜è½¦ä»åŒå­åŸå‡ºå‘ï¼Œåœ¨ä¸­è¥¿éƒ¨æ—·é‡ã€è½åŸºå±±åŒºå’Œè¥¿æµ·å²¸ä»äº‹å¿ƒçµæ¢é™©ã€‚ä»–ä¹‹æ‰€ä»¥å¼€å§‹è¿™åœºæ¨ªè·¨ç¾å›½å¤§é™†çš„ä¸‡é‡Œé•¿æ—…ï¼Œæ˜¯å¸Œæœ›ä»ç‹­çª„è€Œå—é™çš„è‡ªæˆ‘è§£è„±ã€‚ä¸€è·¯ç»è¿‡å¤æ‚ç»éªŒä¸åçœæ€è€ƒï¼Œä»–ç»ˆäºæš‚æ—¶æ¢å¤äº†çµæ€§çš„å®Œæ•´ä¸æ¸…å‡€ã€‚ã€Šç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯ã€‹å³ä¸ºè¿½è®°è¿™æ¬¡æ—…è¡Œä¹‹ä½œã€‚
1974å¹´ï¼Œã€Šç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯ã€‹åœ¨è¢«121å®¶å‡ºç‰ˆç¤¾æ‹’ç»ä¹‹åç»ˆäºå‡ºç‰ˆï¼Œå¹¶ç«‹å³æˆä¸ºè¶…çº§ç•…é”€ä¹¦ï¼Œ*ä¸€å¹´å³é”€å”®è¾¾ç™¾ä½™ä¸‡å†Œï¼Œè€Œä¸”åœ¨ä¹‹ååä½™å¹´ä¸­ä¸€ç›´ä½å±…ç•…é”€æ’è¡Œæ¦œã€‚å®ƒè¢«åˆ—ä¸ºç¾å›½å¤§å­¦â€œç¦…ä¸ç°ä»£ç¾å›½æ–‡å­¦â€è¯¾ç¨‹çš„å¿…è¯»å‚è€ƒä¹¦ï¼Œå¹¶è¢«ã€Šæ—¶ä»£å‘¨åˆŠã€‹è¯„é€‰ä¸ºäºŒåä¸–çºª*å…·å½±å“åŠ›çš„åæœ¬ä¹¦ä¹‹ä¸€ã€‚ä½œè€…ç½—ä¼¯ç‰¹.æ³¢è¥¿æ ¼ä¹Ÿå› å…¶å‡ºç‰ˆè¢«è§†ä¸º20ä¸–çºª70å¹´ä»£çš„æ¢­ç½—ã€‚
å…¶åï¼Œã€Šç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯ã€‹è¢«å…¨ä¸–ç•Œæ•°åä¸ªå›½å®¶å¼•è¿›å‡ºç‰ˆï¼Œè‡³ä»Šç´¯ç§¯é”€é‡å·²è¶…è¿‡ä¸€åƒä¸‡å†Œã€‚
æˆ‘ç¤¾åœ¨2006å¹´å’Œ2011å¹´å…ˆåå‡ºç‰ˆäº†æœ¬ä¹¦çš„ç®€ä½“ä¸­æ–‡å¹³è£…ç‰ˆå’Œç²¾è£…ç‰ˆï¼Œå‡å–å¾—ä¸ä¿—åå“ã€‚2017å¹´4æœˆï¼Œè€„è€‹ä¹‹å¹´çš„æ³¢è¥¿æ ¼è¾ä¸–è€Œå»ï¼Œã€Šç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯ã€‹å°±æ­¤æˆä¸ºä»–çš„æ¯•ç”Ÿç»å”±ã€‚
ä¸ºäº†è‡´æ•¬æ³¢è¥¿æ ¼å…ˆç”Ÿï¼Œæˆ‘ä»¬è€—è´¹é•¿è¾¾ä¸€å¹´çš„æ—¶é—´ç­¹å¤‡äº†è¿™å¥—ã€Šç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯ã€‹ï¼ˆçè—ç‰ˆï¼‰ã€‚çè—ç‰ˆé‡‡å–äº†ç²¾è£…å¥—ç›’çš„è£…å¸§æ–¹å¼ï¼Œé™¤å¯¹åŸä¹¦è¿›è¡Œäº†é‡æ–°æ ¡è¯‘ã€è¡¥è¯‘ï¼Œå¢åŠ äº†è¿‘ä¸‰ä¸‡å­—å†…å®¹å¤–ï¼Œè¿˜é¢å¤–é™„èµ ä¸€æœ¬è¿‘å…­åé¡µçš„åˆ«å†Œï¼Œå…¶ä¸­åŒ…å«å…¨æ–°ç»˜åˆ¶çš„æ—…ç¨‹åœ°å›¾ã€ä½œè€…è®¿è°ˆã€ä¹¦ä¿¡ã€æ‰‹è®°ï¼Œä»¥åŠå½“å¹´æ—…é€”ä¸­ä½œè€…äº²è‡ªæ‹æ‘„çš„æ•°åå¼ ç…§ç‰‡ï¼Œè¿™äº›ç…§ç‰‡åœ¨å…¨çƒèŒƒå›´å†…éƒ½æ˜¯é¦–æ¬¡å‡ºç‰ˆã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>é¿å¼€é™·é˜±çš„ç¬¬ä¸€ä¸ªæŠ€å·§å°±æ˜¯æ‹¿å‡ºä½ çš„ç¬”è®°æœ¬ï¼Œå†™ä¸‹æ‹†å¸çš„æ¯ä¸€ä¸ªæ­¥éª¤ï¼Œå…³æ³¨ç‰¹æ®Šç»†èŠ‚ï¼Œå®ƒä»¬åœ¨å®‰è£…æ—¶å¾ˆå¯èƒ½å‡ºé—®é¢˜ã€‚è¿™æœ¬ç¬”è®°æœ¬ä¸Šé¢ä¸€å®šä¼šæ²¾æŸ“è®¸å¤šæ²¹æ±¡ï¼Œä½†æ˜¯å‡ æ¬¡ä¸‹æ¥ä¹‹åï¼Œå†™åœ¨ä¸Šé¢çš„ä¸€ä¸¤ä¸ªå­—è™½ç„¶å¾€å¾€çœ‹ä¼¼ä¸ç”šé‡è¦ï¼Œå´ä½¿ä½ é¿å…äº†å¾ˆå¤šé”™è¯¯ï¼ŒèŠ‚çœäº†ä¸å°‘æ—¶é—´ã€‚å†™çš„æ—¶å€™ï¼Œè¦ç‰¹åˆ«æ³¨æ„å„ä¸ªé›¶ä»¶åœ¨å·¦åœ¨å³ï¼Œä»¥åŠä¸Šä¸‹æœå‘ï¼Œç”µçº¿çš„é¢œè‰²å’Œå¸ƒçº¿æ–¹å¼ã€‚è€Œä¸”ï¼Œå¦‚æœæœ‰æŸä¸ªé›¶ä»¶ç£¨æŸï¼Œæ­£å¥½è®°ä¸‹æ¥ï¼Œä»¥ä¾¿ä»¥åä¸€èµ·é‡‡è´­ã€‚&lt;br />ç¬¬äºŒä¸ªæŠ€å·§å°±æ˜¯åœ¨è½¦åº“åœ°ä¸Šé“ºä¸€å¼ æŠ¥çº¸ï¼ŒæŠŠæ‰€æœ‰çš„é›¶ä»¶ç”±å·¦åˆ°å³ã€ç”±ä¸Šåˆ°ä¸‹æ’åˆ—æ•´é½ï¼Œå’Œæˆ‘ä»¬è¯»ä¹¦çš„é¡ºåºä¸€æ ·ã€‚è¿™æ ·ä¸€æ¥ï¼Œå®‰è£…çš„æ—¶å€™ï¼Œä½ å°±å¯ä»¥æŒ‰ç…§ç›¸åçš„æ¬¡åºè¿›è¡Œï¼Œè®¸å¤šå°èºé’‰ã€å«åœˆè¿˜æœ‰æ‰£é’ˆæ‰ä¸ä¼šè¢«é—æ¼ã€‚å³ä½¿æœ‰è¿™æ ·å‘¨å…¨çš„å‡†å¤‡ï¼Œå¯èƒ½ä»ç„¶ä¼šå‡ºæ„å¤–ï¼Œè¿™æ—¶ä½ å°±è¦ç‰¹åˆ«æ³¨æ„è‡ªå·±çš„å£«æ°”ã€‚ä¸€å®šè¦é™ä¸‹å¿ƒæ¥ã€‚å¦‚æœä½ æƒ³åŠ ç´§è„šæ­¥ï¼Œå¼¥è¡¥æŸå¤±çš„æ—¶é—´ï¼Œå¯èƒ½åè€Œä¼šé”™è¯¯ç™¾å‡ºã€‚å½“ä½ æ„è¯†åˆ°ä½ å¿…é¡»å…¨éƒ¨æ‹†å¼€ï¼Œä»å¤´å†æ¥ä¸€éçš„æ—¶å€™ï¼Œä¸€å®šè¦åœä¸‹æ¥ï¼Œå¥½å¥½ä¼‘æ¯ä¸€ç•ªã€‚ &lt;br />---- ç¬¬ä¸‰éƒ¨ 26&lt;/li>
&lt;/ul>
&lt;h2 id="æ˜æœé‚£äº›äº‹å„¿">æ˜æœé‚£äº›äº‹å„¿&lt;/h2>
&lt;p>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2021/09/159ed0608e-3522-4c4f-969b-1a29fc77090a.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/7163250/" class="cute" target="_blank" rel="noreferrer">æ˜æœé‚£äº›äº‹å„¿&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:87%">&lt;/span>&lt;/span>&lt;span class="rating_nums">8.7&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">ã€Šæ˜æœé‚£äº›äº‹å„¿ã€‹è¿™ç¯‡æ–‡ä¸»è¦è®²è¿°çš„æ˜¯ä»1344å¹´åˆ°1644å¹´è¿™ä¸‰ç™¾å¹´é—´å…³äºæ˜æœçš„ä¸€äº›äº‹æƒ…ï¼Œä»¥å²æ–™ä¸ºåŸºç¡€ï¼Œä»¥å¹´ä»£å’Œå…·ä½“äººç‰©ä¸ºä¸»çº¿ï¼Œå¹¶åŠ å…¥äº†å°è¯´çš„ç¬”æ³•ï¼Œå¯¹æ˜æœåä¸ƒå¸å’Œå…¶ä»–ç‹å…¬æƒè´µå’Œå°äººç‰©çš„å‘½è¿è¿›è¡Œå…¨æ™¯å±•ç¤ºï¼Œå°¤å…¶å¯¹å®˜åœºæ”¿æ²»ã€æˆ˜äº‰ã€å¸ç‹å¿ƒæœ¯ç€å¢¨æœ€å¤šï¼Œå¹¶åŠ å…¥å¯¹å½“æ—¶æ”¿æ²»ç»æµåˆ¶åº¦ã€äººä¼¦é“å¾·çš„æ¼”ä¹‰ã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;br />åƒé”¤ç™¾ç‚¼å‡ºæ·±å±±ï¼Œçƒˆç«ç„šçƒ§è‹¥ç­‰é—²ã€‚ç²‰èº«ç¢éª¨æµ‘ä¸æ€•ï¼Œè¦ç•™æ¸…ç™½åœ¨äººé—´ï¼ --- äºè°¦&lt;/p>
&lt;h2 id="82å¹´ç”Ÿçš„é‡‘æ™ºè‹±">82å¹´ç”Ÿçš„é‡‘æ™ºè‹±&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2021/09/1546233224-d001-44f8-b159-2bb88a15e542.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/34434309/" class="cute" target="_blank" rel="noreferrer">82å¹´ç”Ÿçš„é‡‘æ™ºè‹±&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:79%">&lt;/span>&lt;/span>&lt;span class="rating_nums">7.9&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">ä¸€ä¸ªå¥³å­©è¦ç»å†å¤šå°‘çœ‹ä¸è§çš„åå·ï¼Œæ‰èƒ½è·Œè·Œæ’æ’åœ°é•¿å¤§æˆäººã€‚
äºšæ´²10å¹´æ¥ç½•è§çš„ç°è±¡çº§ç•…é”€ä¹¦ï¼Œå‡­å£å£ç›¸ä¼ åœ¨éŸ©å›½é”€é‡çªç ´100ä¸‡å†Œã€‚
éŸ©å›½ä¹¦åº—è”åˆä¼šè¯„é€‰2017å¹´æœ€ä½³å°è¯´ï¼Œä½œè€…èµµå—æŸ±è¢«æˆäºˆâ€œå¹´åº¦ä½œå®¶â€æ®Šè£ã€‚
éŸ©å›½æ€»ç»Ÿæ–‡åœ¨å¯…ã€å›½æ°‘ä¸»æŒäººåˆ˜åœ¨çŸ³ã€â€œå°‘å¥³æ—¶ä»£â€å´”ç§€è‹±ã€BTSå›¢é•¿é‡‘å— ä¿Šéƒ½ åœ¨é˜…è¯»ï¼Œ ä½†é˜…è¯»è¿™æœ¬ä¹¦çš„å¥³è‰ºäººä¼šè¢«äººèº«æ”»å‡»ã€‚
ã€Šç†”ç‚‰ã€‹ã€Šé‡œå±±è¡Œã€‹åŸç­ä¸»æ¼”å­”ä¾‘ã€éƒ‘æœ‰ç¾å‡ºæ¼”åŒåç”µå½±å³å°†ä¸Šæ˜ ã€‚
å†…å®¹ç®€ä»‹ï¼š
é‡‘æ™ºè‹±ï¼Œ1982å¹´4æœˆ1æ—¥å‡ºç”Ÿäºé¦–å°”æŸåŒ»é™¢å¦‡äº§ç§‘ã€‚æˆé•¿äºå…¬åŠ¡å‘˜å®¶åº­ï¼Œä¸€å®¶å…­å£äººä½åœ¨ä¸‰åä¸‰å¹³çš„æˆ¿å­é‡Œã€‚
å¥¹å°±æ˜¯é‚£ç§ä½ æ¯å¤©éƒ½ä¼šè¿é¢é‡åˆ°çš„æ™®é€šå¥³å­©ã€‚
ä»å°ï¼Œé‡‘æ™ºè‹±å°±æœ‰å¾ˆå¤šå›°æƒ‘ã€‚
å®¶é‡Œæœ€å¥½çš„ä¸œè¥¿æ€»æ˜¯ä¼˜å…ˆç»™å¼Ÿå¼Ÿï¼Œå¥¹å’Œå§å§åªèƒ½äº«æœ‰å‰©ä¸‹çš„é£Ÿç‰©ï¼Œå…±ç”¨ä¸€é—´æˆ¿ã€ä¸€åºŠè¢«å­ã€‚ä¸Šå°å­¦æ—¶ï¼Œè¢«é‚»åº§ç”·å­©æ¬ºè´Ÿï¼Œå¥¹å“­ç€å‘è€å¸ˆå€¾è¯‰ï¼Œè€å¸ˆå´ç¬‘ç€è¯´ï¼šâ€œç”·å­©å­éƒ½æ˜¯è¿™æ ·çš„ï¼Œæ„ˆæ˜¯å–œæ¬¢çš„å¥³ç”Ÿå°±æ„ˆä¼šæ¬ºè´Ÿå¥¹ã€‚â€ä¸Šäº†ä¸­å­¦ï¼Œå¸¸è¦æåœ°é“ã€å…¬äº¤è½¦ä¸Šçš„å’¸çŒªæ‰‹ã€‚åœ¨å­¦æ ¡ä¹Ÿä¸èƒ½æ‰ä»¥è½»å¿ƒï¼Œä¹Ÿæœ‰ç”·è€å¸ˆå–œæ¬¢å¯¹å¥³åŒå­¦åŠ¨æ‰‹åŠ¨è„šã€‚å¯å¥¹ä»¬å¾€å¾€é€‰æ‹©å¿æ°”åå£°ã€‚å¤§å­¦æ¯•ä¸šï¼Œè¿›å…¥ä¸€å®¶å…¬å…³å…¬å¸ã€‚å¥¹å‘ç°è™½ç„¶å¥³åŒäº‹å±…å¤šï¼Œé«˜ç®¡å´å‡ ä¹éƒ½æ˜¯ç”·æ€§ã€‚ä¸‹ç­ä¸å¾—ä¸å»åº”é…¬ï¼Œå¿å—å®¢æˆ·çš„é»„è‰²ç¬‘è¯å’Œæ— ä¼‘æ­¢åœ°åŠé…’ã€‚ä¸‰åä¸€å²ç»“äº†å©šï¼Œä¸ä¹…å°±åœ¨é•¿è¾ˆçš„å‚¬ä¿ƒä¸‹æœ‰äº†å­©å­ã€‚åœ¨ä¼—äººâ€œé¡ºç†æˆç« â€çš„æœŸå¾…ä¸‹ï¼Œå¥¹è¾æ‰å·¥ä½œï¼Œæˆä¸ºä¸€åå…¨èŒæ¯äº²ã€‚
é‡‘æ™ºè‹±æ„Ÿè§‰è‡ªå·±å½·å½¿ç«™åœ¨è¿·å®«çš„ä¸­å¤®ï¼Œæ˜æ˜ä¸€ç›´éƒ½åœ¨è„šè¸å®åœ°æ‰¾å¯»å‡ºå£ï¼Œå´å‘ç°æ€ä¹ˆéƒ½èµ°ä¸åˆ°é“è·¯çš„å°½å¤´ã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>æœ‰æ—¶æŒå®¶ä¼šè¢«çœ‹ä½œâ€œæ•´å¤©åœ¨å®¶é‡Œé—²ç€æ²¡äº‹åšâ€ï¼Œå……æ»¡è´¬ä¹‰å’Œæ­§è§†ï¼›æœ‰æ—¶åˆ™è¢«çœ‹ä½œå…»æ´»ä¸€å®¶è€å°çš„äº‹â€ï¼ŒæŠŠä½ æ§å¾—é«˜é«˜åœ¨ä¸Šï¼Œå´åˆä¸ä¼šç”¨é‡‘é’±æ¥æ¢ç®—è¿™ä»¶äº‹æƒ…ï¼Œå› ä¸ºä¸€æ—¦æœ‰äº†å®šä»·ï¼ŒåŠ¿å¿…å¾—æœ‰äººæ”¯ä»˜ã€‚&lt;/li>
&lt;li>æˆ‘ä»¬ç»å¸¸ä¼šå¬è¿‡æ¥äººè¯´ï¼šâ€œæ¯çˆ±æ˜¯æœ¬èƒ½ï¼Œç­‰ä½ é¢å¯¹æ—¶è‡ªç„¶å°±ä¼šäº†ã€‚â€å¯æ˜¯å½“å¦ˆå¦ˆçœŸçš„ä¸æ˜¯è¿™ä¹ˆä¸€å›äº‹ï¼Œé‚£æ˜¯ä¸€è¿ä¸²éš¾ä»¥è¨€å–»çš„ææƒ§ã€ç–²åŠ³ã€æƒŠå“ã€ä¸çŸ¥æ‰€æªã€æ··ä¹±ã€æŒ«æŠ˜ï¼Œç”šè‡³ä¼šå‡ºç°ä¸€è‚¡èƒŒå›æ„Ÿï¼Œè§‰å¾—â€œæ€ä¹ˆéƒ½æ²¡æœ‰äººäº‹å…ˆå‘Šè¯‰æˆ‘ä¼šè¿™ä¹ˆè¾›è‹¦ï¼Œè¦æ˜¯æœ‰äººå‘Šè¯‰æˆ‘ï¼Œæˆ‘å°±ä¼šææ—©åšå¥½èº«ä½“ä¸å¿ƒç†å‡†å¤‡ï¼Œè¯´ä¸å®šä¼šå¤„ç†å¾—æ›´å¾—å¿ƒåº”æ‰‹ï¼Œä¸ä¼šé‚£ä¹ˆè¾›è‹¦ã€‚éš¾é“æ˜¯å› ä¸ºæ€•è¯´å‡ºå®æƒ…ä»¥åï¼Œåœ¨è¿™å‡ºç”Ÿç‡å·²ç»å¤Ÿä½çš„å¹´ä»£ä¼šå®³å¾—æ›´å¤šäººä¸æ•¢ç”Ÿå°å­©å—ï¼Ÿè¿˜æ˜¯åˆ°å¤„å¯¹äººè¯´å¸¦å°å­©æœ‰å¤šç´¯æ˜¯ä¸ç¤¼è²Œçš„è¡Œä¸ºâ€ï¼Ÿå½“ç„¶ï¼Œæˆ‘ä»¬ä»ä¸è®¤ä¸ºèº«ä¸ºå¥³å„¿ã€å¥³å­¦ç”Ÿã€å¥³æœ‹å‹ã€å¥³å‘˜å·¥ã€å¦»å­ã€åª³å¦‡çš„äººç”Ÿå°±ä¸è¾›è‹¦ï¼Œä½†æ˜¯æ¯äº²çš„è§’è‰²æ¯‹åº¸ç½®ç–‘æ˜¯è¾›è‹¦çš„ï¼Œè€Œè¿™ä»½è¾›è‹¦ï¼Œä¹Ÿå¹¶éå•çº¯åªæ¥è‡ªæŠšå…»å¦å¤–ä¸€ä¸ªå°ç”Ÿå‘½ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="the-old-man-and-the-sea">The old man and the sea&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2022/06/21fe3e6e62-4a46-4a4a-9ecc-dfd931c8dc5f.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/26994251/" class="cute" target="_blank" rel="noreferrer">THE OLD MAN AND THE SEA&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:0%">&lt;/span>&lt;/span>&lt;span class="rating_nums">0&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">Set in the Gulf Stream off the coast of Havana, Hemingway&amp;#39;s magnificent fable is the story of an old man, a young boy and a giant fish. It was The Old Man and the Sea that won for Hemingway the Nobel Prize for Literature. Here, in a perfectly crafted story, is unique and timeless vision of the beauty and grief of man&amp;#39;s challenge to the elements in which he lives.&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>But, he thought, I keep them with precision. Only I have no luck any more.But who knows? Maybe today. Every day is a new day. It is better to be lucky. But I would rather be exact. Then when luck comes you are ready.&lt;/li>
&lt;/ul>
&lt;h2 id="å¤§å­¦">å¤§å­¦&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2022/05/1434461e16-630c-4bfc-9e6e-0bce2c9275e4.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/2037610/" class="cute" target="_blank" rel="noreferrer">å¤§å­¦&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:0%">&lt;/span>&lt;/span>&lt;span class="rating_nums">0&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">ã€Šå¤§å­¦ã€‹æ˜¯å„’å®¶ç»å…¸ï¼Œä¹Ÿæ˜¯å››ä¹¦ä¹‹ä¸€ï¼Œå…¨ä¹¦ä»¥äººä¸ºä¸­å¿ƒï¼Œæ—¨åœ¨æé«˜äººçš„ä¿®å…»ï¼Œé€ å°±é«˜å°šçš„äººæ ¼ï¼Œæˆå°±äººçš„å¾·è¡ŒåŠŸä¸šã€‚æœ¬ä¹¦å¯¹ã€Šå¤§å­¦ã€‹æ³¨æè§£è¯»ï¼Œæ—¨åœ¨ä»å¹³æ°‘çš„è§†è§’å‡ºå‘ï¼Œä¸æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ç›¸ç»“åˆï¼Œä½¿ä¹‹æˆä¸ºæŒ‡å¯¼å¹³æ°‘ä¿®å…»çš„æ•™ç§‘ä¹¦ã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>æ‰€è°“è¯šå…¶æ„è€…ï¼šæ¯‹è‡ªæ¬ºä¹Ÿã€‚å¦‚æ¶æ¶è‡­ï¼Œå¦‚å¥½å¥½è‰²ï¼Œæ­¤ä¹‹è°“è‡ªè°¦ï¼Œæ•…å›å­å¿…æ…å…¶ç‹¬ä¹Ÿï¼&lt;/li>
&lt;/ul>
&lt;h2 id="å—äº¬å¤§å± æ€">å—äº¬å¤§å± æ€&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2021/09/26fa6b598e-d192-435f-a13e-a0500849f688.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/26545308/" class="cute" target="_blank" rel="noreferrer">å—äº¬å¤§å± æ€&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:96%">&lt;/span>&lt;/span>&lt;span class="rating_nums">9.6&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">1937å¹´12æœˆï¼Œæ—¥å†›æ”»å…¥ä¸­å›½å¤éƒ½å—äº¬ã€‚å‡ å‘¨ä¹‹å†…ï¼Œ30å¤šä¸‡ä¸­å›½å¹³æ°‘å’Œå£«å…µé­åˆ°æœ‰è®¡åˆ’åœ°å¼ºæš´ã€æŠ˜ç£¨å’Œå± æ€â€”â€”æ­»äº¡äººæ•°è¶…è¿‡å¹¿å²›å’Œé•¿å´åŸå­å¼¹çˆ†ç‚¸é‡éš¾äººæ•°çš„æ€»å’Œã€‚
å¼ çº¯å¦‚ä¸ä»…åœ¨ä¹¦ä¸­è¯¦è¿°äº†æ—¥å†›ç–¯ç‹‚æš´è¡Œçš„ç»†èŠ‚ï¼Œè€Œä¸”åˆ†æäº†åœ¨å†›å›½ä¸»ä¹‰æ–‡åŒ–èƒŒæ™¯ä¸‹æˆé•¿èµ·æ¥çš„æ—¥æœ¬å£«å…µå¯¹äººç±»ç”Ÿå‘½çš„æ¼ è§†ã€‚å¼ çº¯å¦‚å¯¹å—äº¬å¤§å± æ€çš„å¹¸å­˜è€…è¿›è¡Œäº†å¤§é‡é‡‡è®¿ï¼Œå¹¶é¦–æ¬¡å‘æ˜äº†è®¸å¤šé‡è¦æ–‡çŒ®ã€‚
å…¨ä¹¦å…ˆæ˜¯ä»æ—¥æœ¬å£«å…µã€å†›å®˜ä¸ºä»€ä¹ˆå®Œå…¨è„±ç¦»äº†äººç±»åŸºæœ¬çš„è¡Œä¸ºè§„èŒƒï¼Œæ—¥æœ¬å­¦æ ¡å’Œæ•™ç§‘ä¹¦ä»å¿ƒç†å±‚é¢å‘å­¦ç”ŸçŒè¾“å¯¹ä¸­å›½äººæ°‘çš„ä»‡æ¨å’Œè”‘è§†ï¼Œä»¥åŠé«˜åº¦å†›äº‹åŒ–çš„æ•™è‚²ä½“åˆ¶ç­‰å¤šä¸ªæ–¹é¢é˜è¿°äº†å—äº¬å¤§å± æ€å‘ç”Ÿçš„æ ¹æºæ€§åŸå› ã€‚
åœ¨è¿™æœ¬ä¹¦çš„æ ¸å¿ƒç¯‡ç« é‡Œï¼Œä½œè€…é€šè¿‡é‡‡è®¿å½“äº‹äººã€æŸ¥é˜…æ¡£æ¡ˆèµ„æ–™ä»¥åŠå®åœ°è€ƒå¯Ÿä¸ç ”ç©¶ï¼Œæå…¶è¯¦å®åœ°è®°å½•äº†æ—¥æœ¬å†›é˜Ÿæ®‹æš´ã€ç­ç»äººæ€§çš„å± æ€è¡ŒåŠ¨ï¼Œæ·±åˆ»æ­ç¤ºäº†æ—¥æœ¬ä¾µç•¥å†›çš„å‡¶æ®‹æœ¬æ€§ã€‚åŒæ—¶ï¼Œä½œè€…è¿˜ç”ŸåŠ¨è®°è¿°äº†å—äº¬å®‰å…¨åŒºé‡Œä»¥å¾·å›½å•†äººçº¦ç¿°â€¢æ‹‰è´ã€ç¾å›½å¤–ç§‘åŒ»ç”Ÿç½—ä¼¯ç‰¹â€¢å¨å°”é€Šã€â€œå—äº¬æ´»è©è¨â€æ˜å¦®â€¢é­ç‰¹ç³æ‹¯æ•‘ä¸­å›½äººçš„è‹±é›„å£®ä¸¾ã€‚
æœ€åï¼Œä½œè€…ä»¥æ‚²æ„¤çš„ç¬”è§¦æ­éœ²äº†ä¸–äººæ‰€äº†è§£çš„å—äº¬å¤§å± æ€ã€æ—¥æœ¬å é¢†ä¸‹çš„å—äº¬ã€å¯¹æ—¥æœ¬æˆ˜çŠ¯çš„å®¡åˆ¤ã€å¹¸å­˜è€…çš„å‘½è¿ç­‰é²œä¸ºäººçŸ¥çš„æƒ…èŠ‚ã€‚
è¿™æœ¬ä¹¦æ˜¯å…³äºè¿™æ®µææ€–å†å²çš„æƒå¨ä¹‹ä½œã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>åœ¨ä¸€ä¸ªçœ©æ™•çš„ç¬é—´ï¼Œæˆ‘é™¡ç„¶æ˜ç™½ç”Ÿå‘½å’Œäººç±»çš„ç»å†æœ¬èº«éƒ½æ˜¯å¦‚æ­¤è„†å¼±ã€‚æˆ‘ä»¬ä»å°å°±çŸ¥é“æ­»äº¡æ˜¯ä»€ä¹ˆã€‚ä»»ä½•äººéƒ½ä¼šè¢«å¡è½¦æˆ–è€…å·´å£«æ’åˆ°ï¼Œç”Ÿå‘½éšä¹‹åœ¨åˆ¹é‚£é—´æ¶ˆå¤±ã€‚å¦‚æœæ²¡æœ‰æŸç§å®—æ•™è¥é˜³ï¼Œæˆ‘ä»¬ä¼šè®¤ä¸ºè¿™æ ·çš„æ­»äº¡æ˜¯æ¯«æ— æ„ä¹‰ä¹Ÿä¸å…¬æ­£çš„å¯¹ç”Ÿå‘½çš„å‰¥å¤ºã€‚ä½†æˆ‘ä»¬ä¹ŸçŸ¥é“ï¼Œå¤§å¤šæ•°äººéƒ½å°Šé‡ç”Ÿå‘½å’Œæ­»äº¡çš„è¿‡ç¨‹ã€‚å¦‚æœä½ è¢«ä¸€è¾†å·´å£«è£…æ’äº†ï¼Œä¹Ÿè®¸æœ‰äººä¼šä¹˜ä½ å—ä¼¤çš„æ—¶å€™å·èµ°ä½ çš„é’±åŒ…ï¼Œä½†æ›´å¤šçš„äººä¼šæ¥å¸®ä½ ï¼ŒæŠ¢æ•‘ä½ å®è´µçš„ç”Ÿå‘½ã€‚æœ‰äººä¼šæ‹¨æ€¥æ•‘ç”µè¯ï¼Œæœ‰äººä¼šå¥”è·‘åˆ°è¡—ä¸Šå«å½“ç­çš„è­¦å¯Ÿï¼Œè¿˜æœ‰äººä¼šè„±ä¸‹å¤§è¡£ï¼Œå èµ·æ¥å«åœ¨ä½ çš„è„‘åã€‚è¿™æ ·ï¼Œå³ä½¿è¿™æ˜¯ä½ ç”Ÿå‘½çš„æœ€åæ—¶åˆ»ï¼Œä½ ä¹Ÿèƒ½ä»è¿™äº›å¾ˆå°å´å¾ˆæ¸©æš–çš„äº‹æƒ…ä¸­æ„Ÿå—åˆ°ä»–äººçš„å…³å¿ƒã€‚æŒ‚åœ¨æ™®åº“æè¯ºå¢™ä¸Šçš„ç…§ç‰‡å´å±•ç¤ºäº†åƒåƒä¸‡ä¸‡çš„ç”Ÿå‘½ä¼šå› ä»–äººçš„ç‹‚å¦„å¿µå¤´è€Œé­åˆ°æ¯ç­ï¼Œè€Œè¿™ç§æ­»äº¡åœ¨ç¬¬äºŒå¤©å°±å˜å¾—æ¯«æ— æ„ä¹‰ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œé‚£äº›å¸¦æ¥æ­»äº¡çš„äººç«Ÿè¿˜ç¾è¾±å—éš¾è€…ï¼Œé€¼ä½¿ä»–ä»¬åœ¨æœ€å¤§é™åº¦çš„ç—›è‹¦å’Œè€»è¾±ä¸­æ­»å»ã€‚è¿™æ ·å¯¹æ­»äº¡çš„æ®‹å¿çš„ä¸æ•¬ï¼Œè¿™æ ·äººç±»ç¤¾ä¼šè¿‡ç¨‹çš„å€’é€€ï¼Œå°†åªä¼šç¼©æˆå†å²çš„ä¸€ä¸ªè„šæ³¨ã€‚é™¤éæœ‰äººè¿«ä½¿è¿™ä¸ªä¸–ç•Œå»è®°ä½å®ƒï¼Œå¦åˆ™å®ƒå°±åƒè®¡ç®—æœºç¨‹åºä¸­çš„ä¸€ä¸ªæ— å®³çš„å°é”™ï¼Œä¹Ÿè®¸ä¼šï¼Œåˆä¹Ÿè®¸ä¸ä¼šå¼•èµ·ä»»ä½•é—®é¢˜ã€‚æƒ³åˆ°è¿™é‡Œï¼Œæˆ‘æ„Ÿåˆ°ä¸€é˜µå¿ƒæ‚¸ã€‚ å›é¡¾åƒå¹´å†å²ï¼Œä½¿äººæ¸…æ¥šçš„æ˜¯ï¼Œæ²¡æœ‰ä¸€ä¸ªç§æ—æˆ–ä¸€ç§æ–‡åŒ–åœ¨æˆ˜äº‰çš„æ®‹é…·æ€§æ–¹ä¾¿å æœ‰å„æ–­æƒã€‚æ–‡æ˜çš„å¤–è¡£çœ‹èµ·æ¥æ˜¯å¤ªè–„äº†â€”â€”ä»¥è‡´äººä»¬èƒ½å¤Ÿå¾ˆå®¹æ˜“å°±æŠŠå®ƒæ’•å»ï¼Œç‰¹åˆ«æ˜¯åœ¨æˆ˜äº‰çš„å‹åŠ›ä¸‹ã€‚ å°½ç®¡ä¸­å›½ä¿˜è™çš„äººæ•°å¤§å¤§è¶…è¿‡è¦æ€æ­»ä»–ä»¬çš„æ—¥æœ¬äººï¼Œè€Œä¸”æœ‰å¯èƒ½æˆ˜èƒœä»–ä»¬ï¼Œä½†å´æ²¡æœ‰ä¸€ä¸ªäººè¡ŒåŠ¨ï¼Œæ¯ä¸ªäººéƒ½ç•æ€¯çš„é¡ºä»ã€‚å¯æ‚²çš„æ˜¯ï¼Œåœ¨è¿™ä¸ªå¤§å‘å‘¨å›´çš„æ‰€æœ‰äººå½“ä¸­ï¼Œå”è®°å¾—åªæœ‰è¿™ä½å­•å¦‡è¡¨ç°å‡ºä¸€ç‚¹ç‚¹å‹‡æ°”ã€‚ æˆ‘ä»¬åº”ä»¥æ…é‡çš„å¤©éƒ½çœ‹å¾…å—äº¬çš„æš´è¡Œâ€”â€”å®ƒé˜æ˜äº†äººæ˜¯å¤šä¹ˆå®¹æ˜“è¢«é¼“åŠ±è®©åå‡ å²çš„å­©å­æ³¯ç­å¤©æ€§ï¼Œæˆä¸ºå¯æ€•çš„æ€äººæœºå™¨ã€‚ åªè¦ç½ªæ¶ç¦»æˆ‘ä»¬è¿œå¾—ä¸è¶³ä»¥å¯¹ä¸ªäººå½¢æˆå¨èƒï¼Œäººæ€§ä¸­ä¸€äº›æ‰­æ›²çš„ä¸œè¥¿ï¼Œç¤¾ä¼šä¼šä½¿å¾—æœ€ä»¤äººéš¾ä»¥è¨€è¯´çš„ç½ªæ¶åœ¨ç¬é—´å˜æˆå¹³å¸¸çäº‹ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ç™½é¹¿åŸ">ç™½é¹¿åŸ&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2021/09/169494f437-e2ba-4d95-a8ca-b146aad59140.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/10564071/" class="cute" target="_blank" rel="noreferrer">ç™½é¹¿åŸ&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:91%">&lt;/span>&lt;/span>&lt;span class="rating_nums">9.1&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">åœ¨ä»æ¸…æœ«æ°‘åˆåˆ°å»ºå›½ä¹‹åˆçš„åŠä¸ªä¸–çºªé‡Œï¼Œä¸€é˜µé˜µç‹‚é£æ è¿‡äº†ç™½é¹¿åŸä¸Šç©ºï¼Œè€Œæ¯ä¸€æ¬¡çš„å˜åŠ¨éƒ½éœ‡è¡ç€å®ƒçš„å†…åœ¨ç»“æ„ï¼šæ‰“ä¹±äº†å†æ¢å¤ï¼Œæ¢å¤äº†å†æ‰“ä¹±ï¼Œç»†è…»åœ°åæ˜ å‡ºç™½å§“å’Œé¹¿å§“ä¸¤å¤§å®¶æ—ç¥–å­™ä¸‰ä»£çš„æ©æ€¨çº·äº‰ã€‚é™ˆå¿ å®å…ˆç”Ÿåœ¨è¿™é‡Œï¼Œäººç‰©çš„å‘½è¿æ˜¯çºµçº¿ï¼Œç™¾å›åƒè½¬ï¼Œç¤¾ä¼šå†å²çš„æ¼”è¿›æ˜¯æ¨ªé¢ï¼Œæ„ˆæ‹“æ„ˆå®½ï¼Œä¼ ç»Ÿæ–‡åŒ–çš„å…´è¡°åˆ™æ˜¯å…¨ä¹¦çš„ç²¾ç¥ä¸»ä½“ï¼Œä»¥è‡³äººã€ç¤¾ä¼šå†å²ã€æ–‡åŒ–ç²¾ç¥ä¸‰è€…ä¹‹é—´ç›¸äº’æ¿€è¡ï¼Œç›¸äº’ä½œç”¨ï¼Œå…±åŒæ¨è¿›äº†ä½œå“çš„æ—¶ç©ºï¼Œåœ¨æˆ‘ä»¬çœ¼å‰é“ºå¼€äº†ä¸€è½´æ¢å®çš„ã€åŠ¨æ€çš„ã€æå¯Œçºµæ·±æ„Ÿçš„å…³äºæˆ‘ä»¬æ°‘æ—çµé­‚çš„ç°å®ä¸»ä¹‰çš„ç”»å·ã€‚
æ–°ç‰ˆã€Šç™½é¹¿åŸã€‹ç‰¹è‰²ï¼š
1ã€å®Œæ•´å‘ˆç°äº†1993å¹´æœ€åŸå§‹ç‰ˆæœ¬ã€‚
2ã€å…¨æ–°ç²¾è£…æœ¬ã€‚å†…é™„å¤šå¹…å½©æ’ï¼ŒåŒ…æ‹¬ä½œè€…æ—§ç…§ã€æ‰‹ç¨¿å½±å°ä»¶ã€‚æ›´æœ‰ç”µå½±ã€Šç™½é¹¿åŸã€‹çš„ç¾æœ¯è®¾è®¡å¸ˆåˆ›ä½œçš„ç²¾ç¾æ’å›¾é¦–æ¬¡é¢ä¸–ã€‚
3ã€å…¨ä¹¦æµ“ç¼©ç€æ·±æ²‰çš„æ°‘æ—å†å²å†…æ¶µï¼Œæœ‰ä»¤äººéœ‡æ’¼çš„çœŸå®æ„Ÿå’Œåšé‡çš„å²è¯—é£æ ¼ã€‚
4ã€æœ¬ä¹¦1997å¹´è£è·ä¸­å›½é•¿ç¯‡å°è¯´æœ€é«˜è£èª‰--ç¬¬å››å±ŠèŒ…ç›¾æ–‡å­¦å¥–ã€‚å·²è¢«æ”¹ç¼–æˆåŒåè¯å‰§ã€ç”µå½±ã€èˆå‰§ã€ç§¦è…”ç­‰å¤šç§è‰ºæœ¯å½¢å¼ã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>æ´»ç€å°±è¦è®°ä½ï¼Œäººç”Ÿæœ€ç—›è‹¦æœ€ç»æœ›çš„é‚£ä¸€åˆ»æ˜¯æœ€éš¾ç†¬çš„ä¸€åˆ»ï¼Œä½†ä¸æ˜¯ç”Ÿå‘½ç»“æŸçš„æœ€åä¸€åˆ»ï¼›ç†¬è¿‡å»æŒ£è¿‡å»å°±ä¼šå¼€å§‹ä¸€ä¸ªé‡è¦çš„è½¬æŠ˜ï¼Œå¼€å§‹ä¸€ä¸ªæ–°çš„è¾‰ç…Œå†ç¨‹ï¼›å¿ƒè½¯ä¸€ä¸‹ç†¬ä¸è¿‡å»å°±æ­»äº†ï¼Œæ­»äº†ä¸€åˆ‡å°±éƒ½å®Œäº†ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="é•¿å®‰çš„è”æ">é•¿å®‰çš„è”æ&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2022/10/2573823f61-b01b-40a3-926a-f2563cbd989a.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/36104107/" class="cute" target="_blank" rel="noreferrer">é•¿å®‰çš„è”æ&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:78%">&lt;/span>&lt;/span>&lt;span class="rating_nums">7.8&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">å¤§å”å¤©å®åå››å¹´ï¼Œé•¿å®‰åŸçš„å°åæå–„å¾·çªç„¶æ¥åˆ°ä¸€ä¸ªä»»åŠ¡ï¼šè¦åœ¨è´µå¦ƒè¯æ—¥ä¹‹å‰ï¼Œä»å²­å—è¿æ¥æ–°é²œè”æã€‚è”æâ€œä¸€æ—¥è‰²å˜ï¼Œä¸¤æ—¥é¦™å˜ï¼Œä¸‰æ—¥å‘³å˜â€ï¼Œè€Œå²­å—è·é•¿å®‰äº”åƒä½™é‡Œï¼Œå±±æ°´è¿¢è¿¢ï¼Œè¿™æ˜¯ä¸ªä¸å¯èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œå¯ä¸ºäº†å®¶äººï¼Œæå–„å¾·å†³å¿ƒæ”¾æ‰‹ä¸€æï¼šâ€œå°±ç®—å¤±è´¥ï¼Œæˆ‘ä¹Ÿæƒ³çŸ¥é“ï¼Œè‡ªå·±å€’åœ¨è·ç¦»ç»ˆç‚¹å¤šè¿œçš„åœ°æ–¹ã€‚â€&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>åšå®˜ä¹‹é“ï¼Œå…¶å®å°±ä¸‰å¥è¯ï¼šå’Œå…‰åŒå°˜ï¼Œé›¨éœ²å‡æ²¾ï¼ŒèŠ±èŠ±è½¿å­ä¼—äººæŠ¬ã€‚&lt;/li>
&lt;li>ä¸€éª‘çº¢å°˜å¦ƒå­ç¬‘ï¼Œæ— äººçŸ¥æ˜¯è”ææ¥&lt;/li>
&lt;/ul>
&lt;h2 id="æˆ¿æ€çªçš„åˆæ‹ä¹å›­">æˆ¿æ€çªçš„åˆæ‹ä¹å›­&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2021/09/154e31faed-94bf-42a2-acbf-0d560dac3547.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/27614904/" class="cute" target="_blank" rel="noreferrer">æˆ¿æ€çªçš„åˆæ‹ä¹å›­&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:94%">&lt;/span>&lt;/span>&lt;span class="rating_nums">9.4&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">ä»¤äººå¿ƒç¢å´æ— èƒ½ä¸ºåŠ›çš„çœŸå®æ•…äº‹ã€‚
å‘æ­»è€Œç”Ÿçš„æ–‡å­¦ç»å”± æ‰“åŠ¨ä¸‡åƒè¯»è€…çš„å¹´åº¦åè¯­å°è¯´ã€‚
æé“¶æ²³ æˆ´é”¦å éª†ä»¥å†› å¼ æ‚¦ç„¶ å†¯å” è©¹å®å¿— è’‹æ–¹èˆŸ å²èˆª ç­‰å¤šä½å­¦è€…ä½œå®¶ç¤¾ä¼šåäººéƒ‘é‡æ¨èã€‚
ç—›è‹¦çš„é™…é‡æ˜¯å¦‚æ­¤éš¾ä»¥åˆ†äº«ï¼Œå¥½é™©è¿™ä¸ªä¸–ç•Œè¿˜æœ‰æ–‡å­¦ã€‚
æˆ‘ä¸‹æ¥¼æ‹¿ä½œæ–‡ç»™æè€å¸ˆæ”¹ã€‚ä»–æå‡ºæ¥ï¼Œæˆ‘è¢«é€¼åˆ°æ¶‚åœ¨å¢™ä¸Šã€‚è€å¸ˆè¯´äº†ä¹ä¸ªå­—ï¼šâ€œä¸è¡Œçš„è¯ï¼Œå˜´å·´å¯ä»¥å§ã€‚â€æˆ‘è¯´äº†äº”ä¸ªå­—ï¼šâ€œä¸è¡Œï¼Œæˆ‘ä¸ä¼šã€‚â€ä»–å°±å¡è¿›æ¥ã€‚é‚£æ„Ÿè§‰åƒæººæ°´ã€‚å¯ä»¥è¯´è¯ä¹‹åï¼Œæˆ‘å¯¹è€å¸ˆè¯´ï¼šâ€œå¯¹ä¸èµ·ã€‚â€æœ‰ä¸€ç§åŠŸè¯¾åšä¸å¥½çš„æ„Ÿè§‰ã€‚
å°å°çš„æˆ¿æ€çªä½åœ¨é‡‘ç¢§è¾‰ç…Œçš„äººç”Ÿé‡Œï¼Œå¥¹çš„è„¸å’Œå¥¹å¯ä»¥æƒ³è±¡çš„å°†æ¥ä¸€æ ·æ¼‚äº®ã€‚è¡¥ä¹ ç­è¯­æ–‡åå¸ˆæå›½åæ˜¯åŒä¸€æ ‹é«˜çº§ä½å®…çš„é‚»å±…ã€‚å´‡æ‹œæ–‡å­¦çš„å°æˆ¿æ€çªåŒæ ·å´‡æ‹œé¥±è¯»è¯—ä¹¦çš„æè€å¸ˆã€‚
æœ‰ä¸€å¤©æè€å¸ˆè¯´ï¼Œä½ çš„ç¨‹åº¦è¿™ä¹ˆå¥½ï¼Œä¸å¦‚æ¯ä¸ªç¤¼æ‹œäº¤ä¸€ç¯‡ä½œæ–‡ç»™æˆ‘å§ï¼Œä¸æ”¶ä½ å‘¨ç‚¹è´¹ã€‚æ€çªå¬è¯åœ°ä¸‹æ¥¼äº†ã€‚è€å¸ˆåœ¨å®¶é‡Œç­‰å¥¹ï¼Œæ¡Œä¸Šæ²¡æœ‰çº¸ç¬”ã€‚
æ€çªçš„åˆæ‹æ˜¯æè€å¸ˆã€‚å› ä¸ºæè€å¸ˆæŠŠå¥¹ç¿»é¢ï¼ŒæŠŠä»–çš„ä¸œè¥¿å¡è¿›å»ã€‚é‚£å¹´çš„æ•™å¸ˆèŠ‚æ€çªæ‰åä¸‰å²ï¼Œè¿™ä¸ªä¸–ç•Œå’Œå¥¹åŸæœ¬è®¤è¯†çš„ä¸ä¸€æ ·ã€‚ å¦‚æœè¿™æ˜¯çˆ±æƒ…ï¼Œä¸ºä»€ä¹ˆè§‰å¾—æš´åŠ›ï¼Ÿä¸ºä»€ä¹ˆè§‰å¾—è¢«æŠ˜æ–­ï¼Ÿä¸ºä»€ä¹ˆè€å¸ˆè¦ä¸€ä¸ªå¥³å­¦ç”Ÿæ¢è¿‡ä¸€ä¸ªå¥³å­¦ç”Ÿï¼Ÿå¦‚æœè¿™ä¸æ˜¯çˆ±æƒ…ï¼Œé‚£æ»¡å£å­¦é—®çš„æè€å¸ˆæ€ä¹ˆèƒ½åšäº†ä»¥åï¼Œè¿˜è¿™ä¹ˆè‡ªä¿¡ã€æ— ç–‘ã€æ— æ„§äºå¿ƒï¼Ÿ
æ•…äº‹å¿…é¡»é‡æ–°è®²è¿‡ï¼Œä¸æˆ¿æ€çªæƒ…åŒåŒèƒçš„åˆ˜æ€¡å©·ï¼Œæ¥åˆ°è­¦å±€é€šçŸ¥ï¼Œå»å¸¦å›ç¥å¿—ä¸æ¸…ï¼Œè¢«åˆ¤å®šç–¯äº†çš„æˆ¿æ€çªã€‚é€è¿‡æ€çªçš„æ—¥è®°ï¼Œæ€¡å©·å¾—çŸ¥æ€çªäº”å¹´ä¸­çš„æ‰€è§æ‰€æ€â€¦â€¦
å«å…¥é’±å®¶çš„è®¸ä¼Šçº¹ï¼Œæ˜¯ä¸¤ä½å°‘å¥³çš„å¿˜å¹´äº¤ï¼ŒäºŒåä½™å²çš„å¥¹ï¼Œæ˜¯ä¸¤ä½å°‘å¥³çš„æ–‡å­¦å¯è’™è€…åŒæ—¶ä¹Ÿæ˜¯ä¸ˆå¤«å®¶æš´çš„æ²‰é»˜å—å®³è€…â€¦â€¦ å‡å…¥å¤§å­¦åçš„éƒ­æ™“å¥‡ä»æ—§çˆ±ç€é«˜ä¸­æ—¶çš„è¡¥ä¹ æ•™å¸ˆæå›½åï¼Œè€Œè¿™ä½æ–‡è´¨å½¬å½¬çš„è¡¥ä¹ æ•™å¸ˆå¹¶ä¸åªæœ‰å¹³æ—¶äººä»¬çœ¼ä¸­å—äººå°Šæ•¬çš„è€å¸ˆå½¢è±¡çš„ä¸€é¢â€¦â€¦
è¿™æ˜¯ä¸€éƒ¨æƒŠäººè€Œç‰¹åˆ«çš„å°è¯´ï¼Œå°è¯´ä½œè€…æ—¢å…·æœ‰é«˜åº¦æ•é”çš„æ„Ÿå—åŠ›ã€åˆæ˜¯ä¸€ä¸ªè¿‘è·ç¦»ç›®å‡»è€…ï¼Œä½¿è¿™æ•´ä»¶äº‹åƒä¸€ä¸ªâ€œå¹¸å­˜çš„æ ‡æœ¬â€é‚£æ ·åœ°è¢«ä¿ç•™ä¸‹æ¥ã€‚æ•´æœ¬ä¹¦åè¦†åœ°ã€ç”¨æåº¦è´´è¿‘è¢«ä¾µå®³è€…çš„è§†è§’ï¼Œç›´ç›´é€¼è§†é‚£ç§â€œåˆ«äººå¤ºå»ä½ æŸä¸ªçè´µä¹‹ç‰©â€çš„ç—›è‹¦â”€â”€ä¸”æ å¤ºä¹‹äººæ˜¯ä»¥æ­¤ä¸ºä¹ã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>æˆ‘ä¸€ç›´æ˜¯ä¸ªè‹Ÿä¸”ã€å¾—è¿‡ä¸”è¿‡çš„äººï¼Œæ€»ä»¥ä¸ºç”Ÿæ´»å°±åƒèƒŒè¾å…¸ï¼Œä¸€å¤©èƒŒåé¡µå°±ä¸€å®šå¯ä»¥èƒŒå®Œã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å¿ƒ">å¿ƒ&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/item/doubanbook/2023/03/07/b382290a-23f5-4f19-a660-4d2873bae299.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/35341437/" class="cute" target="_blank" rel="noreferrer">å¿ƒ&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:0%">&lt;/span>&lt;/span>&lt;span class="rating_nums">0&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">ã€å†…å®¹ç®€ä»‹ã€‘
å¤§å­¦äºŒå¹´çº§æ—¶ï¼Œæˆ‘åœ¨ä¸€æ¬¡æ—…æ¸¸é€”ä¸­å¶é‡ç‰¹ç«‹ç‹¬è¡Œçš„å…ˆç”Ÿï¼Œæˆ‘ä»¬æˆä¸ºå¿˜å¹´äº¤ã€‚é‚£æ—¶æˆ‘æ­£å¤„åœ¨è¿·èŒ«ä¹‹ä¸­ï¼Œæ‰¾ä¸åˆ°äººç”Ÿæ–¹å‘ï¼Œç‰¹åˆ«æƒ³ä»å…ˆç”Ÿé‚£å„¿æ±²å–äººç”Ÿæ™ºæ…§å’Œç²¾ç¥åŠ›é‡ã€‚éšç€äº¤å¾€çš„æ·±å…¥ï¼Œæˆ‘å‘ç°å…ˆç”Ÿæ˜¯ä¸ªæ¸¸æ‰‹å¥½é—²çš„äººï¼Œè€Œä¸”ååˆ†ç¥ç§˜ï¼Œæ—¶å¸¸è¯´è‡ªå·±æ˜¯ä¸€ä¸ªå­¤ç‹¬çš„äººã€‚
å¤§å­¦æ¯•ä¸šä¸ä¹…ï¼Œçˆ¶äº²çªç„¶ç—…å±ï¼Œæˆ‘å‘Šåˆ«å…ˆç”Ÿå›è€å®¶ç…§é¡¾çˆ¶äº²ï¼Œå°±åœ¨è¿™æ—¶ï¼Œæˆ‘æ„å¤–åœ°æ”¶åˆ°äº†å…ˆç”Ÿçš„ä¸€å°é•¿ä¿¡ï¼Œä»–ç»™æˆ‘è¿°è¯´äº†ä¸€ä¸ªæ·±è—äºå¿ƒçš„ç§˜å¯†â€¦â€¦
ã€ç¼–è¾‘æ¨èã€‘
â˜…ç°è±¡çº§ç•…é”€ä¹¦ã€Šå¿ƒã€‹ï¼šå†™ç»™æ‰€æœ‰å¤±çœ çš„å­¤ç‹¬è€…ï¼æ²»æ„ˆå›°æ‰°ä½ çš„å¿ƒçµä¼¤ç—›ï¼
â˜…ä¸å®¹é”™è¿‡ï¼1000å¹´æ¥æ—¥æœ¬è‡³å—æ¬¢è¿çš„ä½œå®¶ï¼800å¤šä¸‡å†Œé”€é‡ç¥ä½œå¼•å¯¼ä½ è‡ªæ•‘ï¼
â˜…æ—¥æœ¬æ–‡å­¦å·¨åŒ å¤ç›®æ¼±çŸ³ç»å…¸ä»£è¡¨ä½œï¼Œä½œå®¶æ¦œç»å…¸æ–‡åº“ç‰ˆå…«å¤§ç‰¹è‰²ï¼š
â˜…æ—¥è¯­ç›´è¯‘ï¼ŒåŸæ±åŸå‘³ï¼šæ›¹ç¦ºæˆå‰§æ–‡å­¦å¥–å‰§æœ¬å¥–å¾—ä¸»é‡‘æµ·æ›™ï¼Œæ ¹æ®1914å¹´å²©æ³¢ä¹¦åº—å‡ºç‰ˆçš„ã€Šã“ã“ã‚ã€‹åˆç‰ˆç¿»è¯‘ï¼Œä¼ ç¥è¿˜åŸå¤ç›®æ¼±çŸ³æ–‡å­¦ç‰¹è‰²ï¼Œä¸€å­—æœªåˆ å®Œæ•´å…¸è—ã€‚
â˜…å…¨æ–°å°é¢ï¼Œé¢œå€¼çˆ†è¡¨ï¼šæ–°é”è®¾è®¡å¸ˆè”åˆä½œå®¶æ¦œè®¾è®¡å›¢é˜Ÿæ‰“é€ å…¨æ–°å°é¢ï¼Œå…¸é›…ç‹¬ç‰¹ï¼Œå€¼å¾—æ”¶è—ã€‚
â˜…åŸåˆ›å½©æ’ï¼Œå›¾æ–‡å¹¶èŒ‚ï¼šæ–°å¢29å¼ å…¨æ–°æ‰‹ç»˜æ’å›¾ï¼Œå†ç°å°è¯´ç»å…¸åœºæ™¯ã€‚å…¨æ–°è§†è§‰æ„Ÿå—ï¼Œä¸°å¯Œé˜…è¯»ã€‚
â˜…æ·±åº¦è§£è¯»ï¼Œè®²é€ç²¾é«“ï¼šæ–°å¢è¯‘è€…ç²¾å½©è§£è¯»ï¼Œå¸¦æ‚¨è½»è½»æ¾æ¾è¯»æ‡‚ã€Šå¿ƒã€‹çš„ç²¾é«“ã€‚
â˜…ä½œè€…å¹´è¡¨ï¼Œå®Œæ•´æ”¶å½•ï¼šå¸¦æ‚¨å¿«é€Ÿäº†è§£å¤ç›®æ¼±çŸ³çš„æˆé•¿ç»†èŠ‚å’Œåˆ›ä½œç”Ÿæ¶¯ï¼Œäº†è§£ä¼ å¥‡ä½œå®¶çš„ä¼ å¥‡ä¸€ç”Ÿã€‚
â˜…åŒé‡æƒŠå–œï¼Œå…è´¹èµ é€ï¼šéšä¹¦é™„èµ å¤ç›®æ¼±çŸ³æ‰‹ç»˜ç‰ˆç”»è—ä¹¦ç¥¨ã€å°é¢åŒæ¬¾ç²¾ç¾æ‰‹ç»˜ä¹¦ç­¾å„1å¼ ã€‚
â˜…ç‰ˆå¼ç–æœ—ï¼Œæ•´æ´ç¾è§‚ï¼šå­—ä½“ã€å­—å·ã€è¡Œè·ç²¾è‡´è€ƒç©¶ï¼Œå°åˆ·ç²¾ç¾ï¼Œé€‚å®œé˜…è¯»ï¼Œä¸è´¹çœ¼ç›ã€‚
â˜…ç»ä¹…ä¸è¡°ï¼Œè€äººå¯»å‘³ï¼š2000å¹´ï¼Œæ—¥æœ¬ã€Šæœæ—¥æ–°é—»ã€‹å‘èµ·â€œä¸€åƒå¹´æ¥æ—¥æœ¬è‡³å—æ¬¢è¿çš„ä½œå®¶â€è°ƒæŸ¥ï¼Œå¤ç›®æ¼±çŸ³é«˜å±…é¦–ä½ï¼›è¶…è¿‡äº†ã€Šæºæ°ç‰©è¯­ã€‹çš„ä½œè€…ç´«å¼éƒ¨ï¼Œè¯ºè´å°”æ–‡å­¦å¥–å¾—ä¸»å·ç«¯åº·æˆã€å¤§æ±Ÿå¥ä¸‰éƒã€‚
â˜…â€œæœ¬ä¹¦çŒ®ç»™æ‰€æœ‰è¿½å¯»è‡ªæˆ‘å†…å¿ƒçš„äººï¼Œä½ ä»¬ç»ˆå°†å¦‚æ„¿ä»¥å¿ã€‚â€â€”â€”ã€Šå¿ƒã€‹ä½œè€… å¤ç›®æ¼±çŸ³
ã€åäºº/åª’ä½“æ¨èã€‘
â˜…çŒ®ç»™æ‰€æœ‰è¿½å¯»è‡ªæˆ‘å†…å¿ƒçš„äººï¼Œä½ ä»¬ç»ˆå°†å¦‚æ„¿ä»¥å¿ã€‚â€”â€”æœ¬ä¹¦ä½œè€… å¤ç›®æ¼±çŸ³
â˜…ä»»ä½•æ—¶å€™æœ‰æœºä¼šé‡è¯»æ¼±çŸ³çš„ä½œå“ï¼Œæˆ‘éƒ½ä¼šéœ‡æƒŠäºå…¶ä½œå“çš„å‡ºè‰²ã€‚â€”â€”æ‘ä¸Šæ˜¥æ ‘
â˜…æˆ‘ååˆ†å–œæ¬¢çš„æ—¥æœ¬å†å²äººç‰©æ˜¯å¤ç›®æ¼±çŸ³ã€‚â€”â€”å‚æœ¬é¾™ä¸€
â˜…2000å¹´ï¼Œæ—¥æœ¬ã€Šæœæ—¥æ–°é—»ã€‹å‘èµ·â€œä¸€åƒå¹´æ¥æ—¥æœ¬è‡³å—æ¬¢è¿çš„ä½œå®¶â€è°ƒæŸ¥ï¼Œå¤ç›®æ¼±çŸ³é«˜å±…é¦–ä½ï¼›è¶…è¿‡äº†ã€Šæºæ°ç‰©è¯­ã€‹çš„ä½œè€…ç´«å¼éƒ¨ï¼Œè¯ºè´å°”æ–‡å­¦å¥–å¾—ä¸»å·ç«¯åº·æˆã€å¤§æ±Ÿå¥ä¸‰éƒã€‚â€”â€”ç•Œé¢æ–°é—»
â˜…â€œè¯»è€…æƒ³ä¼ ç»™åä»£çš„å¤ç›®æ¼±çŸ³ä½œå“â€ï¼Œã€Šå¿ƒã€‹ä½åˆ—ç¬¬ä¸‰ã€‚â€”â€”æœæ—¥æ–°é—»
â˜…â€œè¯»è€…å–œæ¬¢çš„å²©æ³¢æ–‡åº“â€æ¦œé¦–ã€‚â€”â€”å²©æ³¢ä¹¦åº—
â˜…äºšæ´²äºŒåä¸–çºªâ€œå¡‘é€ æ—¶ä»£çš„5æœ¬ä¹¦â€æ¦œé¦–ã€‚â€”â€”æ—¶ä»£æ‚å¿—
â˜…æ–°æ½®æ–‡åº“ç´¯è®¡å‘è¡Œé‡é¦–ä½çš„å°è¯´ã€‚â€”â€”æ—¥æœ¬ç»æµæ–°é—»&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>æˆ‘çœŸæƒ³åœ¨äººçš„èƒ¸è…”é‡Œè£…ä¸Šä¸€éƒ¨å¤æ‚çš„æœºå™¨ï¼Œèƒ½åƒæ—¶é’Ÿçš„æŒ‡é’ˆé‚£æ ·ç®€å•æ˜äº†ã€æ¯«æ— è™šå‡åœ°æŒ‡å‘è¡¨ç›˜ä¸Šçš„æ•°å­—ã€‚&lt;/li>
&lt;li>å¾€æ—¥è·ªåœ¨å…¶äººè„šå‰çš„è®°å¿†ï¼Œå¿…ä½¿ä½ ä¸‹ä¸€æ­¥éª‘åœ¨å…¶äººå¤´ä¸Šã€‚ æˆ‘ä¹‹æ‰€ä»¥æ‘’å¼ƒä»Šå¤©çš„å°Šæ•¬ï¼Œæ˜¯ä¸ºäº†æ˜å¤©ä¸å—ä¾®è¾±ï¼›ä¹‹æ‰€ä»¥å¿è€ä»Šå¤©çš„å¯‚å¯ï¼Œæ˜¯ä¸ºäº†æ˜å¤©ä¸å¿å—æ›´å¤§çš„å¯‚å¯ã€‚ ç”Ÿæ´»åœ¨å……æ»¡è‡ªç«‹ã€ç‹¬ç«‹ã€è‡ªæˆ‘çš„ç°ä»£çš„æˆ‘ä»¬ï¼Œä½œä¸ºä»£ä»·ææ€•äººäººéƒ½å¿…é¡»å“å°è¿™ç§å¯‚å¯ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å°å··äººå®¶">å°å··äººå®¶&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/item/doubanbook/2023/07/31/db0166ca-2634-488f-b82f-09332d3db8b4.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/30564617/" class="cute" target="_blank" rel="noreferrer">å°å··äººå®¶&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:0%">&lt;/span>&lt;/span>&lt;span class="rating_nums">0&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">ã€Šå°å··äººå®¶ã€‹æ”¶é›†ä½œè€…è¿‘å‡ å¹´å†™çš„æ•£æ–‡ã€éšç¬”ã€è¯—æ­Œã€æ‚æ–‡ç­‰è¿‘50ç¯‡ã€‚éƒ¨åˆ†ä½œå“åœ¨ã€Šå—æ–¹å‘¨æœ«ã€‹ã€Šæ–°å®‰æ™šæŠ¥ã€‹ã€Šå®£åŸæ—¥æŠ¥ã€‹ã€Šå®£åŸç”µè§†æŠ¥ã€‹å’Œã€Šæ•¬äº­å±±ã€‹ç­‰å¤„å‘è¡¨è¿‡ã€‚è¿™äº›æ–‡å­—ä¸»è¦æ˜¯ä½œè€…å†™è‡ªå·±ã€å®¶äººã€äº²å‹ã€åŒäº‹ï¼Œå›å¿†å®¶ä¹¡ï¼Œæ„Ÿæ‚Ÿç”Ÿæ´»ï¼ŒæŠ’å‘å¹³æ—¥ç”Ÿæ´»å’Œå·¥ä½œä¸­çš„æ„Ÿæ‚Ÿå’Œéšæƒ³ã€‚ä½œè€…å–æè‡ªç”±ï¼Œç¬”æ³•çµæ´»ï¼Œé€šè¿‡éšç¬”æ•£æ–‡æŠ’å‘å‡ºä»–å¯¹ç”Ÿæ´»çš„æ„Ÿå—ï¼Œç‡çœŸæ¸…æ™°åœ°å±•ç¤ºå‡ºä»–çš„ç²¾ç¥ä¸–ç•Œï¼ŒæœºåŠ¨çµæ´»åœ°å½°æ˜¾å‡ºä»–çš„ä¸ªæ€§æ‰æƒ…ï¼Œä»è€Œè‡ªç”±åœ°è¡¨è¾¾å‡ºä½œè€…çš„å†…å¿ƒä¸–ç•Œã€‚è¯¥æ–‡é›†æ–‡ç¬”ä¼˜ç¾ï¼Œå†…å®¹ç§¯æå‘ä¸Šï¼Œä½œè€…é€šè¿‡å¯¹ç”Ÿæ´»çš„çœŸå®æ„Ÿæ‚Ÿï¼Œå†™å‡ºç”Ÿæ´»ä¸­çš„çœŸå–„ç¾ï¼Œè®´æ­Œäººä¸–é—´è‡³çœŸè‡³çº¯çš„äº²æƒ…ã€å‹æƒ…å’Œçˆ±æƒ…ã€‚æ–‡å­—é£æ ¼ä»‹äºå†œæ‘å’ŒåŸå¸‚ä¹‹é—´ï¼Œæ—¢ä¿å­˜äº†çº¯æœ´çš„å†…æ ¸ï¼Œä¹Ÿåæ˜ äº†åŸå¸‚åŒ–çš„æ–‡æ˜æŠ•å½±ã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>æ¯ä¸ªäººä¼¼ä¹éƒ½çŸ¥é“è‡ªå·±çš„ç›®æ ‡ï¼Œä½†åˆä¼¼ä¹èº«å¤„è¿·èŒ«ä¸­ã€‚ æ¯ä¸ªäººä¼¼ä¹éƒ½æœ‰é€‰æ‹©ï¼Œä½†åˆä¼¼ä¹ä¾æ—§èº«é™·å›¹åœ„ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æˆ‘ä¸åœ°å›">æˆ‘ä¸åœ°å›&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2021/09/153bc9f79f-856f-4cbb-9111-f5a6bf2a4790.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/5910656/" class="cute" target="_blank" rel="noreferrer">æˆ‘ä¸åœ°å›&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:90%">&lt;/span>&lt;/span>&lt;span class="rating_nums">9&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">ã€Šæˆ‘ä¸åœ°å›ã€‹æ”¶å…¥ã€Šæˆ‘ä¸åœ°å›ã€‹ã€ã€Šè®°å¿†ä¸å°è±¡ã€‹ç­‰ä»¥è®°äº‹ä¸ºä¸»çš„æ•£æ–‡ï¼Œé…å°‘é‡å›¾ç‰‡ã€‚ã€Šæˆ‘ä¸åœ°å›ã€‹ç”±ä¸­å›½å½“ä»£è‘—åä½œå®¶å²é“ç”Ÿè‘—ã€‚æ˜¯å²é“ç”Ÿæ–‡å­¦ä½œå“ä¸­ï¼Œå……æ»¡å“²æ€åˆæä¸ºäººæ€§åŒ–çš„ä»£è¡¨ä½œä¹‹ä¸€ã€‚å…¶å‰ç¬¬ä¸€æ®µå’Œç¬¬äºŒæ®µè¢«çº³å…¥äººæ°‘æ•™è‚²å‡ºç‰ˆç¤¾çš„é«˜ä¸€æ•™æä¸­ã€‚å‰ä¸¤éƒ¨åˆ†æ³¨é‡è®²åœ°å›å’Œä»–ä¸æ¯äº²çš„åæ‚”ï¼Œå¯¹äºä¸­å­¦ç”Ÿæ¥è¯´ï¼Œè¿™æ˜¯ä¸€ç¯‡ä»¤äººåæ€çš„ä¼˜ç§€æ–‡ç« ã€‚
å²é“ç”Ÿæ˜¯å½“ä»£ä¸­å›½æœ€ä»¤äººæ•¬ä½©çš„ä½œå®¶ä¹‹ä¸€ã€‚ä»–çš„å†™ä½œä¸ä»–çš„ç”Ÿå‘½å®Œå…¨åŒæ„åœ¨äº†ä¸€èµ·ï¼Œåœ¨è‡ªå·±çš„â€œå†™ä½œä¹‹å¤œâ€ï¼Œå²é“ç”Ÿç”¨æ®‹ç¼ºçš„èº«ä½“ï¼Œè¯´å‡ºäº†æœ€ä¸ºå¥å…¨è€Œä¸°æ»¡çš„æ€æƒ³ã€‚ä»–ä½“éªŒåˆ°çš„æ˜¯ç”Ÿå‘½çš„è‹¦éš¾ï¼Œè¡¨è¾¾å‡ºçš„å´æ˜¯å­˜åœ¨çš„æ˜æœ—å’Œæ¬¢ä¹ï¼Œä»–ç¿æ™ºçš„è¨€è¾ï¼Œç…§äº®çš„åè€Œæ˜¯æˆ‘ä»¬æ—¥ç›Šå¹½æš—çš„å†…å¿ƒã€‚
åœ°å›åªæ˜¯ä¸€ä¸ªè½½ä½“ï¼Œè€Œæ–‡ç« çš„æœ¬è´¨å´æ˜¯ä¸€ä¸ªç»æœ›çš„äººå¯»æ±‚å¸Œæœ›çš„è¿‡ç¨‹ï¼Œä»¥åŠå¯¹æ¯äº²çš„æ€å¿µã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>é˜³å…‰åœ¨é‚£å„¿æ…¢æ…¢åœ°æ·¡è–„ï¼Œè„±ç¦»ï¼Œå‡ä½œä¸€ç¼•å­¤å“€å‡„å¯‚çš„çº¢å…‰ä¸€æ­¥æ­¥çˆ¬ä¸Šå¢™ï¼Œçˆ¬ä¸Šæ¥¼é¡¶â€¦â€¦&lt;/li>
&lt;li>å‡å¦‚ä¸–ç•Œä¸Šæ²¡æœ‰äº†è‹¦éš¾ï¼Œä¸–ç•Œè¿˜èƒ½å¤Ÿå­˜åœ¨ä¹ˆ?è¦æ˜¯æ²¡æœ‰æ„šé’ï¼Œæœºæ™ºè¿˜æœ‰ä»€ä¹ˆå…‰è£å‘¢?è¦æ˜¯æ²¡äº†ä¸‘é™‹ï¼Œæ¼‚äº®åˆæ€ä¹ˆç»´ç³»è‡ªå·±çš„å¹¸è¿?è¦æ˜¯æ²¡æœ‰äº†æ¶åŠ£å’Œå‘ä¸‹ï¼Œå–„è‰¯ä¸é«˜å°šåˆå°†å¦‚ä½•ç•Œå®šè‡ªå·±åˆå¦‚ä½•æˆä¸ºç¾å¾·å‘¢?è¦æ˜¯æ²¡æœ‰äº†æ®‹ç–¾ï¼Œå¥å…¨ä¼šå¦å› å…¶å¸ç©ºè§æƒ¯è€Œå˜å¾—è…»çƒ¦å’Œä¹å‘³å‘¢?æˆ‘å¸¸æ¢¦æƒ³ç€åœ¨äººé—´å½»åº•æ¶ˆç­æ®‹ç–¾ï¼Œä½†å¯ä»¥ç›¸ä¿¡ï¼Œé‚£æ—¶å°†ç”±æ‚£ç—…è€…ä»£æ›¿æ®‹ç–¾äººå»æ‰¿æ‹…åŒæ ·çš„è‹¦éš¾ã€‚å¦‚æœèƒ½å¤ŸæŠŠç–¾ç—…ä¹Ÿå…¨æ•°æ¶ˆç­ï¼Œé‚£ä¹ˆè¿™ä»½è‹¦éš¾åˆå°†ç”±(æ¯”å¦‚è¯´)åƒè²Œä¸‘é™‹çš„äººå»æ‰¿æ‹…äº†ã€‚å°±ç®—æˆ‘ä»¬è¿ä¸‘é™‹ï¼Œè¿æ„šæ˜§å’Œå‘é„™å’Œä¸€åˆ‡æˆ‘ä»¬æ‰€ä¸å–œæ¬¢çš„äº‹ç‰©å’Œè¡Œä¸ºï¼Œä¹Ÿéƒ½å¯ä»¥ç»Ÿç»Ÿæ¶ˆç­æ‰ï¼Œæ‰€æœ‰çš„äººéƒ½ä¸€æ ·å¥åº·ã€æ¼‚äº®ã€èªæ…§ã€é«˜å°šï¼Œç»“æœä¼šæ€æ ·å‘¢?æ€•æ˜¯äººé—´çš„å‰§ç›®å°±å…¨è¦æ”¶åœºäº†ï¼Œä¸€ä¸ªå¤±å»å·®åˆ«çš„ä¸–ç•Œå°†æ˜¯ä¸€æ¡æ­»æ°´ï¼Œæ˜¯ä¸€å—æ²¡æœ‰æ„Ÿè§‰æ²¡æœ‰è‚¥åŠ›çš„æ²™æ¼ ã€‚ çœ‹æ¥å·®åˆ«æ°¸è¿œæ˜¯è¦æœ‰çš„ã€‚çœ‹æ¥å°±åªå¥½æ¥å—è‹¦éš¾â€”â€”äººç±»çš„å…¨éƒ¨å‰§ç›®éœ€è¦å®ƒï¼Œå­˜åœ¨çš„æœ¬èº«éœ€è¦å®ƒã€‚çœ‹æ¥ä¸Šå¸åˆä¸€æ¬¡å¯¹äº†ã€‚ äºæ˜¯å°±æœ‰ä¸€ä¸ªæœ€ä»¤äººç»æœ›çš„ç»“è®ºç­‰åœ¨è¿™é‡Œï¼šç”±è°å»å……ä»»é‚£äº›è‹¦éš¾çš„è§’è‰²ï¼Ÿåˆæœ‰è°å»ä½“ç°è¿™ä¸–é—´çš„å¹¸ç¦ï¼Œéª„å‚²å’Œå¿«ä¹?åªå¥½å¬å‡­å¶ç„¶ï¼Œæ˜¯æ²¡æœ‰é“ç†å¥½è®²çš„ã€‚ å°±å‘½è¿è€Œè¨€ï¼Œä¼‘è®ºå…¬é“ã€‚ é‚£ä¹ˆï¼Œä¸€åˆ‡ä¸å¹¸å‘½è¿çš„æ•‘èµä¹‹è·¯åœ¨å“ªé‡Œå‘¢?è®¾è‹¥æ™ºæ…§çš„æ‚Ÿæ€§å¯ä»¥å¼•é¢†æˆ‘ä»¬å»æ‰¾åˆ°æ•‘èµä¹‹è·¯ï¼Œéš¾é“æ‰€æœ‰çš„äººéƒ½èƒ½å¤Ÿè·å¾—è¿™æ ·çš„æ™ºæ…§å’Œæ‚Ÿæ€§å—?æˆ‘å¸¸ä»¥ä¸ºæ˜¯ä¸‘å¥³é€ å°±äº†ç¾äººã€‚æˆ‘å¸¸ä»¥ä¸ºæ˜¯æ„šæ°“ä¸¾å‡ºäº†æ™ºè€…ã€‚æˆ‘å¸¸ä»¥ä¸ºæ˜¯æ‡¦å¤«è¡¬ç…§äº†è‹±é›„ã€‚æˆ‘å¸¸ä»¥ä¸ºæ˜¯ä¼—ç”Ÿåº¦åŒ–äº†ä½›ç¥–ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å±±æœˆè®°">å±±æœˆè®°&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2021/09/16dc788348-f8fa-448d-a95d-275ed44d2689.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/34795345/" class="cute" target="_blank" rel="noreferrer">å±±æœˆè®°&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:95%">&lt;/span>&lt;/span>&lt;span class="rating_nums">9.5&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">æ—¥æœ¬æ–‡è±ªä¸­å²›æ•¦é‡å¡‘ä¸­å›½å¤å…¸ï¼Œä¹¦å†™ä¸œæ–¹â€œå˜å½¢è®°â€ã€‚æ”¶å½•ä¸­å²›æ•¦é•¿å­â€¢ä¸­å²›æ¡“è‡´ä¸­å›½è¯»è€…åºã€‚éšä¹¦èµ æŠ˜çº¸è€è™ï¼
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
â˜…æ—¥æœ¬æ–‡è±ªä¸­å²›æ•¦é‡å¡‘ä¸­å›½å¤å…¸ï¼Œä¹¦å†™ä¸œæ–¹â€œå˜å½¢è®°â€ã€‚
ç²¾é€‰ã€Šå±±æœˆè®°ã€‹ã€Šå¼Ÿå­ã€‹ã€Šæé™µã€‹ç­‰åç¯‡ï¼Œæ•…äº‹çš†å–æè‡ªä¸­å›½å¤ä»£å…¸ç±ï¼Œé‡æ–°æ¼”ç»æå¾ã€å­è·¯ã€æé™µã€è‹æ­¦ã€æ‚Ÿå‡€ç­‰äººç‰©çš„æ•…äº‹ã€‚
â˜…ç‰¹åˆ«æ”¶å½•ä¸­å²›æ•¦é•¿å­â€¢ä¸­å²›æ¡“è‡´ä¸­å›½è¯»è€…åºã€‚
ä¸­å²›æ•¦çš„é•¿å­ä¸­å²›æ¡“å…ˆç”Ÿå·²å¹´è¿‡å…«æ—¬ï¼Œæ­¤æ¬¡ç‰¹åˆ«ä¸ºä¸­å›½è¯»è€…å†™ä¸‹åºæ–‡ï¼Œå›å¿†ä¸çˆ¶äº²ç›¸å¤„çš„æ—¥å¸¸ã€‚
â˜…ã€Šå±±æœˆè®°ã€‹å¸¸å¹´å…¥é€‰æ—¥æœ¬é«˜ä¸­è¯­æ–‡æ•™æã€‚
æ—¥æœ¬é«˜ä¸­å››å¤§å¿…å½•æ•™æï¼šä¸­å²›æ•¦ã€Šå±±æœˆè®°ã€‹ã€èŠ¥å·é¾™ä¹‹ä»‹ã€Šç½—ç”Ÿé—¨ã€‹ã€å¤ç›®æ¼±çŸ³ã€Šå¿ƒã€‹ã€æ£®é¸¥å¤–ã€Šèˆå§¬ã€‹ã€‚
â˜…æ‰§ç¬”ä¹¦å†™ç†æƒ³ä¸ç°å®çš„è½å·®ï¼Œæ¢æ±‚è‡ªæˆ‘å­˜åœ¨çš„æ„ä¹‰ã€‚
â€œæ·±æ€•è‡ªå·±å¹¶éæ˜ç è€Œä¸æ•¢åˆ»è‹¦ç¢ç£¨ï¼Œåˆè‡ªä¿¡æœ‰å‡ åˆ†æ‰åï¼Œä¸ç”˜ä¸ç“¦ç ¾ä¸ºä¼ã€‚â€
â€œä¸–äººçš†ä¸ºé©¯å…½å¸ˆï¼ŒçŒ›å…½å³å„äººæ€§æƒ…ã€‚â€
â˜…è¶…äººæ°”åŠ¨ç”»ã€Šæ–‡è±ªé‡çŠ¬ã€‹ä¸»äººå…¬åŸå‹ä½œå®¶ï¼Œæ—¥æœ¬æ–‡å›å½“ä¹‹æ— æ„§çš„æ˜ç ã€‚
â˜…çŸ¥åè¯‘è€…ä»£ç‚è€—æ—¶ä¸€å¹´ç²¾å¿ƒç¼–è¯‘ï¼Œè¯‘æ–‡è€ƒç©¶ï¼Œå°½æ˜¾ä¸­å²›æ•¦â€œæ±‰æ–‡ä½“â€çš„é­…åŠ›ã€‚
â˜…å°æ¹¾è‘—åè®¾è®¡å¸ˆè®¸æ™‹ç»´æ‹…ä»»è£…å¸§è®¾è®¡ï¼Œå¤–å°é‡‡ç”¨æ—¥æœ¬ç«¹å°¾VENT NOUVEAUç‰¹ç§çº¸ï¼Œå…¼é¡¾è‰²å½©å‘ˆç°ä¸å’Œçº¸è´¨æ„Ÿï¼Œå†…å°ä½¿ç”¨å‹å‡¹å·¥è‰ºï¼Œå°½æ˜¾å¤æœ´å¤§æ°”ã€‚
â˜…ä¸€åˆ‡å¿ƒé­”çš†æ˜¯çº¸è€è™ã€‚éšä¹¦èµ æŠ˜çº¸è€è™ï¼Œç›´é¢å®ƒï¼æ‰“è´¥å®ƒï¼
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
ä½œä¸ºå¯¹äººæ€§çš„çŸ¥æ€§çš„ç†è§£è€…ï¼Œä¸­å²›æ•¦èº«ä¸Šæœ‰ä¸€ç§ç©¿è¶Šæ€§ï¼Œè¿™ç§ç©¿è¶Šæ€§å¯ä»¥å’Œå¤ç›®æ¼±çŸ³ä»¥åŠæ™šå¹´çš„å¹¸ç”°éœ²ä¼´åª²ç¾ã€‚â€”â€”ä¼Šè—¤æ•´ï¼ˆæ—¥æœ¬ä½œå®¶ï¼‰
åœ¨ç°ä»£é’å¹´ä½œå®¶ä¸­ï¼Œå¤©èµ„ã€å†™ä½œé£æ ¼ç”šè‡³æ–‡ç« é•¿åº¦éƒ½å’ŒèŠ¥å·é¾™ä¹‹ä»‹æ¥è¿‘çš„ä¸å°±æ˜¯ä¸­å²›æ•¦å—ï¼Ÿä¸€å®šæ„ä¹‰ä¸Šå¯ä»¥æŠŠä¸­å²›æ•¦ç§°ä½œç°ä»£çš„å°èŠ¥å·ã€‚â€”â€”ä¸­æ‘å…‰å¤«ï¼ˆæ—¥æœ¬ä½œå®¶ï¼‰
ä¸­å²›æ•¦æ˜¯æ—¥æœ¬æ±‰å­¦ä¼ ç»Ÿçš„æœ€åé—ªå…‰ç‚¹ã€‚â€”â€”æ–°ä¿ç¥å¸ï¼ˆæ—¥æœ¬æ–‡è‰ºè¯„è®ºå®¶ï¼‰
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
æœ¬ä¹¦ç²¾é€‰æ—¥æœ¬ä½œå®¶ä¸­å²›æ•¦çš„ã€Šå±±æœˆè®°ã€‹ã€Šå¼Ÿå­ã€‹ã€Šæé™µã€‹ç­‰åç¯‡ï¼Œæ•…äº‹çš†å–æè‡ªä¸­å›½å¤ä»£å…¸ç±ã€‚ä¸­å²›æ•¦é‡æ–°æ¼”ç»æå¾ã€å­è·¯ã€æé™µã€è‹æ­¦ã€æ‚Ÿå‡€ç­‰äººç‰©çš„æ•…äº‹ï¼Œä»¥æ­¤å›åº”æ—¶ä»£ï¼Œæ¢æ±‚è‡ªæˆ‘ã€‚
å”ä»£æ‰å­æå¾è‡ªæƒæ‰é«˜ï¼Œä¸ç”˜ä¸è´±åä¸ºä¼ï¼Œå´ä¸å¾—ä¸ä¸ºäº”æ–—ç±³æŠ˜è…°ï¼Œç»ˆæ—¥éƒéƒå¯¡æ¬¢ã€‚æŸæ—¥å¤œåŠï¼Œæå¾äºæ¢¦ä¸­æƒŠèµ·ï¼Œç‹‚ä¹±ä¹‹ä¸­åŒ–ä½œçŒ›è™å†²å…¥å±±æ—ã€‚
ç›‘å¯Ÿå¾¡å²è¢å‚ªå¥‰å‘½å‡ºä½¿å²­å—ï¼Œé€”ä¸­å¿½é‡çŒ›è™äºè‰æœ¨ä¸›ä¸­é£è·ƒè€Œå‡ºï¼Œçœ¼è§å°±è¦æ‰‘è‡³è¢å‚ªï¼Œåˆè½¬èº«é€€äº†å›å»ã€‚ç´§æ¥ç€è‰æœ¨ä¸›ä¸­ä¼ æ¥äººå£°ï¼šâ€œå¥½é™©ï¼å¥½é™©ï¼â€
è¢å‚ªå¬é‚£å£°éŸ³ä¼¼æ›¾ç›¸è¯†ï¼Œå¤§æƒŠä¹‹ä½™å¼€å£é—®é“ï¼šâ€œå¬ä½ çš„å£°éŸ³ï¼Œå¯æ˜¯æˆ‘çš„å¥½å‹æå¾ï¼Ÿâ€ æ­¤æ—¶ï¼Œåªå¬ä¼ æ¥éšéšå•œæ³£ï¼Œé‚£äººä½å£°åº”é“ï¼šâ€œæ­£æ˜¯åœ¨ä¸‹ã€‚å¦‚ä»Šæˆ‘å·²æ˜¯å¼‚ç±»ä¹‹èº«ï¼Œä¸çŸ¥æ•…å‹æ˜¯å¦æ„¿ä¸æˆ‘äº¤è°ˆç‰‡åˆ»ï¼Ÿâ€&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>éä½†å¦‚æ­¤ï¼Œä»–ç”šè‡³éšçº¦æ„Ÿè§‰è‡ªå·±æ²¦è½æˆäº†æŸç§è½»é£˜é£˜ï¼ˆä»¿ä½›ä¸å†æ˜¯è‡ªå·±ï¼‰ã€ä¸ç€è¾¹é™…çš„ä¸œè¥¿ã€‚æ›¾ç»çš„è‡ªå·±åŒæ ·æ„šè ¢ï¼Œä½†è‡³å°‘æ¯”ç°åœ¨æ‰å®â€”â€”è¿™å®Œå…¨æ˜¯ä¸€ç§è‚‰ä½“ä¸Šçš„æ„Ÿè§‰ï¼Œæ€»ä¹‹ä»–è®¤ä¸ºæ›¾ç»çš„è‡ªå·±æœ‰ç€è‡ªå·±çš„åˆ†é‡ã€‚å¦‚ä»Šçš„ä»–ä¼¼ä¹å¤±å»äº†é‡é‡ï¼Œè½»æ˜“å°±èƒ½è¢«å¹èµ°ï¼Œå¤–åœ¨æ— è®ºå¦‚ä½•æ”¹é€ ä¿®é¥°ï¼Œå†…åœ¨å¯è°“ç©ºæ— ä¸€ç‰©ã€‚&lt;/li>
&lt;li>è‹¥é€‰æ‹©è‰°é™©å‰è·¯ï¼Œå†ç»è‹¦éš¾å´æœªå¾—è§£æ•‘ï¼Œé‚£ä¾¿æˆäº†æ— æ³•æŒ½å›çš„æŸå¤±ã€‚è¿™ç§æƒ³æ³•åœ¨ä¸çŸ¥ä¸è§‰é—´å¯¼è‡´äº†è‡ªå·±çš„çŠ¹è±«ä¸å†³ã€‚&lt;/li>
&lt;li>åœ¨çŠ¹è±«ä¹‹å‰å…ˆå»å°è¯•ã€‚ä¸ç®¡ç»“æœæˆè´¥ï¼Œè¯•ç€æ‹¼å°½å…¨åŠ›å»å°è¯•ã€‚&lt;/li>
&lt;li>å› ä¸ºå®³æ€•è‡ªå·±å¹¶éæ˜ç è€Œä¸æ•¢åˆ»è‹¦ç¢ç£¨ï¼Œåˆå› ä¸ºæœ‰å‡ åˆ†ç›¸ä¿¡è‡ªå·±æ˜¯æ˜ç ï¼Œè€Œä¸èƒ½ä¸ç“¦ç ¾ç¢Œç¢Œä¸ºä¼ï¼Œé‚é€æ¸è¿œç¦»ä¸–é—´ï¼Œç–é¿äººç¾¤ï¼Œç»“æœåœ¨å†…å¿ƒä¸æ–­åœ°ç”¨æ„¤æ‡‘å’Œç¾æ€’é¥²è‚²ç€è‡ªå·±æ‡¦å¼±çš„è‡ªå°Šå¿ƒã€‚ä¸–ç•Œä¸Šæ¯ä¸ªäººéƒ½æ˜¯é©¯å…½å¸ˆï¼Œè€Œé‚£åŒ¹çŒ›å…½ï¼Œå°±æ˜¯æ¯ä¸ªäººå„è‡ªçš„æ€§æƒ…ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="èˆå§¬">èˆå§¬&lt;/h2>
&lt;div class="db-card">
&lt;div class="db-card-subject">
&lt;div class="db-card-post">&lt;img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://neodb.social/media/book/2021/09/223155385c-c346-4c1c-86d8-da76a353c3f9.jpg">&lt;/div>
&lt;div class="db-card-content">
&lt;div class="db-card-title">&lt;a href="https://book.douban.com/subject/27074020/" class="cute" target="_blank" rel="noreferrer">èˆå§¬&lt;/a>&lt;/div>
&lt;div class="rating">&lt;span class="allstardark">&lt;span class="allstarlight" style="width:87%">&lt;/span>&lt;/span>&lt;span class="rating_nums">8.7&lt;/span>&lt;/div>
&lt;div class="db-card-abstract">ã€Šèˆå§¬ã€‹æ˜¯æ£®é¸¥å¤–å°è¯´ç²¾é€‰é›†ï¼Œæ”¶å½•äº†â€œã€Šèˆå§¬ã€‹ä¸‰éƒ¨æ›²â€ã€ã€Šæ²‰é»˜ä¹‹å¡”ã€‹ã€ä¸­ç¯‡å°è¯´ã€Šé›ã€‹ã€å¿ƒçµè‡ªä¼ è‰²å½©ã€Šå¦„æƒ³ã€‹ã€ã€Šé±¼ç„æœºã€‹ã€å†å²å°è¯´å‹å·åç¯‡ã€Šé«˜æ¿‘èˆŸã€‹ã€Šå¯’å±±æ‹¾å¾—ã€‹ç­‰åä¸‰éƒ¨ä¸­çŸ­ç¯‡å°è¯´ä»£è¡¨ä½œï¼Œä½ä»¥ä¸‡å­—å¯¼è¯»ï¼Œç«‹ä½“å‘ˆç°ä¸€ä»£æ–‡è±ªçš„åˆ›ä½œç”Ÿæ¶¯ã€‚&lt;/div>
&lt;/div>
&lt;div class="db-card-cate">book&lt;/div>
&lt;/div>
&lt;/div></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/life/">life</category><category domain="https://keepjolly.com/tags/life/">Life</category><category domain="https://keepjolly.com/tags/books/">Books</category></item><item><title>2023å¹´å°è®°</title><link>https://keepjolly.com/posts/life/2023-mynote/</link><guid isPermaLink="true">https://keepjolly.com/posts/life/2023-mynote/</guid><pubDate>Mon, 12 Jun 2023 22:32:10 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="ç”µè„‘é—´åˆ‡æ¢ç¡¬ç›˜">ç”µè„‘é—´åˆ‡æ¢ç¡¬ç›˜&lt;/h2>
&lt;p>è¿™æ˜¯ä¸å¯è¡Œçš„ï¼Œå·²ç»å°è¯•è¿‡äº†ï¼ŒåŒç³»ç»Ÿä¸¢å¤±ï¼Œä½†æ˜¯è£…å›æ¥å°±å¯ä»¥å¤åŸ&lt;/p>
&lt;h2 id="å¦‚ä½•å¤§è‡´è§„åˆ’ç ”ç©¶ç”Ÿç”Ÿæ´»">å¦‚ä½•å¤§è‡´è§„åˆ’ç ”ç©¶ç”Ÿç”Ÿæ´»&lt;/h2>
&lt;p>å¦‚æœä½ çš„å¯¼å¸ˆæ˜¯æ”¾å…»å‹ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šè¯•ä¸è¯•çš„å…³ç…§ä½ çš„è¯ï¼Œå‰æœŸå¤šå‡†å¤‡å·¥ä½œçš„äº‹æƒ…ï¼Œç­‰åé¢è€å¸ˆç»™ä½ 
å®‰æ’ä»»åŠ¡çš„æ—¶å€™ï¼ŒåŠªåŠ›å»é’»ç ”ç§‘ç ”ã€‚&lt;/p>
&lt;p>çº¯æ”¾å…»å‹çš„è¯ï¼Œåªèƒ½æ—©ç‚¹ç¡®å®šæ–¹å‘ï¼Œèµ¶ç´§æŠŠæ¯•ä¸šè¦æ±‚è¾¾åˆ°ï¼Œå¦‚æœæƒ³è¦å·¥ä½œå­¦ä¸šä¸¤æ‰‹æŠ“çš„è¯ï¼Œæ•ˆæœä¸å¤ªå¥½
å®¹æ˜“ä¸¤è¾¹éƒ½å¿˜ã€‚&lt;/p></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/life/">life</category><category domain="https://keepjolly.com/tags/others/">Others</category></item><item><title>Instant-ngpç¬”è®°</title><link>https://keepjolly.com/posts/learn/ngp_note/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/ngp_note/</guid><pubDate>Fri, 09 Jun 2023 22:28:26 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;p>&lt;a href="https://blog.csdn.net/qq_43620967/article/details/124382650">ç¿»è¯‘&lt;/a>ã€&lt;a href="https://blog.csdn.net/qq_32981275/article/details/125888274">æ€ç»´å¯¼å›¾ï¼ˆgoodï¼‰&lt;/a>&lt;/p>
&lt;h2 id="instant-ngp-æ˜¯åšä»€ä¹ˆçš„">Instant-ngp æ˜¯åšä»€ä¹ˆçš„&lt;/h2>
&lt;p>Given a fully connected neural network$m(\mathbf{y} ; \Phi)$ we are interested in &lt;strong>an encoding&lt;/strong> of its inputs ${y}=\operatorname{enc}(\mathbf{x} ; \theta)$ that &lt;strong>improves the approximation quality and training speed&lt;/strong> &lt;strong>across a wide range of applications&lt;/strong> without incurring a notable performance overhead.&lt;/p>
&lt;h2 id="instant-ngp-æ˜¯æ€ä¹ˆåšçš„">Instant-ngp æ˜¯æ€ä¹ˆåšçš„&lt;/h2>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230609222700.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;h3 id="pipeline">Pipeline&lt;/h3>
&lt;blockquote>
&lt;p>å®šä¹‰ä¸€ä¸ª$L\ resolution\ levels$ çš„dç»´ç½‘æ ¼ã€‚å…¶ä¸­çº¢è‰²æ¡†å¤„åœ¨$1/ N_1$åˆ†è¾¨ç‡ä¸‹ï¼ŒåŒç†è“è‰²æ¡†å¤„åœ¨$1/N_0$ã€‚ä»¥ä¸‹éƒ½ä¸º2ç»´ç½‘æ ¼ï¼Œæ¯ä¸ªç½‘æ ¼å››ä¸ªé¡¶ç‚¹ã€‚
æ¯ä¸ª$l\ resolution\ level$å…³è”Tä¸ªFç»´ç‰¹å¾å‘é‡ã€‚(Fæ˜¯entryç»´æ•°ï¼Œdæ˜¯å›¾ç‰‡çš„ç»´æ•°)&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>å¯¹äºç»™å®šçš„&lt;strong>è¾“å…¥åæ ‡x&lt;/strong>ï¼Œæˆ‘ä»¬åœ¨$level \ l$ä¸Šæ‰¾åˆ°å‘¨å›´çš„&lt;strong>ä½“ç´ &lt;/strong>(dç»´ç½‘æ ¼)ã€‚å³xè½åœ¨$l_0$ä¸Šçš„å³ä¸‹ç½‘æ ¼ï¼Œè½åœ¨$l_1$ä¸Šçš„ä¸­é—´ç½‘æ ¼ ã€‚&lt;/li>
&lt;li>å°†$level \ l$ä¸Šçš„ä½“ç´ çš„&lt;strong>æ•´æ•°&lt;/strong>é¡¶ç‚¹æ˜ å°„æˆå“ˆå¸Œè¡¨$\theta_{l}$çš„ç´¢å¼•å€¼ã€‚&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>ç»™å®š$level \ l$çš„é¡¶ç‚¹æ•°æ˜¯$V=(N_l+1)^d$ï¼Œä¾‹å¦‚å¯¹äºlevel 1ï¼Œæœ‰ (3 + 1)Â² = 16 ä¸ªé¡¶ç‚¹ã€‚å¦‚æœ V â‰¤ Tï¼Œå¯¹åº”levelçš„é¡¶ç‚¹å’Œç‰¹å¾å‘é‡ä¹‹é—´æ˜¯ 1:1 çš„æ˜ å°„ã€‚åœ¨æ›´ç²¾ç»†çš„levelï¼Œå…¶ä¸­ V &amp;gt; Tï¼Œä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†æ¯ä¸ªdç»´é¡¶ç‚¹æ˜ å°„åˆ°å¯¹åº”levelçš„ T ä¸ªç‰¹å¾å‘é‡ä¸­ã€‚å…¶ä¸­çš„ç‰¹å¾å‘é‡å°±æ˜¯ç½‘ç»œè¦æ›´æ–°çš„å‚æ•°ã€‚&lt;/p>
&lt;/blockquote>
&lt;ol start="3">
&lt;li>ä»å“ˆå¸Œè¡¨$\theta_{l}$ä¸­æŸ¥æ‰¾å››ä¸ªç´¢å¼•å€¼å¯¹åº”çš„&lt;strong>Fç»´&lt;/strong>ç‰¹å¾å‘é‡ï¼Œè¿›è¡Œd-linearly interpolateã€‚&lt;/li>
&lt;li>å°†**æ¯ä¸ª level **æ’å€¼åçš„ç‰¹å¾å‘é‡ä»¥åŠè¾…åŠ©å‘é‡$\xi \in \mathbb{R}^{E}$&lt;strong>concat&lt;/strong>ï¼Œäº§ç”Ÿç¼–ç çš„MLPè¾“å…¥$y \in \mathbb{R}^{L F+E}$ã€‚ï¼ˆé‚£ä¹ˆä¸€å¼ å›¾ç‰‡æå–åˆ°çš„æ‰€æœ‰xï¼Œpipelineåéƒ½ä½œä¸ºä¸€ä¸ªyæ ·æœ¬é€å…¥ç½‘ç»œä¸­ï¼‰&lt;/li>
&lt;li>è¾“å…¥åè¿›å…¥å…¨è¿æ¥ç¥ç»ç½‘ç»œã€‚ä¹‹åå°±è·Ÿ&lt;a href="https://keepjolly.com/posts/learn/nerf_note/#pipeline">Nerf&lt;/a>å·®ä¸å¤š&lt;/li>
&lt;/ol>
&lt;h3 id="å“ˆå¸Œè¡¨">å“ˆå¸Œè¡¨&lt;/h3>
&lt;p>è¯¦ç»†ä»‹ç»å‚è€ƒ&lt;a href="https://www.bilibili.com/video/BV11e4y1V77L">è§†é¢‘&lt;/a>ï¼Œä»¥åŠ&lt;a href="https://www.bilibili.com/video/BV1GD4y1Y754">è¡¥å……è§†é¢‘&lt;/a>&lt;/p>
&lt;ul>
&lt;li>é€Ÿåº¦ vs è´¨é‡ã€‚éšç€å“ˆå¸Œè¡¨å¤§å° T å¢å¤§ä¼šå¸¦æ¥é«˜è´¨é‡ä½é€Ÿåº¦ï¼Œä½†æ˜¯åˆ°ä¸€å®šç“¶é¢ˆåï¼ŒTå¸¦æ¥çš„è´¨é‡å°±æ²¡é‚£ä¹ˆæ˜æ˜¾äº†ï¼Œåœ¨æ–‡ä¸­ $T=2^{19}$æ•ˆæœæœ€å¥½ã€‚å¦å¤–åˆ†è¾¨ç‡ç­‰çº§ L å’Œ ç‰¹å¾ç»´åº¦ F ä¹Ÿæœ‰å½±å“ï¼Œæ–‡ä¸­$F=2,L=16$æ•ˆæœæœ€å¥½ã€‚&lt;/li>
&lt;li>éšå¼å“ˆå¸Œç¢°æ’ã€‚é‡å»ºæ•ˆæœè¿™ä¹ˆå¥½çš„å…³é”®æ˜¯ä¸åŒåˆ†è¾¨ç‡ä¸‹å¸¦æ¥ä¸åŒçš„æ•ˆæœï¼Œå¯ä»¥äº’ç›¸å¼¥è¡¥ã€‚åœ¨coarserä¸‹ï¼Œå“ˆå¸Œæ˜ å°„æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œä¸ä¼šé‡åˆ°å“ˆå¸Œç¢°æ’ï¼›ä½†æ˜¯åœ¨finerä¸‹ï¼Œä¼šç»å¸¸é€ æˆå“ˆå¸Œç¢°æ’ã€‚æ–‡ä¸­ä½œè€…æŒ‡å‡ºè¶Šé‡è¦çš„åŒºåŸŸå¯¹æ¢¯åº¦çš„å½±å“è¶Šå¤§ï¼Œè¶Šç¨€ç–çš„åŒºåŸŸå¯¹æ¢¯åº¦å½±å“è¾ƒå°ï¼Œäº’ç›¸å½±å“ä¸‹æ¢¯åº¦ä¼šè¶‹äºå¹³å‡ã€‚åœ¨ç½‘ç»œå­¦ä¹ ä¸­è‡ªåŠ¨ä»å¯†é›†çš„åŒºåŸŸå†…æå–æ ·æœ¬ï¼Œè€Œä¸æ˜¯ä»æ›´å¤§èŒƒå›´å†…æå–æ ·æœ¬ï¼Œä»è€Œé¿å…å“ˆå¸Œç¢°æ’ã€‚&lt;/li>
&lt;li>è®­ç»ƒé€‚åº”æ€§ã€‚å¤šåˆ†è¾¨ç‡å“ˆå¸Œç¼–ç å¯ä»¥è‡ªåŠ¨é€‚åº”æ ·æœ¬æ•°æ®åˆ†å¸ƒã€‚&lt;/li>
&lt;li>d-linear interpolationã€‚ç¡®ä¿ç¼–ç  enc(x; ğœƒ) ä»¥åŠé€šè¿‡é“¾å¼æ³•åˆ™åå®ƒä¸ç¥ç»ç½‘ç»œ ğ‘š(enc(x; ğœƒ); Î¦) çš„ç»„åˆæ˜¯è¿ç»­çš„ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="instant-ngp-åšçš„ç»“æœæ€ä¹ˆæ ·">Instant-ngp åšçš„ç»“æœæ€ä¹ˆæ ·&lt;/h2>
&lt;h3 id="ä¼˜åŠ¿">ä¼˜åŠ¿&lt;/h3>
&lt;ul>
&lt;li>æé«˜æ•ˆç‡&lt;/li>
&lt;li>èŒƒç”¨æ€§å¼ºï¼Œé€‚åˆå¤šä¸ªä»»åŠ¡&lt;/li>
&lt;li>é€‚åˆç°ä»£GPUå¹¶è¡Œè®¡ç®—&lt;/li>
&lt;li>å‡å°‘control flow å’Œ pointer chasing&lt;/li>
&lt;/ul>
&lt;h3 id="ä¸è¶³">ä¸è¶³&lt;/h3>
&lt;ul>
&lt;li>æ— æ³•é¿å…çš„å“ˆå¸Œç¢°æ’ä¼šå¯¼è‡´è¡¨é¢äº§ç”Ÿå¤§é‡é¢—ç²’&lt;/li>
&lt;li>é€‚ç”¨äºé«˜å‡ ä½•ç»†èŠ‚åœºæ™¯ï¼Œåœ¨å¤æ‚çš„ã€ä¾èµ–äºåå°„çš„åœºæ™¯ä¸‹éœ€è¦æ›´å¤§çš„MLPï¼Œå¸¦æ¥é€Ÿåº¦ä¸Šçš„é™ä½&lt;/li>
&lt;/ul>
&lt;h2 id="instant-ngp-è®¨è®ºä¸å±•æœ›">Instant-ngp è®¨è®ºä¸å±•æœ›&lt;/h2>
&lt;ul>
&lt;li>concat and reduct. concaté€‚åˆå¹¶è¡Œå¤„ç†ï¼Œè€Œreducté€‚åˆç¥ç»ç½‘ç»œæ›´å¤§ï¼Œæ¯”ç¼–ç è¿˜è¦expensiveã€‚&lt;/li>
&lt;li>ç”±å“ˆå¸Œç¢°æ’å¼•èµ·çš„å¾®è§‚å˜åŒ–ã€‚é€šè¿‡æˆ‘ä»¬çš„ç¼–ç åœ¨sdfä¸Šå®ç°æœ€å…ˆè¿›çš„è´¨é‡çš„å…³é”®å°†æ˜¯æ‰¾åˆ°ä¸€ç§å…‹æœè¿™ç§å¾®è§‚ç»“æ„çš„æ–¹æ³•ï¼Œä¾‹å¦‚é€šè¿‡è¿‡æ»¤å“ˆå¸Œè¡¨æŸ¥æ‰¾æˆ–é€šè¿‡åœ¨æŸå¤±ä¹‹å‰æ–½åŠ é¢å¤–çš„å¹³æ»‘æ€§ã€‚&lt;/li>
&lt;li>ä¼˜åŒ–å“ˆå¸Œå‡½æ•°ã€‚ä¸¤ç§é€”å¾„æ˜¯å¼€å‘è§£æå¾®åˆ†çš„è¿ç»­å“ˆå¸Œå‡½æ•°ï¼Œæˆ–è€…æœ‰æ•ˆæ¢ç´¢ç¦»æ•£å‡½æ•°ç©ºé—´çš„è¿›åŒ–ä¼˜åŒ–ç®—æ³•ã€‚&lt;/li>
&lt;li>ç”Ÿæˆç½‘ç»œã€‚å› ä¸ºç‰¹å¾ä¸è§„åˆ™çš„ç‚¹ç½‘æ ¼ä¸æ˜¯äº’ç›¸æ˜ å°„ï¼Œæ— æ³•è¿›è¡Œç”Ÿæˆå¼ç½‘ç»œã€‚&lt;/li>
&lt;li>å¤–éƒ¨çš„ç©ºç™½ç©ºé—´ã€å†…éƒ¨çš„å›ºä½“ç©ºé—´ä»¥åŠå…¶è¡¨é¢çš„ç¨€ç–ç»†èŠ‚ï¼Œéå¸¸é€‚åˆæˆ‘ä»¬çš„ç¼–ç ã€‚&lt;/li>
&lt;/ul></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/computervision/">ComputerVision</category></item><item><title>Nerfåˆå…¥é—¨ç¬”è®°</title><link>https://keepjolly.com/posts/learn/nerf_note/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/nerf_note/</guid><pubDate>Wed, 07 Jun 2023 22:05:23 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;p>æ¨èä¸€ä¸ª&lt;a href="https://zhuanlan.zhihu.com/p/486710656">ä¸“æ &lt;/a>, è½¬è½½è‡ª&lt;a href="https://zicx.top/notebook/research/nerf/note/#hierarchical-volume-sampling">æ¥æº&lt;/a>, å†åŠ å…¥è‡ªå·±çš„ä¸œè¥¿&lt;/p>
&lt;h2 id="nerf-æ˜¯åšä»€ä¹ˆçš„">NeRF æ˜¯åšä»€ä¹ˆçš„&lt;/h2>
&lt;p>é€šè¿‡ä½¿ç”¨ç¨€ç–çš„è¾“å…¥è§†å›¾ä¼˜åŒ–åº•å±‚çš„çš„è¿ç»­è¾å°„ä½“ç§¯åœºå‡½æ•°ï¼Œå®ç°&lt;strong>å¤æ‚åœºæ™¯çš„æ–°è§†è§’åˆæˆ&lt;/strong>&lt;/p>
&lt;h2 id="nerf-æ˜¯æ€ä¹ˆåšçš„">NeRF æ˜¯æ€ä¹ˆåšçš„&lt;/h2>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220051.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="Nerf pipeline: (a)ï¼Œ(b)ç”Ÿæˆå°„çº¿ï¼Œ(c)ç«‹ä½“æ¸²æŸ“ï¼Œ(d)ç®— mse lossã€‚" title="Nerf pipeline: (a)ï¼Œ(b)ç”Ÿæˆå°„çº¿ï¼Œ(c)ç«‹ä½“æ¸²æŸ“ï¼Œ(d)ç®— mse lossã€‚">&lt;/p>
&lt;h3 id="pipeline">Pipeline&lt;/h3>
&lt;p>&lt;a href="https://github.com/yangkang2021/nerf-learn/blob/master/nerf/02.%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86.md">nerf(äºŒ)---å·¥ä½œæµç¨‹ä¸åŸºæœ¬åŸç†&lt;/a>&lt;/p>
&lt;ul>
&lt;li>a).æ²¿ç€ç›¸æœºå…‰çº¿çš„æ–¹å‘é‡‡æ · 5D åæ ‡&lt;/li>
&lt;li>b).å°†åæ ‡ä¿¡æ¯è¾“å…¥åˆ° MLP ä¸­ï¼Œäº§ç”Ÿé¢œè‰²å’Œä½“ç§¯å¯†åº¦&lt;/li>
&lt;li>c).ä½¿ç”¨ç«‹ä½“æ¸²æŸ“å°†é¢œè‰²å’Œä½“ç§¯å¯†åº¦åˆæˆä¸ºå›¾åƒ&lt;/li>
&lt;li>d).æ¸²æŸ“å‡½æ•°æ˜¯å¯å¾®åˆ†çš„ï¼Œå› æ­¤å¯ä»¥é€šè¿‡æœ€å°åŒ–åˆæˆå›¾åƒå’Œå®é™…è§‚å¯Ÿåˆ°çš„å›¾åƒä¹‹é—´çš„æ®‹å·®æ¥ä¼˜åŒ–åœºæ™¯è¡¨ç¤º&lt;/li>
&lt;/ul>
&lt;h3 id="é™æ€åœºæ™¯çš„è¡¨ç¤º">é™æ€åœºæ™¯çš„è¡¨ç¤º&lt;/h3>
&lt;ul>
&lt;li>ä½¿ç”¨å…¨è¿æ¥ï¼ˆéå·ç§¯ï¼‰æ·±åº¦ç½‘ç»œ(å¤šå±‚æ„ŸçŸ¥æœºï¼ŒMLP)æ¥è¡¨ç¤ºåœºæ™¯&lt;/li>
&lt;li>è¾“å…¥æ˜¯ä¸€ä¸ªè¿ç»­çš„5Dåæ ‡ï¼š**ç©ºé—´ä½ç½® **$(x,y,z)$ å’Œ &lt;strong>2D è§‚å¯Ÿæ–¹å‘&lt;/strong>$(\theta, \phi)$&lt;/li>
&lt;li>è¾“å‡ºæ˜¯è¯¥ç©ºé—´ä½ç½®çš„**ä½“ç§¯å¯†åº¦ &lt;strong>$\sigma$&lt;/strong> å’Œè§†è§’ç›¸å…³çš„é¢œè‰² **$\textbf{c} = (r,g,b)$&lt;br />è¿™é‡Œçš„ä½“ç§¯å¯†åº¦åªå¯¹æŸä¸€ä¸ªç©ºé—´ç‚¹$(x,y,z)$ è€Œè¨€ï¼Œå®ƒè¡¨ç¤ºä¸€æ¡ç©¿è¿‡ç©ºé—´ç‚¹$(x,y,z)$ çš„å°„çº¿ç´¯è®¡äº†å¤šå°‘è¾å°„(radiance)ï¼Œåé¢ä¼šå°†å®ƒè½¬åŒ–ä¸ºæ¦‚ç‡å¯†åº¦&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>å¤šè§†å›¾ä¹‹é—´ä¿æŒè¿ç»­ä¸€è‡´æ€§&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>ä½“ç§¯å¯†åº¦ $\sigma$ å‡½æ•°åªä¸ç©ºé—´ä½ç½® $\mathbf{x}$ æœ‰å…³ --&amp;gt; $\sigma(\mathbf{x})$&lt;/li>
&lt;li>é¢œè‰² $c$ å‡½æ•°ä¸ç©ºé—´ä½ç½® $\mathbf{x}$ å’Œè§†è§’ $\mathbf{d}$ éƒ½æœ‰å…³ --&amp;gt; $c(\mathbf{x},\mathbf{d})$&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>MLP çš„è®¾è®¡&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>ç”¨ 8 ä¸ªå…¨è¿æ¥å±‚æ¥å¤„ç†è¾“å…¥çš„ç©ºé—´åæ ‡ $x$ (æ¿€æ´»å‡½æ•°ä¸º ReLUï¼Œæ¯å±‚256ä¸ªé€šé“)&lt;/li>
&lt;li>è¾“å‡º $\sigma$ å’Œä¸€ä¸ª 256 ç»´çš„ç‰¹å¾å‘é‡&lt;/li>
&lt;li>å°†ç‰¹å¾å‘é‡å’Œè§†è§’æ–¹å‘ $d$ è¿æ¥èµ·æ¥&lt;/li>
&lt;li>ä¼ é€’åˆ°ä¸€ä¸ªé¢å¤–çš„å…¨è¿æ¥å±‚ (æ¿€æ´»å‡½æ•°ä¸º ReLUï¼Œ128ä¸ªé€šé“)&lt;/li>
&lt;li>è¾“å‡ºä¾èµ–äºè§†å›¾çš„ RGB é¢œè‰²&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>MLP çš„ Loss è®¡ç®—&lt;/strong>&lt;br />$\mathcal{L}=\sum_{\mathbf{r} \in \mathcal{R}}\left[\left|\hat{C}_c(\mathbf{r})-C(\mathbf{r})\right|_2^2+\left|\hat{C}_f(\mathbf{r})-C(\mathbf{r})\right|_2^2\right]$&lt;/p>
&lt;ul>
&lt;li>ç”¨äº†ä¸¤ä¸ª MLP ç½‘ç»œï¼Œåˆ†åˆ«æ˜¯&lt;strong>ç²—(coarse) ç½‘ç»œå’Œç»†(fine) ç½‘ç»œ&lt;/strong>&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>åç»­&lt;strong>å¦‚ä½•ä¼˜åŒ–&lt;/strong>çš„éƒ¨åˆ†ä¼šå…·ä½“è§£é‡Šç²—ç½‘ç»œå’Œç»†ç½‘ç»œ&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>$\mathcal{R}$ æ˜¯æ¯ä¸ª batch é‡Œé¢å…‰çº¿çš„é›†åˆï¼Œ$\mathbf{r}$ æ˜¯æŒ‡é›†åˆé‡Œé¢çš„æ¯ä¸€æ¡å…‰çº¿&lt;/li>
&lt;li>$C(\mathbf{r})$ï¼Œ$\hat{C}_c(\mathbf{r})$ï¼Œ$\hat{C}_f(\mathbf{r})$ åˆ†åˆ«æ˜¯gtå®æ™¯ï¼Œç²—ç½‘ç»œï¼Œç»†ç½‘ç»œä¸­è¾“å‡ºçš„å…‰çº¿ RGB é¢œè‰²&lt;/li>
&lt;li>åŒæ—¶è¿˜å°† $\hat{C}_c(\mathbf{r})$ çš„æŸå¤±æœ€å°åŒ–ï¼Œä»¥ä¾¿ç²—ç½‘ç»œçš„æƒé‡åˆ†å¸ƒå¯ä»¥ç”¨äºåœ¨ç»†ç½‘ç»œä¸­åˆ†é…æ ·æœ¬&lt;/li>
&lt;/ul>
&lt;h3 id="ç¥ç»æ¸²æŸ“">ç¥ç»æ¸²æŸ“&lt;/h3>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/486642042">https://zhuanlan.zhihu.com/p/486642042&lt;/a>&lt;/p>
&lt;ul>
&lt;li>æ²¿ç€ç›¸æœºå…‰çº¿æŸ¥è¯¢ 5D åæ ‡æ¥åˆæˆè§†å›¾&lt;/li>
&lt;li>ä½¿ç”¨&lt;strong>ç«‹ä½“æ¸²æŸ“&lt;/strong>å°†è¾“å‡ºé¢œè‰²å’Œå¯†åº¦æŠ•å½±åˆ° 2D å›¾åƒä¸­&lt;/li>
&lt;/ul>
&lt;p>ä»ç‰¹å®šçš„è§†è§’æ¸²æŸ“ NeRF çš„è¿‡ç¨‹&lt;/p>
&lt;ul>
&lt;li>åˆ©ç”¨ç©¿è¿‡åœºæ™¯çš„ç›¸æœºå…‰çº¿ï¼Œç”Ÿæˆä¸€ç»„é‡‡æ ·çš„ä¸‰ç»´ç‚¹ $P_{3D}$&lt;/li>
&lt;li>åˆ©ç”¨ä¸‰ç»´ç‚¹å’Œå¯¹åº”çš„ 2D è§†è§’æ–¹å‘ä½œä¸º MLP çš„è¾“å…¥ï¼Œè¾“å‡ºå¯†åº¦å’Œé¢œè‰²&lt;/li>
&lt;li>ä½¿ç”¨ç«‹ä½“æ¸²æŸ“æŠ€æœ¯å°†è¾“å‡ºé¢œè‰²å’Œå¯†åº¦ç´¯ç§¯åˆ°ä¸€ä¸ªäºŒç»´å›¾åƒ $I_{2D}$ ä¸­&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>ç”±äºå…·æœ‰å¯å¾®æ€§ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨&lt;strong>æ¢¯åº¦ä¸‹é™&lt;/strong>çš„æ–¹æ³•æ¥ä¼˜åŒ– MLP ç½‘ç»œï¼Œ&lt;strong>æœ€å°åŒ–æ¯ä¸ªè§‚å¯Ÿå›¾åƒå’Œ NeRF æ¸²æŸ“å‡ºæ¥çš„ç›¸åº”è§†å›¾ä¹‹é—´çš„è¯¯å·®&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>è¯¥éƒ¨åˆ†è¯¦ç»†å†…å®¹å‚è§ &lt;a href="./math.md">NeRF çš„æ•°å­¦æ¨å¯¼&lt;/a>[NeRFæ•°å­¦å…¬å¼ä»é›¶æ¨å¯¼](&lt;a href="https://www.bilibili.com/video/BV1Wd4y1X7H1/">https://www.bilibili.com/video/BV1Wd4y1X7H1/&lt;/a>)&lt;br />å…‰çº¿å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ª 3D ç©ºé—´åæ ‡&lt;br />$\mathbf{r}(t) = \mathbf{o} + t \mathbf{d}$&lt;/p>
&lt;blockquote>
&lt;p>åŸæ–‡ä¸­çš„ä¸€äº›å‡è®¾ï¼š&lt;/p>
&lt;ol>
&lt;li>åœºæ™¯æ˜¯ç”±ä¸€å›¢å‘å…‰ç²’å­ç»„æˆçš„ï¼Œè¿™é‡Œç²’å­å¯†åº¦çš„ç©ºé—´åˆ†å¸ƒä¼šå‘ç”Ÿå˜åŒ–&lt;/li>
&lt;li>å‘å°„çš„å…‰ï¼ˆæ¯ä¸€ä¸ªä½“ç´ éƒ½ä¼šå‘å››å‘¨å‡åŒ€å‘å‡ºå…‰ï¼‰ä¸éšè§‚å¯Ÿè§†è§’è€Œæ”¹å˜&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;p>å‡è®¾&lt;strong>è·ç¦»&lt;/strong> $t$ çš„è¿‘åœºè¾¹ç•Œå’Œè¿œåœºè¾¹ç•Œåˆ†åˆ«ä¸º $t_n$ å’Œ $t_f$ ï¼Œé‚£ä¹ˆå¯¹äºä¸€æ¡å°„çº¿ï¼Œå®ƒçš„æœŸæœ›é¢œè‰²è¡¨è¾¾å¼åº”è¯¥å¦‚ä¸‹ï¼š&lt;br />$C(\mathbf{r})=\int_{t_n}^{t_f} T(t) \sigma(\mathbf{r}(t)) \mathbf{c}(\mathbf{r}(t), \mathbf{d}) d t, \text{ where } T(t)=\exp \left(-\int_{t_n}^t \sigma(\mathbf{r}(s)) d s\right)$&lt;br />å‡½æ•° $T(t)$ è¡¨ç¤ºçš„æ˜¯å…‰çº¿åœ¨ $t_n$ åˆ° $t$ è·ç¦»å†…çš„é€å°„ç‡ï¼Œå³å…‰çº¿åœ¨ä¸ç¢°åˆ°ä»»ä½•å…¶ä»–ç²’å­çš„æƒ…å†µä¸‹èƒ½å¤Ÿä¼ æ’­çš„æ¦‚ç‡&lt;br />ä¸€å¼ ç¤ºä¾‹å›¾ï¼š&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220051-1.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;br />ä»è¿ç»­çš„ NeRF ä¸­æ¸²æŸ“è§†å›¾éœ€è¦ä¼°è®¡ç›¸æœºå…‰çº¿è¿½è¸ªçš„æ¯ä¸ªåƒç´ çš„ç§¯åˆ† $C(\mathbf{r})$&lt;/p>
&lt;blockquote>
&lt;p>&lt;em>è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå› ä¸º 2D å›¾åƒçš„æ¯ä¸€ä¸ªåƒç´ å€¼å®é™…ä¸Šæ˜¯ç›¸æœºå‘å‡ºçš„ä¸€æ¡å°„çº¿ä¸Šçš„æ‰€æœ‰ç‚¹ç´¯ç§¯å åŠ çš„ç»“æœ&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>æ–‡ä¸­ä¼°è®¡ç§¯åˆ†çš„æ–¹æ³•æ˜¯ &lt;a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E6%96%AF%E6%B1%82%E7%A7%AF">æ•°å€¼ç§¯åˆ†(Quadrature)&lt;/a>&lt;br />ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åˆ†å±‚æŠ½æ ·ï¼ŒæŠŠ $[t_n, t_f]$ ç­‰åˆ†æˆ $\mathbf{N}$ ä¸ªåŒºé—´ï¼Œç„¶åä»æ¯ä¸ªåŒºé—´å†…å‡åŒ€éšæœºåœ°æŠ½å–ä¸€ä¸ªæ ·æœ¬&lt;/p>
&lt;p>$t_i \sim \mathcal{U}\left[t_n+\frac{i-1}{N}\left(t_f-t_n\right), t_n+\frac{i}{N}\left(t_f-t_n\right)\right] \quad i =1,2,...N$&lt;/p>
&lt;blockquote>
&lt;p>è¿™é‡Œå¾—åˆ°çš„ $t_i$ æ˜¯æ¯ä¸ªå°åŒºé—´å†…çš„éšæœºæŠ½å–æ ·æœ¬ç‚¹çš„ç©ºé—´åæ ‡&lt;/p>
&lt;/blockquote>
&lt;p>æ ¹æ®æ•°å€¼ç§¯åˆ†æ–¹æ³•ä¼°è®¡çš„é¢œè‰²ç§¯åˆ†ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;br />$\hat{C}(\mathbf{r})=\sum_{i=1}^N T_i\left(1-\exp \left(-\sigma_i \delta_i\right)\right) \mathbf{c}&lt;em>i, \text { where } T_i=\exp \left(-\sum&lt;/em>{j=1}^{i-1} \sigma_j \delta_j\right)$&lt;br />é€šè¿‡åˆ†å±‚æŠ½æ ·çš„æ–¹å¼ï¼Œå°†&lt;strong>è¿ç»­çš„ç§¯åˆ†å˜æˆäº†ç¦»æ•£çš„æ±‚å’Œ&lt;/strong>ï¼Œ$\delta_i = t_{i+1} - t_i$ æ˜¯&lt;strong>æ ·æœ¬é—´éš”(è·ç¦»)&lt;/strong>&lt;br />æ–‡ä¸­è¿˜æåˆ°äº†å¯ä»¥ç®€åŒ–ä¸ºä¼ ç»Ÿçš„ Alpha åˆæˆï¼Œå¯¹åº”çš„ alpha value æ˜¯&lt;br />$\alpha_i = 1 - exp(-\sigma_i \delta_i)$&lt;/p>
&lt;h3 id="å¦‚ä½•ä¼˜åŒ–">å¦‚ä½•ä¼˜åŒ–&lt;/h3>
&lt;p>è¾“å…¥ä¸ºä¸€ç³»åˆ—&lt;strong>å·²çŸ¥ç›¸æœºä½å§¿&lt;/strong>çš„å›¾åƒ&lt;br />&lt;strong>ä¸¤æ–¹é¢çš„ä¼˜åŒ–ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨&lt;strong>ä½ç½®ç¼–ç &lt;/strong>æ¥è½¬æ¢è¾“å…¥çš„ 5D åæ ‡ï¼Œå°†åæ ‡æ˜ å°„åˆ°&lt;strong>æ›´é«˜ç»´åº¦çš„ç©ºé—´&lt;/strong>ä¸­ï¼Œä½¿ç›¸ä¼¼çš„å†…å®¹åˆ†ç¦»åˆ°æ›´è¿œçš„åœ°æ–¹ï¼Œä»è€Œä½¿ MLP èƒ½å¤Ÿè¡¨ç¤º&lt;strong>æ›´é«˜é¢‘ç‡çš„å‡½æ•°&lt;/strong>ï¼Œä½¿å¾—ç‰©ä½“è¡¨é¢çš„å‡ ä½•å’Œçº¹ç†æ›´åŠ é€¼çœŸ&lt;/li>
&lt;li>é‡‡ç”¨äº†ä¸€ç§&lt;strong>ç”±ç²—åˆ°ç»†çš„åˆ†å±‚é‡‡æ ·&lt;/strong>ç¨‹åºï¼Œå¯¹äºé¢œè‰²è´¡çŒ®å¤§çš„ç‚¹é™„è¿‘é‡‡æ ·å¯†é›†ï¼Œè´¡çŒ®å°çš„ç‚¹é™„è¿‘é‡‡æ ·ç¨€ç–ï¼Œä»¥å‡å°‘å¿…è¦çš„é‡‡æ ·æ¬¡æ•°ï¼Œå……åˆ†é‡‡æ ·æ•´ä¸ªé«˜é¢‘åœºæ™¯è¡¨ç¤º&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>è¿™ä¸ªé‡‡æ ·çš„è¿‡ç¨‹åº”è¯¥æ˜¯æŒ‡ç›¸æœºå…‰çº¿å¯¹çœŸå® 3D åœºæ™¯çš„é‡‡æ ·ï¼Œåœ¨è¾“å…¥åˆ° MLP ä¹‹å‰&lt;/p>
&lt;/blockquote>
&lt;h4 id="ä½ç½®ç¼–ç positional-encoding">ä½ç½®ç¼–ç (Positional encoding)&lt;/h4>
&lt;blockquote>
&lt;p>æ·±åº¦ç½‘ç»œæ›´åå‘äºå­¦ä¹ ä½é¢‘å‡½æ•°ï¼Œç ”ç©¶è¡¨æ˜ï¼Œåœ¨å°†è¾“å…¥é€šè¿‡é«˜é¢‘å‡½æ•°æ˜ å°„åˆ°æ›´é«˜ç»´ç©ºé—´åå†ä¼ é€’ç»™ç½‘ç»œï¼Œå¯ä»¥æ›´å¥½åœ°æ‹ŸåˆåŒ…å«&lt;strong>é«˜é¢‘å˜åŒ–&lt;/strong>çš„æ•°æ®&lt;/p>
&lt;/blockquote>
&lt;p>å°†åŸå…ˆçš„è¡¨ç¤ºå‡½æ•°å˜æˆä¸¤ä¸ªå‡½æ•°çš„ç»„åˆï¼š&lt;br />$F_{\Theta}=F_{\Theta}^{\prime} \circ \gamma$&lt;br />ä¸¤ä¸ªå‡½æ•°ï¼Œ$F_{\Theta}^{\prime}$ å‡½æ•°éœ€è¦ç½‘ç»œå­¦ä¹ çš„ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ MLPï¼Œ$\gamma$ å‡½æ•°åˆ™ä¸éœ€è¦å­¦ä¹ &lt;br />$\gamma$ åœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªæ˜ å°„(mapping) å‡½æ•°ï¼Œä»ç©ºé—´ $\mathbf{R}$ æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ $\mathbf{R}^{2L}$&lt;br />åŸæ–‡ä¸­ä½¿ç”¨çš„ç¼–ç æ–¹ç¨‹å¦‚ä¸‹ï¼š&lt;br />$\gamma(p)=\left(\sin \left(2^0 \pi p\right), \cos \left(2^0 \pi p\right), \cdots, \sin \left(2^{L-1} \pi p\right), \cos \left(2^{L-1} \pi p\right)\right)$&lt;br />$\gamma(\cdot)$ åˆ†åˆ«ä½œç”¨äºç©ºé—´åæ ‡ $\mathbf{x}$ ä¸­çš„&lt;strong>æ¯ä¸€ä¸ªåˆ†é‡(x,y,z)&lt;/strong> å’Œ è§†è§’æ–¹å‘çš„å•ä½å‘é‡ $\mathbf{d}$ çš„&lt;strong>ä¸‰ä¸ªåˆ†é‡&lt;/strong>ï¼Œæœ€åä¼šè¢«å½’ä¸€åŒ–åˆ°åŒºé—´ [-1, 1] ä¹‹é—´(sinh å‡½æ•°)&lt;br />æ–‡ä¸­ç”¨åˆ°çš„&lt;strong>è¶…å‚æ•°&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>$L = 10 \quad \text{for} \quad \gamma(\mathbf{x})$&lt;/li>
&lt;li>$L = 4 \quad \text{for} \quad \gamma(\mathbf{d})$&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>&lt;em>ç»´åº¦ &lt;em>$L$&lt;/em> çš„é€‰æ‹©å’Œåœºæ™¯çš„å¤æ‚åº¦ä»¥åŠç®—åŠ›æœ‰å…³ï¼Œä¹Ÿå†³å®šäº†ç¥ç»ç½‘ç»œèƒ½å­¦ä¹ åˆ°çš„æœ€é«˜é¢‘ç‡çš„å¤§å°&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;h4 id="åˆ†å±‚é‡‡æ ·hierarchical-volume-sampling">åˆ†å±‚é‡‡æ ·(Hierarchical volume sampling)&lt;/h4>
&lt;p>é€šè¿‡æŒ‰ç…§æ ·æœ¬å¯¹æœ€ç»ˆæ¸²æŸ“çš„é¢„æœŸå½±å“è¿›è¡Œæ¯”ä¾‹åˆ†é…æé«˜æ¸²æŸ“æ•ˆç‡&lt;br />åŒæ—¶ä¼˜åŒ–ä¸¤ä¸ª MLP ç½‘ç»œï¼š&amp;quot;coarse&amp;quot; å’Œ &amp;quot;fine&amp;quot;&lt;/p>
&lt;ol>
&lt;li>å°†åœ¨ç›¸æœºå°„çº¿ä¸Šï¼Œç”± near å’Œ far æ„æˆçš„åŒºé—´èŒƒå›´ç­‰åˆ†ï¼Œç„¶ååœ¨æ¯ä¸ªå°åŒºé—´å†…å‡åŒ€é‡‡æ ·å¾—åˆ°ä¸€ä¸ªé‡‡æ ·ç‚¹ï¼Œä¸€å…± $N_c$ Â ä¸ªé‡‡æ ·ç‚¹&lt;/li>
&lt;li>åˆ©ç”¨è¿™äº›ç©ºé—´ç‚¹æ¥è¯„ä¼°ç²—ç½‘ç»œ&lt;/li>
&lt;li>å†åœ¨æ¯æ¡å°„çº¿ä¸Šç”Ÿæˆæ›´å¤šä¿¡æ¯çš„é‡‡æ ·ç‚¹ (çŒœæƒ³æ˜¯ç²—ç½‘ç»œçš„ç»“æœ&lt;strong>è¾“å‡ºäº†æ ·æœ¬ç‚¹çš„æ¦‚ç‡å¯†åº¦åˆ†å¸ƒ&lt;/strong>ï¼Œä¸ºç¬¬äºŒæ¬¡é‡‡æ ·æä¾›äº†å‚è€ƒ)&lt;/li>
&lt;li>ä½¿ç”¨&lt;a href="https://zhuanlan.zhihu.com/p/396618080">é€†å˜æ¢é‡‡æ ·&lt;/a>é‡‡æ ·ç¬¬äºŒç»„ $N_f$ ä¸ªç©ºé—´ä½ç½®ç‚¹ï¼Œç”¨&lt;strong>ä¸¤ç»„ç©ºé—´ç‚¹&lt;/strong>è¯„ä¼°ç»†ç½‘ç»œï¼Œå¹¶ä½¿ç”¨ä¸¤ç»„ç©ºé—´ç‚¹æ¥è®¡ç®—å°„çº¿æœ€åçš„é¢œè‰² $\hat{C}_f(\mathbf{r})$&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>ç¬¬ä¸‰æ­¥å…·ä½“æ˜¯æ€ä¹ˆåšçš„&lt;/strong>&lt;br />é¦–å…ˆå°†åŸæ–¹ç¨‹ä¸­ç²—ç½‘ç»œ $\hat{C_c}(\mathbf{r})$ çš„ Alpha åˆæˆçš„é¢œè‰²é‡å†™ä¸ºæ²¿ç€å…‰çº¿é‡‡æ ·åˆ°çš„æ‰€æœ‰é¢œè‰² $c_i$ çš„åŠ æƒå’Œ&lt;br />$\hat{C}&lt;em>c(\mathbf{r})=\sum&lt;/em>{i=1}^{N_c} w_i c_i, \quad w_i=T_i\left(1-\exp \left(-\sigma_i \delta_i\right)\right)$&lt;/p>
&lt;blockquote>
&lt;p>è¿™ä¸ªæƒå€¼ $w_i$ å’Œé€è¿‡ç‡ä»¥åŠä½“ç§¯å¯†åº¦æœ‰å…³&lt;/p>
&lt;/blockquote>
&lt;p>å°†æƒå€¼å½’ä¸€åŒ–åå¯ä»¥åŒ–ä¸ºæ²¿å°„çº¿åˆ†å¸ƒçš„&lt;strong>åˆ†æ®µå¸¸æ•°æ¦‚ç‡å¯†åº¦å‡½æ•°&lt;/strong>(Piecewise-constant PDF), &lt;strong>ç›®çš„æ˜¯ç²—ç•¥ä¼°è®¡å°„çº¿ä¸Šçš„ç‰©ä½“åˆ†å¸ƒæƒ…å†µ&lt;/strong>&lt;br />$\hat{w_i} = \frac{w_i}{\sum_{j=1}^{N_c}w_j}$&lt;/p>
&lt;h3 id="ç»†èŠ‚è¯´æ˜">ç»†èŠ‚è¯´æ˜&lt;/h3>
&lt;p>&lt;strong>ä½“ç§¯è¾¹ç•Œ&lt;/strong>&lt;br />å¯¹äºåˆæˆå›¾åƒ: ç¼©æ”¾åœºæ™¯ï¼Œä½¿å…¶ä½äºä»¥åŸç‚¹ä¸ºä¸­å¿ƒã€è¾¹é•¿ä¸º 2 $([-1,1])$çš„ç«‹æ–¹ä½“å†…ï¼Œå¹¶ä»…æŸ¥è¯¢è¿™ä¸ªè¾¹ç•Œä½“ç§¯å†…çš„ NeRF è¡¨ç¤º&lt;br />å¯¹äºçœŸå®å›¾åƒ: æ•°æ®é›†åŒ…å«å¯ä»¥å­˜åœ¨äºæœ€è¿‘ç‚¹å’Œæ— ç©·è¿œç‚¹ä¹‹é—´çš„å†…å®¹ï¼Œç”¨å½’ä¸€åŒ–çš„æ–¹å¼å°†è¿™äº›ç‚¹çš„æ·±åº¦èŒƒå›´æ˜ å°„åˆ°åŒºé—´ [-1, 1]&lt;br />è¿™å°†æ‰€æœ‰å…‰çº¿çš„èµ·ç‚¹ç§»åŠ¨åˆ°&lt;strong>åœºæ™¯çš„è¿‘å¹³é¢(near plane)&lt;/strong>ï¼Œå°†ç›¸æœºçš„é€è§†å…‰æ˜ å°„ä¸ºå˜æ¢åä½“ç§¯ä¸­çš„å¹³è¡Œå…‰çº¿ï¼Œå¹¶ä½¿ç”¨&lt;strong>è§†å·®&lt;/strong>è€Œä¸æ˜¯ä½¿ç”¨åº¦é‡æ·±åº¦ï¼Œå› æ­¤&lt;strong>æ‰€æœ‰åæ ‡éƒ½æ˜¯æœ‰ç•Œé™çš„&lt;/strong>&lt;br />&lt;strong>è®­ç»ƒ&lt;/strong>&lt;br />å¯¹äºçœŸå®åœºæ™¯çš„æ•°æ®ï¼Œåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­å¯¹è¾“å‡ºç»“æœ $\sigma$ æ·»åŠ äº†éšæœºé«˜æ–¯å™ªå£° (åœ¨é€šè¿‡ ReLU ä¹‹å‰)&lt;br />&lt;strong>æ¸²æŸ“&lt;/strong>&lt;br />åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œåœ¨æ¯æ¡å°„çº¿ä¸Šé‡‡æ · 64 ä¸ªç‚¹è¾“å…¥åˆ°ç²—ç½‘ç»œä¸­ï¼Œé‡‡æ · 64+128=192 ä¸ªç‚¹åˆ°ç»†ç½‘ç»œä¸­ï¼Œ&lt;strong>æ¯æ¡å…‰çº¿ä¸€å…±é‡‡æ · 256 ä¸ªç‚¹&lt;/strong>&lt;br />å¯¹äºåˆæˆçš„å›¾ç‰‡ï¼Œæ¯å¼ å›¾ç‰‡éœ€è¦ 640k æ¡å…‰çº¿ï¼›å¯¹äºçœŸå®åœºæ™¯ï¼Œæ¯å¼ å›¾ç‰‡éœ€è¦ 762k æ¡å…‰çº¿&lt;/p>
&lt;h2 id="nerf-åšçš„ç»“æœæ€ä¹ˆæ ·">NeRF åšçš„ç»“æœæ€ä¹ˆæ ·&lt;/h2>
&lt;h3 id="ç›¸å…³æŒ‡æ ‡">ç›¸å…³æŒ‡æ ‡&lt;/h3>
&lt;ul>
&lt;li>PSNR: å³°å€¼ä¿¡å™ªæ¯”ï¼Œæ˜¯ä¸€ç§è¯„ä»·&lt;strong>å›¾åƒè´¨é‡&lt;/strong>çš„æŒ‡æ ‡ &lt;em>(è¶Šé«˜è¶Šå¥½)&lt;/em>&lt;/li>
&lt;li>SSIM: ç»“æ„ç›¸ä¼¼æ€§ï¼Œæ˜¯ä¸€ç§è¡¡é‡ä¸¤å¹…&lt;strong>å›¾åƒç›¸ä¼¼åº¦&lt;/strong>çš„æŒ‡æ ‡ &lt;em>(è¶Šé«˜è¶Šå¥½)&lt;/em>&lt;/li>
&lt;li>LPIPS: å­¦ä¹ æ„ŸçŸ¥å›¾åƒå—ç›¸ä¼¼åº¦ï¼Œæ˜¯ä¸€ç§åº¦é‡ä¸¤å¹…&lt;strong>å›¾åƒä¹‹é—´çš„å·®åˆ«&lt;/strong>çš„æŒ‡æ ‡ &lt;em>(è¶Šä½è¶Šå¥½)&lt;/em>&lt;/li>
&lt;/ul>
&lt;h3 id="ä¼˜åŠ¿">ä¼˜åŠ¿&lt;/h3>
&lt;ul>
&lt;li>ç»§æ‰¿äº†ä½“ç§¯è¡¨ç¤ºçš„ä¼˜ç‚¹ï¼Œå¯ä»¥è¡¨ç¤º&lt;strong>å¤æ‚çš„å‡ ä½•å½¢çŠ¶å’Œå¤–è§‚&lt;/strong>&lt;/li>
&lt;li>é€‚åˆä½¿ç”¨æŠ•å½±å›¾åƒè¿›è¡Œ&lt;strong>åŸºäºæ¢¯åº¦ï¼ˆå¯å¾®ï¼‰çš„ä¼˜åŒ–&lt;/strong>&lt;/li>
&lt;li>å…‹æœäº†åœ¨é«˜åˆ†è¾¨ç‡å»ºæ¨¡å¤æ‚åœºæ™¯æ—¶ï¼Œ&lt;strong>ç¦»æ•£åŒ–ä½“ç´ ç½‘æ ¼&lt;/strong>æ‰€å¸¦æ¥çš„&lt;strong>å­˜å‚¨æˆæœ¬è¿‡é«˜&lt;/strong>çš„é—®é¢˜&lt;/li>
&lt;/ul>
&lt;h3 id="ä¸è¶³">ä¸è¶³&lt;/h3>
&lt;ul>
&lt;li>è®­ç»ƒé€Ÿåº¦å¤ªæ…¢ï¼šæ¯ä¸ªåƒç´ éƒ½éœ€è¦è¿‘ 200 æ¬¡ MLP æ¨¡å‹çš„å‰å‘é¢„æµ‹&lt;/li>
&lt;li>æ¨¡å‹æ³›åŒ–æ€§å¤ªå·®ï¼šNeRF è¦é’ˆå¯¹æ¯ä¸ªåœºæ™¯å•ç‹¬è¿›è¡Œè®­ç»ƒï¼Œæ— æ³•ç›´æ¥æ‰©å±•åˆ°æ–°å‡ºç°çš„åœºæ™¯&lt;/li>
&lt;/ul>
&lt;h2 id="nerf-ä¸æ‡‚çš„åœ°æ–¹">Nerf ä¸æ‡‚çš„åœ°æ–¹&lt;/h2>
&lt;h3 id="positional-encoding">Positional Encoding&lt;/h3>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/623432244">æ€è€ƒPositional Encoding&lt;/a>&lt;br />map each input 5D coordinate into a higher dimensional spaceã€‚&lt;br />ä¸ºä»€ä¹ˆè¦æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ï¼š&lt;br />This is consistent with recent work by Rahaman et al. [35], which shows that deep networks are biased towards learning lower frequency functions. They additionally show that** mapping the inputs to a higher dimensional space using high frequency functions** before passing them to the network enables &lt;strong>better fitting of data&lt;/strong> that contains high frequency variation.&lt;/p>
&lt;h3 id="3d-occupancy-fields">3D occupancy fields&lt;/h3>
&lt;p>æ¨èåšå®¢: &lt;a href="https://blog.csdn.net/qq_34342853/article/details/120078510">1&lt;/a>, &lt;a href="https://hideoninternet.github.io/2019/12/21/b040bbb5/">2&lt;/a>&lt;br />&lt;strong>å°±æ˜¯ç”¨ä¸€ä¸ªéšå‡½æ•°æ¥è¡¨ç¤ºç‰©ä½“çš„è¿ç»­è¾¹ç•Œ.&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>ä½“ç´ è¡¨ç¤ºçš„ç¼ºç‚¹ï¼šå†…å­˜éšåˆ†è¾¨ç‡å‘ˆç«‹æ–¹å¢åŠ ï¼Œæ•…éœ€è¦é™åˆ¶åœ¨32&lt;em>32&lt;/em>32æˆ–64&lt;em>64&lt;/em>64ã€‚ä½¿ç”¨ä¾‹å¦‚å…«å‰æ ‘çš„æ•°æ®è‡ªé€‚åº”è¡¨ç¤ºæ¥é™ä½å†…å­˜ï¼Œå®ç°èµ·æ¥åˆä¼šå¤æ‚ï¼Œç°æœ‰æ•°æ®è‡ªé€‚åº”ç®—æ³•ä¾æ—§å±€é™äºç›¸å¯¹è¾ƒå°çš„256&lt;em>256&lt;/em>256åˆ†è¾¨ç‡ã€‚&lt;/li>
&lt;li>ç‚¹äº‘è¡¨ç¤ºçš„ç¼ºç‚¹ï¼šç”±äºç¼ºå°‘åº•å±‚ç½‘æ ¼çš„è¿æ¥ç»“æ„ï¼Œéœ€è¦é¢å¤–çš„åå¤„ç†æ¥ä»æ¨¡å‹ä¸­æå–ä¸‰ç»´å‡ ä½•å›¾å½¢ã€‚&lt;/li>
&lt;li>ç½‘æ ¼è¡¨ç¤ºçš„ç¼ºç‚¹ï¼šç°æœ‰çš„ç½‘æ ¼è¡¨ç¤ºé€šå¸¸åŸºäºå¯¹ä¸€ä¸ªæ¨¡æ¿ç½‘æ ¼çš„å˜å½¢ï¼Œå› æ­¤ä¸å…è®¸ä»»æ„æ‹“æ‰‘ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://blog.csdn.net/weixin_45616624/article/details/122790729">Occupancy Networks&lt;/a>åŸºäºå¯¹è¿ç»­ä¸‰ç»´å æ®å‡½æ•°è¿›è¡Œç›´æ¥å­¦ä¹ çš„ä¸‰ç»´é‡å»ºæ–°æ–¹æ³•ã€‚åˆ©ç”¨ç¥ç»ç½‘ç»œå®ç°å¯¹ä»»æ„åˆ†è¾¨ç‡çš„å æ®å‡½æ•°çš„é¢„æµ‹ã€‚è®­ç»ƒæ—¶å¤§å¤§é™ä½äº†å†…å­˜ï¼Œæ¨ç†æ—¶åˆ©ç”¨ç®€å•çš„å¤šåˆ†è¾¨ç‡ç­‰å€¼é¢æå–ç®—æ³•ä»å­¦ä¹ çš„æ¨¡å‹ä¸­æå–ç½‘æ ¼ã€‚&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220051-2.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="1.jpg">&lt;/p>
&lt;h3 id="a-neural-3d-texture-field">a neural 3D texture field&lt;/h3>
&lt;p>a &lt;a href="https://arxiv.org/abs/1905.07259">Texture Field&lt;/a> as a mapping from 3D point p, shape embedding s and condition z to color c:&lt;/p>
&lt;h3 id="light-field-sample-interpolation-techniques">light field sample interpolation techniques&lt;/h3>
&lt;p>è¿œå¤æ–¹æ³•äº†,ä¸åšäº†è§£,å¼•ç”¨è®ºæ–‡æœ€è¿Ÿéƒ½æ˜¯2012å¹´.&lt;/p>
&lt;h3 id="differentiable-rasterizers">Differentiable rasterizers&lt;/h3>
&lt;p>optimize mesh representations to reproduce a set of input images&lt;br />å¯å‚è€ƒåšå®¢:&lt;a href="https://blog.csdn.net/qq_43420530/article/details/117909788">1&lt;/a>, &lt;a href="https://zhuanlan.zhihu.com/p/584510853">2&lt;/a>&lt;/p>
&lt;h3 id="alpha-compositing">alpha-compositing&lt;/h3>
&lt;p>&lt;a href="https://zh.wikipedia.org/zh-tw/Alpha%E5%90%88%E6%88%90">Alphaåˆæˆ&lt;/a>ï¼ˆè‹±èªï¼šalpha compositingï¼‰æ˜¯ä¸€ç¨®å°‡åœ–åƒèˆ‡èƒŒæ™¯çµåˆçš„éç¨‹ï¼Œçµåˆå¾Œå¯ä»¥ç”¢ç”Ÿéƒ¨åˆ†é€æ˜æˆ–å…¨é€æ˜çš„è¦–è¦ºæ•ˆæœã€‚&lt;/p>
&lt;h3 id="discretization-artifacts">discretization artifacts&lt;/h3>
&lt;p>æä¸æ‡‚,ç¦»æ•£åŒ–ä¼ªå½±?&lt;br />41 24 è®ºæ–‡ ä»–ä»¬ç”¨çš„æ˜¯ä»€ä¹ˆæ–¹æ³•&lt;/p>
&lt;h3 id="view-dependent">view-dependent&lt;/h3>
&lt;p>view-dependentå°±æ˜¯åŠ å…¥äº†directionï¼ˆÎ¸,Ï•ï¼‰ï¼Œå¯ä»¥ä½¿å¾—æ¯ä¸ªæ–¹å‘éƒ½æœ‰ç‹¬ç«‹çš„é¢œè‰²å˜åŒ–&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220051-3.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="1.jpg">&lt;/p>
&lt;h3 id="å¦‚ä½•çœ‹å›¾ä¸‰">å¦‚ä½•çœ‹å›¾ä¸‰&lt;/h3>
&lt;p>å›¾ä¸‰è¡¨ç¤ºä¸åŒæ–¹å‘ä¸‹ï¼Œå±•ç¤ºçš„ç»“æœä¼šä¸ä¸€è‡´ï¼Œæœ‰é•œé¢åå°„çš„æ•ˆæœ&lt;br />&lt;a href="https://blog.devgenius.io/paper-explained-nerf-representing-scenes-as-neural-radiance-fields-for-view-synthesis-e16567180531">In the case of a fully Lambertian surface&lt;/a> ( imagine an ideal â€œmatteâ€ surface like a terracotta vase), when a light ray hits a point the light enters slightly into the surface of the object and &lt;strong>is scattered in all directions&lt;/strong>. In this case, I can look at the point from any direction and its color will be about the same. At the opposite extreme we have a perfect mirror: in this case each light ray is reflected in only one direction and this makes that, for example, when we look at a mirror what we see changes depending on where we are looking from. Fig. 3 of the paper shows the effect of the viewing direction&lt;/p>
&lt;h3 id="inverse-transform-sampling">inverse transform sampling&lt;/h3>
&lt;p>å·²çŸ¥PDFå’ŒCDFå, å°±å¯ä»¥æ±‚é€†å‡½æ•°, å†é€šè¿‡é‡‡æ ·å‡åŒ€åˆ†å¸ƒçš„ç‚¹ï¼Œå°†å…¶ä»£å…¥åˆ°é€†å‡½æ•°ï¼Œè¿›è€Œå¾—åˆ°æœä»æŒ‡æ•°åˆ†å¸ƒçš„æ ·æœ¬ç‚¹(æœ€ç»ˆç›®æ ‡).&lt;br />&lt;a href="https://zhuanlan.zhihu.com/p/396618080">é‡‡æ ·ç†è®ºæ¦‚è¿°ï¼ˆé€†å˜æ¢é‡‡æ ·ã€æ‹’ç»é‡‡æ ·ï¼‰&lt;/a>&lt;/p>
&lt;h3 id="deepsdf">DeepSDF&lt;/h3>
&lt;p>&lt;a href="https://blog.csdn.net/qq_43420530/article/details/122404223">æ¨èåšå®¢&lt;/a>ã€&lt;a href="https://openaccess.thecvf.com/content_CVPR_2019/papers/Park_DeepSDF_Learning_Continuous_Signed_Distance_Functions_for_Shape_Representation_CVPR_2019_paper.pdf">è®ºæ–‡&lt;/a>&lt;br />&lt;a href="https://www.jianshu.com/p/d34afd45f28e">ä¼ ç»Ÿçš„sdfï¼Œæ–‡ä¸­ä¹Ÿä»‹ç»äº†ray tracingã€ray marchingã€‚ã€‚ã€‚&lt;/a>&lt;br />&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220051-4.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="BV1Nv4y1m7hJ" title="BV1Nv4y1m7hJ">&lt;br />æ­£å¼ä»‹ç»DeepSDFï¼š&lt;/p>
&lt;ol>
&lt;li>é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥ç”¨SDFï¼ˆSigned Distance Functionï¼‰è¿™æ ·ä¸€ä¸ªå‡½æ•°æ¥éšå¼åœ°è¡¨ç¤ºä¸€ä¸ªä¸‰ç»´ç‰©ä½“ï¼Œè¾“å…¥æ˜¯ç©ºé—´ä¸­ç‚¹çš„ä¸‰ç»´åæ ‡ï¼Œè¾“å‡ºæ˜¯è¿™ä¸ªç‚¹ç¦»æˆ‘ä»¬æƒ³è¡¨ç¤ºçš„ç‰©ä½“è¡¨é¢çš„æœ€è¿‘è·ç¦»ï¼Œå¦‚æœåœ¨å¤–éƒ¨å°±æ˜¯æ­£ï¼Œå†…éƒ¨å°±æ˜¯è´Ÿã€‚&lt;strong>æ˜¾ç„¶åªè¦SDFæ‰¾çš„å¥½ï¼Œä»ç†è®ºä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿç®€å•ç²—æš´åœ°è¡¨ç¤ºä»»æ„å¤æ‚ä¸”è¿ç»­çš„ç‰©ä½“&lt;/strong>ï¼Œè¿™ä¹Ÿæ˜¯ç‰©ä½“çš„éšå¼è¡¨ç¤ºæ–¹å¼ä¸ç”¨ç‚¹äº‘ã€ä½“ç´ ã€ç½‘æ ¼ç­‰è¡¨ç¤ºæ–¹å¼ç›¸æ¯”æœ€å¤§çš„å¥½å¤„ã€‚&lt;/li>
&lt;/ol>
&lt;p>$S D F(\boldsymbol{x})=s: \boldsymbol{x} \in \mathbb{R}^{3}, s \in \mathbb{R}$&lt;br />å…¶ä¸­xä¸ºä¸‰ç»´çš„é‡‡æ ·ç‚¹ï¼Œsä¸ºä¸€ç»´çš„å¸¦æ­£è´Ÿçš„æ•°å€¼ï¼Œå‡å®šçœŸçš„æœ‰è¿™æ ·ä¸€ä¸ªå®Œç¾çš„SDFå‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½ç”¨å›¾å½¢å­¦ä¸­ç°æˆçš„Marching Cubesæ–¹æ³•å°†å…¶è½¬æ¢æˆç½‘æ ¼æ•°æ®ï¼Œæˆ–è€…ç›´æ¥ç”¨raycastingæ–¹æ³•ç›´æ¥æ¸²æŸ“ï¼Œåœ¨è¿™é‡Œä¸ä½œè¯¦ç»†è®¨è®ºã€‚&lt;/p>
&lt;ol start="2">
&lt;li>ç°åœ¨å‡å®šæˆ‘ä»¬æœ‰å‡ ä¸ªç¦»æ•£çš„SDFå‡½æ•°çš„è¾“å…¥ä¸è¾“å‡ºï¼Œæˆ‘ä»¬æƒ³è¦é€šè¿‡æŸç§æ–¹å¼å¾—åˆ°è¿™ä¸ªå®Œæ•´çš„SDFå‡½æ•°ï¼Œæœ€ç»ˆå°±èƒ½å®ç°æ ¹æ®è¿™å‡ ä¸ªç¦»æ•£çš„é‡‡æ ·ç‚¹æ¥é‡å»ºæ•´ä¸ªä¸‰ç»´ç‰©ä½“äº†ï¼Œè¿™ä¹Ÿæ˜¯æœ¬æ–‡çš„æ ¹æœ¬ç›®çš„ã€‚æœ¬æ–‡æå‡ºçš„DeepSDFæ€æƒ³ä¾¿æ˜¯ï¼Œç”¨&lt;strong>ç¥ç»ç½‘ç»œå½“åšSDFå‡½æ•°çš„æ‹Ÿåˆå™¨&lt;/strong>ï¼Œè®­ç»ƒå®Œï¼ˆæˆ–è€…è¯´æ‹Ÿåˆå®Œï¼‰ä¹‹åï¼Œè¾“å…¥å¤§é‡è‡ªå®šä¹‰çš„ä¸‰ç»´ç©ºé—´é‡‡æ ·ç‚¹ï¼Œå†æå–å‡ºæ‰€æœ‰å€¼ä¸º0çš„ç‚¹ç»„æˆé¢ï¼Œå°±èƒ½å¤Ÿé‡å»ºæ•´ä¸ªä¸‰ç»´ç‰©ä½“äº†ã€‚å› ä¸ºç¥ç»ç½‘ç»œæ˜¯ä¸‡èƒ½å‡½æ•°æ‹Ÿåˆå™¨ï¼Œæ‰€ä»¥è¯´è¿™ç§æ–¹æ³•å¯ä»¥è¡¨ç¤ºä»»æ„ç²¾åº¦çš„ï¼Œè¿ç»­çš„ä¸‰ç»´ç‰©ä½“ï¼Œåªä¸è¿‡æ˜¯å¾—å–å†³äºä½ çš„é‡‡æ ·ç‚¹æ•°é‡ä¸ç¥ç»ç½‘ç»œçš„å±‚æ•°ç½¢äº†&lt;/li>
&lt;li>å¾ˆæ˜¾ç„¶ï¼ŒåŸºäºä¸Šé¢çš„æ€æƒ³æˆ‘ä»¬å¾ˆè‡ªç„¶åœ°æƒ³åˆ°è¿™ç§ç»“æ„ï¼š&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://cdn.nlark.com/yuque/0/2023/jpeg/12600461/1685605681470-8fe98fb6-6bad-41a4-bfe3-db8edec29925.jpeg#averageHue=%23f7f1eb&amp;amp;clientId=u11484f18-29d5-4&amp;amp;from=ui&amp;amp;height=219&amp;amp;id=BHKkM&amp;amp;originHeight=261&amp;amp;originWidth=442&amp;amp;originalType=binary&amp;amp;ratio=1.25&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=12333&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u517107bc-b88c-4d70-a7a4-1a1cc2147d5&amp;amp;title=&amp;amp;width=371" alt="1.jpg">&lt;br />åœ¨è¿™é‡Œï¼Œç¥ç»ç½‘ç»œçš„ä½œç”¨ä¸æ˜¯å»å®ç°æŸç§åŠŸèƒ½ï¼Œè€Œæ˜¯&lt;strong>å»è¡¨ç¤ºç‰©ä½“æˆ–åœºæ™¯æœ¬èº«&lt;/strong>ï¼Œå› æ­¤ä¹Ÿä¼šå¯¼è‡´åç»­çš„å„ç§è®­ç»ƒä¸Šå’Œæˆ‘ä»¬æ­£å¸¸è®¤çŸ¥çš„ç¥ç»ç½‘ç»œè®­ç»ƒæ–¹å¼æœ‰äº›è®¸çš„åŒºåˆ«ï¼ˆå…³äºè¿™ä¸¤è€…åŒºåˆ«å»ºè®®çœ‹ä¸€ä¸‹&lt;a href="https://pic.keepjolly.com/halo/blog/2023/06/20230607220051-5..png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5">ã€Šç”¨ç¥ç»ç½‘ç»œè¡¨ç¤ºç‰©ä½“æˆ–åœºæ™¯ä¸ç”¨ç¥ç»ç½‘ç»œå®Œæˆä»»åŠ¡çš„åŒºåˆ«ä¸è”ç³»ã€‹&lt;/a>ï¼‰&lt;/p>
&lt;ol start="4">
&lt;li>è¿™æ ·å°±ä¸‡äº‹å¤§å‰äº†å—ï¼Ÿå¹¶æ²¡æœ‰ï¼Œå› ä¸ºå¦‚æœç”¨è¿™ç§æ–¹æ³•ï¼Œå¹¶ä¸æ˜¯æ•°æ®é©±åŠ¨çš„ï¼Œè€Œæ›´åƒæ˜¯ä¸€ç§æ•°å­¦çš„æ–¹æ³•ï¼Œæˆ‘ä»¬&lt;strong>æ¯æ¬¡è¿›è¡Œé‡å»ºçš„æ—¶å€™éƒ½å¾—é‡æ–°è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œå¾—åˆ°è¡¨ç¤ºè¿™ä¸ªç‰©ä½“çš„ä¸“å±SDF&lt;/strong>ï¼Œæ¯”å¦‚ç»™æˆ‘ä¸€ä¸ªè½¿è½¦çš„è‹¥å¹²é‡‡æ ·ç‚¹ï¼Œæˆ‘ç»™è®­ç»ƒå‡ºæ¥äº†ï¼Œä½ è¦æ˜¯å†ç»™æˆ‘ä¸€ä¸ªå¡è½¦çš„é‡‡æ ·ç‚¹ï¼Œæˆ‘è¿˜å¾—é‡æ–°è®­ç»ƒï¼Œè™½è¯´è¿™æ ·æˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦æ•°æ®é›†ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¾è€Œæ˜“è§ï¼šæˆ‘æ˜¯å¸Œæœ›åœ¨ç¥ç»ç½‘ç»œä¸­å¼•å…¥å¯¹ä¸‰ç»´æ•°æ®é›†çš„ä¸€äº›å…ˆéªŒæ¥è¾…åŠ©æ‹Ÿåˆï¼Œä»¥ä¾¿äºæ›´å¥½åœ°è¿›è¡Œä¸‰ç»´é‡å»ºçš„ï¼Œæ¯”å¦‚ä½ å°±ç»™æˆ‘8ä¸ªé‡‡æ ·ç‚¹ï¼Œåˆ†åˆ«ä»£è¡¨æ­£æ–¹ä½“çš„8ä¸ªé¡¶ç‚¹ï¼Œå¦‚æœä¸å¼•å…¥æ•°æ®é›†ï¼ˆå¦‚æ±½è½¦æ•°æ®é›†ï¼‰çš„å…ˆéªŒçš„è¯ï¼Œæœ€ç»ˆæ‹Ÿåˆå‡ºæ¥çš„ä¸œè¥¿è‚¯å®šå°±æ˜¯ä¸€ä¸ªæ­£æ–¹ä½“ï¼ˆæˆ–è€…æ˜¯ä¸ªçƒä½“ï¼‰ä¹‹ç±»çš„ä¸œè¥¿ï¼Œè€Œä¸æ˜¯åƒä¸ªæ±½è½¦çš„æ ·å­ã€‚&lt;/li>
&lt;li>å› æ­¤ï¼Œæœ¬æ–‡æå‡ºäº†ä¸‹é¢çš„æ¶æ„ï¼š&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220051-6.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="1.jpg">&lt;br />å‡å®šæ•°æ®é›†ä¸­çš„æŸç±»æ•°æ®è¢«ç¼–ç æˆlatent codeè¿›è¡Œè¡¨ç¤ºï¼Œè¿™æ ·æˆ‘å°†è¿™ä¸ªlatent codeå’Œä¸‰ç»´åæ ‡åŒæ—¶ä¸¢å…¥ç¥ç»ç½‘ç»œæŸ¥è¯¢å¾—åˆ°sdfå€¼ï¼Œå…¶å®å°±èƒ½å¤Ÿå¾—åˆ°æŸç±»ä¸­æŸä¸ªå…·ä½“çš„ä¸‰ç»´ç‰©ä½“çš„SDFå‡½æ•°è¡¨ç¤ºäº†&lt;/p>
&lt;ol>
&lt;li>auto-coder&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/06/20230607220051-7.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="1.jpg">&lt;/p></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/computervision/">ComputerVision</category></item><item><title>ubuntuå®‰è£…nerfstudio</title><link>https://keepjolly.com/posts/tech/ubuntu-install-nerfstudio/</link><guid isPermaLink="true">https://keepjolly.com/posts/tech/ubuntu-install-nerfstudio/</guid><pubDate>Sun, 28 May 2023 09:34:46 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;p>åšä¸»é…ç½®ï¼š&lt;/p>
&lt;ul>
&lt;li>ubuntu18.04&lt;/li>
&lt;li>gcc11 ï¼ˆ&lt;a href="https://github.com/NVlabs/tiny-cuda-nn#requirements">éœ€è¦&lt;/a>$\geq$8ï¼‰&lt;/li>
&lt;li>conda&lt;/li>
&lt;li>cuda11.8&lt;/li>
&lt;li>&lt;a href="https://docs.nerf.studio/en/latest/quickstart/installation.html">å®‰è£…æ•™ç¨‹&lt;/a>ï¼ˆåŸºæœ¬æ¥æºäºæ­¤ï¼Œé™¤äº†DependenciesåŠ å…¥é¢å¤–å†…å®¹ï¼‰&lt;/li>
&lt;/ul>
&lt;h2 id="create-environment">Create environment&lt;/h2>
&lt;blockquote>
&lt;p>conda create --name nerfstudio -y python=3.8
conda activate nerfstudio
python -m pip install --upgrade pip&lt;/p>
&lt;/blockquote>
&lt;h2 id="dependencies">Dependencies&lt;/h2>
&lt;blockquote>
&lt;p>pip uninstall torch torchvision functorch tinycudann
pip install ninja git+&lt;a href="https://github.com/NVlabs/tiny-cuda-nn/#subdirectory=bindings/torch">https://github.com/NVlabs/tiny-cuda-nn/#subdirectory=bindings/torch&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>æ³¨æ„æ­¤å¤„å¯èƒ½æ— æ³•å®‰è£…tiny-cuda-nnï¼Œå¯ä»¥å…ˆè¿›è¡Œ&lt;/p>
&lt;blockquote>
&lt;p>git clone --recursive &lt;a href="https://github.com/nvlabs/tiny-cuda-nn">https://github.com/nvlabs/tiny-cuda-nn&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>åº”è¯¥å°±å¯ä»¥äº†&lt;/p>
&lt;blockquote>
&lt;p>pip install ninja /home/ubuntu/tiny-cuda-nn-master/bindings/torch #ä¸‹è½½è·¯å¾„&lt;/p>
&lt;/blockquote>
&lt;p>ä½†æ˜¯æˆ‘è¿™æ ·å­è™½ç„¶æˆåŠŸå®‰è£…ï¼Œä»ä¼šæŠ¥é”™ï¼š'MLP' object has no attribute 'layers'&lt;br />æœ€åè¿˜æ˜¯è¢«è¿«ç”¨git+æ–¹å¼æ¥å®‰è£…ï¼ˆç¿»å¢™ä¸‹è½½ï¼‰ï¼Œåç»­æ›´æ–°ï¼Œå¯ä»¥å°è¯•ï¼ˆæˆ‘è¿˜æ²¡è¯•è¿‡ï¼‰ï¼š&lt;/p>
&lt;blockquote>
&lt;p>git clone --recursive &lt;a href="https://github.com/nvlabs/tiny-cuda-nn">https://github.com/nvlabs/tiny-cuda-nn&lt;/a>
cd bindings/torch&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>conda activate nerfstudio
python setup.py install
æ¥æºï¼š&lt;a href="https://github.com/NVlabs/tiny-cuda-nn#pytorch-extension">https://github.com/NVlabs/tiny-cuda-nn#pytorch-extension&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h2 id="installing-nerfstudio">Installing nerfstudio&lt;/h2>
&lt;blockquote>
&lt;p>git clone &lt;a href="mailto:git@github.com">git@github.com&lt;/a>:nerfstudio-project/nerfstudio.git
cd nerfstudio
pip install --upgrade pip setuptools
pip install -e .
ns-install-cli ï¼ˆå¯é€‰å®‰è£…ï¼‰&lt;/p>
&lt;/blockquote>
&lt;h2 id="train-and-run-viewer">Train and run viewer&lt;/h2>
&lt;h1 id="download-some-test-data">Download some test data:&lt;/h1>
&lt;blockquote>
&lt;p>ns-download-data nerfstudio --capture-name=poster&lt;/p>
&lt;/blockquote>
&lt;h1 id="train-model">Train model&lt;/h1>
&lt;blockquote>
&lt;p>ns-train nerfacto --data data/nerfstudio/poster&lt;/p>
&lt;/blockquote></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/tech/">tech</category><category domain="https://keepjolly.com/tags/computervision/">ComputerVision</category><category domain="https://keepjolly.com/tags/ubuntu/">Ubuntu</category></item><item><title>ubuntuå¤šç‰ˆæœ¬ç®¡ç†</title><link>https://keepjolly.com/posts/tech/ubuntu-multi-version-management/</link><guid isPermaLink="true">https://keepjolly.com/posts/tech/ubuntu-multi-version-management/</guid><pubDate>Sun, 28 May 2023 09:33:29 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;blockquote>
&lt;p>é»˜è®¤å·²å®‰è£…
sudo apt-get install build-essential
sudo apt-get install cmake git libgtk2.0-dev pkg-config libavcodec-dev libavformat-dev libswscale-dev
sudo apt-get install python-dev python-numpy libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev libjasper-dev libdc1394-22-dev&lt;/p>
&lt;/blockquote>
&lt;h2 id="ç®¡ç†gcc">ç®¡ç†GCC&lt;/h2>
&lt;ol>
&lt;li>å‰ææ˜¯å®‰è£…äº†å¤šä¸ªgccç‰ˆæœ¬ï¼Œå¯é‡‡å–å¦‚ä¸‹å‘½ä»¤&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>sudo apt-get install gcc-11 g++-11&lt;/p>
&lt;/blockquote>
&lt;ol start="2">
&lt;li>ç„¶åé€‰æ‹©è¦ä½¿ç”¨çš„gccç‰ˆæœ¬&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>update-alternatives &lt;em>--config gcc&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;ol start="3">
&lt;li>è¾“å…¥ä½ æƒ³ä½¿ç”¨çš„ç‰ˆæœ¬çš„åºå·ï¼Œå¦‚1&lt;/li>
&lt;li>æŸ¥çœ‹å½“å‰ç‰ˆæœ¬&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>gcc -v&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://lantern.cool/tool-linux-muti-gcc/index.html">å‚è€ƒé“¾æ¥&lt;/a>&lt;/p>
&lt;h2 id="ç®¡ç†opencv">ç®¡ç†opencv&lt;/h2>
&lt;ol>
&lt;li>ä¸‹è½½&lt;a href="https://github.com/opencv/opencv/archive/3.4.15.zip">æºæ–‡ä»¶&lt;/a>ï¼Œæœ¬æ–‡é€‰çš„æ˜¯opencv3.4.15 &lt;code>..source..&lt;/code>ç‰ˆæœ¬&lt;/li>
&lt;li>åœ¨ä»»æ„ç›®å½•ä¸‹åˆ›å»ºå­˜æ”¾opencvå®‰è£…è·¯å¾„&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">conda deactivate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir otherpackages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> otherpackages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir opencv3.4.15
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>è§£å‹ç¼©opencv-3.4.15.zipæ–‡ä»¶&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> opencv-3.4.15
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir build
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>cmake opencv&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cmake -D &lt;span class="nv">CMAKE_BUILD_TYPE&lt;/span>&lt;span class="o">=&lt;/span>RELEASE -D &lt;span class="nv">CMAKE_INSTALL_PREFIX&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;/home/yourusername/otherpackages/opencv3.4.15&amp;#34;&lt;/span> ..
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="5">
&lt;li>ç¼–è¯‘ &amp;amp;&amp;amp; å®‰è£…&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">make -j8 &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> sudo make install
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ²¡æŠ¥å…¶ä»–é”™è¯¯çš„è¯ï¼ŒOpenCVå·²ç»é¡ºåˆ©è¢«å®‰è£…åˆ°è‡ªå®šä¹‰è·¯å¾„otherpackages/opencv3.4.15ä¸­äº†&lt;/p>
&lt;ol start="6">
&lt;li>ä½¿ç”¨opencv
&lt;ol>
&lt;li>å°†otherpackagesä¸­çš„opencv3.4.15å¤åˆ¶åˆ°é¡¹ç›®è·¯å¾„
&lt;ol>
&lt;li>åœ¨qt.proä¸­ç²˜è´´ä»£ç &lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">INCLUDEPATH&lt;/span> &lt;span class="o">+=&lt;/span> ./opencv3415/include &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> ./opencv3415/include/opencv &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> ./opencv3415/include/opencv2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">LIBS&lt;/span> &lt;span class="o">+=&lt;/span> -L./opencv3415/lib -lopencv_core -lopencv_highgui &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -lopencv_imgcodecs -lopencv_imgproc -lopencv_videoio &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>å¦‚æœæ˜¯cmake&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">include_directories&lt;span class="o">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="si">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="si">}&lt;/span>/./opencv3415/include
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">set&lt;span class="o">(&lt;/span>link_libs &lt;span class="si">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="si">}&lt;/span>/./opencv3415/lib/libopencv_core.so
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="si">}&lt;/span>/./opencv3415/lib/libopencv_highgui.so
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="si">}&lt;/span>/./opencv3415/lib/libopencv_imgcodecs.so
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="si">}&lt;/span>/./opencv3415/lib/libopencv_imgproc.so
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="si">}&lt;/span>/./opencv3415/lib/libopencv_videoio.so
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">add_executable&lt;span class="o">(&lt;/span>main ./main.cpp&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">target_link_libraries&lt;span class="o">(&lt;/span>main &lt;span class="si">${&lt;/span>&lt;span class="nv">link_libs&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/510292490">å‚è€ƒåšå®¢&lt;/a>&lt;/p>
&lt;h2 id="ç®¡ç†cuda">ç®¡ç†cuda&lt;/h2>
&lt;ol>
&lt;li>åˆ é™¤åŸè½¯é“¾æ¥&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>cd /usr/local&lt;/p>
&lt;p>sudo unlink cuda&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>å»ºç«‹æ–°é“¾æ¥&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>sudo ln -snf /usr/local/&lt;code>..cuda-xx..&lt;/code> /usr/local/cuda&lt;/p>
&lt;p>cuda-xxæ˜¯æ–‡ä»¶å¤¹å&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>æŸ¥çœ‹å½“å‰ç‰ˆæœ¬&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>nvcc -V&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/410764884">å‚è€ƒé“¾æ¥&lt;/a>&lt;/p></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/tech/">tech</category><category domain="https://keepjolly.com/tags/ubuntu/">Ubuntu</category><category domain="https://keepjolly.com/tags/c-/">C++</category></item><item><title>MemEå…³é”®ç¾åŒ–</title><link>https://keepjolly.com/posts/create/meme-custom-important/</link><guid isPermaLink="true">https://keepjolly.com/posts/create/meme-custom-important/</guid><pubDate>Sat, 27 May 2023 19:59:46 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="hugoå‘">hugoå‘&lt;/h2>
&lt;ul>
&lt;li>ä½¿ç”¨shortcodeæ—¶ï¼Œæ— è®ºæ”¾ä½•å¤„éƒ½ä¼šç”Ÿæ•ˆï¼Œå¿…é¡»å–æ¶ˆshortcodeæ ¼å¼ï¼Œå¦‚ï¼š
&lt;ul>
&lt;li>{a(åŠ å…¥aç ´åshortcode){ music }}&lt;/li>
&lt;li>ç›®å‰å·²çŸ¥é—®é¢˜:ç›®å½•è·³è½¬æ— æ³•ç”Ÿæ•ˆ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="é…ç½®front-matter">é…ç½®front matter&lt;/h2>
&lt;p>ä½¿ç”¨&lt;a href="https://code.visualstudio.com/docs/editor/userdefinedsnippets">vscode snippet&lt;/a>å¿«æ·ç”Ÿæˆfront matter
å‚è€ƒåšå®¢ï¼š&lt;a href="https://moonbooth.com/hugo/vs-code/#vs-code-workflows-for-hugo">vs-code-workflows-for-hugo&lt;/a>ã€ &lt;a href="https://bingdoal.github.io/others/2021/12/markdown-snippets-not-working-in-vscode/">markdown-snippets-not-working-in-vscode&lt;/a>
åœ¨ä½¿ç”¨äº†obsidianåï¼ŒåŠ å…¥ä¸€äº›æ’ä»¶å¦‚quickaddç­‰ï¼Œä¼˜åŒ–äº†æ–‡ç« æ’°å†™ï¼Œä½†æ˜¯obsidianä¸èƒ½åœ¨ç½‘é¡µç«¯ç™»é™†ï¼Œè™½ç„¶å¤šä¸ªå¹³å°éƒ½æœ‰éƒ¨ç½²å®‰è£…åŒ…ï¼Œæ­¤å¤–&lt;strong>ä»…æ”¯æŒmdæ–‡ä»¶&lt;/strong>ä½¿æˆ‘ä¸èƒ½ç»§ç»­ä½¿ç”¨ä¸‹å»ã€‚
åæ¥æ²‰æ€ä¸€ä¸‹ç°æœ‰å†™æ–‡ç« æµç¨‹ï¼Œç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œå‘ç°æ˜¯ä¸èƒ½ç”Ÿæˆfront matterï¼Œæ•…ä¸œæ‰¾è¥¿æ‰¾ï¼Œç”šè‡³ä¸€åº¦åˆå›å½’åˆ°obsidianåï¼Œç»ˆäºå‘ç°vscodeçš„snippetï¼Œæ­£å¥½å‡ ä¹å®Œç¾ç¬¦åˆæˆ‘çš„éœ€æ±‚ï¼ˆä¸èƒ½è‡ªåŠ¨å‘ˆç°æ‰€æœ‰tagsï¼‰ã€‚
ç›®å‰æˆ‘çš„å†™ä½œæµç¨‹æ˜¯ï¼š&lt;/p>
&lt;ol>
&lt;li>è¯­é›€ä¸Šå†™å¥½æ–‡ç« åå¯¼å‡ºmd&lt;/li>
&lt;li>ç”¨pic-goæ’ä»¶pic-migrateè½¬æ¢è¯­é›€å›¾ç‰‡å¹¶ç”Ÿæˆæ–°mdæ–‡ä»¶&lt;/li>
&lt;li>åœ¨vscodeä¸ŠåŠ å…¥front matter&lt;/li>
&lt;li>åœ¨vscodeä¸Šä¸Šä¼ è‡³github&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;hugo post template&amp;#34;&lt;/span>&lt;span class="p">:{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;scope&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;markdown&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// Add comma separated ids of the languages where the snippet is applicable in the scope field.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nt">&amp;#34;prefix&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;post&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// trigger the snippet
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nt">&amp;#34;body&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="c1">// expanded and inserted where trigger
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s2">&amp;#34;---&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;title: ${TM_FILENAME/(.*)\\..+$/$1/}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;date: $CURRENT_YEAR-$CURRENT_MONTH-$CURRENT_DATE $CURRENT_HOUR:$CURRENT_MINUTE:$CURRENT_SECOND +0800&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;lastmod: &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;summary: &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;slug: $2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// url: www.keepjolly.com/tags/:slug/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s2">&amp;#34;toc: ${3|true,false|}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;rightToc: ${4|false,true|}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;categories: &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;- ${5|tech,learn,algorithm,error,create,other,life|}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;tags: &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;- ${6|ComputerVision,C++,LeetCode,Blog,Others,Install|}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;original: true&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;author: Rurouni&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;website: www.keepjolly.com&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;---&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;update time&amp;#34;&lt;/span>&lt;span class="p">:{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;scope&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;yaml&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;prefix&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;update&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;body&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;$CURRENT_YEAR-$CURRENT_MONTH-$CURRENT_DATE $CURRENT_HOUR:$CURRENT_MINUTE:$CURRENT_SECOND +0800&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å®Œæ•´å¯æ”¯æŒçš„&lt;a href="https://github.com/reuixiy/hugo-theme-meme#supported-front-matter">front-matter&lt;/a>ï¼Œè²Œä¼¼ä¹Ÿå¯ä»¥å®šåˆ¶ï¼Œè‡ªè¡Œç™¾åº¦å§&lt;/p>
&lt;h2 id="é…ç½®æœç´¢åŠŸèƒ½">é…ç½®æœç´¢åŠŸèƒ½&lt;/h2>
&lt;p>å‚è€ƒåšå®¢ï¼š&lt;a href="https://www.dreamsafari.info/2020/04/hugo-loveit-mod/#23-%E4%BF%AE%E6%94%B9algolia%E7%9A%84%E8%AE%BE%E7%BD%AE">ä¿®æ”¹algoliaçš„è®¾ç½®&lt;/a>ã€&lt;a href="https://edward852.github.io/post/hugo%E6%B7%BB%E5%8A%A0algolia%E6%90%9C%E7%B4%A2%E6%94%AF%E6%8C%81/">hugoæ·»åŠ algoliaæœç´¢æ”¯æŒ&lt;/a>&lt;/p>
&lt;h3 id="é…ç½®configtoml">é…ç½®config.toml&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Algolia çš„æœç´¢ç´¢å¼•&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">outputFormats&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Algolia&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">mediaType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;application/json&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">baseName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;algolia&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">isPlainText&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">notAlternative&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ‘˜è¦çš„å­—æ•°é™åˆ¶ æ­¤å¤„ç”¨äºalgoliaæ£€ç´¢&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">summaryLength&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">70&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Hugo çš„è¾“å‡ºæ§åˆ¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">outputs&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">page&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;HTML&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">home&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;HTML&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;SectionsAtom&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;SectionsRSS&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;SearchIndex&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;Algolia&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">section&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;HTML&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">taxonomy&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;HTML&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">term&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;HTML&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># èœå•é…ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c">## èœå•æ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">main&lt;/span>&lt;span class="p">]]&lt;/span> &lt;span class="c"># å¤šåŠ å…¥ä¸€ä¸ªæœç´¢æ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">weight&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">identifier&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;search&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">post&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;search&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">######################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Algolia search&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># è¯´æ˜ï¼šéœ€è¦å¼€å¯ `Algolia` åœ¨Hugo çš„è¾“å‡ºæ§åˆ¶ï¼Œä¸”éœ€è¦æ¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ¬¡å°†ç”Ÿæˆçš„ algolia.json æ–‡ä»¶ä¸Šä¼ åˆ°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Algolia&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">enableAlgoliaSearch&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">algoliaAppId&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">algoliaApiKey&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">algoliaIndexName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># è¯´æ˜ï¼šhttps://www.algolia.com/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="algoliaå®˜ç½‘æŸ¥æ‰¾key">algoliaå®˜ç½‘æŸ¥æ‰¾key&lt;/h3>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230527195908.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">
æˆ–è€…ç™»å½•åè®¿é—®&lt;a href="https://www.algolia.com/account/api-keys">ç½‘å€&lt;/a>ï¼Œç„¶åæ‰¾åˆ°å¯¹åº”Application IDã€ApiKeyã€IndexNameï¼Œæ‰¾ä¸åˆ°å¯ä»¥è‡ªè¡Œåœ¨å‚è€ƒåšå®¢ä¸­æŸ¥æ‰¾ã€‚&lt;/p>
&lt;h3 id="è¦†ç›–indexalgoliajsoné…ç½®">è¦†ç›–index.algolia.jsoné…ç½®&lt;/h3>
&lt;p>ç„¶ååœ¨åšå®¢ä¸»ç›®å½•/layoutsä¸‹æ–°å»ºindex.algolia.jsonæ¥è¦†ç›–memeä¸­çš„é…ç½®ï¼Œæ­¤å¤„å†…å®¹å‚è€ƒ&lt;a href="https://github.com/dreamsafari/LoveIt/blob/master/layouts/_default/list.algolia.json">dreamsafariçš„json&lt;/a>
æ­¤å¤„éœ€å¤šåŠ ä¸€ä¸ªå‚æ•°summaryï¼Œå†…å®¹ä¸ºcontentå†…å®¹ï¼Œæˆ–è€…$page.Summaryï¼ˆä½†æ˜¯æ­¤å¤„æ˜¾ç¤ºä¼šæ— æ³•è½¬ä¹‰å­—ç¬¦ï¼Œç›®å‰æ— æ³•è§£å†³ï¼Œä»¥ååº”è¯¥ä¹Ÿä¸ä¼šè§£å†³ï¼Œç­‰æœ‰ç¼˜äººï¼‰ï¼Œå¦åˆ™ä¼šæ˜¾ç¤ºundefined&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="err">{-&lt;/span> &lt;span class="err">range&lt;/span> &lt;span class="err">$i,&lt;/span> &lt;span class="err">$c&lt;/span> &lt;span class="err">:=&lt;/span> &lt;span class="err">$chunked&lt;/span> &lt;span class="err">-&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="err">{-&lt;/span> &lt;span class="err">$index&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">$index&lt;/span> &lt;span class="err">|&lt;/span> &lt;span class="err">append&lt;/span> &lt;span class="err">(dict&lt;/span> &lt;span class="nt">&amp;#34;objectID&amp;#34;&lt;/span> &lt;span class="err">(print&lt;/span> &lt;span class="err">$page.File.UniqueID&lt;/span> &lt;span class="s2">&amp;#34;_&amp;#34;&lt;/span> &lt;span class="err">$i)&lt;/span> &lt;span class="s2">&amp;#34;order&amp;#34;&lt;/span> &lt;span class="err">$i&lt;/span> &lt;span class="s2">&amp;#34;title&amp;#34;&lt;/span> &lt;span class="err">$page.Title&lt;/span> &lt;span class="s2">&amp;#34;date&amp;#34;&lt;/span> &lt;span class="err">$page.Date&lt;/span> &lt;span class="s2">&amp;#34;url&amp;#34;&lt;/span> &lt;span class="err">$page.Permalink&lt;/span> &lt;span class="s2">&amp;#34;tags&amp;#34;&lt;/span> &lt;span class="err">$page.Params.tags&lt;/span> &lt;span class="s2">&amp;#34;categories&amp;#34;&lt;/span> &lt;span class="err">$page.Params.Categories&lt;/span> &lt;span class="s2">&amp;#34;summary&amp;#34;&lt;/span> &lt;span class="err">$c)&lt;/span> &lt;span class="err">-&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="err">{-&lt;/span> &lt;span class="err">end&lt;/span> &lt;span class="err">-&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ä¿®æ”¹algoliaæœç´¢é…ç½®">ä¿®æ”¹algoliaæœç´¢é…ç½®&lt;/h3>
&lt;p>æ­¤å¤„é…ç½®æœç´¢é€‰é¡¹ï¼Œå‚è€ƒ&lt;a href="https://www.dreamsafari.info/2020/04/hugo-loveit-mod/#23-%E4%BF%AE%E6%94%B9algolia%E7%9A%84%E8%AE%BE%E7%BD%AE">ä¿®æ”¹algoliaçš„è®¾ç½®&lt;/a>
&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230527195908-1.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;h3 id="è‡ªåŠ¨ä¸Šä¼ algoliajson">è‡ªåŠ¨ä¸Šä¼ algolia.json&lt;/h3>
&lt;p>è¯¦è§github actionå¤„&lt;/p>
&lt;h2 id="é…ç½®abouté¡µåŠè§†é¢‘">é…ç½®abouté¡µåŠè§†é¢‘&lt;/h2>
&lt;h3 id="è§†é¢‘">è§†é¢‘&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">video&lt;/span> &lt;span class="na">src&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;QmTz7jzWdGrTVKT7YwNwX9cEgfg4smNFHVxnaFDR82BrXt&amp;#34;&lt;/span> &lt;span class="na">poster&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;../images/Gypsy Heart.jpg&amp;#34;&lt;/span> &lt;span class="na">controls&lt;/span> &lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> å¦‚éœ€ä¸‹è½½ï¼š&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;https://gateway.pinata.cloud/ipfs/QmTz7jzWdGrTVKT7YwNwX9cEgfg4smNFHVxnaFDR82BrXt&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>MP4&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">video&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">config.toml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ˜¯å¦å¼€å¯
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">enableVideoHost = true # ç›¸å¯¹è·¯å¾„è·å–å›¾ç‰‡ï¼Œç”¨äºposterå±æ€§
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># è§†é¢‘å¤–é“¾åœ°å€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">videoHostURL = &amp;#34;https://gateway.pinata.cloud/ipfs/&amp;#34; # ç”¨äºsrcå±æ€§ï¼Œä½¿å…¶é“¾æ¥å¹²å‡€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># !!å¿…é¡»srcå¼€å¤´ï¼Œå¦åˆ™æ— æ³•è¯†åˆ«åˆ°hash!!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸ºäº†ä½¿å°é¢å›¾posterä¸è§†é¢‘é€‚é…ï¼š
&lt;a href="https://stackoverflow.com/questions/10826784/make-html5-video-poster-be-same-size-as-video-itself">è®¾ç½®object-fit: æ— æ•ˆ&lt;/a>ï¼Œè¢«è¿«å‰ªè£å›¾ç‰‡ä»¥é€‚é…è§†é¢‘ã€‚&lt;/p>
&lt;h3 id="éŸ³ä¹">éŸ³ä¹&lt;/h3>
&lt;p>å¦‚æœæƒ³é…ç½®&lt;a href="https://tianheg.xyz/posts/hugo-toc-conflicts-with-aplayer/">éŸ³ä¹&lt;/a>&lt;/p>
&lt;ol>
&lt;li>æ ¹ç›®å½•ä¸‹çš„layouts\shortcodes\åˆ›å»ºmusic.html&lt;/li>
&lt;/ol>
&lt;p>è¯¥ä»£ç åŒæ—¶æ”¯æŒåˆ—è¡¨å’Œå•æ›²æ¨¡å¼&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-css" data-lang="css">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;!&lt;/span>&lt;span class="nt">--&lt;/span> &lt;span class="nt">ä½¿ç”¨meting-jsçš„æ–¹å¼&lt;/span> &lt;span class="nt">https&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nt">immmmm&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nt">hugo-shortcodes-music&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nt">--&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;!&lt;/span>&lt;span class="nt">--&lt;/span> &lt;span class="nt">require&lt;/span> &lt;span class="nt">APlayer&lt;/span> &lt;span class="nt">https&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nt">aplayer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">js&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">org&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">#&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nt">zh-Hans&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nt">id&lt;/span>&lt;span class="o">=%&lt;/span>&lt;span class="nt">E5&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="nt">85&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="nt">A5&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="nt">E9&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="nt">97&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="nt">A8&lt;/span> &lt;span class="nt">--&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nt">link&lt;/span> &lt;span class="nt">rel&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;stylesheet&amp;#34;&lt;/span> &lt;span class="nt">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css&amp;#34;&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span> &lt;span class="nt">src&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js&amp;#34;&lt;/span>&lt;span class="o">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="err">{-&lt;/span> &lt;span class="err">if&lt;/span> &lt;span class="err">.IsNamedParams&lt;/span> &lt;span class="err">-&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="nt">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;player&amp;#34;&lt;/span>&lt;span class="o">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="err">{-&lt;/span> &lt;span class="err">if&lt;/span> &lt;span class="err">.Get&lt;/span> &lt;span class="err">&amp;#34;url&amp;#34;&lt;/span> &lt;span class="err">-&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">const&lt;/span> &lt;span class="nt">ap1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nt">new&lt;/span> &lt;span class="nt">APlayer&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">container&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">document&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nf">getElementById&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;player&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">lrcType&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">audio&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `name` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">artist&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `artist` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `url` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kc">cover&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `cover` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">lrc&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `lrc` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">theme&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;#f44336&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">}&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="err">{-&lt;/span> &lt;span class="err">else&lt;/span> &lt;span class="err">if&lt;/span> &lt;span class="err">.Get&lt;/span> &lt;span class="err">&amp;#34;auto&amp;#34;&lt;/span> &lt;span class="err">-&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">const&lt;/span> &lt;span class="nt">ap&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nt">new&lt;/span> &lt;span class="nt">APlayer&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">container&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">document&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nf">getElementById&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;player&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mini&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">autoplay&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">theme&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;#FADFA3&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">loop&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;all&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">order&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;random&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">preload&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;auto&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">volume&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mf">0.7&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mutex&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listFolded&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listMaxHeight&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">90&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">lrcType&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">audio&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `name1` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">artist&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `artist1` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `url1` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kc">cover&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `cover1` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">lrc&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `lrc1` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">theme&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;#f44336&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;span class="o">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `name2` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">artist&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `artist2` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `url2` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kc">cover&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `cover2` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">lrc&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;{{ .Get `lrc2` }}&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">theme&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;#46718b&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">}&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="err">{-&lt;/span> &lt;span class="err">end&lt;/span> &lt;span class="err">-&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="err">{-&lt;/span> &lt;span class="err">end&lt;/span> &lt;span class="err">-&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>åœ¨about/_index.mdä¸­ä¿®æ”¹ä»£ç &lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-css" data-lang="css">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="err">a(å»æ‰a){&amp;lt;&lt;/span> &lt;span class="err">music&lt;/span> &lt;span class="err">url=&amp;#34;xxx.mp3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">name=&amp;#34;Try&amp;#34;&lt;/span> &lt;span class="err">artist=&amp;#34;Colbie&lt;/span> &lt;span class="err">Caillat&amp;#34;&lt;/span> &lt;span class="err">cover=&amp;#34;../songs/Gypsy&lt;/span> &lt;span class="err">Heart&lt;/span> &lt;span class="err">song.jpg&amp;#34;&lt;/span> &lt;span class="err">lrc=&amp;#34;xxx.lrc&amp;#34;&amp;gt;&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>åœ¨assets\scss\custom_custom.scssä¸­ä¿®æ”¹æš—å¤œæ ·å¼&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-css" data-lang="css">&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="nt">Aplayer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="nd">root&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="nt">data-theme&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;light&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">.aplayer-pic{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#b7daff&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="nd">root&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="nt">data-theme&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;dark&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">.aplayer&lt;/span> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#212121&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-withlist&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-info&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">border-bottom-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#5c5c5c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-fixed&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">border-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#5c5c5c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-body&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#212121&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-info&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">border-top-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#212121&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-info&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-music&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-title&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#fff&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-info&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-music&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-author&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#fff&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-info&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-controller&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-time&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#eee&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-info&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-controller&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-time&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-icon&lt;/span> &lt;span class="nt">path&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fill&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#eee&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#212121&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="nd">-webkit-scrollbar-thumb&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#999&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="nd">-webkit-scrollbar-thumb&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nd">hover&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#bbb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list&lt;/span> &lt;span class="nt">li&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#fff&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">border-top-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#666&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list&lt;/span> &lt;span class="nt">li&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nd">hover&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#4e4e4e&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list&lt;/span> &lt;span class="nt">li&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list-light&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#6c6c6c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list&lt;/span> &lt;span class="nt">li&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list-index&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#ddd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list&lt;/span> &lt;span class="nt">li&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-list-author&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#ddd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-lrc&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">text-shadow&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">-1&lt;/span>&lt;span class="kt">px&lt;/span> &lt;span class="mi">-1&lt;/span>&lt;span class="kt">px&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mh">#666&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-lrc&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nd">before&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kp">-moz-&lt;/span>&lt;span class="nb">linear-gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">top&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#212121&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">rgba&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kp">-webkit-&lt;/span>&lt;span class="nb">linear-gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">top&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#212121&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">rgba&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">linear-gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">to&lt;/span> &lt;span class="kc">bottom&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#212121&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">rgba&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">filter&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">progid&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="n">DXImageTransform&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Microsoft&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nf">gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">startColorstr&lt;/span>&lt;span class="err">=&lt;/span>&lt;span class="s1">&amp;#39;#212121&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">endColorstr&lt;/span>&lt;span class="err">=&lt;/span>&lt;span class="s1">&amp;#39;#00212121&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GradientType&lt;/span>&lt;span class="err">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-lrc&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nd">after&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kp">-moz-&lt;/span>&lt;span class="nb">linear-gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">top&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">rgba&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">rgba&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kp">-webkit-&lt;/span>&lt;span class="nb">linear-gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">top&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">rgba&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">rgba&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">linear-gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">to&lt;/span> &lt;span class="kc">bottom&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">rgba&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">rgba&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">filter&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">progid&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="n">DXImageTransform&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Microsoft&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nf">gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">startColorstr&lt;/span>&lt;span class="err">=&lt;/span>&lt;span class="s1">&amp;#39;#00212121&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">endColorstr&lt;/span>&lt;span class="err">=&lt;/span>&lt;span class="s1">&amp;#39;#cc212121&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GradientType&lt;/span>&lt;span class="err">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-lrc&lt;/span> &lt;span class="nt">p&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#fff&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-miniswitcher&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#484848&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-miniswitcher&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nc">aplayer-icon&lt;/span> &lt;span class="nt">path&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fill&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#eee&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="é…ç½®è§†é¢‘ä»‹ç»æ–‡å­—">é…ç½®è§†é¢‘ä»‹ç»æ–‡å­—&lt;/h4>
&lt;ol>
&lt;li>_index.md&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">h2&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;try&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>Try&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">h2&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;lt;!-- &amp;lt;p style=&amp;#34;text-align:center&amp;#34; class=&amp;#34;colbie&amp;#34;&amp;gt;Colbie Caillat&amp;lt;/p&amp;gt; --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">p&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;text-align:center&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">em&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You don&amp;#39;t have to try so hard&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">br&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You don&amp;#39;t have to, give it all away&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">br&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You just have to get up, get up, get up, get up&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">br&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You don&amp;#39;t have to change a single thing&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">em&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>config.toml&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ç½‘ç»œå­—ä½“é“¾æ¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fontsLink&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;700&amp;amp;family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&amp;amp;family=Cinzel+Decorative:wght@700&amp;amp;display=swap&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>assets/scss/custom/_custom.scss&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-css" data-lang="css">&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="nt">abouté¡µ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nc">try&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="err">//&lt;/span> &lt;span class="err">io-oi.me&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">margin-top&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="kt">px&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">text-align&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">center&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">font-family&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;Cinzel Decorative&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">serif&lt;/span> &lt;span class="cp">!important&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-image&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">linear-gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">90&lt;/span>&lt;span class="kt">deg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#f37055&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#ef4e7b&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#f37055&lt;/span> &lt;span class="mi">45&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#a166ab&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#f37055&lt;/span> &lt;span class="mi">55&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#ef4e7b&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#f37055&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">cover&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-clip&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">text&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">-webkit-&lt;/span>&lt;span class="k">background-clip&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">text&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">-webkit-&lt;/span>&lt;span class="n">text-fill-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">transparent&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nc">colbie&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">text-align&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">center&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">font-family&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;Cinzel Decorative&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">serif&lt;/span> &lt;span class="cp">!important&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-image&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">linear-gradient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">90&lt;/span>&lt;span class="kt">deg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#f37055&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#ef4e7b&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#f37055&lt;/span> &lt;span class="mi">45&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#a166ab&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#f37055&lt;/span> &lt;span class="mi">55&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#ef4e7b&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">#f37055&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">cover&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-clip&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">text&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">-webkit-&lt;/span>&lt;span class="k">background-clip&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">text&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">-webkit-&lt;/span>&lt;span class="n">text-fill-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">transparent&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="nt">https&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nt">io-oi&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">me&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nt">tech&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nt">get-started-with-variable-fonts&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">@&lt;/span>&lt;span class="k">font-face&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-family&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;Amstelvar&amp;#39;&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-display&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">swap&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">src&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">url&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;#{$baseRelURL}/fonts/Amstelvar-Italic-VF.woff2&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="nt">format&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;woff2-variations&amp;#39;&lt;/span>&lt;span class="o">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">url&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;#{$baseRelURL}/fonts/Amstelvar-Italic-VF.woff2&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="nt">format&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;woff2&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-weight&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">100&lt;/span> &lt;span class="nt">900&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-stretch&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">50&lt;/span>&lt;span class="o">%&lt;/span> &lt;span class="nt">125&lt;/span>&lt;span class="o">%;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-style&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">italic&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">@&lt;/span>&lt;span class="k">font-face&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-family&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;Amstelvar&amp;#39;&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-display&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">swap&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">src&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">url&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;#{$baseRelURL}/fonts/Amstelvar-Roman-VF.woff2&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="nt">format&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;woff2-variations&amp;#39;&lt;/span>&lt;span class="o">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">url&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;#{$baseRelURL}/fonts/Amstelvar-Roman-VF.woff2&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="nt">format&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;woff2&amp;#39;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-weight&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">100&lt;/span> &lt;span class="nt">900&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-stretch&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">50&lt;/span>&lt;span class="o">%&lt;/span> &lt;span class="nt">125&lt;/span>&lt;span class="o">%;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">font-style&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">normal&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">body&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">font-family&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;Amstelvar&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Noto Serif SC&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">serif&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="nd">root&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">--text-wdth&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">90&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">--text-opsz&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">--text-YTLC&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">460&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">body&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">font-variation-settings&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;wdth&amp;#39;&lt;/span> &lt;span class="nf">var&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="kc">text&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">wdth&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;opsz&amp;#39;&lt;/span> &lt;span class="nf">var&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="kc">text&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">opsz&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;YTLC&amp;#39;&lt;/span> &lt;span class="nf">var&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="kc">text&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">YTLC&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nc">post-title&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">font-family&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;glyph-correction&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Amstelvar&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Noto Serif SC&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">serif&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">font-variation-settings&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;wght&amp;#39;&lt;/span> &lt;span class="mi">550&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;opsz&amp;#39;&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;YOPQ&amp;#39;&lt;/span> &lt;span class="mi">90&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nc">list-item-time&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">font-feature-settings&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;tnum&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">blockquote&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">quote&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">position&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">relative&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">margin&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="kt">em&lt;/span> &lt;span class="kc">auto&lt;/span> &lt;span class="cp">!important&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">padding-left&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="kt">em&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">inherit&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">border&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">none&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">p&lt;/span> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">text-indent&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="cp">!important&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="nd">before&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">position&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">absolute&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">left&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">content&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;â€œ&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">font-size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="kt">em&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">font-weight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">bold&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">line-height&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">poetry&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">display&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">table&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">padding&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&amp;amp;::before&lt;/span> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">left&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">-1&lt;/span>&lt;span class="kt">em&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">p&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">margin&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="kt">em&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">p&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nd">last-child&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">margin&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">en&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">p&lt;/span> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">line-height&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">1.618&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">text-align&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">left&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">hyphens&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">auto&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">-webkit-&lt;/span>&lt;span class="k">hyphens&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">auto&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">-moz-&lt;/span>&lt;span class="k">hyphens&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">auto&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">italic&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">p&lt;/span> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">font-style&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">italic&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">@&lt;/span>&lt;span class="k">media&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nt">max-width&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="nt">maxWidth&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">blockquote&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">quote&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&amp;amp;.poetry&lt;/span> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">padding-left&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="kt">em&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&amp;amp;::before&lt;/span> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">left&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="é…ç½®tocåˆ°é¡µé¢å³è¾¹">é…ç½®tocåˆ°é¡µé¢å³è¾¹&lt;/h2>
&lt;p>&lt;a href="https://yyqx.online/posts/%E5%8D%9A%E5%AE%A2%E4%BE%A7%E8%BE%B9%E5%AF%BC%E8%88%AA%E6%A0%8F/">å‚è€ƒåšå®¢&lt;/a>
åŸæœ¬æƒ³å®ç°æ»šåŠ¨åŠ¨ç”»çš„ï¼ŒæŠ€æœ¯åŠ›ä¸å¤Ÿï¼Œç­‰å¤§ä½¬&lt;/p>
&lt;h3 id="åˆ›å»ºmytochtml">åˆ›å»ºmytoc.html&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;lt;!-- æ³¨æ„éœ€è¦åœ¨é¡µé¢çš„front-matterä¸­tocï¼šfalseå¹¶rightTocï¼štrue --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ if (.Params.rightToc | default false ) }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;post-toc&amp;#34;&lt;/span> &lt;span class="na">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;post-toc&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">aside&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">header&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">h4&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>æ–‡ç« ã®å­—æ•°: {{ .WordCount }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">h4&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">header&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ $emtLiPtrn := &amp;#34;(?s)&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>\\s&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>\\s&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>(.*)&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>\\s&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&amp;#34; }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ $rplcEmtLi := &amp;#34;&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>$1&amp;#34; }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ .TableOfContents | replaceRE $emtLiPtrn $rplcEmtLi | safeHTML }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c">&amp;lt;!-- https://github.com/gohugoio/hugo/issues/1778#issuecomment-483880269 --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c">&amp;lt;!-- {{.TableOfContents}} --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">aside&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;#&amp;#34;&lt;/span> &lt;span class="na">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;toc-toggle&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ end }}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="åˆ›å»ºsinglehtml">åˆ›å»ºsingle.html&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">{{ define &amp;#34;main&amp;#34; }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ partial &amp;#34;pages/post.html&amp;#34; . }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;lt;!-- å°†ä¸»é¢˜çš„singleå¤åˆ¶åæ–°åŠ çš„å†…å®¹ --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class &lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;toc-wrapper&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ partial &amp;#34;mytoc.html&amp;#34; . }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ end }}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ä¿®æ”¹_customscssæ ·å¼">ä¿®æ”¹_custom.scssæ ·å¼&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-css" data-lang="css">&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nc">post-toc&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">position&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">fixed&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">right&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="kt">px&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">max-width&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">overflow&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">auto&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">top&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="kt">%&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">width&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">25&lt;/span>&lt;span class="kt">vw&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">bottom&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">30&lt;/span>&lt;span class="kt">px&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nc">toc-wrapper&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">::&lt;/span>&lt;span class="kp">-webkit-&lt;/span>&lt;span class="err">scrollbar&lt;/span> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">width&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="kt">px&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">height&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="kt">px&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">::&lt;/span>&lt;span class="nd">-webkit-scrollbar-thumb&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">height&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="kt">px&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#eee&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">border-radius&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="kt">px&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&amp;amp;:hover&lt;/span> &lt;span class="err">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">background-color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mh">#ddd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">@&lt;/span>&lt;span class="k">media&lt;/span> &lt;span class="nt">only&lt;/span> &lt;span class="nt">screen&lt;/span> &lt;span class="nt">and&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nt">max-width&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nt">1224px&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nc">post-toc&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">display&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">none&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="é…ç½®è±†ç“£çŸ­ç ">é…ç½®è±†ç“£çŸ­ç &lt;/h2>
&lt;h3 id="åˆ›å»ºdoubanmd">åˆ›å»ºdouban.md&lt;/h3>
&lt;p>xxx\layouts\shortcodes ä¸‹åˆ›å»ºdouban.md&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">{{ $dbUrl := .Get 0 }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ $dbApiUrl := &amp;#34;https://neodb.social/api/&amp;#34; }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ $dbType := &amp;#34;&amp;#34; }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ if ( findRE `^.*neodb\.social\/.*` $dbUrl ) }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ $dbType = replaceRE `.*neodb.social\/(.*\/.*)` &amp;#34;$1&amp;#34; $dbUrl }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ else }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ $dbType = $dbUrl }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ $dbApiUrl = &amp;#34;https://neodb.social/api/catalog/fetch?url=&amp;#34; }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ end }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ $dbFetch := getJSON $dbApiUrl $dbType }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{ if $dbFetch }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ $itemRating := 0 }}{{ with $dbFetch.rating }}{{ $itemRating = . }}{{ end }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;db-card&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;db-card-subject&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;db-card-post&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">img&lt;/span> &lt;span class="na">loading&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;lazy&amp;#34;&lt;/span> &lt;span class="na">decoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;async&amp;#34;&lt;/span> &lt;span class="na">referrerpolicy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;no-referrer&amp;#34;&lt;/span> &lt;span class="na">src&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ $dbFetch.cover_image_url }}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;db-card-content&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;db-card-title&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ $dbUrl }}&amp;#34;&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;cute&amp;#34;&lt;/span> &lt;span class="na">target&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;_blank&amp;#34;&lt;/span> &lt;span class="na">rel&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;noreferrer&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ $dbFetch.title }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;rating&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">span&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;allstardark&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">span&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;allstarlight&amp;#34;&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;width:{{mul 10 $itemRating }}%&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">span&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">span&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">span&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;rating_nums&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ $itemRating }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">span&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;db-card-abstract&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ $dbFetch.brief }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;db-card-cate&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ $dbFetch.category }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{else}}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">p&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;text-align: center;&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">small&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>è¿œç¨‹è·å–å†…å®¹å¤±è´¥ï¼Œè¯·æ£€æŸ¥ API æœ‰æ•ˆæ€§ã€‚&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">small&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{{end}}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ä¿®æ”¹customscssæ ·å¼">ä¿®æ”¹custom.scssæ ·å¼&lt;/h3>
&lt;p>åœ¨æºæ–‡ä»¶ä¸‹è¿½åŠ ï¼Œä¿®æ”¹äº†ä¸€äº›æ ·å¼ï¼Œä½¿å…¶æ›´é€‚é…Meme&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">// douban (api unstable)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.db-card{background:#fafafa;border-radius: 5px;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.db-card-subject{display: flex;align-items:flex-start;line-height:1.6;padding:12px;position:relative;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.dark .db-card{background:#252627;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.db-card-content {flex:1 1 auto;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.db-card-post {width: 96px;margin-right: 15px;display: flex;flex: 0 0 auto;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.db-card-title {margin-bottom: 5px;font-size: 18px;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.db-card-title a{text-decoration: none!important}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.db-card-abstract,.db-card-comment{font-size:14px;overflow: hidden;max-height:4rem;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.db-card-cate{position: absolute;top:0;right:0;background:#f99b01;padding:1px 8px;font-size:small;font-style:italic;border-radius:0 8px 0 8px;text-transform:capitalize;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.db-card-post img{margin:0;width: 96px!important;border-radius: 5px;-o-object-fit: cover;object-fit: cover;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.rating{margin: 0 0 5px;font-size:13px;line-height: 1;display: flex;align-items: center;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.rating .allstardark{position:relative;color: #f99b01;height: 16px;width: 80px;background-size: auto 100%;margin-right: 8px;background-repeat: repeat;background-image: url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxwYXRoIGQ9Ik05MDguMSAzNTMuMWwtMjUzLjktMzYuOUw1NDAuNyA4Ni4xYy0zLjEtNi4zLTguMi0xMS40LTE0LjUtMTQuNS0xNS44LTcuOC0zNS0xLjMtNDIuOSAxNC41TDM2OS44IDMxNi4ybC0yNTMuOSAzNi45Yy03IDEtMTMuNCA0LjMtMTguMyA5LjMtMTIuMyAxMi43LTEyLjEgMzIuOS42IDQ1LjNsMTgzLjcgMTc5LjEtNDMuNCAyNTIuOWMtMS4yIDYuOS0uMSAxNC4xIDMuMiAyMC4zIDguMiAxNS42IDI3LjYgMjEuNyA0My4yIDEzLjRMNTEyIDc1NGwyMjcuMSAxMTkuNGM2LjIgMy4zIDEzLjQgNC40IDIwLjMgMy4yIDE3LjQtMyAyOS4xLTE5LjUgMjYuMS0zNi45bC00My40LTI1Mi45IDE4My43LTE3OS4xYzUtNC45IDguMy0xMS4zIDkuMy0xOC4zIDIuNy0xNy41LTkuNS0zMy43LTI3LTM2LjN6TTY2NC44IDU2MS42bDM2LjEgMjEwLjNMNTEyIDY3Mi43IDMyMy4xIDc3MmwzNi4xLTIxMC4zLTE1Mi44LTE0OUw0MTcuNiAzODIgNTEyIDE5MC43IDYwNi40IDM4MmwyMTEuMiAzMC43LTE1Mi44IDE0OC45eiIgZmlsbD0iI2Y5OWIwMSIvPjwvc3ZnPg==);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.rating .allstarlight{position: absolute;left: 0;color: #f99b01;height:16px;overflow: hidden;background-size: auto 100%;background-repeat: repeat;background-image: url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxwYXRoIGQ9Ik05MDguMSAzNTMuMWwtMjUzLjktMzYuOUw1NDAuNyA4Ni4xYy0zLjEtNi4zLTguMi0xMS40LTE0LjUtMTQuNS0xNS44LTcuOC0zNS0xLjMtNDIuOSAxNC41TDM2OS44IDMxNi4ybC0yNTMuOSAzNi45Yy03IDEtMTMuNCA0LjMtMTguMyA5LjMtMTIuMyAxMi43LTEyLjEgMzIuOS42IDQ1LjNsMTgzLjcgMTc5LjEtNDMuNCAyNTIuOWMtMS4yIDYuOS0uMSAxNC4xIDMuMiAyMC4zIDguMiAxNS42IDI3LjYgMjEuNyA0My4yIDEzLjRMNTEyIDc1NGwyMjcuMSAxMTkuNGM2LjIgMy4zIDEzLjQgNC40IDIwLjMgMy4yIDE3LjQtMyAyOS4xLTE5LjUgMjYuMS0zNi45bC00My40LTI1Mi45IDE4My43LTE3OS4xYzUtNC45IDguMy0xMS4zIDkuMy0xOC4zIDIuNy0xNy41LTkuNS0zMy43LTI3LTM2LjN6IiBmaWxsPSIjZjk5YjAxIi8+PC9zdmc+);}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@media (max-width:550px) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .db-card{margin:0.8rem 1rem;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .db-card-comment{display: none;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹&lt;/h3>
&lt;ul>
&lt;li>æ‰€ç»™apiå¯èƒ½ä¸ç¨³å®šï¼Œå¯èƒ½éœ€è¦æ›´æ¢ã€‚&lt;/li>
&lt;li>ä¹Ÿå¯ä»¥è¯•è¯•&lt;a href="https://blog.yandaojiang.com/posts/others/hugo_shortcodes%E7%A4%BA%E4%BE%8B/#%E8%B1%86%E7%93%A3%E6%9D%A1%E7%9B%AE">æœ¬åœ°ç¼“å­˜&lt;/a>&lt;/li>
&lt;li>ä½¿ç”¨ï¼š
&lt;ul>
&lt;li>{a(å»æ‰a){&amp;lt; douban(shortcode_name) &amp;quot;https://book.douban.com/subject/35496106/&amp;quot;&amp;gt;}}&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å‚è€ƒç½‘å€ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://immmmm.com/post-show-douban-item/">æ–‡ç« å†…æ˜¾ç¤ºè±†ç“£æ¡ç›®&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://immmmm.com/hugo-shortcodes-douban/">Hugo è±†ç“£çŸ­ä»£ç &lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.sulvblog.cn/posts/blog/shortcodes/#5-%e5%bc%95%e5%85%a5%e8%b1%86%e7%93%a3%e9%98%85%e8%af%bb%e5%92%8c%e7%94%b5%e5%bd%b1%e5%8d%a1%e7%89%87">å¼•å…¥è±†ç“£ï¼ˆæš‚æ—¶æ²¡ç”¨ï¼‰&lt;/a>&lt;/li>
&lt;/ul></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/create/">create</category><category domain="https://keepjolly.com/tags/blog/">Blog</category></item><item><title>MemEç¾åŒ–1</title><link>https://keepjolly.com/posts/create/meme-custom-1/</link><guid isPermaLink="true">https://keepjolly.com/posts/create/meme-custom-1/</guid><pubDate>Sat, 27 May 2023 19:51:00 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="è®¾ç½®ä¸ºsection">è®¾ç½®ä¸ºsection&lt;/h2>
&lt;p>æ–‡ç« è·¯å¾„æ”¾åœ¨ blog/content/posts ï¼Œå…¶å†…æ¯ä¸ªæ–‡ä»¶å¤¹å¿…é¡»æœ‰ä¸ª_index.mdæ–‡ä»¶ï¼Œä¸ºç©ºæ²¡äº‹ï¼Œå¹¶ä¸”postsä¸‹ä¹Ÿéœ€è¦æœ‰ã€‚&lt;/p>
&lt;p>å¦‚æœéœ€è¦åœ¨ç¬¬ä¸€ä¸ªsectionå†…åˆ›å»ºæ–‡ä»¶å¤¹ä½†æ˜¯ä¸æ˜¾ç¤ºè¯¥æ–‡ä»¶å¤¹åå¯ä»¥é…ç½®Permalinkså±æ€§ä¸º&lt;/p>
&lt;p>[permalinks]
posts = '/posts/:sections[1]/:slug/'&lt;/p>
&lt;p>&lt;a href="https://gohugo.io/content-management/urls/#permalinks">url pattern&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>.
â””â”€â”€ content
â””â”€â”€ about
| â””â”€â”€ index.md // &amp;lt;- https://example.com/about/
â”œâ”€â”€ posts
| â”œâ”€â”€ _index.md // &amp;lt;- https://example.com/posts/
| â”œâ”€â”€ firstpost.md // &amp;lt;- https://example.com/posts/firstpost/
| â”œâ”€â”€ happy
| | â””â”€â”€ ness.md // &amp;lt;- https://example.com/posts/ness/ ä¸æ˜¾ç¤ºhappy
| â””â”€â”€ secondpost.md // &amp;lt;- https://example.com/posts/secondpost/
â””â”€â”€ quote
â”œâ”€â”€ first.md // &amp;lt;- https://example.com/quote/first/
â””â”€â”€ second.md // &amp;lt;- https://example.com/quote/second/
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">######################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ†ç±»æ–¹å¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># MemE ä¸»é¢˜æ”¯æŒä»¥ä¸‹ä¸¤ç§åˆ†ç±»æ–¹å¼ï¼š&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 1. sections åˆ†åŒº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 2. categories éƒ¨ç±»&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å…¶ä¸­ï¼Œåˆ†åŒºæ˜¯åŸºäºç«™ç‚¹çš„ content ç›®å½•ä¸‹çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ–‡ä»¶å¤¹å’Œå­æ–‡ä»¶å¤¹ï¼›éƒ¨ç±»æ˜¯åŸºäºæ–‡ç« çš„ Front&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Matterã€‚åˆ†ç±»å³æ ‘çŠ¶åˆ†ç±»ï¼ŒHexo æ˜¯åŸºäºæ–‡ç« &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># çš„ Front Matterï¼ŒHugo åˆ™æ˜¯åŸºäºæ–‡ä»¶ç³»ç»Ÿ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># çš„ç»“æ„ã€‚ç”±äºè®¾è®¡ç†å¿µçš„ä¸åŒï¼Œå¯¼è‡´äº† Hexo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸ Hugo çš„è¿™ä¸ªå·®å¼‚ï¼Œæ•…åœ¨æ­¤è®¾è®¡è¿™ä¸ªé€‰é¡¹ï¼Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä»¥å¯¹ä» Hexo è¿‡æ¥çš„ç”¨æˆ·å‹å¥½ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼š&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Hugo ä¸­æ— æ³•å®Œå…¨å®ç°åŸºäº Front Matter&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># çš„æ ‘çŠ¶åˆ†ç±»ï¼Œæ•…å¦‚éœ€ä¿ç•™æ ‘çŠ¶åˆ†ç±»ï¼Œå»ºè®®é€‚åº”&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Hugo çš„è®¾è®¡ç†å¿µâ€”â€”åˆ†åŒºã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">categoryBy&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;sections&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ³¨æ„ï¼šå¦‚æœä½ è®¾ç½®ä¸º `sections`ï¼Œè¯·åŠ¡å¿…å°†&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ­¤é…ç½®æ–‡ä»¶ä¸­çš„ç±»åˆ«ï¼ˆtaxonomiesï¼‰ä¸­&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># çš„ `categories` åˆ é™¤ï¼Œä¸ç„¶åˆ†ç±»é¡µ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é¢ä¼šå¤±æ•ˆã€‚åŒæ—¶ï¼Œä½ è¿˜éœ€è¦è‡ªå·±æ–°å»ºä¸€ä¸ª&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># `content/categories/_index.md`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ–‡ä»¶ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230527195030.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;h2 id="åˆ—è¡¨é¡µé¢">åˆ—è¡¨é¡µé¢&lt;/h2>
&lt;p>æ­¤å¤„é¡µé¢åœ¨ç‚¹å‡»åˆ†ç±»é¡µä¸­ä»»æ„æ–‡ä»¶å¤¹åå³å¯æ˜¾ç¤º&lt;/p>
&lt;h2 id="è®¾ç½®ç½‘å€å›¾æ ‡">è®¾ç½®ç½‘å€å›¾æ ‡&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># è¯´æ˜ï¼šå‰å¾€ https://realfavicongenerator.net/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ç”Ÿæˆç›¸å…³å›¾æ ‡å’Œæ–‡ä»¶ï¼Œä¸‹è½½åè§£å‹ï¼Œä»…ä¿ç•™&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># android-chrome-512x512.pngã€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># apple-touch-icon.pngã€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># mstile-150x150.pngã€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># safari-pinned-tab.svgã€favicon.icoã€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># site.webmanifest è¿™äº›æ–‡ä»¶ï¼Œåˆ é™¤å…¶ä½™ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ç„¶åå°†è¿™äº›æ–‡ä»¶ç§»åŠ¨åˆ° ~/blog/static/icons/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ç›®å½•ä¸‹ï¼Œå†å°† favicon.icoã€site.webmanifest&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ç§»åŠ¨åˆ° ~/blog/static/ ç›®å½•ä¸‹ï¼Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æœ€åå°† site.webmanifest é‡å‘½åä¸º&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># manifest.jsonï¼Œå¹¶æ£€æŸ¥å’Œä¿®æ”¹ç›¸å…³å†…å®¹ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Jolly&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;short_name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Jolly&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;icons&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;src&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;./icons/android-chrome-512x512.png&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;sizes&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;512x512&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;type&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;image/png&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;theme_color&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#ffffff&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;background_color&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#ffffff&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;display&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;standalone&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="å›¾è¡¨ç»˜åˆ¶å·¥å…·">å›¾è¡¨ç»˜åˆ¶å·¥å…·&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ˜¯å¦å¼€å¯ï¼ˆå…¨å±€è®¾ç½®ï¼‰å›¾è¡¨ç»˜åˆ¶å·¥å…·&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">enableMermaid&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># è¯´æ˜ï¼šæ–‡ç« çš„ Front Matter ä¸­çš„ `mermaid`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># çš„ä¼˜å…ˆçº§é«˜äºæ­¤å¤„&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æç®€é¡µè„š">æç®€é¡µè„š&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æç®€é¡µè„š&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ˜¯å¦å¼€å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">enableMinimalFooter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">enableVerticalBarStructure&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># è¯´æ˜ï¼šå¦‚æœå¼€å¯æ­¤é¡¹ï¼Œæ˜¾ç¤ºåœ¨å³è¾¹çš„éƒ¨ç±»æˆ–åˆ†åŒº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># å°†ä¼šåŒ…å«å…¨éƒ¨çš„ç¬¬ä¸€çº§éƒ¨ç±»æˆ–åˆ†åŒºï¼Œå¹¶ä¸”&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ä»¥ç«–çº¿ï¼ˆ|ï¼‰åˆ†éš”å¼€æ¥ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ˜¯å¦å¼€å¯å…³äºé¡µé¢çš„æç®€é¡µè„š&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">enableAboutPageMinimalFooter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">######################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ–‡ç« ä¸Šä¸‹ç¯‡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># è¯´æ˜ï¼šåœ¨ MemE ä¸»é¢˜ä¸­ï¼Œæ–‡ç« ä¸Šä¸‹ç¯‡æ˜¯ä»ç©ºé—´&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ä½ç½®è§’åº¦è®¾è®¡çš„ï¼Œè€Œä¸æ˜¯åƒå¤§å¤šæ•°å…¶å®ƒä¸»&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># é¢˜æ‰€åšçš„é‚£æ ·â€”â€”ä»æ—¶é—´è§’åº¦è®¾è®¡ã€‚å› æ­¤ï¼Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># å¦‚æœä½ ç‚¹å‡»å·¦è¾¹çš„ä¸Šç¯‡ï¼Œè·³è½¬çš„æ˜¯ä¸€ç¯‡æ›´&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ–°çš„æ–‡ç« ï¼›å¦‚æœä½ ç‚¹å‡»å³è¾¹çš„ä¸‹ç¯‡ï¼Œè·³è½¬&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># çš„æ˜¯ä¸€ç¯‡æ›´æ—§çš„æ–‡ç« ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ˜¯å¦å¼€å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">enablePostNav&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ˜¯å¦ä»…é™äºç›¸åŒçš„æ–‡ç« åˆ†åŒº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">postNavInSection&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">######################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># é¡µè„š&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ˜¯å¦å¼€å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">enableFooter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ˜¯å¦æ˜¾ç¤º&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">displayFooter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;a href="https://github.com/reuixiy/hugo-theme-meme/issues/357">åº•éƒ¨ç•™ç™½&lt;/a>
&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230527195030-1.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;h2 id="life--tech-æ¨¡æ¿">life &amp;amp; tech æ¨¡æ¿&lt;/h2>
&lt;p>è¯¥å¤„å»ºè®®å‚è€ƒä¸»é¢˜ä½œè€…çš„&lt;a href="https://github.com/reuixiy/io-oi.me/blob/master/config.toml#L232">config.toml&lt;/a> ä¸­çš„menuï¼Œä»¥åŠcontentæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ç»„ç»‡è·¯å¾„ï¼Œæ³¨æ„ï¼Œå…¶ä¸­çš„zhæ–‡ä»¶å¤¹æ˜¯ä¸ºäº†åç»­çš„ä¸­è‹±æ–‡è½¬æ¢ï¼Œå¦‚ä¸éœ€è¦ï¼Œç›´æ¥åœ¨contentä¸‹åˆ›å»ºlife &amp;amp; techæ–‡ä»¶å¤¹
æ³¨æ„æ–‡ä»¶å¤¹ä¸ºè‹±æ–‡ï¼Œå¦åˆ™è·¯å¾„ä¼šå¸¦æœ‰ä¸­æ–‡ï¼ŒPermalinkä¸çŸ¥é“ä½œç”¨&lt;/p>
&lt;h2 id="postsé¡µä¸æ˜¾ç¤ºä¸­æ–‡å¹´ä»½">postsé¡µä¸æ˜¾ç¤ºä¸­æ–‡å¹´ä»½&lt;/h2>
&lt;p>æˆ‘å¿˜äº†æ€ä¹ˆå¼„çš„
å¯èƒ½æ˜¯&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># æ—¥æœŸçš„æ ¼å¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">listDateFormat&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;2006-01-02&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/create/">create</category><category domain="https://keepjolly.com/tags/blog/">Blog</category></item><item><title>æé«˜ä¸€äº›é“¾æ¥çš„ä¸‹è½½é€Ÿåº¦</title><link>https://keepjolly.com/posts/tech/improve-download-speed/</link><guid isPermaLink="true">https://keepjolly.com/posts/tech/improve-download-speed/</guid><pubDate>Fri, 26 May 2023 21:16:39 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;p>åšè®°å½•ç”¨&lt;/p>
&lt;h2 id="cudaä¸‹è½½">cudaä¸‹è½½&lt;/h2>
&lt;ol>
&lt;li>&lt;a href="https://developer.download.nvidia.com/compute/cuda/12.1.1/local_installers/cuda_12.1.1_530.30.02_linux.run">https://developer.download.nvidia.com/compute/cuda/12.1.1/local_installers/cuda_12.1.1_530.30.02_linux.run&lt;/a>
&lt;ol>
&lt;li>å°†å…¶ä¸­çš„.nvidia.comæ”¹ä¸º&lt;code>.. .cn ..&lt;/code>å³å¯ï¼Œå¹¶å°†é“¾æ¥å¤åˆ¶åˆ°æµè§ˆå™¨ï¼Œç”±æµè§ˆå™¨æ‰˜ç®¡ä¸‹è½½&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>sudo sh cuda_12.1.1_530.30.02_linux.run&lt;/li>
&lt;/ol>
&lt;h2 id="git-clone">git clone&lt;/h2>
&lt;h3 id="æœç´¢ipåœ°å€">æœç´¢IPåœ°å€&lt;/h3>
&lt;p>&lt;a href="https://link.segmentfault.com/?enc=uBTVyUIamkNzLONeeMfDBA%3D%3D.i5v95tuMG7MNJYNdOaEiPv%2Fw5pvuLjksCoadv7ObJzg%3D">https://www.ipaddress.com/&lt;/a>
github.global.ssl.fastly.net
éšä¾¿æŒ‘ä¸€ä¸ª
&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526205752.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å…‰å­¦Aæ˜Ÿ-20170524-åœ£åœ°äºšå“¥ç¼©ç•¥å›¾.jpg">
github.com
&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526205752-1.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="1.jpg">&lt;/p>
&lt;h3 id="ä¿®æ”¹host">ä¿®æ”¹host&lt;/h3>
&lt;ol>
&lt;li>æ‰“å¼€hostsæ–‡ä»¶&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>Windowsä¸Šçš„hostsæ–‡ä»¶è·¯å¾„åœ¨C:/WindowsSystem32/driversetchosts&lt;/li>
&lt;li>Linuxçš„hostsæ–‡ä»¶è·¯å¾„åœ¨ï¼šsudo vim /etc/hosts&lt;/li>
&lt;/ul>
&lt;ol start="2">
&lt;li>append files&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>151.101.1.194 github.global-ssl.fastly.net
140.82.112.4 github.com&lt;/p>
&lt;/blockquote>
&lt;ol start="3">
&lt;li>åˆ·æ–°DNS&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>sudo systemd-resolve --flush-caches&lt;/p>
&lt;/blockquote>
&lt;h3 id="è¿˜æ˜¯æ…¢">è¿˜æ˜¯æ…¢&lt;/h3>
&lt;p>ç”¨é•œåƒgiteeå§&lt;/p></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/tech/">tech</category><category domain="https://keepjolly.com/tags/others/">Others</category></item><item><title>æ··åˆç¼–ç¨‹pythonä¸C++</title><link>https://keepjolly.com/posts/create/python-client-c-server/</link><guid isPermaLink="true">https://keepjolly.com/posts/create/python-client-c-server/</guid><pubDate>Fri, 26 May 2023 21:14:31 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;p>&lt;a href="https://keepjolly.com/posts/create/python-client-c-server/">ä¸Šä¸ªç‰ˆæœ¬&lt;/a>: åªæ˜¯ç”¨åˆ°ctypesè¿›è¡Œä¼ è¾“, è¿™æ¬¡å°†pythonæœåŠ¡ç«¯æ›´æ”¹ä¸ºC++æœåŠ¡ç«¯,æ–¹ä¾¿åç»­ç»´æŠ¤.
æœ¬æ–‡å®ç°åŠŸèƒ½: pythonä¼ è¾“å›¾ç‰‡ç»™C++, C++æ¥å—å›¾ç‰‡åå¯¹å›¾ç‰‡è¿›è¡Œå¤„ç†,å¹¶å°†ç»“æœè¿”å›ç»™pythonå®¢æˆ·ç«¯, pass image from python to C++&lt;/p>
&lt;h2 id="c-æœåŠ¡ç«¯">C++ æœåŠ¡ç«¯&lt;/h2>
&lt;h3 id="hæ–‡ä»¶">.hæ–‡ä»¶&lt;/h3>
&lt;p>æ³¨æ„æ–‡ä¸­çš„model&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// .h
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cp">#pragma once
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;netinet/in.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;signal.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;opencv2/opencv.hpp&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="k">namespace&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="k">namespace&lt;/span> &lt;span class="n">cv&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">ModelManager&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">ServerManager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">private&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">m_port&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">m_addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cv&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">VideoCapture&lt;/span> &lt;span class="n">m_cap&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">m_server&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">m_accept&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// client conn
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">public&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="n">initialization&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="n">cv&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">VideoCapture&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cap&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">nullptr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="nf">initialization&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">nullptr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="nf">build_connect&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="nf">acceptClient&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">error_print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">ptr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="nf">free_connect&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="nf">send_data_frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ModelManager&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="nf">receive_data_frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cv&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">Mat&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="cppæ–‡ä»¶">.cppæ–‡ä»¶&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;ServerManager.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;ModelManager.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define BUFFER_SIZE 65538
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="n">ServerManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">error_print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">ptr&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">perror&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ptr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EXIT_FAILURE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="n">ServerManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">initialization&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="n">cv&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">VideoCapture&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">cap&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">m_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">m_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">m_cap&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cap&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="n">ServerManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">initialization&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">m_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">m_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="n">ServerManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">build_connect&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">server_addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bzero&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server_addr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">server_addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AF_INET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">m_addr&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="n">inet_addr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_addr&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="n">INADDR_ANY&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">m_port&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// create socket
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">m_server&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_server&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error_print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;socket bind error&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// can reuse port
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_server&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">SO_REUSEADDR&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error_print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;setsockopt error&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// bind addr
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_server&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server_addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">server_addr&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error_print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;bind error&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// listen only one client
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_server&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error_print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;listen failed&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34;ServerManager is listening, plesae wait...&amp;#34;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="n">ServerManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">acceptClient&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">accept_addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">accept_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">accept_addr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bzero&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">accept_addr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">accept_addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// accept client connection
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">m_accept&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_server&lt;/span>&lt;span class="p">,(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">accept_addr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">accept_len&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error_print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;accept error&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34;Connection established&amp;#34;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="n">ServerManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">send_data_frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ModelManager&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">json_output&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">nullptr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">json_output&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">createJson&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">json_output&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="k">nullptr&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">false&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// printf(&amp;#34;send data %s\n&amp;#34;, json_output);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// just send json_output, dont memcpy new char*!!! it wastes me two hours
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// send json
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_accept&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">json_output&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_output&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34;send fail&amp;#34;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">false&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="n">ServerManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">receive_data_frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Mat&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// recv frame size
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">data_size&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_accept&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">data_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data_size&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data_size&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// when client close, then close connection
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_accept&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34;close connection to client&amp;#34;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">acceptClient&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="c1">// restart a new accept, to accept new connection
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="nb">false&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">data_size&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// recv frame data
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// char buf[data_size];
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// std::vector&amp;lt;uchar&amp;gt; decode;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// int bytes_received = 0;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// do
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// {
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// int nBytes = recv(m_accept, buf, data_size - bytes_received, 0);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// for (int i = 0; i &amp;lt; nBytes; i++) // maybe can use memcpy, maybe faster
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// {
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// decode.emplace_back(buf[i]);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// cout &amp;lt;&amp;lt; bytes_received &amp;lt;&amp;lt; endl;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// bytes_received += nBytes;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// } while (bytes_received &amp;lt; data_size);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">recv_char&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">data_size&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">vector&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">uchar&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">decode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">index&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">bytes_received&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">count&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">data_size&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">count&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">// if count &amp;gt;= 0, dead loop
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">iRet&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_accept&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">recv_char&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">count&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">index&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="n">data_size&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">index&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">data_size&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">decode&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">recv_char&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="n">iRet&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">index&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">iRet&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">iRet&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">count&lt;/span> &lt;span class="o">-=&lt;/span> &lt;span class="n">iRet&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// decode message
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">frame&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">imdecode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">decode&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">cv&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">IMREAD_COLOR&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// push into Model&amp;#39;s queueMat
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mtxQueueImg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">model&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">queueMat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">model&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mtxQueueImg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">unlock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="n">ServerManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">free_connect&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">m_cap&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">release&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_accept&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">m_server&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="c-modeléƒ¨åˆ†ä»£ç ">C++ modeléƒ¨åˆ†ä»£ç &lt;/h2>
&lt;h3 id="hæ–‡ä»¶-1">.hæ–‡ä»¶&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#pragma once
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;CV_Classify.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;CV_Detect.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;ServerManager.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;opencv2/opencv.hpp&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;mutex&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;queue&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp"> &lt;/span>&lt;span class="c1">// usleep
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;thread&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;cJSON.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="k">namespace&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="k">namespace&lt;/span> &lt;span class="n">cv&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">ModelManager&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">public&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Detect&lt;/span> &lt;span class="n">objdetect&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Classify&lt;/span> &lt;span class="n">objclassify&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">mutex&lt;/span> &lt;span class="n">mtxQueueDet&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// mutex for detect queue
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">mutex&lt;/span> &lt;span class="n">mtxQueueImg&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// mutex for image queue
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">mutex&lt;/span> &lt;span class="n">mtxQueueCls&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// mutex for classify queue
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">queue&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">cv&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">Mat&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">queueMat&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">queue&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">ObjDetectOutput&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">queueDetOut&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">// Detect queue
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">queue&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">ObjClassifyOutput&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">queueClsOut&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">// Classify queue
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="n">DetectFlag&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="n">ClassifyFlag&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">bool&lt;/span> &lt;span class="n">empty_flag&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">false&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">friend&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">ServerManager&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">public&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="n">initDetectModel&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">initClassifyModel&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">DetectImg&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">ClassifyImg&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">getClsResult&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ObjClassifyOutput&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ObjClassifyOutput getClsResult();
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nf">createJson&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="cppæ–‡ä»¶-1">.cppæ–‡ä»¶&lt;/h3>
&lt;p>éƒ¨åˆ†æœ‰åˆ å‡,createJsonå¯å‚è€ƒä½¿ç”¨,åˆ©ç”¨jsonæ¥ä¼ é€’å€¼&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;ModelManager.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">initDetectModel&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">string&lt;/span> &lt;span class="n">config_path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;DetectConfig.yaml&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">objdetect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">config_path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">initClassifyModel&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">string&lt;/span> &lt;span class="n">config_path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;ClassiflyConfig.yaml&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">objclassify&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">config_path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">DetectImg&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DetectInput&lt;/span> &lt;span class="n">detect_input&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DetectOutput&lt;/span> &lt;span class="n">detect_output&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cv&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">Mat&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">size_t&lt;/span> &lt;span class="n">mm&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">queueMat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">empty&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">DetectFlag&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">usleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// get image from queueMat
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">mtxQueueImg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frame&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">queueMat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">front&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">queueMat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">pop&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mtxQueueImg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">unlock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// run model
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">objdetect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">detect_input&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">detect_output&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// push detect result into queueDetOut
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">mtxQueueDet&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">queueDetOut&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">detect_output&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// cout &amp;lt;&amp;lt; &amp;#34;detect run !!&amp;#34; &amp;lt;&amp;lt; endl;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">mtxQueueDet&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">unlock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">ClassifyImg&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ObjClassifyInput&lt;/span> &lt;span class="n">input&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ObjClassifyOutput&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cv&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">Mat&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Detoutput&lt;/span> &lt;span class="n">detect_result&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">queueDetOut&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">empty&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">ClassifyFlag&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">usleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// get detect from queueDetOut
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">mtxQueueDet&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">detect_result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">queueDetOut&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">front&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">queueDetOut&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">pop&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mtxQueueDet&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">unlock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// run model
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">objclassify&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// push cls result into queueClsOut
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">mtxQueueCls&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">queueClsOut&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mtxQueueCls&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">unlock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">getClsResult&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ObjClassifyOutput&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">queueClsOut&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">empty&lt;/span>&lt;span class="p">()){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_num&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// -1 is now empty;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// must return in thread otherwise cant use &amp;amp;output
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">output&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">queueClsOut&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">front&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">queueClsOut&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">pop&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">createJson&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1">// dont know why cant use &amp;amp;value, need return value
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mtxQueueCls&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ObjClassifyOutput&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">getClsResult&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mtxQueueCls&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">unlock&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_num&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="k">nullptr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// prepare send data json
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">cJSON&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">json_object_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">json_ObjClassifyOutput&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">json_ObjClassifyOutput&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cJSON_CreateObject&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">json_object_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cJSON_CreateObject&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddItemToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_ObjClassifyOutput&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;object_list&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">json_object_list&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">obj_num&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_num&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddNumberToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_object_list&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;object_num&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">obj_num&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">obj_num&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">json_object&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cJSON_CreateObject&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">json_box&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cJSON_CreateObject&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddNumberToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_box&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;x&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">bbox&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddNumberToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_box&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;y&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">bbox&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddNumberToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_box&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;w&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">bbox&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">w&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddNumberToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_box&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;h&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">bbox&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">h&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddItemToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_object&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;bbox&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">json_box&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddNumberToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_object&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;classes&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">classes&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddNumberToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_object&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;objectness&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object_list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">object&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">objectness&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// double prob = output.object_list.object[i].prob;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// cJSON_AddNumberToObject(json_object, &amp;#34;prob&amp;#34;, prob); // pointer cant use?
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">string&lt;/span> &lt;span class="n">str&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;object&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">to_string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_AddItemToObject&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_object_list&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">str&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">c_str&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="n">json_object&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// printf(&amp;#34;prob: %f&amp;#34;, output.object_list.object[i].prob);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">json_output&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cJSON_Print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_ObjClassifyOutput&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cJSON_Delete&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_ObjClassifyOutput&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">json_output&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="c-æœåŠ¡ç«¯è¿è¡Œ">C++ æœåŠ¡ç«¯è¿è¡Œ&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;../include/ServerManager.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;../include/ModelManager.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;thread&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define PORT 8080
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">recvServer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ServerManager&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">idx&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// auto start = std::chrono::steady_clock::now();
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">cv&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">Mat&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">receive_data_frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// cal time cost
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// auto end = std::chrono::steady_clock::now();
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// std::chrono::duration&amp;lt;double, std::milli&amp;gt; elapsed = end - start;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// std::cout &amp;lt;&amp;lt; &amp;#34;recv execution time: &amp;#34; &amp;lt;&amp;lt; elapsed.count() &amp;lt;&amp;lt; &amp;#34; ms\n&amp;#34;;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">empty&lt;/span>&lt;span class="p">())&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">usleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// cv::imwrite(&amp;#34;image&amp;#34;+to_string(idx++)+&amp;#34;.jpg&amp;#34;, frame);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34;Image &amp;#34;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">idx&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span>&lt;span class="s">&amp;#34; received !!&amp;#34;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">sendServer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ServerManager&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ModelManager&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">send_data_frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34;send success!!&amp;#34;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// cout &amp;lt;&amp;lt; &amp;#34;send fail!!&amp;#34; &amp;lt;&amp;lt; endl;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">usleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ServerManager&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ModelManager&lt;/span> &lt;span class="n">model&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">model&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">initDetectModel&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">model&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">initClassifyModel&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">initialization&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PORT&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">build_connect&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">acceptClient&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">thread&lt;/span> &lt;span class="n">recv_server&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">recvServer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">thread&lt;/span> &lt;span class="n">send_server&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sendServer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">thread&lt;/span> &lt;span class="n">detect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">ModelManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">DetectImg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">thread&lt;/span> &lt;span class="n">classfy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">ModelManager&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">ClassifyImg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">detect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">classfy&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recv_server&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">send_server&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="pythonå®¢æˆ·ç«¯">pythonå®¢æˆ·ç«¯&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">json&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">struct&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">multiprocessing&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">JoinableQueue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">threading&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Thread&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">natsort&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">ns&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">natsorted&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">host&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;192.168.0.2&amp;#39;&lt;/span> &lt;span class="c1"># &amp;#39;192.168.0.2&amp;#39; &amp;#39;localhost&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">8080&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">img_encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">img_path&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cv2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">imread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">img_path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># img = cv2.resize(img, (500, 500), interpolation=cv2.INTER_CUBIC)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_param&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">95&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1"># å›¾ç‰‡å‹ç¼©ç‡0-100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">img&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cv2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">imencode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.jpg&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">img&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">img_param&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">img&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tobytes&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">img&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">img_product&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">img_queue&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path_mode&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;image&amp;#39;&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">path_mode&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;image&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">image&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">img_encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">put&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elif&lt;/span> &lt;span class="n">path_mode&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;dir&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dir_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">listdir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">files&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">natsorted&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dir_list&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">alg&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">ns&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># é¡ºåºè¯»å–æ–‡ä»¶å&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">filename&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">files&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">path&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39;/&amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">filename&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">image&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">img_encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">img_path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">put&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">put&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;E&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">server_consumer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">img_queue&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">1000&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 1. get img from queue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_obj&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">img_queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_queue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">task_done&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># get end signal&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">img_obj&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;E&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">client&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 2. send package(img_bytes_size, img_bytes)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pack_size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">struct&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pack&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;i&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">img_obj&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">client&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pack_size&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">img_obj&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">1000&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">client&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">65536&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">json_str&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">decode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;utf8&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;ignore&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">strip&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">b&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\x00&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">decode&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">results&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">json&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">loads&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">json_str&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">1000&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">end_time&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">strftime&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;%Y-%m-&lt;/span>&lt;span class="si">%d&lt;/span>&lt;span class="s2"> %H:%M:%S&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">localtime&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;send and recv cost time: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">end&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">start&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">client&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">client&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">connect&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_dir&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;data&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">one_img&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;./data/image.jpg&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mode&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;dir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_jq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">JoinableQueue&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">producer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Thread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">img_product&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">img_jq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">img_dir&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">mode&lt;/span>&lt;span class="p">,))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">consumer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Thread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">server_consumer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">img_jq&lt;/span>&lt;span class="p">,))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">producer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">daemon&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">True&lt;/span> &lt;span class="c1"># set daemon but not set join()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">producer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># producer.join() // è®©ç”Ÿäº§è€…å…ˆå…³é—­,é˜²æ­¢closeé”™è¯¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">consumer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;ul>
&lt;li>å…¶å®è¿™ä¸ªé¡¹ç›®çœŸæ­£åšå®Œæ„Ÿè§‰è¿˜æ˜¯æŒºç®€å•, å°±æ˜¯å¯¹socketé€šä¿¡ä¸å¤ªç†Ÿæ‚‰, ä»¥åŠä¼ å›¾ç‰‡æ²¡åšè¿‡.&lt;/li>
&lt;li>å®é™…ä¸Šä¼ å›¾ç‰‡åªéœ€è¦&lt;strong>è¯»å–å›¾ç‰‡å,imencode,ç„¶åtobytes,æœ€åå‘é€sizeå’Œdata&lt;/strong>å³å¯.è€Œæ¥å—ç«¯åªéœ€è¦&lt;strong>æ‹¼æ¥æ•°ç»„,ç„¶åimdecode&lt;/strong>å³å¯.&lt;/li>
&lt;li>å¦å¤–ä¼ è¾“ç»“æœçš„è¯åˆ©ç”¨jsonä¼ è¾“å¯ä»¥è®©ç»“æœå¯è¯»æ€§å¯é«˜, ä¼ è¾“ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿, å½“æ—¶&lt;a href="https://www.cnblogs.com/zuti666/p/16840009.html">copyåˆ«äººçš„å‘é€ä»£ç &lt;/a>, æ²¡æœ‰ç»†çœ‹,å¯¼è‡´ä½¿ç”¨memcpyè®©jsonæ ¼å¼ä¹±ç ,å¯¼è‡´æ— æ³•è§£ç json.&lt;/li>
&lt;li>å¦‚æœä½ &lt;strong>æ„Ÿè§‰æ¥æ”¶ç«¯&lt;/strong>&lt;a href="https://www.json.cn/">&lt;strong>æ²¡é—®é¢˜&lt;/strong>&lt;/a>&lt;strong>,ä¸€å®šè¦çœ‹çœ‹å‘é€ç«¯.&lt;/strong>&lt;/li>
&lt;li>&lt;strong>ä¹‹åçš„æ–°ä»»åŠ¡å°±æ˜¯è§†é¢‘ä¼ è¾“åˆ©ç”¨rtspæµ,æ•¬è¯·æœŸå¾…&lt;/strong>&lt;/li>
&lt;/ul>
&lt;h2 id="å‚è€ƒåšå®¢">å‚è€ƒåšå®¢&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://blog.csdn.net/linxizi0622/article/details/128868324">use memcpy in receive_frame function if you want&lt;/a>,&lt;a href="https://github.com/linxizi/TCP_Online_Video">å¯¹åº”githubåœ°å€&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/Apollon_krj/article/details/53437764">a pure client and server code to create a simple demo&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/msdnwolaile/article/details/50743254">å¦‚æœç”¨ctrl+zä¸­æ–­,å¯èƒ½å¯¼è‡´address in use,ä½¿ç”¨bg/fg&lt;/a>
&lt;ul>
&lt;li>ç”¨æˆ·å¯ä»¥ä½¿ç”¨fg/bgæ“ä½œç»§ç»­å‰å°æˆ–åå°çš„ä»»åŠ¡ï¼Œfgå‘½ä»¤é‡æ–°å¯åŠ¨å‰å°è¢«ä¸­æ–­çš„ä»»åŠ¡ï¼Œbgå‘½ä»¤æŠŠè¢«ä¸­æ–­çš„ä»»åŠ¡æ”¾åœ¨åå°æ‰§è¡Œ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/42106974/sending-and-getting-image-from-python-to-c/69949615#69949615">zmq send img&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/cgt19910923/article/details/86541471">ä¼˜åŒ–imdecodeé€Ÿåº¦,æœ¬ä»£ç æœªä½¿ç”¨&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/TJLCY/article/details/126051927">è§†é¢‘ä¼ è¾“è·Ÿå›¾ç‰‡ä¼ è¾“å·®ä¸å¤š&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/guotianqing/article/details/95970785">Linux c++è·å–æœ¬åœ°æ¯«ç§’çº§ç²¾ç¡®æ—¶é—´&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c06/p12_read_nested_and_variable_sized_binary_structures.html">å¦‚æœä¸æƒ³ç”¨json,å¯ä»¥è¯•è¯•struct&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/Mculover666/article/details/103796256">åˆ©ç”¨jsonæ¥ä¼ è¾“åˆ†ç±»ç»“æœ&lt;/a>&lt;/li>
&lt;/ul></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/create/">create</category><category domain="https://keepjolly.com/tags/c-/">C++</category><category domain="https://keepjolly.com/tags/python/">Python</category><category domain="https://keepjolly.com/tags/tcp/">TCP</category></item><item><title>ç¬¬3ã€4è®²ï¼šå®ç°ä¸€ä¸ªåŸºäºTCPçš„RTPåŒæ—¶ä¼ è¾“h264å’Œaacçš„RTSPæœåŠ¡å™¨</title><link>https://keepjolly.com/posts/learn/rtsp-server-of-h264-and-aac-based-on-rtp-over-tcp/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/rtsp-server-of-h264-and-aac-based-on-rtp-over-tcp/</guid><pubDate>Fri, 26 May 2023 21:04:25 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="éŸ³é¢‘åŸç†">éŸ³é¢‘åŸç†&lt;/h2>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/53475069">åšå®¢&lt;/a>&lt;/p>
&lt;ol>
&lt;li>&lt;strong>å£°éŸ³&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>é¢‘ç‡ï¼ˆéŸ³è°ƒï¼‰ï¼šå£°éŸ³1ç§’å†…å‘¨æœŸæ€§å˜åŒ–çš„æ¬¡æ•°&lt;/strong>&lt;/p>
&lt;p>äººè€³çš„å¬è§‰èŒƒå›´åœ¨20Hz-20kHzã€‚ ä½é¢‘çš„å£°éŸ³æ²‰é—·åšé‡ï¼Œé«˜é¢‘çš„å£°éŸ³å°–é”åˆºè€³ã€‚ é«˜äº 20kHzçš„å£°éŸ³ä¸ºè¶…å£°æ³¢ã€‚&lt;/p>
&lt;p>&lt;strong>æŒ¯å¹…ï¼ˆå“åº¦ï¼‰ï¼šå£°éŸ³çš„å¤§å°&lt;/strong>&lt;/p>
&lt;p>æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨åˆ†è´ï¼ˆdBï¼‰å½¢å®¹å£°éŸ³å¤§å°ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ&lt;strong>dBæ˜¯ä¸€ä¸ªæ¯”å€¼ï¼Œæ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œæ²¡æœ‰ä»»ä½•å•ä½æ ‡æ³¨ã€‚ï¼ˆåŠŸç‡å¼ºåº¦ä¹‹æ¯”çš„å¯¹æ•°çš„10å€ï¼‰&lt;/strong>&lt;/p>
&lt;ol start="2">
&lt;li>&lt;strong>å£°éŸ³é‡‡é›†ä¸å­˜å‚¨&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>é‡‡æ ·&lt;/strong>ï¼ŒæŒ‡æŠŠæ—¶é—´åŸŸæˆ–ç©ºé—´åŸŸçš„è¿ç»­é‡è½¬åŒ–æˆç¦»æ•£é‡çš„è¿‡ç¨‹ ã€‚&lt;/p>
&lt;p>å¯¹å£°éŸ³çš„é‡‡æ ·å¸¸ç”¨éº¦å…‹é£ç­‰è®¾å¤‡å°†å£°éŸ³ä¿¡å·è½¬æ¢æˆç”µä¿¡å·ï¼Œå†ç”¨æ¨¡/æ•°è½¬æ¢å™¨å°†ç”µä¿¡å·è½¬æ¢æˆä¸€ä¸²ç”¨1å’Œ0è¡¨ç¤ºçš„äºŒè¿›åˆ¶æ•°å­—ï¼ˆæ•°å­—ä¿¡å·ï¼‰ã€‚&lt;/p>
&lt;p>&lt;strong>é‡‡æ ·é¢‘ç‡&lt;/strong>æŒ‡å½•éŸ³è®¾å¤‡åœ¨ä¸€ç§’é’Ÿå†…å¯¹å£°éŸ³ä¿¡å·çš„é‡‡æ ·æ¬¡æ•°ã€‚é‡‡æ ·é¢‘ç‡è¶Šé«˜ï¼Œå£°éŸ³çš„è¿˜åŸå°±è¶ŠçœŸå®è¶Šè‡ªç„¶ã€‚&lt;/p>
&lt;p>ç›®å‰ä¸»æµçš„é‡‡æ ·é¢‘ç‡æœ‰22.05KHzã€44.1KHzã€48KHzä¸‰ç§ã€‚&lt;/p>
&lt;h3 id="pcm">PCM&lt;/h3>
&lt;p>PCM(Pulse Code Modulation)ä¹Ÿè¢«ç§°ä¸º è„‰ç ç¼–ç è°ƒåˆ¶ã€‚PCMä¸­çš„å£°éŸ³æ•°æ®æ²¡æœ‰è¢«å‹ç¼©ï¼Œå¦‚æœæ˜¯å•å£°é“çš„æ–‡ä»¶ï¼Œé‡‡æ ·æ•°æ®æŒ‰æ—¶é—´çš„å…ˆåé¡ºåºä¾æ¬¡å­˜å…¥ã€‚(å®ƒçš„åŸºæœ¬ç»„ç»‡å•ä½æ˜¯BYTE(8bit)æˆ–WORD(16bit))&lt;/p>
&lt;p>&lt;strong>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€å¸§PCMæ˜¯ç”±2048æ¬¡é‡‡æ ·ç»„æˆçš„&lt;/strong>ï¼ˆå‚è€ƒ&lt;a href="http://discussion.forum.nokia.com/forum/showthread.php?129458-%E8%AF%B7%E9%97%AEPCM%E6%A0%BC%E5%BC%8F%E7%9A%84%E9%9F%B3%E9%A2%91%E6%B5%81%EF%BC%8C%E6%AF%8F%E6%AC%A1%E8%AF%BB%E5%85%A5%E6%88%96%E8%BE%93%E5%87%BA%E7%9A%84%E5%9D%97%E7%9A%84%E5%A4%A7%E5%B0%8F%E6%98%AF%E5%BF%85%E9%A1%BB%E5%9B%BA%E5%AE%9A%E4%B8%BA4096B%E4%B9%88&amp;amp;s=e79e9dd1707157281e3725a163844c49">è¯·é—®PCMæ ¼å¼çš„éŸ³é¢‘æµï¼Œæ¯æ¬¡è¯»å…¥æˆ–è¾“å‡ºçš„å—çš„å¤§å°æ˜¯å¿…é¡»å›ºå®šä¸º4096Bä¹ˆ&lt;/a>ï¼‰ã€‚&lt;/p>
&lt;p>å¦‚æœæ˜¯åŒå£°é“çš„æ–‡ä»¶ï¼Œé‡‡æ ·æ•°æ®æŒ‰æ—¶é—´å…ˆåé¡ºåºäº¤å‰åœ°å­˜å…¥ã€‚å¦‚å›¾æ‰€ç¤º:&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210449.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/p>
&lt;h2 id="aacçš„ç æµæ ¼å¼">aacçš„ç æµæ ¼å¼&lt;/h2>
&lt;p>&lt;a href="https://blog.csdn.net/jay100500/article/details/52955232">AACçš„ADTSå¤´æ–‡ä»¶ä¿¡æ¯ä»‹ç»&lt;/a>ã€&lt;a href="https://blog.csdn.net/u013113678/article/details/123134860">C++ è§£æaac-adtsçš„å¤´éƒ¨ä¿¡æ¯&lt;/a>ã€&lt;a href="https://www.cnblogs.com/zhangxuan/p/8809245.html">AAC ADTSæ ¼å¼åˆ†æ&lt;/a>ã€&lt;a href="https://xie.infoq.cn/article/403c31f46c2ee5e39fdbede0e">ä¿ç•™ç”¨&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210449-1.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/p>
&lt;p>AACéŸ³é¢‘æ ¼å¼ï¼šAdvanced Audio Coding(é«˜çº§éŸ³é¢‘è§£ç )ï¼Œæ˜¯ä¸€ç§ç”±MPEG-4æ ‡å‡†å®šä¹‰çš„æœ‰æŸéŸ³é¢‘å‹ç¼©æ ¼å¼ï¼Œç”±Fraunhoferå‘å±•ï¼ŒDolby, Sonyå’ŒAT&amp;amp;Tæ˜¯ä¸»è¦çš„è´¡çŒ®è€…ã€‚&lt;/p>
&lt;ul>
&lt;li>ADIFï¼šAudio Data Interchange Format éŸ³é¢‘æ•°æ®äº¤æ¢æ ¼å¼ã€‚è¿™ç§æ ¼å¼çš„ç‰¹å¾æ˜¯å¯ä»¥ç¡®å®šçš„æ‰¾åˆ°è¿™ä¸ªéŸ³é¢‘æ•°æ®çš„å¼€å§‹ï¼Œä¸éœ€è¿›è¡Œåœ¨éŸ³é¢‘æ•°æ®æµä¸­é—´å¼€å§‹çš„è§£ç ï¼Œå³å®ƒçš„è§£ç å¿…é¡»åœ¨æ˜ç¡®å®šä¹‰çš„å¼€å§‹å¤„è¿›è¡Œã€‚æ•…è¿™ç§æ ¼å¼å¸¸ç”¨åœ¨&lt;strong>ç£ç›˜æ–‡ä»¶&lt;/strong>ä¸­ã€‚&lt;/li>
&lt;li>ADTSçš„å…¨ç§°æ˜¯Audio Data Transport Streamã€‚æ˜¯AACéŸ³é¢‘çš„ä¼ è¾“æµæ ¼å¼ã€‚AACéŸ³é¢‘æ ¼å¼åœ¨MPEG-2ï¼ˆISO-13318-7 2003ï¼‰ä¸­æœ‰å®šä¹‰ã€‚AACåæ¥åˆè¢«é‡‡ç”¨åˆ°MPEG-4æ ‡å‡†ä¸­ã€‚è¿™ç§æ ¼å¼çš„ç‰¹å¾æ˜¯å®ƒæ˜¯ä¸€ä¸ªæœ‰åŒæ­¥å­—çš„æ¯”ç‰¹æµï¼Œè§£ç å¯ä»¥åœ¨è¿™ä¸ªæµä¸­ä»»ä½•ä½ç½®å¼€å§‹ã€‚å®ƒçš„ç‰¹å¾ç±»ä¼¼äºmp3æ•°æ®æµæ ¼å¼ã€‚å¸¸ç”¨åœ¨&lt;strong>æ•°æ®ä¼ è¾“&lt;/strong>ä¸­ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="adts-header">ADTS Header&lt;/h3>
&lt;ul>
&lt;li>syncword ï¼šæ€»æ˜¯0xFFF, ä»£è¡¨ä¸€ä¸ªADTSå¸§çš„å¼€å§‹, ç”¨äºåŒæ­¥.è§£ç å™¨å¯é€šè¿‡0xFFFç¡®å®šæ¯ä¸ªADTSçš„å¼€å§‹ä½ç½®.å› ä¸ºå®ƒçš„å­˜åœ¨ï¼Œè§£ç å¯ä»¥åœ¨è¿™ä¸ªæµä¸­ä»»ä½•ä½ç½®å¼€å§‹, å³å¯ä»¥åœ¨ä»»æ„å¸§è§£ç ã€‚&lt;/li>
&lt;li>IDï¼šMPEG Version: 0 for MPEG-4ï¼Œ1 for MPEG-2&lt;/li>
&lt;li>Layerï¼šalways: '00'&lt;/li>
&lt;li>protection_absentï¼šWarning, set to 1 if there is no CRC and 0 if there is CRC&lt;/li>
&lt;li>profileï¼šè¡¨ç¤ºä½¿ç”¨å“ªä¸ªçº§åˆ«çš„AAC
&lt;ul>
&lt;li>profileçš„å€¼ç­‰äº Audio Object Typeçš„å€¼å‡1. ä½†æ˜¯æœ‰17ä¸ªï¼Œ2bitèƒ½è¡¨ç¤ºï¼Ÿ&lt;/li>
&lt;li>profile = MPEG-4 Audio Object Type - 1&lt;/li>
&lt;li>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210449-2.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>sampling_frequency_indexï¼šé‡‡æ ·ç‡çš„ä¸‹æ ‡
&lt;ul>
&lt;li>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210449-3.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>channel_configurationï¼šå£°é“æ•°ï¼Œæ¯”å¦‚2è¡¨ç¤ºç«‹ä½“å£°åŒå£°é“
&lt;ul>
&lt;li>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210449-4.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>æ¥ä¸‹æ¥çœ‹ä¸‹adts_variable_header();&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210449-5.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="å›¾ç‰‡.png">&lt;/p>
&lt;ul>
&lt;li>aac_frame_lengthï¼šä¸€ä¸ªADTSå¸§çš„é•¿åº¦åŒ…æ‹¬ADTSå¤´å’ŒAACåŸå§‹æµã€‚
&lt;ul>
&lt;li>frame length, this value must include 7 or 9 bytes of header length:&lt;/li>
&lt;li>aac_frame_length = (protection_absent == 1 ? 7 : 9) + size(AACFrame)&lt;/li>
&lt;li>protection_absent=0æ—¶, header length=9bytes&lt;/li>
&lt;li>protection_absent=1æ—¶, header length=7bytes&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>adts_buffer_fullnessï¼š0x7FF è¯´æ˜æ˜¯ç ç‡å¯å˜çš„ç æµã€‚&lt;/li>
&lt;li>number_of_raw_data_blocks_in_frameï¼šè¡¨ç¤ºADTSå¸§ä¸­æœ‰number_of_raw_data_blocks_in_frame + 1ä¸ªAACåŸå§‹å¸§ã€‚æ‰€ä»¥è¯´number_of_raw_data_blocks_in_frame == 0 è¡¨ç¤ºè¯´ADTSå¸§ä¸­æœ‰ä¸€ä¸ªAACæ•°æ®å—ã€‚(ä¸€ä¸ªAACåŸå§‹å¸§åŒ…å«ä¸€æ®µæ—¶é—´å†…1024ä¸ªé‡‡æ ·åŠç›¸å…³æ•°æ®)&lt;/li>
&lt;/ul>
&lt;h2 id="ä»£ç ">ä»£ç &lt;/h2>
&lt;p>rtp.hã€ rtp.cppå‚è€ƒå‰æ–‡&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;span class="lnt">137
&lt;/span>&lt;span class="lnt">138
&lt;/span>&lt;span class="lnt">139
&lt;/span>&lt;span class="lnt">140
&lt;/span>&lt;span class="lnt">141
&lt;/span>&lt;span class="lnt">142
&lt;/span>&lt;span class="lnt">143
&lt;/span>&lt;span class="lnt">144
&lt;/span>&lt;span class="lnt">145
&lt;/span>&lt;span class="lnt">146
&lt;/span>&lt;span class="lnt">147
&lt;/span>&lt;span class="lnt">148
&lt;/span>&lt;span class="lnt">149
&lt;/span>&lt;span class="lnt">150
&lt;/span>&lt;span class="lnt">151
&lt;/span>&lt;span class="lnt">152
&lt;/span>&lt;span class="lnt">153
&lt;/span>&lt;span class="lnt">154
&lt;/span>&lt;span class="lnt">155
&lt;/span>&lt;span class="lnt">156
&lt;/span>&lt;span class="lnt">157
&lt;/span>&lt;span class="lnt">158
&lt;/span>&lt;span class="lnt">159
&lt;/span>&lt;span class="lnt">160
&lt;/span>&lt;span class="lnt">161
&lt;/span>&lt;span class="lnt">162
&lt;/span>&lt;span class="lnt">163
&lt;/span>&lt;span class="lnt">164
&lt;/span>&lt;span class="lnt">165
&lt;/span>&lt;span class="lnt">166
&lt;/span>&lt;span class="lnt">167
&lt;/span>&lt;span class="lnt">168
&lt;/span>&lt;span class="lnt">169
&lt;/span>&lt;span class="lnt">170
&lt;/span>&lt;span class="lnt">171
&lt;/span>&lt;span class="lnt">172
&lt;/span>&lt;span class="lnt">173
&lt;/span>&lt;span class="lnt">174
&lt;/span>&lt;span class="lnt">175
&lt;/span>&lt;span class="lnt">176
&lt;/span>&lt;span class="lnt">177
&lt;/span>&lt;span class="lnt">178
&lt;/span>&lt;span class="lnt">179
&lt;/span>&lt;span class="lnt">180
&lt;/span>&lt;span class="lnt">181
&lt;/span>&lt;span class="lnt">182
&lt;/span>&lt;span class="lnt">183
&lt;/span>&lt;span class="lnt">184
&lt;/span>&lt;span class="lnt">185
&lt;/span>&lt;span class="lnt">186
&lt;/span>&lt;span class="lnt">187
&lt;/span>&lt;span class="lnt">188
&lt;/span>&lt;span class="lnt">189
&lt;/span>&lt;span class="lnt">190
&lt;/span>&lt;span class="lnt">191
&lt;/span>&lt;span class="lnt">192
&lt;/span>&lt;span class="lnt">193
&lt;/span>&lt;span class="lnt">194
&lt;/span>&lt;span class="lnt">195
&lt;/span>&lt;span class="lnt">196
&lt;/span>&lt;span class="lnt">197
&lt;/span>&lt;span class="lnt">198
&lt;/span>&lt;span class="lnt">199
&lt;/span>&lt;span class="lnt">200
&lt;/span>&lt;span class="lnt">201
&lt;/span>&lt;span class="lnt">202
&lt;/span>&lt;span class="lnt">203
&lt;/span>&lt;span class="lnt">204
&lt;/span>&lt;span class="lnt">205
&lt;/span>&lt;span class="lnt">206
&lt;/span>&lt;span class="lnt">207
&lt;/span>&lt;span class="lnt">208
&lt;/span>&lt;span class="lnt">209
&lt;/span>&lt;span class="lnt">210
&lt;/span>&lt;span class="lnt">211
&lt;/span>&lt;span class="lnt">212
&lt;/span>&lt;span class="lnt">213
&lt;/span>&lt;span class="lnt">214
&lt;/span>&lt;span class="lnt">215
&lt;/span>&lt;span class="lnt">216
&lt;/span>&lt;span class="lnt">217
&lt;/span>&lt;span class="lnt">218
&lt;/span>&lt;span class="lnt">219
&lt;/span>&lt;span class="lnt">220
&lt;/span>&lt;span class="lnt">221
&lt;/span>&lt;span class="lnt">222
&lt;/span>&lt;span class="lnt">223
&lt;/span>&lt;span class="lnt">224
&lt;/span>&lt;span class="lnt">225
&lt;/span>&lt;span class="lnt">226
&lt;/span>&lt;span class="lnt">227
&lt;/span>&lt;span class="lnt">228
&lt;/span>&lt;span class="lnt">229
&lt;/span>&lt;span class="lnt">230
&lt;/span>&lt;span class="lnt">231
&lt;/span>&lt;span class="lnt">232
&lt;/span>&lt;span class="lnt">233
&lt;/span>&lt;span class="lnt">234
&lt;/span>&lt;span class="lnt">235
&lt;/span>&lt;span class="lnt">236
&lt;/span>&lt;span class="lnt">237
&lt;/span>&lt;span class="lnt">238
&lt;/span>&lt;span class="lnt">239
&lt;/span>&lt;span class="lnt">240
&lt;/span>&lt;span class="lnt">241
&lt;/span>&lt;span class="lnt">242
&lt;/span>&lt;span class="lnt">243
&lt;/span>&lt;span class="lnt">244
&lt;/span>&lt;span class="lnt">245
&lt;/span>&lt;span class="lnt">246
&lt;/span>&lt;span class="lnt">247
&lt;/span>&lt;span class="lnt">248
&lt;/span>&lt;span class="lnt">249
&lt;/span>&lt;span class="lnt">250
&lt;/span>&lt;span class="lnt">251
&lt;/span>&lt;span class="lnt">252
&lt;/span>&lt;span class="lnt">253
&lt;/span>&lt;span class="lnt">254
&lt;/span>&lt;span class="lnt">255
&lt;/span>&lt;span class="lnt">256
&lt;/span>&lt;span class="lnt">257
&lt;/span>&lt;span class="lnt">258
&lt;/span>&lt;span class="lnt">259
&lt;/span>&lt;span class="lnt">260
&lt;/span>&lt;span class="lnt">261
&lt;/span>&lt;span class="lnt">262
&lt;/span>&lt;span class="lnt">263
&lt;/span>&lt;span class="lnt">264
&lt;/span>&lt;span class="lnt">265
&lt;/span>&lt;span class="lnt">266
&lt;/span>&lt;span class="lnt">267
&lt;/span>&lt;span class="lnt">268
&lt;/span>&lt;span class="lnt">269
&lt;/span>&lt;span class="lnt">270
&lt;/span>&lt;span class="lnt">271
&lt;/span>&lt;span class="lnt">272
&lt;/span>&lt;span class="lnt">273
&lt;/span>&lt;span class="lnt">274
&lt;/span>&lt;span class="lnt">275
&lt;/span>&lt;span class="lnt">276
&lt;/span>&lt;span class="lnt">277
&lt;/span>&lt;span class="lnt">278
&lt;/span>&lt;span class="lnt">279
&lt;/span>&lt;span class="lnt">280
&lt;/span>&lt;span class="lnt">281
&lt;/span>&lt;span class="lnt">282
&lt;/span>&lt;span class="lnt">283
&lt;/span>&lt;span class="lnt">284
&lt;/span>&lt;span class="lnt">285
&lt;/span>&lt;span class="lnt">286
&lt;/span>&lt;span class="lnt">287
&lt;/span>&lt;span class="lnt">288
&lt;/span>&lt;span class="lnt">289
&lt;/span>&lt;span class="lnt">290
&lt;/span>&lt;span class="lnt">291
&lt;/span>&lt;span class="lnt">292
&lt;/span>&lt;span class="lnt">293
&lt;/span>&lt;span class="lnt">294
&lt;/span>&lt;span class="lnt">295
&lt;/span>&lt;span class="lnt">296
&lt;/span>&lt;span class="lnt">297
&lt;/span>&lt;span class="lnt">298
&lt;/span>&lt;span class="lnt">299
&lt;/span>&lt;span class="lnt">300
&lt;/span>&lt;span class="lnt">301
&lt;/span>&lt;span class="lnt">302
&lt;/span>&lt;span class="lnt">303
&lt;/span>&lt;span class="lnt">304
&lt;/span>&lt;span class="lnt">305
&lt;/span>&lt;span class="lnt">306
&lt;/span>&lt;span class="lnt">307
&lt;/span>&lt;span class="lnt">308
&lt;/span>&lt;span class="lnt">309
&lt;/span>&lt;span class="lnt">310
&lt;/span>&lt;span class="lnt">311
&lt;/span>&lt;span class="lnt">312
&lt;/span>&lt;span class="lnt">313
&lt;/span>&lt;span class="lnt">314
&lt;/span>&lt;span class="lnt">315
&lt;/span>&lt;span class="lnt">316
&lt;/span>&lt;span class="lnt">317
&lt;/span>&lt;span class="lnt">318
&lt;/span>&lt;span class="lnt">319
&lt;/span>&lt;span class="lnt">320
&lt;/span>&lt;span class="lnt">321
&lt;/span>&lt;span class="lnt">322
&lt;/span>&lt;span class="lnt">323
&lt;/span>&lt;span class="lnt">324
&lt;/span>&lt;span class="lnt">325
&lt;/span>&lt;span class="lnt">326
&lt;/span>&lt;span class="lnt">327
&lt;/span>&lt;span class="lnt">328
&lt;/span>&lt;span class="lnt">329
&lt;/span>&lt;span class="lnt">330
&lt;/span>&lt;span class="lnt">331
&lt;/span>&lt;span class="lnt">332
&lt;/span>&lt;span class="lnt">333
&lt;/span>&lt;span class="lnt">334
&lt;/span>&lt;span class="lnt">335
&lt;/span>&lt;span class="lnt">336
&lt;/span>&lt;span class="lnt">337
&lt;/span>&lt;span class="lnt">338
&lt;/span>&lt;span class="lnt">339
&lt;/span>&lt;span class="lnt">340
&lt;/span>&lt;span class="lnt">341
&lt;/span>&lt;span class="lnt">342
&lt;/span>&lt;span class="lnt">343
&lt;/span>&lt;span class="lnt">344
&lt;/span>&lt;span class="lnt">345
&lt;/span>&lt;span class="lnt">346
&lt;/span>&lt;span class="lnt">347
&lt;/span>&lt;span class="lnt">348
&lt;/span>&lt;span class="lnt">349
&lt;/span>&lt;span class="lnt">350
&lt;/span>&lt;span class="lnt">351
&lt;/span>&lt;span class="lnt">352
&lt;/span>&lt;span class="lnt">353
&lt;/span>&lt;span class="lnt">354
&lt;/span>&lt;span class="lnt">355
&lt;/span>&lt;span class="lnt">356
&lt;/span>&lt;span class="lnt">357
&lt;/span>&lt;span class="lnt">358
&lt;/span>&lt;span class="lnt">359
&lt;/span>&lt;span class="lnt">360
&lt;/span>&lt;span class="lnt">361
&lt;/span>&lt;span class="lnt">362
&lt;/span>&lt;span class="lnt">363
&lt;/span>&lt;span class="lnt">364
&lt;/span>&lt;span class="lnt">365
&lt;/span>&lt;span class="lnt">366
&lt;/span>&lt;span class="lnt">367
&lt;/span>&lt;span class="lnt">368
&lt;/span>&lt;span class="lnt">369
&lt;/span>&lt;span class="lnt">370
&lt;/span>&lt;span class="lnt">371
&lt;/span>&lt;span class="lnt">372
&lt;/span>&lt;span class="lnt">373
&lt;/span>&lt;span class="lnt">374
&lt;/span>&lt;span class="lnt">375
&lt;/span>&lt;span class="lnt">376
&lt;/span>&lt;span class="lnt">377
&lt;/span>&lt;span class="lnt">378
&lt;/span>&lt;span class="lnt">379
&lt;/span>&lt;span class="lnt">380
&lt;/span>&lt;span class="lnt">381
&lt;/span>&lt;span class="lnt">382
&lt;/span>&lt;span class="lnt">383
&lt;/span>&lt;span class="lnt">384
&lt;/span>&lt;span class="lnt">385
&lt;/span>&lt;span class="lnt">386
&lt;/span>&lt;span class="lnt">387
&lt;/span>&lt;span class="lnt">388
&lt;/span>&lt;span class="lnt">389
&lt;/span>&lt;span class="lnt">390
&lt;/span>&lt;span class="lnt">391
&lt;/span>&lt;span class="lnt">392
&lt;/span>&lt;span class="lnt">393
&lt;/span>&lt;span class="lnt">394
&lt;/span>&lt;span class="lnt">395
&lt;/span>&lt;span class="lnt">396
&lt;/span>&lt;span class="lnt">397
&lt;/span>&lt;span class="lnt">398
&lt;/span>&lt;span class="lnt">399
&lt;/span>&lt;span class="lnt">400
&lt;/span>&lt;span class="lnt">401
&lt;/span>&lt;span class="lnt">402
&lt;/span>&lt;span class="lnt">403
&lt;/span>&lt;span class="lnt">404
&lt;/span>&lt;span class="lnt">405
&lt;/span>&lt;span class="lnt">406
&lt;/span>&lt;span class="lnt">407
&lt;/span>&lt;span class="lnt">408
&lt;/span>&lt;span class="lnt">409
&lt;/span>&lt;span class="lnt">410
&lt;/span>&lt;span class="lnt">411
&lt;/span>&lt;span class="lnt">412
&lt;/span>&lt;span class="lnt">413
&lt;/span>&lt;span class="lnt">414
&lt;/span>&lt;span class="lnt">415
&lt;/span>&lt;span class="lnt">416
&lt;/span>&lt;span class="lnt">417
&lt;/span>&lt;span class="lnt">418
&lt;/span>&lt;span class="lnt">419
&lt;/span>&lt;span class="lnt">420
&lt;/span>&lt;span class="lnt">421
&lt;/span>&lt;span class="lnt">422
&lt;/span>&lt;span class="lnt">423
&lt;/span>&lt;span class="lnt">424
&lt;/span>&lt;span class="lnt">425
&lt;/span>&lt;span class="lnt">426
&lt;/span>&lt;span class="lnt">427
&lt;/span>&lt;span class="lnt">428
&lt;/span>&lt;span class="lnt">429
&lt;/span>&lt;span class="lnt">430
&lt;/span>&lt;span class="lnt">431
&lt;/span>&lt;span class="lnt">432
&lt;/span>&lt;span class="lnt">433
&lt;/span>&lt;span class="lnt">434
&lt;/span>&lt;span class="lnt">435
&lt;/span>&lt;span class="lnt">436
&lt;/span>&lt;span class="lnt">437
&lt;/span>&lt;span class="lnt">438
&lt;/span>&lt;span class="lnt">439
&lt;/span>&lt;span class="lnt">440
&lt;/span>&lt;span class="lnt">441
&lt;/span>&lt;span class="lnt">442
&lt;/span>&lt;span class="lnt">443
&lt;/span>&lt;span class="lnt">444
&lt;/span>&lt;span class="lnt">445
&lt;/span>&lt;span class="lnt">446
&lt;/span>&lt;span class="lnt">447
&lt;/span>&lt;span class="lnt">448
&lt;/span>&lt;span class="lnt">449
&lt;/span>&lt;span class="lnt">450
&lt;/span>&lt;span class="lnt">451
&lt;/span>&lt;span class="lnt">452
&lt;/span>&lt;span class="lnt">453
&lt;/span>&lt;span class="lnt">454
&lt;/span>&lt;span class="lnt">455
&lt;/span>&lt;span class="lnt">456
&lt;/span>&lt;span class="lnt">457
&lt;/span>&lt;span class="lnt">458
&lt;/span>&lt;span class="lnt">459
&lt;/span>&lt;span class="lnt">460
&lt;/span>&lt;span class="lnt">461
&lt;/span>&lt;span class="lnt">462
&lt;/span>&lt;span class="lnt">463
&lt;/span>&lt;span class="lnt">464
&lt;/span>&lt;span class="lnt">465
&lt;/span>&lt;span class="lnt">466
&lt;/span>&lt;span class="lnt">467
&lt;/span>&lt;span class="lnt">468
&lt;/span>&lt;span class="lnt">469
&lt;/span>&lt;span class="lnt">470
&lt;/span>&lt;span class="lnt">471
&lt;/span>&lt;span class="lnt">472
&lt;/span>&lt;span class="lnt">473
&lt;/span>&lt;span class="lnt">474
&lt;/span>&lt;span class="lnt">475
&lt;/span>&lt;span class="lnt">476
&lt;/span>&lt;span class="lnt">477
&lt;/span>&lt;span class="lnt">478
&lt;/span>&lt;span class="lnt">479
&lt;/span>&lt;span class="lnt">480
&lt;/span>&lt;span class="lnt">481
&lt;/span>&lt;span class="lnt">482
&lt;/span>&lt;span class="lnt">483
&lt;/span>&lt;span class="lnt">484
&lt;/span>&lt;span class="lnt">485
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;rtp.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdint.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SERVER_PORT 8554
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SERVER_RTP_PORT 55532
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SERVER_RTCP_PORT 55533
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define BUF_MAX_SIZE (1024*1024)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define AAC_FILE_NAME &amp;#34;./data/test.aac&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">createTcpSocket&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_REUSEADDR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">createUdpSocket&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_DGRAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_REUSEADDR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AF_INET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inet_addr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">AdtsHeader&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">syncword&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//12 bit åŒæ­¥å­— &amp;#39;1111 1111 1111&amp;#39;ï¼Œä¸€ä¸ªADTSå¸§çš„å¼€å§‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">id&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit 0ä»£è¡¨MPEG-4, 1ä»£è¡¨MPEG-2ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">layer&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//2 bit å¿…é¡»ä¸º0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">protectionAbsent&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit 1ä»£è¡¨æ²¡æœ‰CRCï¼Œ0ä»£è¡¨æœ‰CRC
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">profile&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//2 bit AACçº§åˆ«ï¼ˆMPEG-2 AACä¸­å®šä¹‰äº†3ç§profileï¼ŒMPEG-4 AACä¸­å®šä¹‰äº†6ç§profileï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">samplingFreqIndex&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//4 bit é‡‡æ ·ç‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">privateBit&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1bit ç¼–ç æ—¶è®¾ç½®ä¸º0ï¼Œè§£ç æ—¶å¿½ç•¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">channelCfg&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//3 bit å£°é“æ•°é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">originalCopy&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1bit ç¼–ç æ—¶è®¾ç½®ä¸º0ï¼Œè§£ç æ—¶å¿½ç•¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">home&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit ç¼–ç æ—¶è®¾ç½®ä¸º0ï¼Œè§£ç æ—¶å¿½ç•¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">copyrightIdentificationBit&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit ç¼–ç æ—¶è®¾ç½®ä¸º0ï¼Œè§£ç æ—¶å¿½ç•¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">copyrightIdentificationStart&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit ç¼–ç æ—¶è®¾ç½®ä¸º0ï¼Œè§£ç æ—¶å¿½ç•¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">aacFrameLength&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//13 bit ä¸€ä¸ªADTSå¸§çš„é•¿åº¦åŒ…æ‹¬ADTSå¤´å’ŒAACåŸå§‹æµ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">adtsBufferFullness&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//11 bit ç¼“å†²åŒºå……æ»¡åº¦ï¼Œ0x7FFè¯´æ˜æ˜¯ç ç‡å¯å˜çš„ç æµï¼Œä¸éœ€è¦æ­¤å­—æ®µã€‚CBRå¯èƒ½éœ€è¦æ­¤å­—æ®µï¼Œä¸åŒç¼–ç å™¨ä½¿ç”¨æƒ…å†µä¸åŒã€‚è¿™ä¸ªåœ¨ä½¿ç”¨éŸ³é¢‘ç¼–ç çš„æ—¶å€™éœ€è¦æ³¨æ„ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* number_of_raw_data_blocks_in_frame
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * è¡¨ç¤ºADTSå¸§ä¸­æœ‰number_of_raw_data_blocks_in_frame + 1ä¸ªAACåŸå§‹å¸§
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * æ‰€ä»¥è¯´number_of_raw_data_blocks_in_frame == 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * è¡¨ç¤ºè¯´ADTSå¸§ä¸­æœ‰ä¸€ä¸ªAACæ•°æ®å—å¹¶ä¸æ˜¯è¯´æ²¡æœ‰ã€‚(ä¸€ä¸ªAACåŸå§‹å¸§åŒ…å«ä¸€æ®µæ—¶é—´å†…1024ä¸ªé‡‡æ ·åŠç›¸å…³æ•°æ®)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">numberOfRawDataBlockInFrame&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//2 bit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">parseAdtsHeader&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">in&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">AdtsHeader&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">frame_number&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mh">0xFF&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xF0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mh">0xF0&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">id&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x08&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//ç¬¬äºŒä¸ªå­—èŠ‚ä¸0x08ä¸è¿ç®—ä¹‹åï¼Œè·å¾—ç¬¬13ä½bitå¯¹åº”çš„å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">layer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x06&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//ç¬¬äºŒä¸ªå­—èŠ‚ä¸0x06ä¸è¿ç®—ä¹‹åï¼Œå³ç§»1ä½ï¼Œè·å¾—ç¬¬14,15ä½ä¸¤ä¸ªbitå¯¹åº”çš„å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">protectionAbsent&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x01&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">profile&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xc0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">samplingFreqIndex&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x3c&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">privateBit&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x02&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">channelCfg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x01&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="p">(((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xc0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">originalCopy&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x20&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">home&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">copyrightIdentificationBit&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x08&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">copyrightIdentificationStart&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x04&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">aacFrameLength&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(((((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x03&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xFF&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xE0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">adtsBufferFullness&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1f&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">6&lt;/span> &lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xfc&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">numberOfRawDataBlockInFrame&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x03&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to parse adts header&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">rtpSendAACFrame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int16_t&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//æ‰“åŒ…æ–‡æ¡£ï¼šhttps://blog.csdn.net/yangguoyu8023/article/details/106517251/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x00&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x10&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">frameSize&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1FE0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//é«˜8ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">frameSize&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//ä½5ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rtpSendPacketOverUdp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to send rtp packet&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * å¦‚æœé‡‡æ ·é¢‘ç‡æ˜¯44100
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * ä¸€èˆ¬AACæ¯ä¸ª1024ä¸ªé‡‡æ ·ä¸ºä¸€å¸§
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * æ‰€ä»¥ä¸€ç§’å°±æœ‰ 44100 / 1024 = 43å¸§
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * æ—¶é—´å¢é‡å°±æ˜¯ 44100 / 43 = 1025
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * ä¸€å¸§çš„æ—¶é—´ä¸º 1 / 43 = 23ms
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1025&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">acceptClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clientfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">inet_ntoa&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="n">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">clientfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nf">getLineFromBuf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">line&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">buf&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="sc">&amp;#39;\n&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">line&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">buf&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sc">&amp;#39;\n&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">++&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sc">&amp;#39;\0&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">++&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_OPTIONS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Public: OPTIONS, DESCRIBE, SETUP, PLAY&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_DESCRIBE&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">sdp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rtsp://%[^:]:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;v=0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;o=- 9%ld 1 IN IP4 %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;t=0 0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=control:*&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;m=audio 0 RTP/AVP 97&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=rtpmap:97 mpeg4-generic/44100/2&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=fmtp:97 profile-level-id=1;mode=AAC-hbr;sizelength=13;indexlength=3;indexdeltalength=3;config=1210;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//&amp;#34;a=fmtp:97 SizeLength=13;\r\n&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s">&amp;#34;a=control:track0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">NULL&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-Base: %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-type: application/sdp&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-length: %d&lt;/span>&lt;span class="se">\r\n\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;%s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdp&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sdp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_SETUP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Transport: RTP/AVP;unicast;client_port=%d-%d;server_port=%d-%d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Session: 66334873&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientRtpPort&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">SERVER_RTP_PORT&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">SERVER_RTCP_PORT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_PLAY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Range: npt=0.000-&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Session: 66334873; timeout=10&lt;/span>&lt;span class="se">\r\n\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">doClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">clientIP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">serverRtpSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">serverRtcpSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientRtcpPort&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">BUF_MAX_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">sBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">BUF_MAX_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">recvLen&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recvLen&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BUF_MAX_SIZE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">recvLen&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">recvLen&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sc">&amp;#39;\0&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s rBuf = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">__FUNCTION__&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">sep&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">strtok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;OPTIONS&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;DESCRIBE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;SETUP&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;%s %s %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;CSeq&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">CSeq&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strncmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Transport:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Transport:&amp;#34;&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Transport: RTP/AVP/UDP;unicast;client_port=13358-13359
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Transport: RTP/AVP;unicast;client_port=13358-13359
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Transport: RTP/AVP/UDP;unicast;client_port=%d-%d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientRtcpPort&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;parse Transport error &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">strtok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">NULL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;OPTIONS&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_OPTIONS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle options&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;DESCRIBE&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_DESCRIBE&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle describe&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;SETUP&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_SETUP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle setup&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serverRtpSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">createUdpSocket&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serverRtcpSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">createUdpSocket&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="n">serverRtcpSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to create udp socket&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_RTP_PORT&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtcpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_RTCP_PORT&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to bind addr&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_PLAY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle play&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;æœªå®šä¹‰çš„method = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s sBuf = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">__FUNCTION__&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//å¼€å§‹æ’­æ”¾ï¼Œå‘é€RTPåŒ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">AdtsHeader&lt;/span> &lt;span class="n">adtsHeader&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FILE&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">fp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AAC_FILE_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rb&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;è¯»å– %s å¤±è´¥&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">AAC_FILE_NAME&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frame&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpHeaderInit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_VERSION&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_PAYLOAD_TYPE_AAC&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x32411&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;fread err&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;fread ret=%d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">ret&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">parseAdtsHeader&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">adtsHeader&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;parseAdtsHeader err&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">adtsHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">aacFrameLength&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;fread err&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpSendAACFrame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">adtsHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">aacFrameLength&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Sleep(1);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">usleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">23223&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="c1">//1000/43.06 * 1000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CSeq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">serverRtcpSockfd&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtcpSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtspServerSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">createTcpSocket&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to create tcp socket&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_PORT&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to bind addr&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to listen&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s rtsp://127.0.0.1:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">__FILE__&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_PORT&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">acceptClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to accept client&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;accept client;client ip:%s,client port:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ç¬¬4è®²å®ç°ä¸€ä¸ªåŸºäºtcpçš„rtpåŒæ—¶ä¼ è¾“h264å’Œaacçš„rtspæœåŠ¡å™¨">ç¬¬4è®²ï¼šå®ç°ä¸€ä¸ªåŸºäºTCPçš„RTPåŒæ—¶ä¼ è¾“h264å’Œaacçš„RTSPæœåŠ¡å™¨&lt;/h2>
&lt;p>è¿™ä¸ªåªæ˜¯å°†å‰ä¸¤è®²ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶ç”¨çº¿ç¨‹åˆ†åˆ«å¼€å¯ï¼Œæ‰€ä»¥ç›´æ¥åˆå¹¶æˆä¸€ä¸ªåšå®¢ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å¦‚æœä¹‹å‰çš„rtp.cppä¸èƒ½ä½¿ç”¨ï¼Œè¯·é‡æ–°åœ¨&lt;a href="https://gitee.com/Vanishi/BXC_RtspServer_study">åŒ—å°èœ&lt;/a>ä¸‹è½½&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨å‰ä¸‰æœŸè§†é¢‘çš„å­¦ä¹ åŸºç¡€ä¸Šï¼Œæœ¬æœŸå…¶å®æ¯”è¾ƒç®€å•ï¼Œç›¸å¯¹äºä¹‹å‰å®ç°çš„åŠŸèƒ½ï¼Œå˜åŒ–å¦‚ä¸‹&lt;/p>
&lt;ol>
&lt;li>å®¢æˆ·ç«¯è¯·æ±‚RTSPçš„Describeè¯·æ±‚æ—¶ï¼ŒRTSPæœåŠ¡å™¨è¿”å›çš„SDPåè®®ï¼Œéœ€è¦åŒæ—¶&lt;strong>åŒ…å«éŸ³é¢‘æµå’Œè§†é¢‘æµçš„ä¿¡æ¯&lt;/strong>ã€‚&lt;/li>
&lt;li>å®¢æˆ·ç«¯è¯·æ±‚RTSPçš„Setupè¯·æ±‚æ—¶ï¼ŒRTSPæœåŠ¡å™¨ä¸éœ€è¦å†å¯¹åº”åˆ›å»ºRTPå’ŒRTCPçš„UDPè¿æ¥é€šé“ï¼Œå› ä¸ºTCPç‰ˆçš„RTPä¼ è¾“ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨äº¤äº’æ—¶ï¼Œæ— è®ºæ˜¯RTSPä¿¡ä»¤è¿˜æ˜¯RTPæ•°æ®åŒ…æˆ–è€…æ˜¯RTCPæ•°æ®åŒ…ï¼Œéƒ½æ˜¯ä½¿ç”¨åŒä¸€ä¸ªtcpè¿æ¥é€šé“ã€‚åªä¸è¿‡è¿™ä¸ªtcpè¿æ¥é€šé“åœ¨å‘é€rtpæ•°æ®åŒ…æˆ–è€…rtcpæ•°æ®åŒ…æ—¶ï¼Œéœ€è¦&lt;strong>åŠ ä¸€äº›åˆ†éš”å­—èŠ‚&lt;/strong>ã€‚&lt;/li>
&lt;li>å®¢æˆ·ç«¯è¯·æ±‚RTSPçš„Playè¯·æ±‚æ—¶ï¼ŒRTSPæœåŠ¡å™¨åœ¨å¯¹Playè¯·æ±‚å›å¤ä»¥åï¼Œè¿˜éœ€è¦æºæºä¸æ–­çš„åŒæ—¶å‘å®¢æˆ·ç«¯å‘é€éŸ³é¢‘æµå’Œè§†é¢‘æµçš„RTPæ•°æ®åŒ…ã€‚&lt;/li>
&lt;li>æœ‰å‡ ç‚¹æ³¨æ„ï¼Œåœ¨è¿™ä¸ªæ¡ˆä¾‹é¡¹ç›®ä¸­ï¼Œä½¿ç”¨çš„h264è§†é¢‘æ–‡ä»¶ï¼Œå¯¹åº”çš„fpséœ€è¦æ˜¯25ã€‚å¦å¤–ç”±äºNaluçš„æ•°é‡å¹¶ä¸ç­‰äºè§†é¢‘å¸§æ•°é‡çš„åŸå› ï¼Œè¯¥æ¡ˆä¾‹çš„éŸ³è§†é¢‘å¹¶ä¸èƒ½åŒæ­¥&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;span class="lnt">137
&lt;/span>&lt;span class="lnt">138
&lt;/span>&lt;span class="lnt">139
&lt;/span>&lt;span class="lnt">140
&lt;/span>&lt;span class="lnt">141
&lt;/span>&lt;span class="lnt">142
&lt;/span>&lt;span class="lnt">143
&lt;/span>&lt;span class="lnt">144
&lt;/span>&lt;span class="lnt">145
&lt;/span>&lt;span class="lnt">146
&lt;/span>&lt;span class="lnt">147
&lt;/span>&lt;span class="lnt">148
&lt;/span>&lt;span class="lnt">149
&lt;/span>&lt;span class="lnt">150
&lt;/span>&lt;span class="lnt">151
&lt;/span>&lt;span class="lnt">152
&lt;/span>&lt;span class="lnt">153
&lt;/span>&lt;span class="lnt">154
&lt;/span>&lt;span class="lnt">155
&lt;/span>&lt;span class="lnt">156
&lt;/span>&lt;span class="lnt">157
&lt;/span>&lt;span class="lnt">158
&lt;/span>&lt;span class="lnt">159
&lt;/span>&lt;span class="lnt">160
&lt;/span>&lt;span class="lnt">161
&lt;/span>&lt;span class="lnt">162
&lt;/span>&lt;span class="lnt">163
&lt;/span>&lt;span class="lnt">164
&lt;/span>&lt;span class="lnt">165
&lt;/span>&lt;span class="lnt">166
&lt;/span>&lt;span class="lnt">167
&lt;/span>&lt;span class="lnt">168
&lt;/span>&lt;span class="lnt">169
&lt;/span>&lt;span class="lnt">170
&lt;/span>&lt;span class="lnt">171
&lt;/span>&lt;span class="lnt">172
&lt;/span>&lt;span class="lnt">173
&lt;/span>&lt;span class="lnt">174
&lt;/span>&lt;span class="lnt">175
&lt;/span>&lt;span class="lnt">176
&lt;/span>&lt;span class="lnt">177
&lt;/span>&lt;span class="lnt">178
&lt;/span>&lt;span class="lnt">179
&lt;/span>&lt;span class="lnt">180
&lt;/span>&lt;span class="lnt">181
&lt;/span>&lt;span class="lnt">182
&lt;/span>&lt;span class="lnt">183
&lt;/span>&lt;span class="lnt">184
&lt;/span>&lt;span class="lnt">185
&lt;/span>&lt;span class="lnt">186
&lt;/span>&lt;span class="lnt">187
&lt;/span>&lt;span class="lnt">188
&lt;/span>&lt;span class="lnt">189
&lt;/span>&lt;span class="lnt">190
&lt;/span>&lt;span class="lnt">191
&lt;/span>&lt;span class="lnt">192
&lt;/span>&lt;span class="lnt">193
&lt;/span>&lt;span class="lnt">194
&lt;/span>&lt;span class="lnt">195
&lt;/span>&lt;span class="lnt">196
&lt;/span>&lt;span class="lnt">197
&lt;/span>&lt;span class="lnt">198
&lt;/span>&lt;span class="lnt">199
&lt;/span>&lt;span class="lnt">200
&lt;/span>&lt;span class="lnt">201
&lt;/span>&lt;span class="lnt">202
&lt;/span>&lt;span class="lnt">203
&lt;/span>&lt;span class="lnt">204
&lt;/span>&lt;span class="lnt">205
&lt;/span>&lt;span class="lnt">206
&lt;/span>&lt;span class="lnt">207
&lt;/span>&lt;span class="lnt">208
&lt;/span>&lt;span class="lnt">209
&lt;/span>&lt;span class="lnt">210
&lt;/span>&lt;span class="lnt">211
&lt;/span>&lt;span class="lnt">212
&lt;/span>&lt;span class="lnt">213
&lt;/span>&lt;span class="lnt">214
&lt;/span>&lt;span class="lnt">215
&lt;/span>&lt;span class="lnt">216
&lt;/span>&lt;span class="lnt">217
&lt;/span>&lt;span class="lnt">218
&lt;/span>&lt;span class="lnt">219
&lt;/span>&lt;span class="lnt">220
&lt;/span>&lt;span class="lnt">221
&lt;/span>&lt;span class="lnt">222
&lt;/span>&lt;span class="lnt">223
&lt;/span>&lt;span class="lnt">224
&lt;/span>&lt;span class="lnt">225
&lt;/span>&lt;span class="lnt">226
&lt;/span>&lt;span class="lnt">227
&lt;/span>&lt;span class="lnt">228
&lt;/span>&lt;span class="lnt">229
&lt;/span>&lt;span class="lnt">230
&lt;/span>&lt;span class="lnt">231
&lt;/span>&lt;span class="lnt">232
&lt;/span>&lt;span class="lnt">233
&lt;/span>&lt;span class="lnt">234
&lt;/span>&lt;span class="lnt">235
&lt;/span>&lt;span class="lnt">236
&lt;/span>&lt;span class="lnt">237
&lt;/span>&lt;span class="lnt">238
&lt;/span>&lt;span class="lnt">239
&lt;/span>&lt;span class="lnt">240
&lt;/span>&lt;span class="lnt">241
&lt;/span>&lt;span class="lnt">242
&lt;/span>&lt;span class="lnt">243
&lt;/span>&lt;span class="lnt">244
&lt;/span>&lt;span class="lnt">245
&lt;/span>&lt;span class="lnt">246
&lt;/span>&lt;span class="lnt">247
&lt;/span>&lt;span class="lnt">248
&lt;/span>&lt;span class="lnt">249
&lt;/span>&lt;span class="lnt">250
&lt;/span>&lt;span class="lnt">251
&lt;/span>&lt;span class="lnt">252
&lt;/span>&lt;span class="lnt">253
&lt;/span>&lt;span class="lnt">254
&lt;/span>&lt;span class="lnt">255
&lt;/span>&lt;span class="lnt">256
&lt;/span>&lt;span class="lnt">257
&lt;/span>&lt;span class="lnt">258
&lt;/span>&lt;span class="lnt">259
&lt;/span>&lt;span class="lnt">260
&lt;/span>&lt;span class="lnt">261
&lt;/span>&lt;span class="lnt">262
&lt;/span>&lt;span class="lnt">263
&lt;/span>&lt;span class="lnt">264
&lt;/span>&lt;span class="lnt">265
&lt;/span>&lt;span class="lnt">266
&lt;/span>&lt;span class="lnt">267
&lt;/span>&lt;span class="lnt">268
&lt;/span>&lt;span class="lnt">269
&lt;/span>&lt;span class="lnt">270
&lt;/span>&lt;span class="lnt">271
&lt;/span>&lt;span class="lnt">272
&lt;/span>&lt;span class="lnt">273
&lt;/span>&lt;span class="lnt">274
&lt;/span>&lt;span class="lnt">275
&lt;/span>&lt;span class="lnt">276
&lt;/span>&lt;span class="lnt">277
&lt;/span>&lt;span class="lnt">278
&lt;/span>&lt;span class="lnt">279
&lt;/span>&lt;span class="lnt">280
&lt;/span>&lt;span class="lnt">281
&lt;/span>&lt;span class="lnt">282
&lt;/span>&lt;span class="lnt">283
&lt;/span>&lt;span class="lnt">284
&lt;/span>&lt;span class="lnt">285
&lt;/span>&lt;span class="lnt">286
&lt;/span>&lt;span class="lnt">287
&lt;/span>&lt;span class="lnt">288
&lt;/span>&lt;span class="lnt">289
&lt;/span>&lt;span class="lnt">290
&lt;/span>&lt;span class="lnt">291
&lt;/span>&lt;span class="lnt">292
&lt;/span>&lt;span class="lnt">293
&lt;/span>&lt;span class="lnt">294
&lt;/span>&lt;span class="lnt">295
&lt;/span>&lt;span class="lnt">296
&lt;/span>&lt;span class="lnt">297
&lt;/span>&lt;span class="lnt">298
&lt;/span>&lt;span class="lnt">299
&lt;/span>&lt;span class="lnt">300
&lt;/span>&lt;span class="lnt">301
&lt;/span>&lt;span class="lnt">302
&lt;/span>&lt;span class="lnt">303
&lt;/span>&lt;span class="lnt">304
&lt;/span>&lt;span class="lnt">305
&lt;/span>&lt;span class="lnt">306
&lt;/span>&lt;span class="lnt">307
&lt;/span>&lt;span class="lnt">308
&lt;/span>&lt;span class="lnt">309
&lt;/span>&lt;span class="lnt">310
&lt;/span>&lt;span class="lnt">311
&lt;/span>&lt;span class="lnt">312
&lt;/span>&lt;span class="lnt">313
&lt;/span>&lt;span class="lnt">314
&lt;/span>&lt;span class="lnt">315
&lt;/span>&lt;span class="lnt">316
&lt;/span>&lt;span class="lnt">317
&lt;/span>&lt;span class="lnt">318
&lt;/span>&lt;span class="lnt">319
&lt;/span>&lt;span class="lnt">320
&lt;/span>&lt;span class="lnt">321
&lt;/span>&lt;span class="lnt">322
&lt;/span>&lt;span class="lnt">323
&lt;/span>&lt;span class="lnt">324
&lt;/span>&lt;span class="lnt">325
&lt;/span>&lt;span class="lnt">326
&lt;/span>&lt;span class="lnt">327
&lt;/span>&lt;span class="lnt">328
&lt;/span>&lt;span class="lnt">329
&lt;/span>&lt;span class="lnt">330
&lt;/span>&lt;span class="lnt">331
&lt;/span>&lt;span class="lnt">332
&lt;/span>&lt;span class="lnt">333
&lt;/span>&lt;span class="lnt">334
&lt;/span>&lt;span class="lnt">335
&lt;/span>&lt;span class="lnt">336
&lt;/span>&lt;span class="lnt">337
&lt;/span>&lt;span class="lnt">338
&lt;/span>&lt;span class="lnt">339
&lt;/span>&lt;span class="lnt">340
&lt;/span>&lt;span class="lnt">341
&lt;/span>&lt;span class="lnt">342
&lt;/span>&lt;span class="lnt">343
&lt;/span>&lt;span class="lnt">344
&lt;/span>&lt;span class="lnt">345
&lt;/span>&lt;span class="lnt">346
&lt;/span>&lt;span class="lnt">347
&lt;/span>&lt;span class="lnt">348
&lt;/span>&lt;span class="lnt">349
&lt;/span>&lt;span class="lnt">350
&lt;/span>&lt;span class="lnt">351
&lt;/span>&lt;span class="lnt">352
&lt;/span>&lt;span class="lnt">353
&lt;/span>&lt;span class="lnt">354
&lt;/span>&lt;span class="lnt">355
&lt;/span>&lt;span class="lnt">356
&lt;/span>&lt;span class="lnt">357
&lt;/span>&lt;span class="lnt">358
&lt;/span>&lt;span class="lnt">359
&lt;/span>&lt;span class="lnt">360
&lt;/span>&lt;span class="lnt">361
&lt;/span>&lt;span class="lnt">362
&lt;/span>&lt;span class="lnt">363
&lt;/span>&lt;span class="lnt">364
&lt;/span>&lt;span class="lnt">365
&lt;/span>&lt;span class="lnt">366
&lt;/span>&lt;span class="lnt">367
&lt;/span>&lt;span class="lnt">368
&lt;/span>&lt;span class="lnt">369
&lt;/span>&lt;span class="lnt">370
&lt;/span>&lt;span class="lnt">371
&lt;/span>&lt;span class="lnt">372
&lt;/span>&lt;span class="lnt">373
&lt;/span>&lt;span class="lnt">374
&lt;/span>&lt;span class="lnt">375
&lt;/span>&lt;span class="lnt">376
&lt;/span>&lt;span class="lnt">377
&lt;/span>&lt;span class="lnt">378
&lt;/span>&lt;span class="lnt">379
&lt;/span>&lt;span class="lnt">380
&lt;/span>&lt;span class="lnt">381
&lt;/span>&lt;span class="lnt">382
&lt;/span>&lt;span class="lnt">383
&lt;/span>&lt;span class="lnt">384
&lt;/span>&lt;span class="lnt">385
&lt;/span>&lt;span class="lnt">386
&lt;/span>&lt;span class="lnt">387
&lt;/span>&lt;span class="lnt">388
&lt;/span>&lt;span class="lnt">389
&lt;/span>&lt;span class="lnt">390
&lt;/span>&lt;span class="lnt">391
&lt;/span>&lt;span class="lnt">392
&lt;/span>&lt;span class="lnt">393
&lt;/span>&lt;span class="lnt">394
&lt;/span>&lt;span class="lnt">395
&lt;/span>&lt;span class="lnt">396
&lt;/span>&lt;span class="lnt">397
&lt;/span>&lt;span class="lnt">398
&lt;/span>&lt;span class="lnt">399
&lt;/span>&lt;span class="lnt">400
&lt;/span>&lt;span class="lnt">401
&lt;/span>&lt;span class="lnt">402
&lt;/span>&lt;span class="lnt">403
&lt;/span>&lt;span class="lnt">404
&lt;/span>&lt;span class="lnt">405
&lt;/span>&lt;span class="lnt">406
&lt;/span>&lt;span class="lnt">407
&lt;/span>&lt;span class="lnt">408
&lt;/span>&lt;span class="lnt">409
&lt;/span>&lt;span class="lnt">410
&lt;/span>&lt;span class="lnt">411
&lt;/span>&lt;span class="lnt">412
&lt;/span>&lt;span class="lnt">413
&lt;/span>&lt;span class="lnt">414
&lt;/span>&lt;span class="lnt">415
&lt;/span>&lt;span class="lnt">416
&lt;/span>&lt;span class="lnt">417
&lt;/span>&lt;span class="lnt">418
&lt;/span>&lt;span class="lnt">419
&lt;/span>&lt;span class="lnt">420
&lt;/span>&lt;span class="lnt">421
&lt;/span>&lt;span class="lnt">422
&lt;/span>&lt;span class="lnt">423
&lt;/span>&lt;span class="lnt">424
&lt;/span>&lt;span class="lnt">425
&lt;/span>&lt;span class="lnt">426
&lt;/span>&lt;span class="lnt">427
&lt;/span>&lt;span class="lnt">428
&lt;/span>&lt;span class="lnt">429
&lt;/span>&lt;span class="lnt">430
&lt;/span>&lt;span class="lnt">431
&lt;/span>&lt;span class="lnt">432
&lt;/span>&lt;span class="lnt">433
&lt;/span>&lt;span class="lnt">434
&lt;/span>&lt;span class="lnt">435
&lt;/span>&lt;span class="lnt">436
&lt;/span>&lt;span class="lnt">437
&lt;/span>&lt;span class="lnt">438
&lt;/span>&lt;span class="lnt">439
&lt;/span>&lt;span class="lnt">440
&lt;/span>&lt;span class="lnt">441
&lt;/span>&lt;span class="lnt">442
&lt;/span>&lt;span class="lnt">443
&lt;/span>&lt;span class="lnt">444
&lt;/span>&lt;span class="lnt">445
&lt;/span>&lt;span class="lnt">446
&lt;/span>&lt;span class="lnt">447
&lt;/span>&lt;span class="lnt">448
&lt;/span>&lt;span class="lnt">449
&lt;/span>&lt;span class="lnt">450
&lt;/span>&lt;span class="lnt">451
&lt;/span>&lt;span class="lnt">452
&lt;/span>&lt;span class="lnt">453
&lt;/span>&lt;span class="lnt">454
&lt;/span>&lt;span class="lnt">455
&lt;/span>&lt;span class="lnt">456
&lt;/span>&lt;span class="lnt">457
&lt;/span>&lt;span class="lnt">458
&lt;/span>&lt;span class="lnt">459
&lt;/span>&lt;span class="lnt">460
&lt;/span>&lt;span class="lnt">461
&lt;/span>&lt;span class="lnt">462
&lt;/span>&lt;span class="lnt">463
&lt;/span>&lt;span class="lnt">464
&lt;/span>&lt;span class="lnt">465
&lt;/span>&lt;span class="lnt">466
&lt;/span>&lt;span class="lnt">467
&lt;/span>&lt;span class="lnt">468
&lt;/span>&lt;span class="lnt">469
&lt;/span>&lt;span class="lnt">470
&lt;/span>&lt;span class="lnt">471
&lt;/span>&lt;span class="lnt">472
&lt;/span>&lt;span class="lnt">473
&lt;/span>&lt;span class="lnt">474
&lt;/span>&lt;span class="lnt">475
&lt;/span>&lt;span class="lnt">476
&lt;/span>&lt;span class="lnt">477
&lt;/span>&lt;span class="lnt">478
&lt;/span>&lt;span class="lnt">479
&lt;/span>&lt;span class="lnt">480
&lt;/span>&lt;span class="lnt">481
&lt;/span>&lt;span class="lnt">482
&lt;/span>&lt;span class="lnt">483
&lt;/span>&lt;span class="lnt">484
&lt;/span>&lt;span class="lnt">485
&lt;/span>&lt;span class="lnt">486
&lt;/span>&lt;span class="lnt">487
&lt;/span>&lt;span class="lnt">488
&lt;/span>&lt;span class="lnt">489
&lt;/span>&lt;span class="lnt">490
&lt;/span>&lt;span class="lnt">491
&lt;/span>&lt;span class="lnt">492
&lt;/span>&lt;span class="lnt">493
&lt;/span>&lt;span class="lnt">494
&lt;/span>&lt;span class="lnt">495
&lt;/span>&lt;span class="lnt">496
&lt;/span>&lt;span class="lnt">497
&lt;/span>&lt;span class="lnt">498
&lt;/span>&lt;span class="lnt">499
&lt;/span>&lt;span class="lnt">500
&lt;/span>&lt;span class="lnt">501
&lt;/span>&lt;span class="lnt">502
&lt;/span>&lt;span class="lnt">503
&lt;/span>&lt;span class="lnt">504
&lt;/span>&lt;span class="lnt">505
&lt;/span>&lt;span class="lnt">506
&lt;/span>&lt;span class="lnt">507
&lt;/span>&lt;span class="lnt">508
&lt;/span>&lt;span class="lnt">509
&lt;/span>&lt;span class="lnt">510
&lt;/span>&lt;span class="lnt">511
&lt;/span>&lt;span class="lnt">512
&lt;/span>&lt;span class="lnt">513
&lt;/span>&lt;span class="lnt">514
&lt;/span>&lt;span class="lnt">515
&lt;/span>&lt;span class="lnt">516
&lt;/span>&lt;span class="lnt">517
&lt;/span>&lt;span class="lnt">518
&lt;/span>&lt;span class="lnt">519
&lt;/span>&lt;span class="lnt">520
&lt;/span>&lt;span class="lnt">521
&lt;/span>&lt;span class="lnt">522
&lt;/span>&lt;span class="lnt">523
&lt;/span>&lt;span class="lnt">524
&lt;/span>&lt;span class="lnt">525
&lt;/span>&lt;span class="lnt">526
&lt;/span>&lt;span class="lnt">527
&lt;/span>&lt;span class="lnt">528
&lt;/span>&lt;span class="lnt">529
&lt;/span>&lt;span class="lnt">530
&lt;/span>&lt;span class="lnt">531
&lt;/span>&lt;span class="lnt">532
&lt;/span>&lt;span class="lnt">533
&lt;/span>&lt;span class="lnt">534
&lt;/span>&lt;span class="lnt">535
&lt;/span>&lt;span class="lnt">536
&lt;/span>&lt;span class="lnt">537
&lt;/span>&lt;span class="lnt">538
&lt;/span>&lt;span class="lnt">539
&lt;/span>&lt;span class="lnt">540
&lt;/span>&lt;span class="lnt">541
&lt;/span>&lt;span class="lnt">542
&lt;/span>&lt;span class="lnt">543
&lt;/span>&lt;span class="lnt">544
&lt;/span>&lt;span class="lnt">545
&lt;/span>&lt;span class="lnt">546
&lt;/span>&lt;span class="lnt">547
&lt;/span>&lt;span class="lnt">548
&lt;/span>&lt;span class="lnt">549
&lt;/span>&lt;span class="lnt">550
&lt;/span>&lt;span class="lnt">551
&lt;/span>&lt;span class="lnt">552
&lt;/span>&lt;span class="lnt">553
&lt;/span>&lt;span class="lnt">554
&lt;/span>&lt;span class="lnt">555
&lt;/span>&lt;span class="lnt">556
&lt;/span>&lt;span class="lnt">557
&lt;/span>&lt;span class="lnt">558
&lt;/span>&lt;span class="lnt">559
&lt;/span>&lt;span class="lnt">560
&lt;/span>&lt;span class="lnt">561
&lt;/span>&lt;span class="lnt">562
&lt;/span>&lt;span class="lnt">563
&lt;/span>&lt;span class="lnt">564
&lt;/span>&lt;span class="lnt">565
&lt;/span>&lt;span class="lnt">566
&lt;/span>&lt;span class="lnt">567
&lt;/span>&lt;span class="lnt">568
&lt;/span>&lt;span class="lnt">569
&lt;/span>&lt;span class="lnt">570
&lt;/span>&lt;span class="lnt">571
&lt;/span>&lt;span class="lnt">572
&lt;/span>&lt;span class="lnt">573
&lt;/span>&lt;span class="lnt">574
&lt;/span>&lt;span class="lnt">575
&lt;/span>&lt;span class="lnt">576
&lt;/span>&lt;span class="lnt">577
&lt;/span>&lt;span class="lnt">578
&lt;/span>&lt;span class="lnt">579
&lt;/span>&lt;span class="lnt">580
&lt;/span>&lt;span class="lnt">581
&lt;/span>&lt;span class="lnt">582
&lt;/span>&lt;span class="lnt">583
&lt;/span>&lt;span class="lnt">584
&lt;/span>&lt;span class="lnt">585
&lt;/span>&lt;span class="lnt">586
&lt;/span>&lt;span class="lnt">587
&lt;/span>&lt;span class="lnt">588
&lt;/span>&lt;span class="lnt">589
&lt;/span>&lt;span class="lnt">590
&lt;/span>&lt;span class="lnt">591
&lt;/span>&lt;span class="lnt">592
&lt;/span>&lt;span class="lnt">593
&lt;/span>&lt;span class="lnt">594
&lt;/span>&lt;span class="lnt">595
&lt;/span>&lt;span class="lnt">596
&lt;/span>&lt;span class="lnt">597
&lt;/span>&lt;span class="lnt">598
&lt;/span>&lt;span class="lnt">599
&lt;/span>&lt;span class="lnt">600
&lt;/span>&lt;span class="lnt">601
&lt;/span>&lt;span class="lnt">602
&lt;/span>&lt;span class="lnt">603
&lt;/span>&lt;span class="lnt">604
&lt;/span>&lt;span class="lnt">605
&lt;/span>&lt;span class="lnt">606
&lt;/span>&lt;span class="lnt">607
&lt;/span>&lt;span class="lnt">608
&lt;/span>&lt;span class="lnt">609
&lt;/span>&lt;span class="lnt">610
&lt;/span>&lt;span class="lnt">611
&lt;/span>&lt;span class="lnt">612
&lt;/span>&lt;span class="lnt">613
&lt;/span>&lt;span class="lnt">614
&lt;/span>&lt;span class="lnt">615
&lt;/span>&lt;span class="lnt">616
&lt;/span>&lt;span class="lnt">617
&lt;/span>&lt;span class="lnt">618
&lt;/span>&lt;span class="lnt">619
&lt;/span>&lt;span class="lnt">620
&lt;/span>&lt;span class="lnt">621
&lt;/span>&lt;span class="lnt">622
&lt;/span>&lt;span class="lnt">623
&lt;/span>&lt;span class="lnt">624
&lt;/span>&lt;span class="lnt">625
&lt;/span>&lt;span class="lnt">626
&lt;/span>&lt;span class="lnt">627
&lt;/span>&lt;span class="lnt">628
&lt;/span>&lt;span class="lnt">629
&lt;/span>&lt;span class="lnt">630
&lt;/span>&lt;span class="lnt">631
&lt;/span>&lt;span class="lnt">632
&lt;/span>&lt;span class="lnt">633
&lt;/span>&lt;span class="lnt">634
&lt;/span>&lt;span class="lnt">635
&lt;/span>&lt;span class="lnt">636
&lt;/span>&lt;span class="lnt">637
&lt;/span>&lt;span class="lnt">638
&lt;/span>&lt;span class="lnt">639
&lt;/span>&lt;span class="lnt">640
&lt;/span>&lt;span class="lnt">641
&lt;/span>&lt;span class="lnt">642
&lt;/span>&lt;span class="lnt">643
&lt;/span>&lt;span class="lnt">644
&lt;/span>&lt;span class="lnt">645
&lt;/span>&lt;span class="lnt">646
&lt;/span>&lt;span class="lnt">647
&lt;/span>&lt;span class="lnt">648
&lt;/span>&lt;span class="lnt">649
&lt;/span>&lt;span class="lnt">650
&lt;/span>&lt;span class="lnt">651
&lt;/span>&lt;span class="lnt">652
&lt;/span>&lt;span class="lnt">653
&lt;/span>&lt;span class="lnt">654
&lt;/span>&lt;span class="lnt">655
&lt;/span>&lt;span class="lnt">656
&lt;/span>&lt;span class="lnt">657
&lt;/span>&lt;span class="lnt">658
&lt;/span>&lt;span class="lnt">659
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Created by sun on 11/24/20.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;rtp.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdint.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;thread&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define AAC_FILE_NAME &amp;#34;../data/test.aac&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define H264_FILE_NAME &amp;#34;../data/test.h264&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SERVER_PORT 8554
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define BUF_MAX_SIZE (1024*1024)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">createTcpSocket&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_REUSEADDR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AF_INET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inet_addr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">acceptClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clientfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">inet_ntoa&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="n">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">clientfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kr">inline&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kr">inline&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">startCode4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nf">findNextStartCode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">len&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">len&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">len&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="n">startCode4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">++&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">getFrameFromH264File&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">FILE&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">rSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">nextStartCode&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="n">startCode4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">nextStartCode&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">findNextStartCode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rSize&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">nextStartCode&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//lseek(fd, 0, SEEK_SET);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//frameSize = rSize;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nextStartCode&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fseek&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">rSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SEEK_CUR&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">AdtsHeader&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">syncword&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//12 bit åŒæ­¥å­— &amp;#39;1111 1111 1111&amp;#39;ï¼Œè¯´æ˜ä¸€ä¸ªADTSå¸§çš„å¼€å§‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">id&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit MPEG æ ‡ç¤ºç¬¦ï¼Œ 0 for MPEG-4ï¼Œ1 for MPEG-2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">layer&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//2 bit æ€»æ˜¯&amp;#39;00&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">protectionAbsent&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// bit 1è¡¨ç¤ºæ²¡æœ‰crcï¼Œ0è¡¨ç¤ºæœ‰crc
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">profile&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// 2bit è¡¨ç¤ºä½¿ç”¨å“ªä¸ªçº§åˆ«çš„AAC
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">samplingFreqIndex&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//4 bit è¡¨ç¤ºä½¿ç”¨çš„é‡‡æ ·é¢‘ç‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">privateBit&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">channelCfg&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//3 bit è¡¨ç¤ºå£°é“æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">originalCopy&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">home&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/*ä¸‹é¢çš„ä¸ºæ”¹å˜çš„å‚æ•°å³æ¯ä¸€å¸§éƒ½ä¸åŒ*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">copyrightIdentificationBit&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">copyrightIdentificationStart&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//1 bit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">aacFrameLength&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//13 bit ä¸€ä¸ªADTSå¸§çš„é•¿åº¦åŒ…æ‹¬ADTSå¤´å’ŒAACåŸå§‹æµ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">adtsBufferFullness&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//11 bit 0x7FF è¯´æ˜æ˜¯ç ç‡å¯å˜çš„ç æµ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* number_of_raw_data_blocks_in_frame
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * è¡¨ç¤ºADTSå¸§ä¸­æœ‰number_of_raw_data_blocks_in_frame + 1ä¸ªAACåŸå§‹å¸§
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * æ‰€ä»¥è¯´number_of_raw_data_blocks_in_frame == 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * è¡¨ç¤ºè¯´ADTSå¸§ä¸­æœ‰ä¸€ä¸ªAACæ•°æ®å—å¹¶ä¸æ˜¯è¯´æ²¡æœ‰ã€‚(ä¸€ä¸ªAACåŸå§‹å¸§åŒ…å«ä¸€æ®µæ—¶é—´å†…1024ä¸ªé‡‡æ ·åŠç›¸å…³æ•°æ®)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">numberOfRawDataBlockInFrame&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//2 bit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">parseAdtsHeader&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">in&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">AdtsHeader&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">frame_number&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mh">0xFF&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xF0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mh">0xF0&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">id&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x08&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">layer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x06&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">protectionAbsent&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x01&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">profile&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xc0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">samplingFreqIndex&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x3c&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">privateBit&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x02&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">channelCfg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x01&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="p">(((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xc0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">originalCopy&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x20&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">home&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">copyrightIdentificationBit&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x08&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">copyrightIdentificationStart&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x04&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">aacFrameLength&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(((((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x03&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xFF&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xE0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">adtsBufferFullness&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1f&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">6&lt;/span> &lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xfc&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">numberOfRawDataBlockInFrame&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">in&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x03&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to parse adts header&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">rtpSendAACFrame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x00&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å›ºå®š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x10&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">frameSize&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1FE0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//é«˜8ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">frameSize&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//ä½5ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rtpSendPacketOverTcp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mh">0x02&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// åœ¨ç¬¬2é€šé“ä¸Šä¼ è¾“
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to send rtp packet&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * å¦‚æœé‡‡æ ·é¢‘ç‡æ˜¯44100
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * ä¸€èˆ¬AACæ¯ä¸ª1024ä¸ªé‡‡æ ·ä¸ºä¸€å¸§
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * æ‰€ä»¥ä¸€ç§’å°±æœ‰ 44100 / 1024 = 43å¸§
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * æ—¶é—´å¢é‡å°±æ˜¯ 44100 / 43 = 1025
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * ä¸€å¸§çš„æ—¶é—´ä¸º 1 / 43 = 23ms
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1025&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">rtpSendH264Frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">naluType&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// naluç¬¬ä¸€ä¸ªå­—èŠ‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">sendByte&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">naluType&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s frameSize=%d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">__FUNCTION__&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">frameSize&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// nalué•¿åº¦å°äºæœ€å¤§åŒ…åœºï¼šå•ä¸€NALUå•å…ƒæ¨¡å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//* 0 1 2 3 4 5 6 7 8 9
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* |F|NRI| Type | a single NAL unit ... |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rtpSendPacketOverTcp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mh">0x00&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sendByte&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// å¦‚æœæ˜¯SPSã€PPSå°±ä¸éœ€è¦åŠ æ—¶é—´æˆ³
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="c1">// nalué•¿åº¦å°äºæœ€å¤§åŒ…ï¼šåˆ†ç‰‡æ¨¡å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//* 0 1 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* | FU indicator | FU header | FU payload ... |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//* FU Indicator
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* 0 1 2 3 4 5 6 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* |F|NRI| Type |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +---------------+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//* FU Header
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* 0 1 2 3 4 5 6 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* |S|E|R| Type |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +---------------+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">pktNum&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// æœ‰å‡ ä¸ªå®Œæ•´çš„åŒ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">remainPktSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å‰©ä½™ä¸å®Œæ•´åŒ…çš„å¤§å°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pos&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å‘é€å®Œæ•´çš„åŒ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">pktNum&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x60&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="mi">28&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//ç¬¬ä¸€åŒ…æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">|=&lt;/span> &lt;span class="mh">0x80&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// start
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">remainPktSize&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">pktNum&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//æœ€åä¸€åŒ…æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">|=&lt;/span> &lt;span class="mh">0x40&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// end
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">pos&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rtpSendPacketOverTcp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mh">0x00&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// åœ¨ç¬¬0é€šé“å‘é€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sendByte&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pos&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å‘é€å‰©ä½™çš„æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">remainPktSize&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x60&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="mi">28&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">|=&lt;/span> &lt;span class="mh">0x40&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//end
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">pos&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">remainPktSize&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rtpSendPacketOverTcp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">remainPktSize&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x00&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sendByte&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">sendByte&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_OPTIONS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Public: OPTIONS, DESCRIBE, SETUP, PLAY&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_DESCRIBE&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">sdp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rtsp://%[^:]:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;v=0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;o=- 9%ld 1 IN IP4 %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;t=0 0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=control:*&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;m=video 0 RTP/AVP/TCP 96&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=rtpmap:96 H264/90000&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=control:track0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;m=audio 1 RTP/AVP/TCP 97&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=rtpmap:97 mpeg4-generic/44100/2&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=fmtp:97 profile-level-id=1;mode=AAC-hbr;sizelength=13;indexlength=3;indexdeltalength=3;config=1210;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=control:track1&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">NULL&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-Base: %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-type: application/sdp&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-length: %zu&lt;/span>&lt;span class="se">\r\n\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;%s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdp&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sdp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_SETUP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">cseq&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Transport: RTP/AVP/TCP;unicast;interleaved=0-1&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span> &lt;span class="c1">// æŒ‡å®šè§†é¢‘åœ¨0-1é€šé“ä¼ è¾“
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s">&amp;#34;Session: 66334873&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">cseq&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Transport: RTP/AVP/TCP;unicast;interleaved=2-3&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span> &lt;span class="c1">// æŒ‡å®šéŸ³é¢‘åœ¨2-3é€šé“ä¼ è¾“
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s">&amp;#34;Session: 66334873&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_PLAY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Range: npt=0.000-&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Session: 66334873; timeout=10&lt;/span>&lt;span class="se">\r\n\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">doClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">clientIP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">BUF_MAX_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">sBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">BUF_MAX_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">recvLen&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recvLen&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BUF_MAX_SIZE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">recvLen&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">recvLen&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sc">&amp;#39;\0&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;æ¥æ”¶è¯·æ±‚ rBuf = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">sep&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">strtok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;OPTIONS&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;DESCRIBE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;SETUP&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;%s %s %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;CSeq&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">CSeq&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strncmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Transport:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Transport:&amp;#34;&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Transport: RTP/AVP/UDP;unicast;client_port=13358-13359
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Transport: RTP/AVP;unicast;client_port=13358-13359
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Transport: RTP/AVP/TCP;unicast;interleaved=0-1&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;parse Transport error &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">strtok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">NULL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;OPTIONS&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_OPTIONS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle options&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;DESCRIBE&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_DESCRIBE&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle describe&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;SETUP&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_SETUP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle setup&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_PLAY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle play&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;æœªå®šä¹‰çš„method = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;å“åº” sBuf = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//å¼€å§‹æ’­æ”¾ï¼Œå‘é€RTPåŒ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="kr">thread&lt;/span> &lt;span class="n">t1&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">]()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">startCode&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">500000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">500000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FILE&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">fp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">H264_FILE_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rb&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;è¯»å– %s å¤±è´¥&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">H264_FILE_NAME&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpHeaderInit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_VERSION&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_PAYLOAD_TYPE_H264&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x88923423&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;start play&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">getFrameFromH264File&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">500000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">frameSize&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;è¯»å–%sç»“æŸ,frameSize=%d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">H264_FILE_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">startCode&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">startCode&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">-=&lt;/span> &lt;span class="n">startCode&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpSendH264Frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">startCode&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">90000&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="mi">25&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//Sleep(40);//-&amp;gt;30,20,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Sleep(20);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">usleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">40000&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="c1">//1000/25 * 1000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="kr">thread&lt;/span> &lt;span class="n">t2&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">]()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">AdtsHeader&lt;/span> &lt;span class="n">adtsHeader&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FILE&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">fp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AAC_FILE_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rb&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;è¯»å– %s å¤±è´¥&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">AAC_FILE_NAME&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frame&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpHeaderInit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_VERSION&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_PAYLOAD_TYPE_AAC&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x32411&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;fread err&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;fread ret=%d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">parseAdtsHeader&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">adtsHeader&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;parseAdtsHeader err&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">adtsHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">aacFrameLength&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;fread err&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpSendAACFrame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">adtsHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">aacFrameLength&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Sleep(23);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">usleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">23223&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="c1">//1000/43.06 * 1000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">t1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">t2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CSeq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serverSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">createTcpSocket&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to create tcp socket&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_PORT&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to bind addr&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to listen&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s rtsp://127.0.0.1:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">__FILE__&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_PORT&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">acceptClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to accept client&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;accept client;client ip:%s,client port:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/c-/">C++</category><category domain="https://keepjolly.com/tags/rtsp/">RTSP</category></item><item><title>ç¬¬2è®²ï¼šå®ç°ä¸€ä¸ªä¼ è¾“h264çš„RTSPæœåŠ¡å™¨</title><link>https://keepjolly.com/posts/learn/h264-rtsp-server/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/h264-rtsp-server/</guid><pubDate>Fri, 26 May 2023 21:03:50 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;h2 id="vscodeé…ç½®">vscodeé…ç½®&lt;/h2>
&lt;p>&lt;a href="https://blog.csdn.net/Yujian2563/article/details/124749727">vscodeç¼–è¯‘å¤šä¸ªcppæ–‡ä»¶&lt;/a>&lt;/p>
&lt;p>å°†${file}æ›´æ”¹ä¸ºé€‰ä¸­éƒ¨åˆ†ï¼Œä½¿ä¹‹ç¼–è¯‘æ‰€æœ‰cppæ–‡ä»¶ã€‚æ³¨æ„ï¼šå˜æ›´ä¹‹åæœ¬å·¥ç¨‹å†…ä¸èƒ½å‡ºç°å¤šä¸ªmainå‡½æ•°ï¼ï¼&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210444.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;p>æˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œï¼šgcc file1.cpp file2.cpp main.cpp -o myprogram&lt;/p>
&lt;p>æˆ–è€…ä½¿ç”¨cmake&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmake" data-lang="cmake">&lt;span class="line">&lt;span class="cl">&lt;span class="c">#å‡è®¾æˆ‘ä»¬æœ‰ä¸‰ä¸ªæºä»£ç æ–‡ä»¶ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">#main.cpp
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#myclass.cpp
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#utils.cpp
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#ä»¥åŠä¸¤ä¸ªå¤´æ–‡ä»¶ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">#myclass.h
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#utils.h
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#é‚£ä¹ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨CMakeLists.txtä¸­æŒ‡å®šè¿™äº›æºä»£ç æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªåº“ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">cmake_minimum_required&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">VERSION&lt;/span> &lt;span class="s">3.5&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">project&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">myproject&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">## æ·»åŠ æºä»£ç æ–‡ä»¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nb">add_library&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">mylib&lt;/span> &lt;span class="s">SHARED&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">myclass.cpp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">utils.cpp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">## åŒ…å«å¤´æ–‡ä»¶æœç´¢è·¯å¾„
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nb">include_directories&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">${&lt;/span>&lt;span class="nv">CMAKE_CURRENT_SOURCE_DIR&lt;/span>&lt;span class="o">}&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">## æŒ‡å®šå¤´æ–‡ä»¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nb">set&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">MY_HEADERS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">myclass.h&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">utils.h&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">## æŒ‡å®šç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶é“¾æ¥åº“
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nb">add_executable&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">myapp&lt;/span> &lt;span class="s">main.cpp&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">target_link_libraries&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">myapp&lt;/span> &lt;span class="s">mylib&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="é¡¹ç›®åŠŸèƒ½">é¡¹ç›®åŠŸèƒ½&lt;/h2>
&lt;p>æœåŠ¡ç«¯éœ€è¦æºæºä¸æ–­çš„è¯»å–ä¸€ä¸ªæœ¬åœ°h264è§†é¢‘æ–‡ä»¶ï¼Œå¹¶å°†è¯»å–åˆ°çš„h264è§†é¢‘æµå°è£…åˆ°RTPæ•°æ®åŒ…ä¸­ï¼Œå†æ¨é€è‡³å®¢æˆ·ç«¯ã€‚è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†ä¸€ä¸ªç®€å•çš„æ”¯æŒRTSPåè®®æµåª’ä½“åˆ†å‘æœåŠ¡ã€‚&lt;/p>
&lt;h2 id="rtpç†è§£">RTPç†è§£&lt;/h2>
&lt;p>RTP:å®æ—¶ä¼ è¾“åè®®ï¼ˆReal-time Transport Protocolæˆ–ç®€å†™RTPï¼‰æ˜¯ä¸€ä¸ªç½‘ç»œä¼ è¾“åè®®.&lt;/p>
&lt;p>RTPå®šä¹‰äº†ä¸¤ç§æŠ¥æ–‡ï¼šRTPæŠ¥æ–‡å’ŒRTCPæŠ¥æ–‡ï¼ŒRTPæŠ¥æ–‡ç”¨äºä¼ é€åª’ä½“æ•°æ®ï¼ˆå¦‚éŸ³é¢‘å’Œè§†é¢‘ï¼‰ï¼Œå®ƒç”± RTPæŠ¥å¤´å’Œæ•°æ®ä¸¤éƒ¨åˆ†ç»„æˆï¼ŒRTPæ•°æ®éƒ¨åˆ†ç§°ä¸ºæœ‰æ•ˆè½½è·(payload)ï¼›&lt;/p>
&lt;p>RTCPæŠ¥æ–‡ç”¨äºä¼ é€æ§åˆ¶ä¿¡æ¯ï¼Œä»¥å®ç°åè®®æ§åˆ¶åŠŸèƒ½ã€‚RTPæŠ¥æ–‡å’ŒRTCP æŠ¥æ–‡å°†ä½œä¸ºä¸‹å±‚åè®®ï¼ˆTCP/UDPï¼‰çš„æ•°æ®å•å…ƒè¿›è¡Œä¼ è¾“ã€‚å¦‚æœä½¿ç”¨UDPï¼Œåˆ™RTPæŠ¥æ–‡å’ŒRTCPæŠ¥æ–‡åˆ†åˆ«ä½¿ç”¨ä¸¤ä¸ªç›¸é‚»çš„UDPç«¯å£ï¼ŒRTPæŠ¥æ–‡ä½¿ç”¨&lt;strong>ä½ç«¯å£&lt;/strong>ï¼ŒRTCPæŠ¥æ–‡ä½¿ç”¨&lt;strong>é«˜ç«¯å£&lt;/strong>ã€‚å¦‚æœä½¿ç”¨å…¶å®ƒçš„ä¸‹å±‚åè®®ï¼ˆTCPï¼‰ï¼ŒRTPæŠ¥æ–‡å’ŒRTCPæŠ¥æ–‡å¯ä»¥åˆå¹¶ï¼Œæ”¾åœ¨ä¸€ä¸ªæ•°æ®å•å…ƒä¸­ä¸€èµ·ä¼ é€ï¼Œæ§åˆ¶ä¿¡æ¯åœ¨å‰ï¼Œåª’ä½“æ•°æ®åœ¨åã€‚é€šå¸¸ï¼ŒRTPæ˜¯ç”±åº”ç”¨ç¨‹åºå®ç°çš„ã€‚&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210444-1.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// RTPå¤´çš„ç»“æ„ä½“
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpHeader&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* byte 0 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">csrcLen&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//CSRCè®¡æ•°å™¨ï¼Œå å4ä½ï¼ŒæŒ‡ç¤ºCSRC æ ‡è¯†ç¬¦çš„ä¸ªæ•°ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">extension&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//å 1ä½ï¼Œåç¬¬äº”ä½ï¼Œå¦‚æœX=1ï¼Œåˆ™åœ¨RTPæŠ¥å¤´åè·Ÿæœ‰ä¸€ä¸ªæ‰©å±•æŠ¥å¤´ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">padding&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//å¡«å……æ ‡å¿—ï¼Œå 1ä½ï¼Œå¦‚æœP=1ï¼Œåˆ™åœ¨è¯¥æŠ¥æ–‡çš„å°¾éƒ¨å¡«å……ä¸€ä¸ªæˆ–å¤šä¸ªé¢å¤–çš„å…«ä½ç»„ï¼Œå®ƒä»¬ä¸æ˜¯æœ‰æ•ˆè½½è·çš„ä¸€éƒ¨åˆ†ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">version&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//RTPåè®®çš„ç‰ˆæœ¬å·ï¼Œå 2ä½ï¼Œå½“å‰åè®®ç‰ˆæœ¬å·ä¸º2ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* byte 1 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">payloadType&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//æœ‰æ•ˆè½½è·ç±»å‹ï¼Œå 7ä½ï¼Œç”¨äºè¯´æ˜RTPæŠ¥æ–‡ä¸­æœ‰æ•ˆè½½è·çš„ç±»å‹ï¼Œå¦‚GSMéŸ³é¢‘ã€JPEMå›¾åƒç­‰ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">marker&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//æ ‡è®°ï¼Œå 1ä½ï¼Œä¸åŒçš„æœ‰æ•ˆè½½è·æœ‰ä¸åŒçš„å«ä¹‰ï¼Œå¯¹äºè§†é¢‘ï¼Œæ ‡è®°ä¸€å¸§çš„ç»“æŸï¼›å¯¹äºéŸ³é¢‘ï¼Œæ ‡è®°ä¼šè¯çš„å¼€å§‹ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* bytes 2,3 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint16_t&lt;/span> &lt;span class="n">seq&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//å 16ä½ï¼Œç”¨äºæ ‡è¯†å‘é€è€…æ‰€å‘é€çš„RTPæŠ¥æ–‡çš„åºåˆ—å·ï¼Œæ¯å‘é€ä¸€ä¸ªæŠ¥æ–‡ï¼Œåºåˆ—å·å¢1ã€‚æ¥æ”¶è€…é€šè¿‡åºåˆ—å·æ¥æ£€æµ‹æŠ¥æ–‡ä¸¢å¤±æƒ…å†µï¼Œé‡æ–°æ’åºæŠ¥æ–‡ï¼Œæ¢å¤æ•°æ®ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* bytes 4-7 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">timestamp&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//å 32ä½ï¼Œæ—¶æˆ³åæ˜ äº†è¯¥RTPæŠ¥æ–‡çš„ç¬¬ä¸€ä¸ªå…«ä½ç»„çš„é‡‡æ ·æ—¶åˆ»ã€‚æ¥æ”¶è€…ä½¿ç”¨æ—¶æˆ³æ¥è®¡ç®—å»¶è¿Ÿå’Œå»¶è¿ŸæŠ–åŠ¨ï¼Œå¹¶è¿›è¡ŒåŒæ­¥æ§åˆ¶ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* bytes 8-11 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">ssrc&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//å 32ä½ï¼Œç”¨äºæ ‡è¯†åŒæ­¥ä¿¡æºã€‚è¯¥æ ‡è¯†ç¬¦æ˜¯éšæœºé€‰æ‹©çš„ï¼Œå‚åŠ åŒä¸€è§†é¢‘ä¼šè®®çš„ä¸¤ä¸ªåŒæ­¥ä¿¡æºä¸èƒ½æœ‰ç›¸åŒçš„SSRCã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/*æ ‡å‡†çš„RTP Header è¿˜å¯èƒ½å­˜åœ¨ 0-15ä¸ªç‰¹çº¦ä¿¡æº(CSRC)æ ‡è¯†ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> æ¯ä¸ªCSRCæ ‡è¯†ç¬¦å 32ä½ï¼Œå¯ä»¥æœ‰0ï½15ä¸ªã€‚æ¯ä¸ªCSRCæ ‡è¯†äº†åŒ…å«åœ¨è¯¥RTPæŠ¥æ–‡æœ‰æ•ˆè½½è·ä¸­çš„æ‰€æœ‰ç‰¹çº¦ä¿¡æº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// RTPåŒ…çš„ç»“æ„ä½“
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// åŒ…å«ä¸€ä¸ªRTPå¤´éƒ¨å’ŒRTPè½½è·
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpHeader&lt;/span> &lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="h264ç†è§£">H264ç†è§£&lt;/h2>
&lt;p>&lt;a href="https://mp.weixin.qq.com/s/SJblG5lj8nzQweM1VnRTEA">é“¾æ¥&lt;/a>&lt;/p>
&lt;ul>
&lt;li>Iå¸§(intraframe frame),å…³é”®å¸§ã€‚
&lt;ul>
&lt;li>é‡‡ç”¨å¸§å†…å‹ç¼©æŠ€æœ¯ã€‚Iå¸§æ˜¯æ‰€æœ‰æ•°æ®å¸§æœ€å…³é”®çš„å¸§ï¼Œå¦‚æœç¼ºå°‘äº†Iå¸§ï¼Œåé¢çš„æ•°æ®å¸§å°†æ— æ³•ä½¿ç”¨ã€‚IDRå¸§å±äºIå¸§ã€‚ä¸¾ä¾‹æˆ‘å°†GOPä¸­ç¬¬ä¸€å¸§å°±å¯ä»¥ç§°ä½œIå¸§ã€‚åœ¨ç¼–ç æ—¶ï¼ŒIå¸§æ˜¯ä¸éœ€è¦å‚è€ƒå‰åå¸§æ•°æ®ï¼Œæ˜¯ç‹¬ç«‹ç¼–ç ã€‚GOPè‡³å°‘æœ‰ä¸€ä¸ªIå¸§ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>På¸§(forward Predicted frame)ï¼Œå‘å‰å‚è€ƒå¸§ã€‚
&lt;ul>
&lt;li>å‹ç¼©æ—¶ï¼Œåªå‚è€ƒå‰é¢å·²ç»å¤„ç†çš„å¸§ï¼Œé‡‡ç”¨å¸§é—´å‹ç¼©æŠ€æœ¯ã€‚å®ƒå Iå¸§çš„ä¸€åŠå¤§å°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Bå¸§(Bidirectionally predicted frame)ï¼ŒåŒå‘å‚è€ƒå¸§ã€‚
&lt;ul>
&lt;li>å‹ç¼©æ—¶ï¼Œæ—¢å‚è€ƒå‰é¢å·²ç»å¤„ç†çš„å¸§ï¼Œä¹Ÿå‚è€ƒåé¢çš„å¸§ï¼Œå¸§é—´å‹ç¼©æŠ€æœ¯ã€‚å®ƒå Iå¸§1/4å¤§å°ã€‚å‹ç¼©ç‡å˜é«˜&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>ç¼–ç åæ•°æ®ï¼Œæ ¹æ®Iå¸§På¸§Bå¸§çš„ç‰¹æ€§ï¼Œåœ¨è§£ç çš„è¿‡ç¨‹æ˜¯æŒ‰Iå¸§ã€På¸§å’ŒBå¸§è¿›è¡Œè§£ç ï¼Œæ–‡ä»¶æ’­æ”¾è¿˜æ˜¯æŒ‰Iå¸§ã€Bå¸§å’ŒPå¸§é¡ºåºæ’­æ”¾&lt;/strong>
IDRå¸§å’ŒIå¸§çš„å…³ç³»ï¼š&lt;/p>
&lt;p>IDR(Instantannous Decoder Refresh) è§£ç å™¨ç«‹å³åˆ·æ–°&lt;/p>
&lt;p>ä½œç”¨ï¼šåœ¨è§£ç çš„è¿‡ç¨‹ï¼Œä¸€æ—¦æœ‰ä¸€å¸§æ•°æ®å‡ºç°é”™è¯¯ï¼Œå°†æ˜¯æ— æ³•æ¢å¤çš„è¿‡ç¨‹ï¼Œåé¢æ•°æ®å¸§ä¸èƒ½ä½¿ç”¨ã€‚å½“æœ‰äº†IDRå¸§ï¼Œè§£ç å™¨æ”¶åˆ°IDRå¸§æ—¶ï¼Œå°±ä¼šå°†ç¼“å†²åŒºçš„æ•°æ®æ¸…ç©ºï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªIDRå¸§ï¼Œé‡æ–°è§£ç ã€‚Iå’ŒIDRå¸§éƒ½ä½¿ç”¨å¸§å†…é¢„æµ‹ï¼Œåœ¨ç¼–ç è§£ç ä¸­ä¸ºäº†æ–¹ä¾¿ï¼Œé¦–ä¸ªIå¸§è¦å’Œå…¶ä»–Iå¸§åŒºåˆ«å¼€ï¼Œ&lt;strong>æŠŠç¬¬ä¸€ä¸ªIå¸§å«IDR&lt;/strong>ï¼Œè¿™æ ·æ–¹ä¾¿æ§åˆ¶ç¼–ç å’Œè§£ç æµç¨‹ã€‚IDRå¸§å¿…é¡»æ˜¯ä¸€ä¸ªIå¸§ï¼Œä½†æ˜¯Iå¸§ä¸ä¸€å®šæ˜¯IDRå¸§ï¼Œè¿™ä¸ªå¸§å‡ºç°çš„æ—¶å€™ï¼Œæ˜¯å‘Šè¯‰è§£ç å™¨ï¼Œå¯ä»¥æ¸…é™¤æ‰æ‰€æœ‰çš„å‚è€ƒå¸§ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¨æ–°çš„åºåˆ—ï¼Œæ–°çš„GOPå·²ç»å¼€å§‹ã€‚Iå¸§æœ‰è¢«è·¨å¸§å‚è€ƒçš„å¯èƒ½,IDRä¸ä¼šã€‚&lt;/p>
&lt;p>æ¯ä¸ªGOPä¸­çš„ç¬¬ä¸€å¸§å°±æ˜¯IDRå¸§ã€‚&lt;/p>
&lt;h2 id="h264ç æµè¿›è¡Œrtpå°è£…">H264ç æµè¿›è¡ŒRTPå°è£…&lt;/h2>
&lt;p>&lt;a href="https://blog.csdn.net/jwybobo2007/article/details/7054140">RTPå°è£…&lt;/a>&lt;/p>
&lt;p>&lt;strong>H.264ç”±ä¸€ä¸ªä¸€ä¸ªçš„NALUç»„æˆ&lt;/strong>ï¼Œæ¯ä¸ªNALUä¹‹é—´ä½¿ç”¨&lt;strong>00 00 00 01&lt;/strong>æˆ–&lt;strong>00 00 01&lt;/strong>åˆ†éš”å¼€&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210444-2.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;ol>
&lt;li>F(forbiden):ç¦æ­¢ä½ï¼Œå ç”¨NALUå¤´çš„ç¬¬ä¸€ä¸ªä½ï¼Œå½“ç¦æ­¢ä½å€¼ä¸º1æ—¶è¡¨ç¤ºè¯­æ³•é”™è¯¯ï¼›&lt;/li>
&lt;li>NRI:å‚è€ƒçº§åˆ«ï¼Œå ç”¨NALUå¤´çš„ç¬¬äºŒåˆ°ç¬¬ä¸‰ä¸ªä½ï¼›å€¼è¶Šå¤§ï¼Œè¯¥NALè¶Šé‡è¦ã€‚&lt;/li>
&lt;li>Type:Naluæ•°æ®ç±»å‹ï¼Œä¹Ÿå°±æ˜¯æ ‡è¯†è¯¥NALuçš„æ•°æ®ç±»å‹æ˜¯å“ªç§ï¼Œå ç”¨NALUå¤´çš„ç¬¬4åˆ°ç¬¬8ä¸ªä½ï¼›&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210444-3.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/qq_29350001/article/details/78226286#t0">å›¾ç‰‡æ¥æº&lt;/a>&lt;/li>
&lt;li>0x61 (0 11 00001) Iå¸§ type = 1&lt;/li>
&lt;li>0x41 (0 10 00001) På¸§ type = 1&lt;/li>
&lt;li>0x01 (0 00 00001) Bå¸§ type = 1&lt;/li>
&lt;/ul>
&lt;p>æ‰“åŒ…æ–¹å¼ï¼š&lt;/p>
&lt;ol>
&lt;li>å•NALUæ‰“åŒ…&lt;/li>
&lt;/ol>
&lt;p>æ‰€è°“å•NALUæ‰“åŒ…å°±æ˜¯å°†ä¸€æ•´ä¸ªNALUçš„æ•°æ®æ”¾å…¥RTPåŒ…ï¼ˆRTPå¤´+RTPè½½è·ï¼‰çš„&lt;strong>è½½è·&lt;/strong>ä¸­ï¼Œè¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§æ–¹å¼ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>åˆ†ç‰‡æ‰“åŒ…&lt;/li>
&lt;/ol>
&lt;p>æ¯ä¸ªRTPåŒ…éƒ½æœ‰å¤§å°é™åˆ¶çš„ï¼Œå› ä¸ºRTPä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨UDPå‘é€ï¼ŒUDPæ²¡æœ‰æµé‡æ§åˆ¶ï¼Œæ‰€ä»¥è¦é™åˆ¶æ¯ä¸€æ¬¡å‘é€çš„å¤§å°ï¼Œæ‰€ä»¥å¦‚æœä¸€ä¸ªNALUçš„å¤ªå¤§ï¼Œå°±éœ€è¦åˆ†æˆå¤šä¸ªRTPåŒ…å‘é€ï¼Œè‡³äºå¦‚ä½•åˆ†æˆå¤šä¸ªRTPåŒ…ï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;p>é¦–å…ˆè¦æ˜ç¡®ï¼ŒRTPåŒ…çš„æ ¼å¼æ˜¯ç»ä¸ä¼šå˜çš„ï¼Œæ°¸è¿œéƒ½æ˜¯RTPå¤´+RTPè½½è·&lt;/p>
&lt;p>RTPå¤´éƒ¨æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆåªèƒ½åœ¨&lt;strong>RTPè½½è·ä¸­å»æ·»åŠ é¢å¤–ä¿¡æ¯&lt;/strong>æ¥è¯´æ˜è¿™ä¸ªRTPåŒ…æ˜¯è¡¨ç¤ºåŒä¸€ä¸ªNALU&lt;/p>
&lt;p>å¦‚æœæ˜¯åˆ†ç‰‡æ‰“åŒ…çš„è¯ï¼Œé‚£ä¹ˆåœ¨RTPè½½è·å¼€å§‹æœ‰&lt;strong>ä¸¤ä¸ªå­—èŠ‚çš„ä¿¡æ¯&lt;/strong>ï¼Œç„¶åå†æ˜¯NALUçš„å†…å®¹&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210444-4.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;p>ç¬¬ä¸€ä¸ªå­—èŠ‚&lt;strong>FU Indicator&lt;/strong>ï¼Œå…¶æ ¼å¼å¦‚ä¸‹&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210444-5.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;p>é«˜ä¸‰ä½ï¼šä¸NALUç¬¬ä¸€ä¸ªå­—èŠ‚çš„é«˜ä¸‰ä½ç›¸åŒ&lt;/p>
&lt;p>Typeï¼š28ï¼Œè¡¨ç¤ºè¯¥RTPåŒ…ä¸€ä¸ªåˆ†ç‰‡ï¼Œä¸ºä»€ä¹ˆæ˜¯28ï¼Ÿå› ä¸ºH.264çš„è§„èŒƒä¸­å®šä¹‰çš„ï¼Œæ­¤å¤–è¿˜æœ‰è®¸å¤šå…¶ä»–Typeï¼Œè¿™é‡Œä¸è¯¦è®²&lt;/p>
&lt;p>ç¬¬äºŒä¸ªå­—èŠ‚&lt;strong>FU Header&lt;/strong>ï¼Œå…¶æ ¼å¼å¦‚ä¸‹&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210444-6.png?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="image.png">&lt;/p>
&lt;p>Sï¼šæ ‡è®°è¯¥åˆ†ç‰‡æ‰“åŒ…çš„ç¬¬ä¸€ä¸ªRTPåŒ…&lt;/p>
&lt;p>Eï¼šæ¯”è¾ƒè¯¥åˆ†ç‰‡æ‰“åŒ…çš„æœ€åä¸€ä¸ªRTPåŒ…&lt;/p>
&lt;p>Typeï¼šNALUçš„Typeï¼Œä¸åŒä¸FU Indicatorçš„type&lt;/p>
&lt;h2 id="ä»£ç ">ä»£ç &lt;/h2>
&lt;p>**ffmpeg -i test.mp4 -codec copy -bsf: h264_mp4toannexb -f h264 test.h264 **ç”Ÿæˆh264æ–‡ä»¶&lt;/p>
&lt;h3 id="rtphæ–‡ä»¶">rtp.hæ–‡ä»¶&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#pragma once
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdint.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define RTP_VERSION 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define RTP_PAYLOAD_TYPE_H264 96
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define RTP_PAYLOAD_TYPE_AAC 97
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define RTP_HEADER_SIZE 12
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define RTP_MAX_PKT_SIZE 1400
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 0 1 2 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 7 6 5 4 3 2 1 0|7 6 5 4 3 2 1 0|7 6 5 4 3 2 1 0|7 6 5 4 3 2 1 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * |V=2|P|X| CC |M| PT | sequence number |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * | timestamp |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * | synchronization source (SSRC) identifier |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * | contributing source (CSRC) identifiers |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * : .... :
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> *
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpHeader&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* byte 0 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">csrcLen&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//CSRCè®¡æ•°å™¨ï¼Œå 4ä½ï¼ŒæŒ‡ç¤ºCSRC æ ‡è¯†ç¬¦çš„ä¸ªæ•°ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">extension&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//å 1ä½ï¼Œå¦‚æœX=1ï¼Œåˆ™åœ¨RTPæŠ¥å¤´åè·Ÿæœ‰ä¸€ä¸ªæ‰©å±•æŠ¥å¤´ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">padding&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//å¡«å……æ ‡å¿—ï¼Œå 1ä½ï¼Œå¦‚æœP=1ï¼Œåˆ™åœ¨è¯¥æŠ¥æ–‡çš„å°¾éƒ¨å¡«å……ä¸€ä¸ªæˆ–å¤šä¸ªé¢å¤–çš„å…«ä½ç»„ï¼Œå®ƒä»¬ä¸æ˜¯æœ‰æ•ˆè½½è·çš„ä¸€éƒ¨åˆ†ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">version&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//RTPåè®®çš„ç‰ˆæœ¬å·ï¼Œå 2ä½ï¼Œå½“å‰åè®®ç‰ˆæœ¬å·ä¸º2ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* byte 1 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">payloadType&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//æœ‰æ•ˆè½½è·ç±»å‹ï¼Œå 7ä½ï¼Œç”¨äºè¯´æ˜RTPæŠ¥æ–‡ä¸­æœ‰æ•ˆè½½è·çš„ç±»å‹ï¼Œå¦‚GSMéŸ³é¢‘ã€JPEMå›¾åƒç­‰ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="nl">marker&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//æ ‡è®°ï¼Œå 1ä½ï¼Œä¸åŒçš„æœ‰æ•ˆè½½è·æœ‰ä¸åŒçš„å«ä¹‰ï¼Œå¯¹äºè§†é¢‘ï¼Œæ ‡è®°ä¸€å¸§çš„ç»“æŸï¼›å¯¹äºéŸ³é¢‘ï¼Œæ ‡è®°ä¼šè¯çš„å¼€å§‹ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* bytes 2,3 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint16_t&lt;/span> &lt;span class="n">seq&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//å 16ä½ï¼Œç”¨äºæ ‡è¯†å‘é€è€…æ‰€å‘é€çš„RTPæŠ¥æ–‡çš„åºåˆ—å·ï¼Œæ¯å‘é€ä¸€ä¸ªæŠ¥æ–‡ï¼Œåºåˆ—å·å¢1ã€‚æ¥æ”¶è€…é€šè¿‡åºåˆ—å·æ¥æ£€æµ‹æŠ¥æ–‡ä¸¢å¤±æƒ…å†µï¼Œé‡æ–°æ’åºæŠ¥æ–‡ï¼Œæ¢å¤æ•°æ®ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* bytes 4-7 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">timestamp&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//å 32ä½ï¼Œæ—¶æˆ³åæ˜ äº†è¯¥RTPæŠ¥æ–‡çš„ç¬¬ä¸€ä¸ªå…«ä½ç»„çš„é‡‡æ ·æ—¶åˆ»ã€‚æ¥æ”¶è€…ä½¿ç”¨æ—¶æˆ³æ¥è®¡ç®—å»¶è¿Ÿå’Œå»¶è¿ŸæŠ–åŠ¨ï¼Œå¹¶è¿›è¡ŒåŒæ­¥æ§åˆ¶ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* bytes 8-11 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">ssrc&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//å 32ä½ï¼Œç”¨äºæ ‡è¯†åŒæ­¥ä¿¡æºã€‚è¯¥æ ‡è¯†ç¬¦æ˜¯éšæœºé€‰æ‹©çš„ï¼Œå‚åŠ åŒä¸€è§†é¢‘ä¼šè®®çš„ä¸¤ä¸ªåŒæ­¥ä¿¡æºä¸èƒ½æœ‰ç›¸åŒçš„SSRCã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/*æ ‡å‡†çš„RTP Header è¿˜å¯èƒ½å­˜åœ¨ 0-15ä¸ªç‰¹çº¦ä¿¡æº(CSRC)æ ‡è¯†ç¬¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> æ¯ä¸ªCSRCæ ‡è¯†ç¬¦å 32ä½ï¼Œå¯ä»¥æœ‰0ï½15ä¸ªã€‚æ¯ä¸ªCSRCæ ‡è¯†äº†åŒ…å«åœ¨è¯¥RTPæŠ¥æ–‡æœ‰æ•ˆè½½è·ä¸­çš„æ‰€æœ‰ç‰¹çº¦ä¿¡æº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpHeader&lt;/span> &lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">rtpHeaderInit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">csrcLen&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">extension&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">padding&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">payloadType&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">marker&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint16_t&lt;/span> &lt;span class="n">seq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">timestamp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">ssrc&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">rtpSendPacketOverTcp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">dataSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="n">channel&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">rtpSendPacketOverUdp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int16_t&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">dataSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="rtpcpp">rtp.cpp&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;rtp.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdint.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">rtpHeaderInit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">csrcLen&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">extension&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">padding&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">payloadType&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">marker&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint16_t&lt;/span> &lt;span class="n">seq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">timestamp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">ssrc&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">csrcLen&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">csrcLen&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">extension&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">extension&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">padding&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">padding&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">version&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">payloadType&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">payloadType&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">marker&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">marker&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">seq&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">timestamp&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ssrc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ssrc&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">rtpSendPacketOverTcp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">dataSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="n">channel&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htonl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ssrc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htonl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ssrc&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">rtpSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">RTP_HEADER_SIZE&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">dataSize&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">tempBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">rtpSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">tempBuf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x24&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">//$
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">tempBuf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">channel&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="c1">// 0x00;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">tempBuf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)(((&lt;/span>&lt;span class="n">rtpSize&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xFF00&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">tempBuf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">uint8_t&lt;/span>&lt;span class="p">)((&lt;/span>&lt;span class="n">rtpSize&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0xFF&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tempBuf&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">tempBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">rtpSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ssrc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ssrc&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tempBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">tempBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">rtpSendPacketOverUdp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int16_t&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">dataSize&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AF_INET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inet_addr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">//h to nä»ä¸»æœºå­—èŠ‚é¡ºåºè½¬å˜æˆç½‘ç»œå­—èŠ‚é¡ºåº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htonl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ssrc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htonl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ssrc&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sendto&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">dataSize&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">RTP_HEADER_SIZE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ssrc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ssrc&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="maincpp">main.cpp&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;span class="lnt">137
&lt;/span>&lt;span class="lnt">138
&lt;/span>&lt;span class="lnt">139
&lt;/span>&lt;span class="lnt">140
&lt;/span>&lt;span class="lnt">141
&lt;/span>&lt;span class="lnt">142
&lt;/span>&lt;span class="lnt">143
&lt;/span>&lt;span class="lnt">144
&lt;/span>&lt;span class="lnt">145
&lt;/span>&lt;span class="lnt">146
&lt;/span>&lt;span class="lnt">147
&lt;/span>&lt;span class="lnt">148
&lt;/span>&lt;span class="lnt">149
&lt;/span>&lt;span class="lnt">150
&lt;/span>&lt;span class="lnt">151
&lt;/span>&lt;span class="lnt">152
&lt;/span>&lt;span class="lnt">153
&lt;/span>&lt;span class="lnt">154
&lt;/span>&lt;span class="lnt">155
&lt;/span>&lt;span class="lnt">156
&lt;/span>&lt;span class="lnt">157
&lt;/span>&lt;span class="lnt">158
&lt;/span>&lt;span class="lnt">159
&lt;/span>&lt;span class="lnt">160
&lt;/span>&lt;span class="lnt">161
&lt;/span>&lt;span class="lnt">162
&lt;/span>&lt;span class="lnt">163
&lt;/span>&lt;span class="lnt">164
&lt;/span>&lt;span class="lnt">165
&lt;/span>&lt;span class="lnt">166
&lt;/span>&lt;span class="lnt">167
&lt;/span>&lt;span class="lnt">168
&lt;/span>&lt;span class="lnt">169
&lt;/span>&lt;span class="lnt">170
&lt;/span>&lt;span class="lnt">171
&lt;/span>&lt;span class="lnt">172
&lt;/span>&lt;span class="lnt">173
&lt;/span>&lt;span class="lnt">174
&lt;/span>&lt;span class="lnt">175
&lt;/span>&lt;span class="lnt">176
&lt;/span>&lt;span class="lnt">177
&lt;/span>&lt;span class="lnt">178
&lt;/span>&lt;span class="lnt">179
&lt;/span>&lt;span class="lnt">180
&lt;/span>&lt;span class="lnt">181
&lt;/span>&lt;span class="lnt">182
&lt;/span>&lt;span class="lnt">183
&lt;/span>&lt;span class="lnt">184
&lt;/span>&lt;span class="lnt">185
&lt;/span>&lt;span class="lnt">186
&lt;/span>&lt;span class="lnt">187
&lt;/span>&lt;span class="lnt">188
&lt;/span>&lt;span class="lnt">189
&lt;/span>&lt;span class="lnt">190
&lt;/span>&lt;span class="lnt">191
&lt;/span>&lt;span class="lnt">192
&lt;/span>&lt;span class="lnt">193
&lt;/span>&lt;span class="lnt">194
&lt;/span>&lt;span class="lnt">195
&lt;/span>&lt;span class="lnt">196
&lt;/span>&lt;span class="lnt">197
&lt;/span>&lt;span class="lnt">198
&lt;/span>&lt;span class="lnt">199
&lt;/span>&lt;span class="lnt">200
&lt;/span>&lt;span class="lnt">201
&lt;/span>&lt;span class="lnt">202
&lt;/span>&lt;span class="lnt">203
&lt;/span>&lt;span class="lnt">204
&lt;/span>&lt;span class="lnt">205
&lt;/span>&lt;span class="lnt">206
&lt;/span>&lt;span class="lnt">207
&lt;/span>&lt;span class="lnt">208
&lt;/span>&lt;span class="lnt">209
&lt;/span>&lt;span class="lnt">210
&lt;/span>&lt;span class="lnt">211
&lt;/span>&lt;span class="lnt">212
&lt;/span>&lt;span class="lnt">213
&lt;/span>&lt;span class="lnt">214
&lt;/span>&lt;span class="lnt">215
&lt;/span>&lt;span class="lnt">216
&lt;/span>&lt;span class="lnt">217
&lt;/span>&lt;span class="lnt">218
&lt;/span>&lt;span class="lnt">219
&lt;/span>&lt;span class="lnt">220
&lt;/span>&lt;span class="lnt">221
&lt;/span>&lt;span class="lnt">222
&lt;/span>&lt;span class="lnt">223
&lt;/span>&lt;span class="lnt">224
&lt;/span>&lt;span class="lnt">225
&lt;/span>&lt;span class="lnt">226
&lt;/span>&lt;span class="lnt">227
&lt;/span>&lt;span class="lnt">228
&lt;/span>&lt;span class="lnt">229
&lt;/span>&lt;span class="lnt">230
&lt;/span>&lt;span class="lnt">231
&lt;/span>&lt;span class="lnt">232
&lt;/span>&lt;span class="lnt">233
&lt;/span>&lt;span class="lnt">234
&lt;/span>&lt;span class="lnt">235
&lt;/span>&lt;span class="lnt">236
&lt;/span>&lt;span class="lnt">237
&lt;/span>&lt;span class="lnt">238
&lt;/span>&lt;span class="lnt">239
&lt;/span>&lt;span class="lnt">240
&lt;/span>&lt;span class="lnt">241
&lt;/span>&lt;span class="lnt">242
&lt;/span>&lt;span class="lnt">243
&lt;/span>&lt;span class="lnt">244
&lt;/span>&lt;span class="lnt">245
&lt;/span>&lt;span class="lnt">246
&lt;/span>&lt;span class="lnt">247
&lt;/span>&lt;span class="lnt">248
&lt;/span>&lt;span class="lnt">249
&lt;/span>&lt;span class="lnt">250
&lt;/span>&lt;span class="lnt">251
&lt;/span>&lt;span class="lnt">252
&lt;/span>&lt;span class="lnt">253
&lt;/span>&lt;span class="lnt">254
&lt;/span>&lt;span class="lnt">255
&lt;/span>&lt;span class="lnt">256
&lt;/span>&lt;span class="lnt">257
&lt;/span>&lt;span class="lnt">258
&lt;/span>&lt;span class="lnt">259
&lt;/span>&lt;span class="lnt">260
&lt;/span>&lt;span class="lnt">261
&lt;/span>&lt;span class="lnt">262
&lt;/span>&lt;span class="lnt">263
&lt;/span>&lt;span class="lnt">264
&lt;/span>&lt;span class="lnt">265
&lt;/span>&lt;span class="lnt">266
&lt;/span>&lt;span class="lnt">267
&lt;/span>&lt;span class="lnt">268
&lt;/span>&lt;span class="lnt">269
&lt;/span>&lt;span class="lnt">270
&lt;/span>&lt;span class="lnt">271
&lt;/span>&lt;span class="lnt">272
&lt;/span>&lt;span class="lnt">273
&lt;/span>&lt;span class="lnt">274
&lt;/span>&lt;span class="lnt">275
&lt;/span>&lt;span class="lnt">276
&lt;/span>&lt;span class="lnt">277
&lt;/span>&lt;span class="lnt">278
&lt;/span>&lt;span class="lnt">279
&lt;/span>&lt;span class="lnt">280
&lt;/span>&lt;span class="lnt">281
&lt;/span>&lt;span class="lnt">282
&lt;/span>&lt;span class="lnt">283
&lt;/span>&lt;span class="lnt">284
&lt;/span>&lt;span class="lnt">285
&lt;/span>&lt;span class="lnt">286
&lt;/span>&lt;span class="lnt">287
&lt;/span>&lt;span class="lnt">288
&lt;/span>&lt;span class="lnt">289
&lt;/span>&lt;span class="lnt">290
&lt;/span>&lt;span class="lnt">291
&lt;/span>&lt;span class="lnt">292
&lt;/span>&lt;span class="lnt">293
&lt;/span>&lt;span class="lnt">294
&lt;/span>&lt;span class="lnt">295
&lt;/span>&lt;span class="lnt">296
&lt;/span>&lt;span class="lnt">297
&lt;/span>&lt;span class="lnt">298
&lt;/span>&lt;span class="lnt">299
&lt;/span>&lt;span class="lnt">300
&lt;/span>&lt;span class="lnt">301
&lt;/span>&lt;span class="lnt">302
&lt;/span>&lt;span class="lnt">303
&lt;/span>&lt;span class="lnt">304
&lt;/span>&lt;span class="lnt">305
&lt;/span>&lt;span class="lnt">306
&lt;/span>&lt;span class="lnt">307
&lt;/span>&lt;span class="lnt">308
&lt;/span>&lt;span class="lnt">309
&lt;/span>&lt;span class="lnt">310
&lt;/span>&lt;span class="lnt">311
&lt;/span>&lt;span class="lnt">312
&lt;/span>&lt;span class="lnt">313
&lt;/span>&lt;span class="lnt">314
&lt;/span>&lt;span class="lnt">315
&lt;/span>&lt;span class="lnt">316
&lt;/span>&lt;span class="lnt">317
&lt;/span>&lt;span class="lnt">318
&lt;/span>&lt;span class="lnt">319
&lt;/span>&lt;span class="lnt">320
&lt;/span>&lt;span class="lnt">321
&lt;/span>&lt;span class="lnt">322
&lt;/span>&lt;span class="lnt">323
&lt;/span>&lt;span class="lnt">324
&lt;/span>&lt;span class="lnt">325
&lt;/span>&lt;span class="lnt">326
&lt;/span>&lt;span class="lnt">327
&lt;/span>&lt;span class="lnt">328
&lt;/span>&lt;span class="lnt">329
&lt;/span>&lt;span class="lnt">330
&lt;/span>&lt;span class="lnt">331
&lt;/span>&lt;span class="lnt">332
&lt;/span>&lt;span class="lnt">333
&lt;/span>&lt;span class="lnt">334
&lt;/span>&lt;span class="lnt">335
&lt;/span>&lt;span class="lnt">336
&lt;/span>&lt;span class="lnt">337
&lt;/span>&lt;span class="lnt">338
&lt;/span>&lt;span class="lnt">339
&lt;/span>&lt;span class="lnt">340
&lt;/span>&lt;span class="lnt">341
&lt;/span>&lt;span class="lnt">342
&lt;/span>&lt;span class="lnt">343
&lt;/span>&lt;span class="lnt">344
&lt;/span>&lt;span class="lnt">345
&lt;/span>&lt;span class="lnt">346
&lt;/span>&lt;span class="lnt">347
&lt;/span>&lt;span class="lnt">348
&lt;/span>&lt;span class="lnt">349
&lt;/span>&lt;span class="lnt">350
&lt;/span>&lt;span class="lnt">351
&lt;/span>&lt;span class="lnt">352
&lt;/span>&lt;span class="lnt">353
&lt;/span>&lt;span class="lnt">354
&lt;/span>&lt;span class="lnt">355
&lt;/span>&lt;span class="lnt">356
&lt;/span>&lt;span class="lnt">357
&lt;/span>&lt;span class="lnt">358
&lt;/span>&lt;span class="lnt">359
&lt;/span>&lt;span class="lnt">360
&lt;/span>&lt;span class="lnt">361
&lt;/span>&lt;span class="lnt">362
&lt;/span>&lt;span class="lnt">363
&lt;/span>&lt;span class="lnt">364
&lt;/span>&lt;span class="lnt">365
&lt;/span>&lt;span class="lnt">366
&lt;/span>&lt;span class="lnt">367
&lt;/span>&lt;span class="lnt">368
&lt;/span>&lt;span class="lnt">369
&lt;/span>&lt;span class="lnt">370
&lt;/span>&lt;span class="lnt">371
&lt;/span>&lt;span class="lnt">372
&lt;/span>&lt;span class="lnt">373
&lt;/span>&lt;span class="lnt">374
&lt;/span>&lt;span class="lnt">375
&lt;/span>&lt;span class="lnt">376
&lt;/span>&lt;span class="lnt">377
&lt;/span>&lt;span class="lnt">378
&lt;/span>&lt;span class="lnt">379
&lt;/span>&lt;span class="lnt">380
&lt;/span>&lt;span class="lnt">381
&lt;/span>&lt;span class="lnt">382
&lt;/span>&lt;span class="lnt">383
&lt;/span>&lt;span class="lnt">384
&lt;/span>&lt;span class="lnt">385
&lt;/span>&lt;span class="lnt">386
&lt;/span>&lt;span class="lnt">387
&lt;/span>&lt;span class="lnt">388
&lt;/span>&lt;span class="lnt">389
&lt;/span>&lt;span class="lnt">390
&lt;/span>&lt;span class="lnt">391
&lt;/span>&lt;span class="lnt">392
&lt;/span>&lt;span class="lnt">393
&lt;/span>&lt;span class="lnt">394
&lt;/span>&lt;span class="lnt">395
&lt;/span>&lt;span class="lnt">396
&lt;/span>&lt;span class="lnt">397
&lt;/span>&lt;span class="lnt">398
&lt;/span>&lt;span class="lnt">399
&lt;/span>&lt;span class="lnt">400
&lt;/span>&lt;span class="lnt">401
&lt;/span>&lt;span class="lnt">402
&lt;/span>&lt;span class="lnt">403
&lt;/span>&lt;span class="lnt">404
&lt;/span>&lt;span class="lnt">405
&lt;/span>&lt;span class="lnt">406
&lt;/span>&lt;span class="lnt">407
&lt;/span>&lt;span class="lnt">408
&lt;/span>&lt;span class="lnt">409
&lt;/span>&lt;span class="lnt">410
&lt;/span>&lt;span class="lnt">411
&lt;/span>&lt;span class="lnt">412
&lt;/span>&lt;span class="lnt">413
&lt;/span>&lt;span class="lnt">414
&lt;/span>&lt;span class="lnt">415
&lt;/span>&lt;span class="lnt">416
&lt;/span>&lt;span class="lnt">417
&lt;/span>&lt;span class="lnt">418
&lt;/span>&lt;span class="lnt">419
&lt;/span>&lt;span class="lnt">420
&lt;/span>&lt;span class="lnt">421
&lt;/span>&lt;span class="lnt">422
&lt;/span>&lt;span class="lnt">423
&lt;/span>&lt;span class="lnt">424
&lt;/span>&lt;span class="lnt">425
&lt;/span>&lt;span class="lnt">426
&lt;/span>&lt;span class="lnt">427
&lt;/span>&lt;span class="lnt">428
&lt;/span>&lt;span class="lnt">429
&lt;/span>&lt;span class="lnt">430
&lt;/span>&lt;span class="lnt">431
&lt;/span>&lt;span class="lnt">432
&lt;/span>&lt;span class="lnt">433
&lt;/span>&lt;span class="lnt">434
&lt;/span>&lt;span class="lnt">435
&lt;/span>&lt;span class="lnt">436
&lt;/span>&lt;span class="lnt">437
&lt;/span>&lt;span class="lnt">438
&lt;/span>&lt;span class="lnt">439
&lt;/span>&lt;span class="lnt">440
&lt;/span>&lt;span class="lnt">441
&lt;/span>&lt;span class="lnt">442
&lt;/span>&lt;span class="lnt">443
&lt;/span>&lt;span class="lnt">444
&lt;/span>&lt;span class="lnt">445
&lt;/span>&lt;span class="lnt">446
&lt;/span>&lt;span class="lnt">447
&lt;/span>&lt;span class="lnt">448
&lt;/span>&lt;span class="lnt">449
&lt;/span>&lt;span class="lnt">450
&lt;/span>&lt;span class="lnt">451
&lt;/span>&lt;span class="lnt">452
&lt;/span>&lt;span class="lnt">453
&lt;/span>&lt;span class="lnt">454
&lt;/span>&lt;span class="lnt">455
&lt;/span>&lt;span class="lnt">456
&lt;/span>&lt;span class="lnt">457
&lt;/span>&lt;span class="lnt">458
&lt;/span>&lt;span class="lnt">459
&lt;/span>&lt;span class="lnt">460
&lt;/span>&lt;span class="lnt">461
&lt;/span>&lt;span class="lnt">462
&lt;/span>&lt;span class="lnt">463
&lt;/span>&lt;span class="lnt">464
&lt;/span>&lt;span class="lnt">465
&lt;/span>&lt;span class="lnt">466
&lt;/span>&lt;span class="lnt">467
&lt;/span>&lt;span class="lnt">468
&lt;/span>&lt;span class="lnt">469
&lt;/span>&lt;span class="lnt">470
&lt;/span>&lt;span class="lnt">471
&lt;/span>&lt;span class="lnt">472
&lt;/span>&lt;span class="lnt">473
&lt;/span>&lt;span class="lnt">474
&lt;/span>&lt;span class="lnt">475
&lt;/span>&lt;span class="lnt">476
&lt;/span>&lt;span class="lnt">477
&lt;/span>&lt;span class="lnt">478
&lt;/span>&lt;span class="lnt">479
&lt;/span>&lt;span class="lnt">480
&lt;/span>&lt;span class="lnt">481
&lt;/span>&lt;span class="lnt">482
&lt;/span>&lt;span class="lnt">483
&lt;/span>&lt;span class="lnt">484
&lt;/span>&lt;span class="lnt">485
&lt;/span>&lt;span class="lnt">486
&lt;/span>&lt;span class="lnt">487
&lt;/span>&lt;span class="lnt">488
&lt;/span>&lt;span class="lnt">489
&lt;/span>&lt;span class="lnt">490
&lt;/span>&lt;span class="lnt">491
&lt;/span>&lt;span class="lnt">492
&lt;/span>&lt;span class="lnt">493
&lt;/span>&lt;span class="lnt">494
&lt;/span>&lt;span class="lnt">495
&lt;/span>&lt;span class="lnt">496
&lt;/span>&lt;span class="lnt">497
&lt;/span>&lt;span class="lnt">498
&lt;/span>&lt;span class="lnt">499
&lt;/span>&lt;span class="lnt">500
&lt;/span>&lt;span class="lnt">501
&lt;/span>&lt;span class="lnt">502
&lt;/span>&lt;span class="lnt">503
&lt;/span>&lt;span class="lnt">504
&lt;/span>&lt;span class="lnt">505
&lt;/span>&lt;span class="lnt">506
&lt;/span>&lt;span class="lnt">507
&lt;/span>&lt;span class="lnt">508
&lt;/span>&lt;span class="lnt">509
&lt;/span>&lt;span class="lnt">510
&lt;/span>&lt;span class="lnt">511
&lt;/span>&lt;span class="lnt">512
&lt;/span>&lt;span class="lnt">513
&lt;/span>&lt;span class="lnt">514
&lt;/span>&lt;span class="lnt">515
&lt;/span>&lt;span class="lnt">516
&lt;/span>&lt;span class="lnt">517
&lt;/span>&lt;span class="lnt">518
&lt;/span>&lt;span class="lnt">519
&lt;/span>&lt;span class="lnt">520
&lt;/span>&lt;span class="lnt">521
&lt;/span>&lt;span class="lnt">522
&lt;/span>&lt;span class="lnt">523
&lt;/span>&lt;span class="lnt">524
&lt;/span>&lt;span class="lnt">525
&lt;/span>&lt;span class="lnt">526
&lt;/span>&lt;span class="lnt">527
&lt;/span>&lt;span class="lnt">528
&lt;/span>&lt;span class="lnt">529
&lt;/span>&lt;span class="lnt">530
&lt;/span>&lt;span class="lnt">531
&lt;/span>&lt;span class="lnt">532
&lt;/span>&lt;span class="lnt">533
&lt;/span>&lt;span class="lnt">534
&lt;/span>&lt;span class="lnt">535
&lt;/span>&lt;span class="lnt">536
&lt;/span>&lt;span class="lnt">537
&lt;/span>&lt;span class="lnt">538
&lt;/span>&lt;span class="lnt">539
&lt;/span>&lt;span class="lnt">540
&lt;/span>&lt;span class="lnt">541
&lt;/span>&lt;span class="lnt">542
&lt;/span>&lt;span class="lnt">543
&lt;/span>&lt;span class="lnt">544
&lt;/span>&lt;span class="lnt">545
&lt;/span>&lt;span class="lnt">546
&lt;/span>&lt;span class="lnt">547
&lt;/span>&lt;span class="lnt">548
&lt;/span>&lt;span class="lnt">549
&lt;/span>&lt;span class="lnt">550
&lt;/span>&lt;span class="lnt">551
&lt;/span>&lt;span class="lnt">552
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;rtp.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdint.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define H264_FILE_NAME &amp;#34;./data/test.h264&amp;#34; &lt;/span>&lt;span class="c1">// ä¿®æ”¹æ–‡ä»¶ä½ç½®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cp">#define SERVER_PORT 8554
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SERVER_RTP_PORT 55532
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SERVER_RTCP_PORT 55533
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define BUF_MAX_SIZE (1024*1024)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">createTcpSocket&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_REUSEADDR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">createUdpSocket&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_DGRAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_REUSEADDR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AF_INET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inet_addr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">acceptClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clientfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">inet_ntoa&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="n">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">clientfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kr">inline&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// h264æ–‡ä»¶å¿…å®šå·²001 || 0001å¼€å¤´
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kr">inline&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">startCode4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nf">findNextStartCode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">len&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// æ‰¾åˆ°ä¸‹ä¸€ä¸ªnaluåŒ…å¼€å§‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">len&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">len&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="n">startCode4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">++&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// http://c.biancheng.net/view/1769.html
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">getFrameFromH264File&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">FILE&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">rSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">nextStartCode&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// è¯»å–1*sizeä¸ªæ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="n">startCode4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// åˆ¤æ–­frameæ˜¯å¦åˆæ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">nextStartCode&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">findNextStartCode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rSize&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// æ’é™¤startCodeå‰ä¸‰ä½ï¼Ÿ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">nextStartCode&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//lseek(fd, 0, SEEK_SET);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//frameSize = rSize;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nextStartCode&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// é«˜åœ°å€-ä½åœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä»å½“å‰ä½ç½®å‰ç§»rSize-frameSizeä¸ªï¼ˆç¬¬ä¸€æ¬¡æ˜¯æ–‡ä»¶å¤´åˆ°ç¬¬ä¸€ä¸ªnaluåŒ…å°¾çš„æ•°æ®ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//å¹¶ä¸”ä¸‹æ¬¡è¯»å–ä»è¯¥ä½ç½®è¯»å–ï¼Œæ‰€ä»¥ä¸ä¼šä¸€ç›´æ˜¯ç›¸åŒå€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">fseek&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">rSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SEEK_CUR&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">rtpSendH264Frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int16_t&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint32_t&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint8_t&lt;/span> &lt;span class="n">naluType&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sendBytes&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">naluType&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">];&lt;/span> &lt;span class="c1">// naluå¤´ç¬¬ä¸€ä¸ªå­—èŠ‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;frameSize=%d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">frameSize&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// nalué•¿åº¦å°äºæœ€å¤§åŒ…é•¿ï¼šå•ä¸€NALUå•å…ƒæ¨¡å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//* 0 1 2 3 4 5 6 7 8 9
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* |F|NRI| Type | a single NAL unit ... |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rtpSendPacketOverUdp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sendBytes&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">6&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// å¦‚æœæ˜¯SEIã€SPSã€PPSå°±ä¸éœ€è¦åŠ æ—¶é—´æˆ³
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">goto&lt;/span> &lt;span class="n">out&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="c1">// nalué•¿åº¦å°äºæœ€å¤§åŒ…åœºï¼šåˆ†ç‰‡æ¨¡å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//* 0 1 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* | FU indicator | FU header | FU payload ... |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//* FU Indicator
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* 0 1 2 3 4 5 6 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* |F|NRI| Type |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +---------------+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//* FU Header
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* 0 1 2 3 4 5 6 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +-+-+-+-+-+-+-+-+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* |S|E|R| Type |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//* +---------------+
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">pktNum&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// æœ‰å‡ ä¸ªå®Œæ•´çš„åŒ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">remainPktSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å‰©ä½™ä¸å®Œæ•´åŒ…çš„å¤§å°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pos&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å‘é€å®Œæ•´çš„åŒ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">pktNum&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 0x60ï¼š0110 0000ã€ 28ï¼š0001 1100
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x60&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="mi">28&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// &amp;amp; è·å–NRIã€| è·å–TYPE = 28
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// 1Fï¼š0001 1111 è·å–NALUçš„type
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//ç¬¬ä¸€åŒ…æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">|=&lt;/span> &lt;span class="mh">0x80&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// åˆ¤æ–­start 1000 0000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">remainPktSize&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">pktNum&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//æœ€åä¸€åŒ…æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">|=&lt;/span> &lt;span class="mh">0x40&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// åˆ¤æ–­end 0100 0000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">pos&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// é™¤FUä¸¤ä¸ªå­—èŠ‚ï¼Œå°†å‰©ä½™æ•°æ®æ”¾å…¥load
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rtpSendPacketOverUdp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// +2åŒ…å«FU
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sendBytes&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pos&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">RTP_MAX_PKT_SIZE&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å‘é€å‰©ä½™çš„æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">remainPktSize&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x60&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="mi">28&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">naluType&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x1F&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">|=&lt;/span> &lt;span class="mh">0x40&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//end
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">pos&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">remainPktSize&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rtpSendPacketOverUdp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">remainPktSize&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">seq&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sendBytes&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">ret&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">rtpHeader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timestamp&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">90000&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="mi">25&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// https://blog.csdn.net/jwybobo2007/article/details/7235942
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nl">out&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">sendBytes&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_OPTIONS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Public: OPTIONS, DESCRIBE, SETUP, PLAY&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_DESCRIBE&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">sdp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rtsp://%[^:]:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;v=0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;o=- 9%ld 1 IN IP4 %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;t=0 0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=control:*&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;m=video 0 RTP/AVP 96&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=rtpmap:96 H264/90000&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=control:track0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">NULL&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-Base: %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-type: application/sdp&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-length: %zu&lt;/span>&lt;span class="se">\r\n\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;%s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdp&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sdp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_SETUP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">client_Rtp_Port&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Transport: RTP/AVP;unicast;client_port=%d-%d;server_port=%d-%d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Session: 66334873&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">client_Rtp_Port&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">client_Rtp_Port&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">SERVER_RTP_PORT&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">SERVER_RTCP_PORT&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_PLAY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Range: npt=0.000-&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Session: 66334873; timeout=10&lt;/span>&lt;span class="se">\r\n\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">doClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">clientIP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">serverRtpSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">serverRtcpSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">client_Rtp_Port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">client_Rtcp_Port&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">BUF_MAX_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">sBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">BUF_MAX_SIZE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// å¾ªç¯æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ¯ä¸ªè¯·æ±‚å¹¶åšå¤„ç†
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">recvLen&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recvLen&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BUF_MAX_SIZE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">recvLen&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">recvLen&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sc">&amp;#39;\0&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s rBuf = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">__FUNCTION__&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">sep&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">strtok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// è§£æå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;OPTIONS&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;DESCRIBE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;SETUP&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;%s %s %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;CSeq&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">CSeq&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strncmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Transport:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Transport:&amp;#34;&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Transport: RTP/AVP/UDP;unicast;client_port=13358-13359
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Transport: RTP/AVP;unicast;client_port=13358-13359
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Transport: RTP/AVP/UDP;unicast;client_port=%d-%d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">client_Rtp_Port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">client_Rtcp_Port&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;parse Transport error &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">strtok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">NULL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æœåŠ¡ç«¯å›åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œç›®å‰åªæ˜¯å¡«å……äº†sBuf
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;OPTIONS&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_OPTIONS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle options&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;DESCRIBE&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_DESCRIBE&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle describe&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;SETUP&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">//SETUPè¿”å›æœåŠ¡ç«¯ ç«¯å£å·
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_SETUP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">client_Rtp_Port&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle setup&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆ›å»ºæœåŠ¡ç«¯ ç«¯å£å· ç”¨äºé€šä¿¡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">serverRtpSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">createUdpSocket&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serverRtcpSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">createUdpSocket&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="n">serverRtcpSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to create udp socket&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_RTP_PORT&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtcpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_RTCP_PORT&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to bind addr&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_PLAY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle play&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;æœªå®šä¹‰çš„method = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> sBuf = RTSP/1.0 200 OK
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> CSeq: 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> Content-Base: rtsp://127.0.0.1:8554
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> Content-type: application/sdp
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> Content-length: 125
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;sBuf = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> doClient rBuf = SETUP rtsp://127.0.0.1:8554/track0 RTSP/1.0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> Transport: RTP/AVP/UDP;unicast;client_port=16010-16011
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> CSeq: 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> User-Agent: Lavf58.45.100
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s sBuf = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">__FUNCTION__&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// å›åº”å®¢æˆ·ç«¯è¯·æ±‚ ç”¨å¡«å……åçš„sBuf
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//å¼€å§‹æ’­æ”¾ï¼Œå‘é€RTPåŒ…to Client
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">startCode&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">frame&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">500000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rtpPacket&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">RtpPacket&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">500000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FILE&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">fp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">H264_FILE_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rb&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// read binary
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;è¯»å– %s å¤±è´¥&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">H264_FILE_NAME&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æ­£å¸¸é¡ºåº 1: version padding extension csrcLen; 2: payloadType; 3: seq; 4: timestamp; 5:ssrc; 6:csrc
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">rtpHeaderInit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_VERSION&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RTP_PAYLOAD_TYPE_H264&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x88923423&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;start play&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;client ip:%s&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIP&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;client port:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">client_Rtp_Port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">getFrameFromH264File&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">500000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">frameSize&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;è¯»å–%sç»“æŸ,frameSize=%d &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">H264_FILE_NAME&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">startCode3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">startCode&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">startCode&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">frameSize&lt;/span> &lt;span class="o">-=&lt;/span> &lt;span class="n">startCode&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpSendH264Frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">client_Rtp_Port&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">startCode&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frameSize&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">usleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">40000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//usleep(40000);//1000/25 * 1000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">frame&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtpPacket&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CSeq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtpSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">serverRtcpSockfd&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverRtcpSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rtspServerSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">createTcpSocket&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to create tcp socket&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_PORT&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to bind addr&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to listen&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s rtsp://127.0.0.1:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">__FILE__&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_PORT&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">acceptClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to accept client&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;accept client;client ip:%s,client port:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rtspServerSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/c-/">C++</category><category domain="https://keepjolly.com/tags/rtsp/">RTSP</category></item><item><title>ç¬¬1è®²ï¼šRTSPåè®®è®²è§£åŠä»£ç å®ç°</title><link>https://keepjolly.com/posts/learn/rtsp-protocol-explanation-and-code-implementation/</link><guid isPermaLink="true">https://keepjolly.com/posts/learn/rtsp-protocol-explanation-and-code-implementation/</guid><pubDate>Fri, 26 May 2023 21:02:17 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;ul>
&lt;li>RTSPæ˜¯ä¸€ä¸ªå®æ—¶ä¼ è¾“æµåè®®ï¼Œæ˜¯ä¸€ä¸ªåº”ç”¨å±‚çš„åè®®ã€‚é€šå¸¸è¯´çš„RTSPåŒ…æ‹¬RTSPåè®®ã€RTPåè®®ã€RTCPåè®®ï¼Œå¯¹äºè¿™äº›åè®®çš„ä½œç”¨ç®€å•çš„ç†è§£å¦‚ä¸‹
&lt;ul>
&lt;li>RTSPåè®®ï¼šè´Ÿè´£æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„&lt;strong>è¯·æ±‚ä¸å“åº”&lt;/strong>&lt;/li>
&lt;li>RTPåè®®ï¼šè´Ÿè´£æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¹‹é—´&lt;strong>ä¼ è¾“åª’ä½“æ•°æ®&lt;/strong>&lt;/li>
&lt;li>RTCPåè®®ï¼šè´Ÿè´£æä¾›æœ‰å…³RTPä¼ è¾“è´¨é‡çš„åé¦ˆï¼Œå°±æ˜¯&lt;strong>ç¡®ä¿RTPä¼ è¾“çš„è´¨é‡&lt;/strong>&lt;/li>
&lt;li>ä¸‰è€…çš„å…³ç³»ï¼šrtspå¹¶ä¸ä¼šå‘é€åª’ä½“æ•°æ®ï¼Œåªæ˜¯å®ŒæˆæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„ä¿¡ä»¤äº¤äº’ï¼Œrtpåè®®è´Ÿè´£åª’ä½“æ•°æ®ä¼ è¾“ï¼Œrtcpè´Ÿè´£rtpæ•°æ®åŒ…çš„ç›‘è§†å’Œåé¦ˆã€‚rtpå’Œrtcpå¹¶æ²¡æœ‰è§„å®šä¼ è¾“å±‚çš„ç±»å‹ï¼Œå¯ä»¥é€‰æ‹©udpå’Œtcpã€‚Rtspçš„ä¼ è¾“å±‚åˆ™è¦æ±‚æ˜¯åŸºäºtcpã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ&lt;/h2>
&lt;h3 id="å®‰è£…ffmepg">å®‰è£…ffmepg&lt;/h3>
&lt;p>å› ä¸ºå·²ç»è£…è¿‡äº†ï¼Œæ‰€ä»¥è¿™é‡Œ&lt;a href="https://www.google.com.hk/search?q=ffmpeg%E4%B8%8B%E8%BD%BDubuntu">è‡ªè¡Œå®‰è£…&lt;/a>ã€‚&lt;/p>
&lt;h3 id="å®‰è£…wireshark">å®‰è£…wireshark&lt;/h3>
&lt;ol>
&lt;li>sudo apt-get update&lt;/li>
&lt;li>sudo apt-get install wireshark&lt;/li>
&lt;li>å‡ºç°ä¸€ä¸ªå¯¹è¯æ¡†é€‰yes&lt;/li>
&lt;li>å°†wiresharkåŠ å…¥åˆ°å½“å‰ç”¨æˆ·ï¼Œä½¿å…¶å¯ä»¥å‘½ä»¤è¡Œè®¿é—®ï¼Œsudo vim /etc/group
&lt;ol>
&lt;li>ï¼ˆåº”è¯¥åœ¨æœ€åä¸€è¡Œï¼‰æ‰¾åˆ°wiresharkï¼Œæœ€ååŠ å…¥ä½ çš„ubuntuç”¨æˆ·å&lt;/li>
&lt;li>wireshark:x:129:ubuntuç”¨æˆ·å&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>ç„¶åå‘½ä»¤è¡Œè¾“å…¥sudo wiresharkå³å¯&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/magiclyj/article/details/77231707">å‚è€ƒåšå®¢&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>æ³¨æ„è¿è¡Œéœ€è¦ç®¡ç†å‘˜è¿è¡Œï¼Œå³sudo&lt;/p>
&lt;p>é€‰æ‹©æœ¬åœ°å›ç¯ï¼šloopback&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210441.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="1.jpg">&lt;/p>
&lt;p>ç„¶ååŒå‡»è¯¥è¡Œï¼Œè¿›å…¥ç›‘å¬&lt;/p>
&lt;p>éšåè¿è¡Œç¨‹åºå³å¯ï¼Œç„¶åå†å¼€å¯ä¸€ä¸ªç»ˆç«¯ï¼ˆctrl+alt+Tï¼‰ï¼Œè¾“å…¥ffplay -i rtsp://127.0.0.1:8554&lt;/p>
&lt;p>ç„¶åwiresharkå°±ä¼šå‡ºç°&lt;/p>
&lt;p>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210441-1.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="2.jpg">&lt;/p>
&lt;h2 id="rtspç›¸å…³é€‰é¡¹">RTSPç›¸å…³é€‰é¡¹&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://blog.csdn.net/mlfcjob/article/details/109120103">options&lt;/a>è¯·æ±‚ï¼Œç”¨äºæŸ¥è¯¢RTSPæœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•ï¼ˆå¦‚DESCRIBEã€SETUPã€PLAYç­‰ï¼‰ã€‚
&lt;ul>
&lt;li>&lt;img src="https://pic.keepjolly.com/halo/blog/2023/05/20230526210441-2.jpg?imageMogr2/format/webp%7C?watermark/3/type/3/text/a2VlcGpvbGx5" alt="3.jpg">&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/mlfcjob/article/details/109120169">DESCRIBE&lt;/a>è¯·æ±‚ï¼Œç”¨äºè·å–æœ‰å…³æµåª’ä½“çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å®ƒçš„ç¼–ç æ ¼å¼ã€åˆ†è¾¨ç‡ã€ç ç‡ç­‰ã€‚ï¼ˆ&lt;a href="https://blog.csdn.net/uianster/article/details/125902301">sdp&lt;/a>ï¼‰&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/mlfcjob/article/details/109120217">SETUP&lt;/a>è¯·æ±‚ï¼Œä½œç”¨æ˜¯æŒ‡æ˜åª’ä½“æµè¯¥ä»¥ä»€ä¹ˆæ–¹å¼ä¼ è¾“ï¼›æ¯ä¸ªæµPLAYä¹‹å‰å¿…é¡»æ‰§è¡ŒSETUPæ“ä½œï¼›å‘é€SETUPè¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šæŒ‡å®šä¸¤ä¸ªç«¯å£ï¼Œä¸€ä¸ªç«¯å£ç”¨äºæ¥æ”¶RTPæ•°æ®ï¼›å¦ä¸€ä¸ªç«¯å£æ¥æ”¶RTCPæ•°æ®ï¼Œå¶æ•°ç«¯å£ç”¨æ¥æ¥æ”¶RTPæ•°æ®ï¼Œç›¸é‚»çš„å¥‡æ•°ç«¯å£ç”¨äºæ¥æ”¶RTCPæ•°æ®ï¼&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/mlfcjob/article/details/109336283">PLAY&lt;/a>è¯·æ±‚ï¼Œå‘é€æ’­æ”¾è¯·æ±‚çš„æ—¶å€™å¯ä»¥æŒ‡å®šæ’­æ”¾åŒºé—´ï¼å‘èµ·æ’­æ”¾è¯·æ±‚åï¼Œå¦‚æœè¿æ¥æ­£å¸¸ï¼Œåˆ™æœåŠ¡ç«¯å¼€å§‹æ’­æ”¾ï¼Œå³å¼€å§‹å‘å®¢æˆ·ç«¯æŒ‰ç…§ä¹‹å‰åœ¨TRASPORTä¸­çº¦å®šå¥½çš„æ–¹å¼å‘é€éŸ³è§†é¢‘æ•°æ®åŒ…ï¼æ’­æ”¾æµç¨‹ä¾¿è¿™æ ·å¼€å§‹äº†&lt;/li>
&lt;/ul>
&lt;h2 id="linuxä»£ç ">Linuxä»£ç &lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;span class="lnt">137
&lt;/span>&lt;span class="lnt">138
&lt;/span>&lt;span class="lnt">139
&lt;/span>&lt;span class="lnt">140
&lt;/span>&lt;span class="lnt">141
&lt;/span>&lt;span class="lnt">142
&lt;/span>&lt;span class="lnt">143
&lt;/span>&lt;span class="lnt">144
&lt;/span>&lt;span class="lnt">145
&lt;/span>&lt;span class="lnt">146
&lt;/span>&lt;span class="lnt">147
&lt;/span>&lt;span class="lnt">148
&lt;/span>&lt;span class="lnt">149
&lt;/span>&lt;span class="lnt">150
&lt;/span>&lt;span class="lnt">151
&lt;/span>&lt;span class="lnt">152
&lt;/span>&lt;span class="lnt">153
&lt;/span>&lt;span class="lnt">154
&lt;/span>&lt;span class="lnt">155
&lt;/span>&lt;span class="lnt">156
&lt;/span>&lt;span class="lnt">157
&lt;/span>&lt;span class="lnt">158
&lt;/span>&lt;span class="lnt">159
&lt;/span>&lt;span class="lnt">160
&lt;/span>&lt;span class="lnt">161
&lt;/span>&lt;span class="lnt">162
&lt;/span>&lt;span class="lnt">163
&lt;/span>&lt;span class="lnt">164
&lt;/span>&lt;span class="lnt">165
&lt;/span>&lt;span class="lnt">166
&lt;/span>&lt;span class="lnt">167
&lt;/span>&lt;span class="lnt">168
&lt;/span>&lt;span class="lnt">169
&lt;/span>&lt;span class="lnt">170
&lt;/span>&lt;span class="lnt">171
&lt;/span>&lt;span class="lnt">172
&lt;/span>&lt;span class="lnt">173
&lt;/span>&lt;span class="lnt">174
&lt;/span>&lt;span class="lnt">175
&lt;/span>&lt;span class="lnt">176
&lt;/span>&lt;span class="lnt">177
&lt;/span>&lt;span class="lnt">178
&lt;/span>&lt;span class="lnt">179
&lt;/span>&lt;span class="lnt">180
&lt;/span>&lt;span class="lnt">181
&lt;/span>&lt;span class="lnt">182
&lt;/span>&lt;span class="lnt">183
&lt;/span>&lt;span class="lnt">184
&lt;/span>&lt;span class="lnt">185
&lt;/span>&lt;span class="lnt">186
&lt;/span>&lt;span class="lnt">187
&lt;/span>&lt;span class="lnt">188
&lt;/span>&lt;span class="lnt">189
&lt;/span>&lt;span class="lnt">190
&lt;/span>&lt;span class="lnt">191
&lt;/span>&lt;span class="lnt">192
&lt;/span>&lt;span class="lnt">193
&lt;/span>&lt;span class="lnt">194
&lt;/span>&lt;span class="lnt">195
&lt;/span>&lt;span class="lnt">196
&lt;/span>&lt;span class="lnt">197
&lt;/span>&lt;span class="lnt">198
&lt;/span>&lt;span class="lnt">199
&lt;/span>&lt;span class="lnt">200
&lt;/span>&lt;span class="lnt">201
&lt;/span>&lt;span class="lnt">202
&lt;/span>&lt;span class="lnt">203
&lt;/span>&lt;span class="lnt">204
&lt;/span>&lt;span class="lnt">205
&lt;/span>&lt;span class="lnt">206
&lt;/span>&lt;span class="lnt">207
&lt;/span>&lt;span class="lnt">208
&lt;/span>&lt;span class="lnt">209
&lt;/span>&lt;span class="lnt">210
&lt;/span>&lt;span class="lnt">211
&lt;/span>&lt;span class="lnt">212
&lt;/span>&lt;span class="lnt">213
&lt;/span>&lt;span class="lnt">214
&lt;/span>&lt;span class="lnt">215
&lt;/span>&lt;span class="lnt">216
&lt;/span>&lt;span class="lnt">217
&lt;/span>&lt;span class="lnt">218
&lt;/span>&lt;span class="lnt">219
&lt;/span>&lt;span class="lnt">220
&lt;/span>&lt;span class="lnt">221
&lt;/span>&lt;span class="lnt">222
&lt;/span>&lt;span class="lnt">223
&lt;/span>&lt;span class="lnt">224
&lt;/span>&lt;span class="lnt">225
&lt;/span>&lt;span class="lnt">226
&lt;/span>&lt;span class="lnt">227
&lt;/span>&lt;span class="lnt">228
&lt;/span>&lt;span class="lnt">229
&lt;/span>&lt;span class="lnt">230
&lt;/span>&lt;span class="lnt">231
&lt;/span>&lt;span class="lnt">232
&lt;/span>&lt;span class="lnt">233
&lt;/span>&lt;span class="lnt">234
&lt;/span>&lt;span class="lnt">235
&lt;/span>&lt;span class="lnt">236
&lt;/span>&lt;span class="lnt">237
&lt;/span>&lt;span class="lnt">238
&lt;/span>&lt;span class="lnt">239
&lt;/span>&lt;span class="lnt">240
&lt;/span>&lt;span class="lnt">241
&lt;/span>&lt;span class="lnt">242
&lt;/span>&lt;span class="lnt">243
&lt;/span>&lt;span class="lnt">244
&lt;/span>&lt;span class="lnt">245
&lt;/span>&lt;span class="lnt">246
&lt;/span>&lt;span class="lnt">247
&lt;/span>&lt;span class="lnt">248
&lt;/span>&lt;span class="lnt">249
&lt;/span>&lt;span class="lnt">250
&lt;/span>&lt;span class="lnt">251
&lt;/span>&lt;span class="lnt">252
&lt;/span>&lt;span class="lnt">253
&lt;/span>&lt;span class="lnt">254
&lt;/span>&lt;span class="lnt">255
&lt;/span>&lt;span class="lnt">256
&lt;/span>&lt;span class="lnt">257
&lt;/span>&lt;span class="lnt">258
&lt;/span>&lt;span class="lnt">259
&lt;/span>&lt;span class="lnt">260
&lt;/span>&lt;span class="lnt">261
&lt;/span>&lt;span class="lnt">262
&lt;/span>&lt;span class="lnt">263
&lt;/span>&lt;span class="lnt">264
&lt;/span>&lt;span class="lnt">265
&lt;/span>&lt;span class="lnt">266
&lt;/span>&lt;span class="lnt">267
&lt;/span>&lt;span class="lnt">268
&lt;/span>&lt;span class="lnt">269
&lt;/span>&lt;span class="lnt">270
&lt;/span>&lt;span class="lnt">271
&lt;/span>&lt;span class="lnt">272
&lt;/span>&lt;span class="lnt">273
&lt;/span>&lt;span class="lnt">274
&lt;/span>&lt;span class="lnt">275
&lt;/span>&lt;span class="lnt">276
&lt;/span>&lt;span class="lnt">277
&lt;/span>&lt;span class="lnt">278
&lt;/span>&lt;span class="lnt">279
&lt;/span>&lt;span class="lnt">280
&lt;/span>&lt;span class="lnt">281
&lt;/span>&lt;span class="lnt">282
&lt;/span>&lt;span class="lnt">283
&lt;/span>&lt;span class="lnt">284
&lt;/span>&lt;span class="lnt">285
&lt;/span>&lt;span class="lnt">286
&lt;/span>&lt;span class="lnt">287
&lt;/span>&lt;span class="lnt">288
&lt;/span>&lt;span class="lnt">289
&lt;/span>&lt;span class="lnt">290
&lt;/span>&lt;span class="lnt">291
&lt;/span>&lt;span class="lnt">292
&lt;/span>&lt;span class="lnt">293
&lt;/span>&lt;span class="lnt">294
&lt;/span>&lt;span class="lnt">295
&lt;/span>&lt;span class="lnt">296
&lt;/span>&lt;span class="lnt">297
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#pragma comment(lib, &amp;#34;ws2_32.lib&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdint.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#pragma warning( disable : 4996 )
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SERVER_PORT 8554
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SERVER_RTP_PORT 55532
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SERVER_RTCP_PORT 55533
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">createTcpSocket&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setsockopt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SOL_SOCKET&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SO_REUSEADDR&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AF_INET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">htons&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">s_addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inet_addr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">acceptClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socklen_t&lt;/span> &lt;span class="n">len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr_in&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">sockaddr&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clientfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strcpy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">inet_ntoa&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_addr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="n">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ntohs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sin_port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">clientfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ä»¥ä¸Šå°±æ˜¯æ­£å¸¸çš„tcpè¿æ¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_OPTIONS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//replyä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Public: OPTIONS, DESCRIBE, SETUP, PLAY&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_DESCRIBE&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//replyä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">sdp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rtsp://%[^:]:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;v=0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;o=- 9%ld 1 IN IP4 %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;t=0 0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=control:*&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;m=video 0 RTP/AVP 96&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=rtpmap:96 H264/90000&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;a=control:track0&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">NULL&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">localIp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-Base: %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-type: application/sdp&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Content-length: %zu&lt;/span>&lt;span class="se">\r\n\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;%s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdp&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sdp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_SETUP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//replyä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Transport: RTP/AVP;unicast;client_port=%d-%d;server_port=%d-%d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Session: 66334873&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientRtpPort&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">SERVER_RTP_PORT&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">SERVER_RTCP_PORT&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">handleCmd_PLAY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cseq&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">//replyä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;RTSP/1.0 200 OK&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Range: npt=0.000-&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Session: 66334873; timeout=10&lt;/span>&lt;span class="se">\r\n\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cseq&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">doClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">clientIP&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientRtcpPort&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">rBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10000&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// client to server ç¼“å†²åŒº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">sBuf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10000&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// s to c ç¼“å†²åŒº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">recvLen&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recvLen&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2000&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">recvLen&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">recvLen&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sc">&amp;#39;\0&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">string&lt;/span> &lt;span class="n">recvStr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rBuf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// c to s buff
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s rBuf = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">__FUNCTION__&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">sep&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">strtok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;OPTIONS&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;DESCRIBE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;SETUP&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// sscanfå‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ç±»å‹ï¼Œè¡¨ç¤ºæˆåŠŸè¯»å–å¹¶åŒ¹é…çš„å‚æ•°ä¸ªæ•°ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;%s %s %s&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// åˆ¤æ–­Requestå¤´
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">strstr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;CSeq&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;CSeq: %d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">CSeq&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// åˆ¤æ–­å½“å‰lineå‰strlenä¸ªæ˜¯å¦æ˜¯CSeq
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strncmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Transport:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Transport:&amp;#34;&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// åˆ¤æ–­æ˜¯å¦transport
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Transport: RTP/AVP/UDP;unicast;client_port=13358-13359
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Transport: RTP/AVP;unicast;client_port=13358-13359
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Transport: RTP/AVP/UDP;unicast;client_port=%d-%d&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientRtcpPort&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;parse Transport error &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">strtok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">NULL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ç›¸ç­‰è¿”å›0ï¼Œå–ååˆ™è¿›å…¥æ‰§è¡Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;OPTIONS&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_OPTIONS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle options&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;DESCRIBE&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_DESCRIBE&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle describe&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;SETUP&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_SETUP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle setup&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">handleCmd_PLAY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CSeq&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to handle play&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;undefined method = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">method&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s sBuf = %s &lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">__FUNCTION__&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sBuf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ç»™å®¢æˆ·ç«¯å‘é€ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//send RTP pack
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;PLAY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;start play&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;client ip:%s&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIP&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;client port:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientRtpPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//usleep(40000);//1000/25 * 1000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span> &lt;span class="c1">// é‡ç½®ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CSeq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sBuf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">serverSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">createTcpSocket&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to create tcp socket&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bindSocketAddr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_PORT&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to bind addr&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to listen&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s rtsp://127.0.0.1:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">__FILE__&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">SERVER_PORT&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientSockfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">acceptClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to accept client&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;accept client;client ip:%s,client port:%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doClient&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientSockfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientIp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientPort&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">closesocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">serverSockfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ffmpegå…¥é—¨">ffmpegå…¥é—¨&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://zhuanlan.zhihu.com/p/413567427">ffmpegå‘½ä»¤è¡Œ è§†é¢‘ç”Ÿæˆå›¾ç‰‡&lt;/a>
&lt;ul>
&lt;li>ffmpeg -i input.mp4 -r 25 -f image2 data/image%3d.jpg&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://zhuanlan.zhihu.com/p/413449964">ffmpegå‘½ä»¤è¡Œ å›¾ç‰‡åˆå¹¶è§†é¢‘&lt;/a>
&lt;ul>
&lt;li>ffmpeg -r 1 -f image2 -i data/%d.jpg -vcodec libx264 -s 640*480 -g 1 -keyint_min 1 -sc_threshold 0 -pix_fmt yuv420p out.mp4&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://zhuanlan.zhihu.com/p/596277744">ffmpegå¸¸ç”¨å‘½ä»¤è¡Œ&lt;/a>
&lt;ul>
&lt;li>æ³¨æ„linuxæŸ¥çœ‹æ‘„åƒå¤´åˆ—è¡¨å‘½ä»¤ä¸ä¸€è‡´&lt;/li>
&lt;li>&lt;strong>æ‘„åƒå¤´æ¨æµåˆ°RTMPæœåŠ¡&lt;/strong>
&lt;ul>
&lt;li>ffmpeg -f dshow -i video=&amp;quot;USB webcam&amp;quot; -vcodec libx264 -acodec aac -ar 44100 -ac 1 -r 25 -s 1920*1080 -f flv rtmp://192.168.1.3/live/desktop&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>æ‘„åƒå¤´æ¨æµåˆ°RTSPï¼ˆrtp over tcpï¼‰&lt;/strong>
&lt;ul>
&lt;li>ffmpeg -f dshow -i video=&amp;quot;FULL HD webcam&amp;quot; -rtsp_transport tcp -vcodec libx264 -preset ultrafast -acodec libmp3lame -ar 44100 -ac 1 -r 25 -f rtsp rtsp://192.168.0.1/webcam&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/learn/">learn</category><category domain="https://keepjolly.com/tags/c-/">C++</category><category domain="https://keepjolly.com/tags/rtsp/">RTSP</category></item><item><title>zmq å°ç™½ç®€æ˜“å®‰è£…C++ç‰ˆ</title><link>https://keepjolly.com/posts/tech/zmq-install/</link><guid isPermaLink="true">https://keepjolly.com/posts/tech/zmq-install/</guid><pubDate>Fri, 26 May 2023 20:55:03 +0800</pubDate><author>1366475809@qq.com (Rurouni)</author><copyright>åœ¨ä¿ç•™æœ¬æ–‡ä½œè€…åŠæœ¬æ–‡é“¾æ¥çš„å‰æä¸‹ï¼Œéå•†ä¸šç”¨é€”éšæ„è½¬è½½åˆ†äº«(æˆ‘ä¼šé«˜å¼ºåº¦è‡ªæœçš„å–”ğŸ‘Š)ã€‚</copyright><description>&lt;p>ä¸»è¦å‚è€ƒåšå®¢:&lt;a href="https://www.cnblogs.com/y4247464/p/14241876.html"> åœ¨cmakeå·¥ç¨‹ä¸­ä½¿ç”¨ZeroMQ&lt;/a>,å¹¶åŠ ä»¥è¡¥å……
æ¬¡è¦åšå®¢:&lt;a href="https://blog.csdn.net/qq_41453285/article/details/105989698">Linuxä¸‹ZeroMQçš„ç¼–è¯‘å®‰è£…ä¸è¿è¡Œ&lt;/a>
æ–‡ä¸­æåˆ°arm,æˆ‘åªè£…åœ¨linuxç³»ç»Ÿä¸Šï¼ŒåŸæœ¬æƒ³ç”¨åœ¨é€šä¿¡ä¸­ï¼Œæœ€åè¿˜æ˜¯ç”¨tcpå®ç°äº†&lt;/p>
&lt;h2 id="å®‰è£…libzmq">å®‰è£…libzmq&lt;/h2>
&lt;ol>
&lt;li>git clone &lt;a href="https://github.com/zeromq/libzmq.git">https://github.com/zeromq/libzmq.git&lt;/a>
&lt;ol>
&lt;li>åœ¨å½“å‰æ–‡ä»¶å¤¹å†…ä¸‹è½½libzmqæ–‡ä»¶å¤¹,å»ºè®®å…ˆcdåˆ°ä½ æƒ³è¦æ”¾çš„æ–‡ä»¶å¤¹&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>cd libzmq&lt;/li>
&lt;li>./autogen.sh&lt;/li>
&lt;li>./configure&lt;/li>
&lt;/ol>
&lt;h3 id="å®‰è£…zmqpp">å®‰è£…zmqpp&lt;/h3>
&lt;ol>
&lt;li>git clone &lt;a href="https://github.com/zeromq/zmqpp.git">https://github.com/zeromq/zmqpp.git&lt;/a>
&lt;ol>
&lt;li>åŒç†,æ‰¾ä¸ªæ–‡ä»¶å¤¹æ”¾&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>make -j4 &amp;amp;&amp;amp; sudo make install&lt;/li>
&lt;/ol>
&lt;p>ä¸Šè¿°å®‰è£…å®ŒæˆåæŸ¥çœ‹å¤´æ–‡ä»¶å’Œåº“æ–‡ä»¶è·¯å¾„&lt;/p>
&lt;blockquote>
&lt;p>å¦‚æœå½“å‰åœ¨ç”¨æˆ·è·¯å¾„ä¸‹ cd ../../user&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>å¤´æ–‡ä»¶è·¯å¾„ ï¼š /usr/local/include
åº“æ–‡ä»¶è·¯å¾„ : /usr/local/lib&lt;/p>
&lt;/blockquote>
&lt;h3 id="cmakelisttxt">CMakeList.txt&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmake" data-lang="cmake">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cmake_minimum_required&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">VERSION&lt;/span> &lt;span class="s">3.10&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="s">CMAKE_SYSTEM_PROCESSOR&lt;/span> &lt;span class="s">MATCHES&lt;/span> &lt;span class="s2">&amp;#34;x86_64&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nb">set&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">ARCH_DIR&lt;/span> &lt;span class="s">x86&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">else&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nb">set&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">ARCH_DIR&lt;/span> &lt;span class="s">arm&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">endif&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">set&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">CMAKE_C_FLAGS&lt;/span> &lt;span class="s2">&amp;#34;${CMAKE_C_FLAGS}&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">set&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">CMAKE_CXX_FLAGS&lt;/span> &lt;span class="s2">&amp;#34;${CMAKE_CXX_FLAGS} -std=c++11&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">include_directories&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="o">}&lt;/span>&lt;span class="s">/../opencv3415/include&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">set&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">link_libs&lt;/span> &lt;span class="o">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="o">}&lt;/span>&lt;span class="s">/../opencv3415/lib/libopencv_core.so&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="o">}&lt;/span>&lt;span class="s">/../opencv3415/lib/libopencv_highgui.so&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="o">}&lt;/span>&lt;span class="s">/../opencv3415/lib/libopencv_imgcodecs.so&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="o">}&lt;/span>&lt;span class="s">/../opencv3415/lib/libopencv_imgproc.so&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">${&lt;/span>&lt;span class="nv">CMAKE_SOURCE_DIR&lt;/span>&lt;span class="o">}&lt;/span>&lt;span class="s">/../opencv3415/lib/libopencv_videoio.so&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">zmq&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">zmqpp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nb">add_executable&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">server&lt;/span> &lt;span class="s">src/Server.cpp&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c"># å¯æ‰§è¡Œæ–‡ä»¶server .cppæ–‡ä»¶è·¯å¾„
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nb">target_link_libraries&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">server&lt;/span> &lt;span class="s">PRIVATE&lt;/span> &lt;span class="o">${&lt;/span>&lt;span class="nv">link_libs&lt;/span>&lt;span class="o">}&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="servercppç®€æ˜“æ¡ˆä¾‹">server.cppç®€æ˜“æ¡ˆä¾‹&lt;/h3>
&lt;h4 id="server">server&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;zmqpp/zmqpp.hpp&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;thread&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;opencv2/opencv.hpp&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;mutex&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="k">namespace&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="k">namespace&lt;/span> &lt;span class="n">cv&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">zmqpp&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">context&lt;/span> &lt;span class="n">context&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">zmqpp&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">socket_type&lt;/span> &lt;span class="n">type&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">zmqpp&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">socket_type&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">rep&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">zmqpp&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">socket&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">context&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">type&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">string&lt;/span> &lt;span class="n">address&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;tcp://*:5555&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">address&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">zmqpp&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">message&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">receive&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">string&lt;/span> &lt;span class="n">image_data&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">message&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">image_data&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// use get() to retrieve message content
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">td&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34;Received image with size &amp;#34;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">image_data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34; bytes&amp;#34;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// process the image data here
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">zmqpp&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">message&lt;/span> &lt;span class="n">reply&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">string&lt;/span> &lt;span class="n">reply_message&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;Image received!&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">reply_message&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">socket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">reply&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="client">client&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">zmq&lt;/span> &lt;span class="c1"># pip install zmq&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">context&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">zmq&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Context&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">socket&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">context&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">zmq&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">REQ&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">connect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;tcp://localhost:5555&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">with&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;image.jpg&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;rb&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">file&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">image_data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">message&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">zmq&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">image_data&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">reply&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">recv&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">reply&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description><category domain="https://keepjolly.com/posts/">posts</category><category domain="https://keepjolly.com/posts/tech/">tech</category><category domain="https://keepjolly.com/tags/install/">Install</category></item></channel></rss>